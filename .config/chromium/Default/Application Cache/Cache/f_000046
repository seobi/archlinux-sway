define("HubsExtension/ArmExplorer/ViewModels/ArmExplorerBrowserPartVM",["require","exports","f","ko","HubsExtension/ArmExplorer/ArmExplorerClientStrings","HubsExtension/ArmHelpers/ArmApis","HubsExtension/ArmHelpers/ArmApisStartup"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){var o=i.ViewModels.Controls.Lists.TreeView,s=o.ViewModel,t=undefined,h=(function(){function n(t,i,u,f){var e=this;this._treeViewItems=r.observableArray();this._loadInitialData();this._editorPart=f;this.treeView=new s(t,this._treeViewItems,11,{onDemandLoadable:{loadItem:function(n){e.processLoadItem(u,n)}},selectable:{createSelection:function(n,t){e._processSelection(n,t,u)}},loadableByContinuationToken:{loadMoreNode:function(n,t){var i=n;return t=n.nextLink(),t===null?Q.resolve({items:[],continuationToken:null}):e.processLoadItem(u,i,t).then((function(n){return i.nextLink(n),Q.resolve({items:[],continuationToken:n})}))}}});this.treeView.pathSeparator=n.DELIMITER}return n.prototype.addItemsToParent=function(
n,t,i){var s=n.items().length>0,e=[],o=n.items(),f;if(s&&o.forEach((function(n){e.push(n.id)})),!t||!t.length&&!n.items().length){n.items.push({text:r.observable(u.Browser.empty),type:12});n.nextLink(null);return}f=t.map((function(n){return i(n)}));f.sort((function(n,t){return n.text().toLowerCase()<t.text().toLowerCase()?-1:1}));f.forEach((function(t){e.indexOf(t.id)===-1&&(t.parent=n,o.push(t))}));n.items.valueHasMutated()},n.prototype._loadInitialData=function(){this._treeViewItems.removeAll();this._treeViewItems.push({text:r.observable(u.Browser.providers),metadata:{loadable:r.observable(!0)},type:1,id:u.Browser.providers,nextLink:r.observable(null)},{text:r.observable(u.Browser.subscriptions),metadata:{loadable:r.observable(!0)},type:0,id:u.Browser.subscriptions,nextLink:r.observable(null)})},n.prototype.setCloudName=function(n){this._cloudName=n},n.prototype.processLoadItem=function(n,t,i){var r=this,f;switch(t.type){case 1:f=n.getProviders({cloudName:this._cloudName}).then((function(n){var
i=n.value;return r.addItemsToParent(t,i,(function(t){return r.stringToItem(n.nextLink,t.namespace,2)})),n.nextLink}));break;case 0:f=n.getSubscriptions(this._cloudName).then((function(n){var i=n.value;return r.addItemsToParent(t,i,r.subscriptionToItem),n.nextLink}));break;case 2:f=n.getResourceTypes({id:t.id,nextLink:i,cloudName:this._cloudName}).then((function(n){var u=n.value;return r.addItemsToParent(t,u,(function(n){return r.stringToItem(i,n.resourceType,3,!1)})),n.nextLink}));break;case 7:f=n.getResourcesByType({id:t.parent.parent.id,cloudName:this._cloudName,resourceType:t.parent.id+"/"+t.id,nextLink:i}).then((function(n){var u=n.value;return r.addItemsToParent(t,u,(function(n){return r.stringToItem(i,n.name,8,!1,n.id)})),t.nextLink(n.nextLink),n.nextLink||null}));break;case 9:f=n.getResourceGroups({id:t.id,nextLink:i,cloudName:this._cloudName}).then((function(n){var i=n.value;return r.addItemsToParent(t,i,r.resourceGroupToItem),t.nextLink(n.nextLink),n.nextLink||null}));break;case 16:f=n.getDeployments(
{id:t.parent.id,nextLink:i,cloudName:this._cloudName}).then((function(n){var u=n.value;return r.addItemsToParent(t,u,(function(n){return r.stringToItem(i,n.name,17,!0,n.id)})),n.nextLink||null}));break;case 15:f=n.getResources({id:t.parent.parent.id,cloudName:this._cloudName,resourceGroupName:t.parent.text(),nextLink:i}).then((function(n){var u=n.value;return r.addItemsToParent(t,u,(function(n){return r.stringToItem(i,"["+n.type+"] "+n.name,8,!1,n.id)})),t.nextLink(n.nextLink),n.nextLink||null}));break;case 5:this.populateListProviders(t,n,null);f=Q.resolve(null);break;case 6:this.populateSubscriptionProvider(t,n,null);f=Q.resolve(null);break;case 10:this.populateResourceGroup(t,i);f=Q.resolve(null);break;case 17:this.addItemsToParent(t,[this.stringToItem(null,u.Browser.operations,19,!0,t.id)],(function(n){return n}));break;case 19:f=n.getOperations({deploymentId:t.id,cloudName:this._cloudName}).then((function(n){r.addItemsToParent(t,n.value,(function(n){return r.stringToItem(i,n.operationId,18,!1,
n.id)}));t.nextLink(n.nextLink)}));break;default:f=Q.resolve(null)}return f||(f=Q()),f.catch((function(n){r._addErrorNode(t,n.exception)})),f},n.prototype._processSelection=function(n,t,i){var u=this,r;this._selectedItem=n;r=this._editorPart.resourceUriTextBox.value();switch(n.type){case 1:r=f.listResourceProvidersApi();break;case 0:r=e.listSubscriptions();break;case 2:case 6:r=f.getResourceProviderApi(n.id);break;case 7:r=e.resourcesAcrossSubscriptionsApi([n.parent.parent.id],n.parent.id+"/"+n.id);break;case 9:r=e.resourceGroupsInSubscriptionApi(n.id);break;case 16:r=f.listDeploymentsApi(n.parent.id);break;case 17:r=f.singleDeploymentApi(n.id);break;case 10:r=e.resourceGroupApi(n.id);break;case 15:r=f.resourcesInResourceGroupByNameApi(n.parent.parent.id,n.id);break;case 3:r=f.getResourceProviderApi(n.parent.id);break;case 5:r=f.listResourceProvidersApi(n.id);break;case 4:r=f.getSubscriptionApi(n.id);break;case 8:e.resourceApi(n.id,this._cloudName).then((function(n){u._editorPart.resourceUriTextBox.
value(decodeURIComponent(n))}));break;case 18:r=f.singleDeploymentOperationApi(n.id);break;case 19:r=f.deploymentOperationsApi(n.id);break;case 14:this._refreshTree(i,t)}this._editorPart.resourceUriTextBox.value()!==r&&this._editorPart.resourceUriTextBox.value(decodeURIComponent(r));this._editorPart.resourceTitle(n.text())},n.prototype.populateListProviders=function(n,t,i){var r=this;return t.getResources({id:n.id,nextLink:i,cloudName:this._cloudName}).then((function(t){var f=t.value,u=[];return f.forEach((function(n){var t=n.type.substr(0,n.type.indexOf("/"));~u.indexOf(t)||u.push(t)})),u.sort(),r.addItemsToParent(n,u,(function(n){return r.stringToItem(null,n,6)})),n.nextLink(i),i}))},n.prototype.populateSubscriptionProvider=function(n,t,i){var r=this;return t.getResources({id:n.parent.id,nextLink:i,cloudName:this._cloudName}).then((function(t){var f=t.value,u=[];return f.forEach((function(t){if(t.type.indexOf(n.id)!==-1){var i=t.type.indexOf("/");u.indexOf(t.type.substr(i+1))===-1&&u.push(t.type.
substr(i+1))}})),r.addItemsToParent(n,u,(function(n){return r.stringToItem(null,n,7,!0)})),n.nextLink(i),i}))},n.prototype.populateResourceGroup=function(n,t){n.items&&n.items().length>0||(n.nextLink(t),n.items([{text:r.observable(u.Browser.resources),metadata:{loadable:r.observable(!0)},id:n.text(),type:15,parent:n,nextLink:r.observable(t||null)},{text:r.observable(u.Browser.deployments),metadata:{loadable:r.observable(!0)},id:n.text(),type:16,parent:n,nextLink:r.observable(t||null)}]))},n.prototype.subscriptionToItem=function(n){return{text:r.observable(n.displayName),metadata:{loadable:r.observable(!1)},id:n.subscriptionId,type:4,nextLink:r.observable(null),items:r.observableArray([{text:r.observable(u.Browser.providers),metadata:{loadable:r.observable(!0)},id:n.subscriptionId,type:5,nextLink:r.observable(t)},{text:r.observable(u.Browser.resourceGroups),metadata:{loadable:r.observable(!0)},id:n.subscriptionId,type:9,nextLink:r.observable(t)}])}},n.prototype.resourceGroupToItem=function(
n){return{text:r.observable(n.name),metadata:{loadable:r.observable(!0)},id:n.id,type:10,items:r.observableArray(),nextLink:r.observable(null)}},n.prototype.stringToItem=function(n,i,u,f,e){return f===void 0&&(f=!0),f=f?!0:t,{text:r.observable(i),id:e||i,type:u,metadata:{loadable:r.observable(f)},nextLink:r.observable(t)}},n.prototype.loadPath=function(t,i,r){var u=this,f=t.indexOf(n.DELIMITER),o,e;f=f===-1?t.length:f;o=t.substr(0,f);e=t.substr(f+1);r=r||this.treeView.items();r.forEach((function(n){n.text()===o&&(u.treeView.expandNode(n),u.processLoadItem(i,n).then((function(){if(u.loadPath(e,i,n.items()),!e.length){var t=u._selectedItem;t&&t.metadata.selected(!1);u._processSelection(n,null,i);n.metadata.selected(!0)}})))}))},n.prototype._addErrorNode=function(n,t){var i;switch(t.status){case 404:case 429:i=u.Browser.refresh;break;case 403:i=u.Browser.forbidden;break;case 400:i=u.Browser.badRequest;break;default:i=t.statusText}this.addItemsToParent(n,[this.stringToItem(null,i,14,!1)],(function(
n){return n}))},n.prototype._refreshTree=function(n,t){n.clearCaches();this._loadInitialData();this.loadPath(t,n)},n.DELIMITER="â•”",n})();n.ArmExplorerBrowserPartVM=h})(o||(o={})),o}));define("HubsExtension/ArmExplorer/ViewModels/ArmExplorerEditorPartVM",["require","exports","f","i","ko","FxHubs/RpcEndPoints","HubsExtension/ArmExplorer/ArmExplorerClientStrings","HubsExtension/ArmHelpers/ArmApisStartup"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var a=i.Base,h=a.Constants,c=h.AssetNames,v=h.ExtensionNames,y=v.Hubs,p=i.ViewModels.Controls,w=p.Documents.Editor,b=w.ViewModel,t=i.ViewModels.Services.ResourceTypes,k=i.ViewModels.Forms,s=r.Extension.CloudName,d=f.AssetTypes,g=r.Rpc,l=e.EditorPart,nt=(function(){function n(n){var t=this,r={label:u.observable("")},i=this.resourceUriTextBox=new k.TextBox.ViewModel(n,r);i.enabled(!1);this.openButtonLabel=u.observable(l.openButton);this.resourceTitle=u.observable(l.defaultTitle);this.responseTime=u.observable("");this.initializeEditor(
n);this.initializeHotspot(n);i.value.subscribe(n,(function(n){t.hotspot.selectable.isSelected(!1);t.responseTime("");t.activateHotspot(n);t.makeRequest()}))}return n.prototype.initializeEditor=function(n){var t={fileMatch:["*.tslint"],uri:"test-schema",schema:{title:"JSON schema",type:"object",properties:{curly:{description:l.jsonLint,type:"boolean"}}}},i={json:{schemas:[t]}};this.resourceEditor=new b(n,19,"",{readOnly:!0,tabSize:4},undefined,undefined,undefined,i)},n.prototype._isSameResourceId=function(n){var t=this.resourceUriTextBox.value()||"";return t.startsWith(n)},n.prototype.setCloudName=function(n){this._cloudName=n},n.prototype.makeRequest=function(){var n=this,t=this.resourceUriTextBox.value(),i=Date.now(),r=function(){return"("+e.EditorPart.responseTime.format(Date.now()-i)+")"};return o.call(t,"GET",undefined,this._cloudName,o.makeResourceManagerTelemetry("ArmExplorerEditor")).then((function(t){var i=t&&t.id;typeof i=="string"&&n.activateHotspot(t.id);n.resourceEditor.content(
JSON.stringify(t,null,4))})).catch((function(t){n.resourceEditor.content(JSON.stringify(t,null,4));n.hotspotVisibility(!1)})).finally((function(){n.responseTime(r())}))},n.prototype.initializeHotspot=function(n){this.hotspotVisibility=u.observable(!1);this.hotspot=new p.HotSpot.ViewModel(n)},n.prototype.activateHotspot=function(n){var r=this,u,i;this.hotspotVisibility(!1);u=new a.UriBuilder(n);n=u.path;i=this.hotspot.selectable.selectedValue;t.isDeploymentId(n)&&this._isSameResourceId(n)?(i({assetType:c.Deployments,extension:y,detailBladeInputs:s.addToModel(this._cloudName,{id:n})}),this.hotspotVisibility(!0)):t.isResourceId(n)?(i({cloudName:this._cloudName,resourceId:n,detailBladeInputs:s.addToModel(this._cloudName,{id:n})}),this.hotspotVisibility(!0)):t.isResourceGroupId(n)&&this._isSameResourceId(n)?(i({assetType:c.ResourceGroups,extension:y,detailBladeInputs:s.addToModel(this._cloudName,{id:n})}),this.hotspotVisibility(!0)):t.isSubscriptionId(n)&&d.mapAssetIdToDynamicSelectionAndIconEndPoint.
invoke(g.client,h.Shell,{assetTriplet:{assetType:c.SubscriptionDetail,extensionName:v.Billing,assetId:t.parseSubscriptionDescriptor(n).subscription},cloudName:this._cloudName}).then((function(t){r._isSameResourceId(n)&&(s.addToModel(r._cloudName,t.selection.detailBladeInputs),i(t.selection),r.hotspotVisibility(!0))}))},n})();n.ArmExplorerEditorPartVM=nt})(s||(s={})),s}));define("HubsExtension/ArmExplorer/ViewModels/ArmExplorerSearchPartVM",["require","exports","f","ko","HubsExtension/ArmExplorer/ArmExplorerClientStrings","HubsExtension/ArmExplorer/ViewModels/ArmExplorerBrowserPartVM"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var l=i.ViewModels.Forms.Section,h=l.ViewModel,o=i.ViewModels.Services.ResourceTypes,e=i.ViewModels.Obsolete.Forms.FilterComboBox,s=u.Search,t=u.Browser,c=f.ArmExplorerBrowserPartVM.DELIMITER,a=(function(){function n(n,t,i,u){this._browserPart=u;this._initialData=[new e.HierarchicalFormOptionItem("","")];this._setupSearchBox(n,i);this._resourceToUriMap=
{};this._resourceGroupToUriMap={};this._isSearching=r.observable(!1);this._dataContext=i}return n.prototype.setCloudName=function(n){var t=this.searchFilterComboBox;this._cloudName=n;this._dataContext.getSubscriptions(n).then((function(n){var i=n.value;i.length||(t.disabled(!0),t.emptyValueText(s.noSubscriptions))}),(function(){t.disabled(!0);t.emptyValueText(s.errorLoading)}))},n.prototype._setupSearchBox=function(n,t){var i=this,u,f,o;this._dropDownOptions=r.observableArray(this._initialData);u={options:this._dropDownOptions,emptyValueText:r.observable(s.prompt),defaultValue:r.observable("")};this.searchFilterComboBox=new e.ViewModel(n,u);f={submit:r.observable(this.submitOnEnter.bind(this,t)),children:r.observableArray([this.searchFilterComboBox,])};o=new h(n.createChildLifetime(),f);this.searchFilterComboSection=new h(n,o);this.searchFilterComboBox.value.subscribe(n,(function(n){var r=i._isSearching;r()||(r(!0),i._onUserInput(n,t),r(!1))}));this._lastSearchTs=null},n.prototype._onUserInput=
function(n,i){var r=this,f;n=n.toLowerCase();var s=this._lastSearchTs=(new Date).getTime(),h=this._cloudName,u=this._dropDownOptions;u.removeAll();f=u();i.searchResourceGroups(n,h).then((function(n){s===r._lastSearchTs&&(n.forEach((function(n){var i="["+t.resourceGroup+"] "+n.name;f.push(new e.HierarchicalFormOptionItem(i,n.name));r._resourceGroupToUriMap[i]=n.id})),u.valueHasMutated())}));i.searchResources(n,h).then((function(n){s===r._lastSearchTs&&(n.forEach((function(n){var t=o.parseResourceDescriptor(n.id),i="["+t.provider+"/"+t.type+"] "+t.resourceGroup+"/"+t.resource;f.push(new e.HierarchicalFormOptionItem(i,t.resource));r._resourceToUriMap[i]=n.id})),u.valueHasMutated())}))},n.prototype.submitOnEnter=function(n){var i=this.searchFilterComboBox.value(),r=this._resourceToUriMap[i],t;return r&&this._sendResourceId(r,n),t=this._resourceGroupToUriMap[i],t&&this._sendResourceGroupId(t,n),Q({success:!0})},n.prototype._sendResourceId=function(n,i){var r=this;i.getSubscriptions(this._cloudName).
then((function(u){var s=u.value,f=o.parseResourceDescriptor(n),e;s.some((function(n){return n.subscriptionId===f.subscription?(e=n.displayName,!0):!1}));r._browserPart.loadPath([t.subscriptions,e,t.resourceGroups,f.resourceGroup,t.resources,"["+f.provider+"/"+f.type+"] "+f.resource].join(c),i)}))},n.prototype._sendResourceGroupId=function(n,i){var r=this;i.getSubscriptions(this._cloudName).then((function(u){var s=u.value,f=o.parseResourceGroupDescriptor(n),e;s.some((function(n){return n.subscriptionId===f.subscription?(e=n.displayName,!0):!1}));r._browserPart.loadPath([t.subscriptions,e,t.resourceGroups,f.resourceGroup].join(c),i)}))},n})();n.ArmExplorerSearchPartVM=a})(e||(e={})),e}));define("HubsExtension/ArmExplorer/ViewModels/ArmExplorerBladeVM",["require","exports","f","i","ko","HubsExtension/ArmExplorer/ArmExplorerClientStrings","HubsExtension/ArmExplorer/ViewModels/ArmExplorerBrowserPartVM","HubsExtension/ArmExplorer/ViewModels/ArmExplorerEditorPartVM","HubsExtension/ArmExplorer/ViewModels/ArmExplorerSearchPartVM"],
(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){var t=i.Base,h=r.Extension.CloudName,c=(function(){function n(n,r,h){var c=this;this.title=u.observable(f.ArmExplorerBlade.title);this.subtitle=u.observable("");this.icon=u.observable(i.Base.Images.Polychromatic.FolderCube());this.editorPartVM=new o.ArmExplorerEditorPartVM(n,r,h);this.browserPartVM=new e.ArmExplorerBrowserPartVM(n,r,h,this.editorPartVM);this.searchPartVM=new s.ArmExplorerSearchPartVM(n,r,h,this.browserPartVM);t.Security.getUserInfo().then((function(n){c.subtitle(n.directoryName)}))}return n.prototype.onInputsSet=function(n){var t=h.readFromInputs(n);this.searchPartVM.setCloudName(t);this.browserPartVM.setCloudName(t);this.editorPartVM.setCloudName(t);return},n})();n.ArmExplorerBladeVM=c})(h||(h={})),h}));define("HubsExtension/_generated/Blades/ArmExplorerEditor.css",["require","exports"],(function(){"use strict";return".ext-armexplorer-browser-area{float:left;border-right:1px solid #ccc;width:calc(25% - 10px);height:calc(100% - 51px)}.ext-armexplorer-editor-area{float:right;width:75%;height:100%}.ext-armexplorer-editor-title{float:left;display:inline-block}.ext-armexplorer-editor-responsetime{margin-left:20px;margin-top:5px;display:inline-block}.ext-armexplorer-editor-open{float:left;display:inline-block;margin-right:10px;vertical-align:bottom;padding:2.5px 5px;text-align:center;min-width:60px;border:1px solid #2d3239}.ext-armexplorer-editor-header{min-height:30px}.ext-armexplorer-editor-controls{clear:both;margin-top:16px}.ext-armexplorer-editor-btn{margin-right:10px;float:left;display:inline-block;vertical-align:bottom}.ext-armexplorer-editor-uri{display:inline-block;vertical-align:bottom;width:calc(100% - 10px)}.ext-armexplorer-editor-uri-container{float:none;overflow:hidden}.ext-armexplorer-editor{clear:both;margin-top:16px;width:calc(100% - 10px);height:calc(100% - 150px)}.ext-armexplorer-search-container{height:51px;width:calc(100% - 30px)}.ext-armexplorer-search-icon{position:relative;width:14px;height:14px;opacity:.3;top:21px;left:3px}.ext-armexplorer-search-filtercombobox{max-width:100%;padding-top:3px;padding-left:23px}"})
);define("HubsExtension/_generated/Blades/ArmExplorerBlade",["require","exports","f","HubsExtension/_generated/Blades/ArmExplorerEditor.css","HubsExtension/ArmExplorer/ViewModels/ArmExplorerBladeVM"],(function(n,t,i,r){"use strict";var u;return (function(n){n.blade={name:"ArmExplorerBlade",viewModelName:"ArmExplorer$ArmExplorerBladeVM",lenses:[],width:3,pinnable:!0,initialDisplayState:2,templateBlade:{htmlTemplate:null,details:[{invocationInputArguments:[{valuesFrom:[{referenceType:3,property:"content.editorPartVM.hotspot.selectable"}]}]}],partSize:9,htmlTemplateInline:{file:"ArmExplorerTemplate.html",content:'<div class="ext-armexplorer-browser-area"> <div class=\'ext-armexplorer-search-container\'> <div class=\'ext-armexplorer-search-icon\' data-bind=\'image: MsPortalFx.Base.Images.Search()\'><\/div> <div class=\'ext-armexplorer-search-filtercombobox\' data-bind="pcSection: searchPartVM.searchFilterComboSection"><\/div> <\/div> <div class="msportalfx-overflowY" data-bind=\'pcControl: browserPartVM.treeView\'><\/div> <\/div> <div class="ext-armexplorer-editor-area"> <div class="ext-armexplorer-editor-header"> <div class="ext-armexplorer-editor-title msportalfx-text-createsectionheader" data-bind="text: editorPartVM.resourceTitle"><\/div> <div class="ext-armexplorer-editor-responsetime" data-bind="visible: editorPartVM.responseTime().length > 0, text: editorPartVM.responseTime"><\/div> <\/div> <div class="ext-armexplorer-editor-controls"> <div class="ext-armexplorer-editor-open msportalfx-bgcolor-k2" data-bind="pcHotSpot: editorPartVM.hotspot, visible: editorPartVM.hotspotVisibility, text: editorPartVM.openButtonLabel"><\/div> <div class="ext-armexplorer-editor-uri-container"> <div class="ext-armexplorer-editor-uri" data-bind="formElement: editorPartVM.resourceUriTextBox"><\/div> <\/div> <\/div> <div class="ext-armexplorer-editor"> <div data-bind="pcControl: editorPartVM.resourceEditor"><\/div> <\/div> <\/div> '},
styleSheets:[{file:"Blades/ArmExplorerEditor.css",content:r}]},attributes:0}})(u||(u={})),u}))