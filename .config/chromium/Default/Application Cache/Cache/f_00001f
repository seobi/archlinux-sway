//! msrcrypto.js
//! version : 1.5
//! authors : Microsoft Research
//! license : Apache 2.0
//! https://www.microsoft.com/en-us/download/details.aspx?id=52439
"use strict";var msrCryptoVersion="1.5";(function(n,t){typeof define=="function"&&define.amd?define("_oss/msrCrypto",["o","a"],(function(){return n.msrCrypto=t(n)})):n.msrCrypto=t(n)})(this,(function(n){var t=function(){function ri(){function f(n){var t,i=null;if(arguments.length&&typeof arguments[0]!="number"){if(typeof arguments[0]=="object")for(i=new Array(n.length),t=0;t<n.length;t+=1)i[t]=n[t]}else for(i=new Array(n),t=0;t<n;t+=1)i[t]=0;return i}function tt(n){for(var i=new Array(n.length),t=0;t<n.length;)i[t]=n[n.length-t-1],t+=1;return i}function ot(n,t){var i,f,r,e;for(n=n.replace(/^\s+|\s+$/g,""),i=[0],f=[0],t=t||10,r=0;r<n.length;r+=1){if(e=parseInt(n[r],t),isNaN(e))throw new Error("Failed to convert string to integer in radix "+t.toString());a(i,t,f);b(f,[e],i);u(i)}return i}function st(n,t){var l,a,y;if(t=t||10,r<=t)throw new Error("DIGIT_BASE is smaller than RADIX; cannot convert.");var p=n.length,h=[],v=[],w=[],b=[],o=[],e=[],f,i="",c="0";for(o[0]=t;Math.floor(r/o[0])>=t;)o[
0]=o[0]*t,c=c.concat("0");for(f=0;f<p;f+=1)e[f]=n[f];do{for(l=!0,f=0;f<e.length;f+=1)if(e[f]!==0){l=!1;break}if(l)break;s(e,o,h,v,w,b);u(h,e.length,!0);a=v[0].toString(t);i=c.substring(0,c.length-a.length)+a+i;y=e;e=h;h=y}while(1);while(i.length!==0&&i[0]==="0")i=i.substring(1,i.length);return i.length===0&&(i="0"),i}function ht(n){var i=Math.ceil((n+1)/8),t=f(i);return t[0]=Math.pow(2,n%8),t}function ct(n){for(var r=f(n.length*8),u=0,i=n.length-1,t;i>=0;){for(t=0;t<8;){var e=1<<t,o=(n[i]&e)===e?1:0,s=8*(n.length-i-1)+t;o===1&&(u=s+1);r[s]=o;t+=1}i--}return r.slice(0,u)}function it(t){for(var i=r>>>1,u=n;u-->0;){if((t&i)===i)break;i=i>>>1}return u}function lt(n){for(var r=0,t=0,i,u;r<n.length;){if(t===0)for(i=7;i>=0&&t===0;)u=1<<i,(n[r]&u)===u&&(t=i+1),i--;else t+=8;r+=1}return t}function at(n,i,r){var u;n=n.slice();var f=[],e=Math.pow(2,i),o=Math.pow(2,i-1);for(u=0;u<r;u++)f[u]=n[0]%e-o,n[0]=n[0]-f[u],t.shiftRight(n,n,i-1);return f[u]=n[0],f}function e(n,t,i,r,u){while(u-->0)i[r+u]=n[
t+u]}function w(n){for(var t=0;t<n.length;t+=1)if(n[t]!==0)return!1;return!0}function vt(n){return(n[0]&1)==0}function yt(n,t){if(n.length!==t.length)return!1;for(var i=0;i<n.length;i+=1)if(n[i]!==t[i])return!1;return!0}function d(n){var o=Math.floor((n.length+h-1)/h),i=new Array(o),u;i[0]=0;var t=0,e=0,f=0;for(u=n.length-1;u>=0;u--)t=t+v[f++]*(n[u]&255),v[f]===r&&(f=0,i[e++]=t,t=0);return t!==0&&(i[e]=t),i}function pt(n,t,i){var u,f,e,r=[0];for(typeof t=="undefined"&&(t=!0),u=0;u<n.length;u+=1)for(e=n[u],f=0;f<h;f+=1)r[u*h+f]=e&255,e=Math.floor(e/256);if(r=tt(r),i===undefined&&(i=1),t)while(r.length>i&&r[0]===0)r.shift();return r}function l(t,i){var f,u;for(typeof i=="undefined"&&(t<=1?i=1:(f=Math.log(t)/Math.LN2,i=Math.ceil(f/n))),u=[];t>0;)u.push(t%r),t=Math.floor(t/r);while(u.length<i)u.push(0);return u}function c(n){for(var t=n.length-1;t>=0;t--)if(n[t]!==undefined&&n[t]!==0)return t;return n[0]===0?-1:0}function o(n,t){var i=0,r=c(n)+1,u=c(t)+1;if(r>u)i=1;else if(u>r)i=-1;else while(
r-->0&&i===0)i=n[r]-t[r];return i}function u(n,t,i){var r=c(n);if(n.length=t||r+1,i)while(++r<n.length)n[r]=0;return n.length<=0&&(n[0]=0,n.length=1),n}function wt(t,r,u,f){var o,s,e;if(u===undefined)u=1;else if(u>=n||u<0)throw new Error("Invalid bit count for shiftRight");for(f===undefined&&(f=t.length),o=f-1,s=n-u,e=0;e<o;e++)r[e]=(t[e+1]<<s|t[e]>>>u)&i;r[o]=t[o]>>>u}function g(t,r,u,f){var o,e;if(u===undefined)u=1;else if(u>=n||u<0)throw new Error("bit count must be smaller than DIGIT_BITS and positive in shiftLeft");for(f===undefined&&(f=t.length),o=n-u,r[f]=t[f-1]>>>n-u||r[f],e=f-1;e>0;e--)r[e]=(t[e]<<u|t[e-1]>>>o)&i;r[0]=t[0]<<u&i}function b(t,r,u){var s=t,o=r,h,f,e;for(r.length<t.length&&(s=r,o=t),h=s.length,f=0,e=0;e<h;e+=1)f+=s[e]+o[e],u[e]=f&i,f=f>>n;for(e=h;e<o.length;e+=1)f+=o[e],u[e]=f&i,f=f>>n;return u.length=o.length,f!==0&&(u[e]=f&i),f}function rt(t,r,u){var o=r.length,e,f;if(t.length<r.length&&(o=c(r)+1,t.length<o))throw new Error("Subtrahend is longer than minuend, not supported.");
for(f=0,e=0;e<o;e+=1)f+=t[e]-r[e],u[e]=f&i,f=f>>n;while(e<t.length)f+=t[e],u[e++]=f&i,f=f>>n;return f}function a(n,t,u){for(var s=typeof t=="number"?[t]:t,h=Math.max(n.length,s.length),e,o,f=0;f<h;f+=1)u[f]=0;for(f=0;f<s.length;f+=1){for(o=0,e=0;e<n.length;e+=1)o+=n[e]*s[f]+u[f+e],u[f+e]=o&i,o=Math.floor(o/r);u[n.length+f]=o&i}return u.length=n.length+s.length,u}function s(t,f,o,s,h,l){var b=c(t)+1,a=c(f)+1,nt,k,tt,rt,w,p,v,ut,d,y;if(b<a){e(t,0,s,0,t.length);s.length=t.length;u(s);o[0]=0;o.length=1;return}if(a===0||a===1&&f[a-1]===0)throw new Error("Division by zero.");else if(a===1){for(w=f[0],k=0,v=b-1;v>=0;v--)rt=k*r+t[v],o[v]=rt/w&i,k=rt-o[v]*w&i;o.length=b;u(o);s[0]=k;s.length=1;return}for(ut=n-1-it(f[a-1]),d=h||[],d.length=a,g(f,d,ut,a),y=l||[],y.length=b,g(t,y,ut,b),y[b]=y[b]||0,o.length=b-a+1,s.length=a,v=b-a;v>=0;v--){for(nt=Math.floor((y[v+a]*r+y[v+a-1])/d[a-1]),k=y[v+a]*r+y[v+a-1]-nt*d[a-1];;)if(!(nt>=r)&&!(nt*d[a-2]>k*r+y[v+a-2])||(nt=nt-1,k=k+d[a-1],!(k<r)))break;for(tt=0,
p=0;p<a;p++)rt=nt*d[p],w=y[p+v]-tt-(rt&i),y[p+v]=w&i,tt=Math.floor(rt/r)-Math.floor(w/r);if(w=y[v+a]-tt,y[v+a]=w&i,o[v]=nt&i,w<0){for(o[v]=o[v]-1,tt=0,p=0;p<a;p++)w=y[p+v]+d[p]+tt,y[p+v]=w&i,tt=w>>n;y[v+a]=y[v+a]+tt&i}}for(p=0;p<a;p++)s[p]=(y[p]>>>ut|y[p+1]<<n-ut)&i;u(o);u(s)}function bt(n,t,i,r,u){return s(n,t,[],i,r,u),i}function ut(n,t,i,r,u,f){var e=[];return a(n,t,e),s(e,i,e,r,u,f),r}function ft(n,t,i,r,f){var c,y,h,k;if(w(n))return e(t,0,f,0,t.length),f.length=t.length,0;if(w(t))return e(n,0,f,0,n.length),f.length=n.length,0;o(n,t)<0?(c=n.slice(0),e(t,0,f,0,t.length),f.length=t.length):(c=t.slice(0),e(n,0,f,0,n.length),f.length=n.length);u(f);u(c);var d=new Array(f.length),g=new Array(f.length),l=new Array(f.length),nt=r!==undefined,v;nt&&(v=new Array(f.length),v[0]=1,v.length=1,r[0]=0,r.length=1);h=new Array(f.length);k=i!==undefined;k&&(y=new Array(f.length),y[0]=0,y.length=1,i[0]=1,i.length=1);for(var tt=-1,it=i,rt=r,ut=f,p;!w(c);)s(f,c,d,g,h,l),k&&(a(d,y,h),b(h,i,h),u(h),p=i,
i=y,y=h,h=p),nt&&(a(d,v,l),b(l,r,l),u(l),p=r,r=v,v=l,l=p),p=f,f=c,c=g,g=p,tt++;return k&&(e(i,0,it,0,i.length),it.length=i.length),nt&&(e(r,0,rt,0,r.length),rt.length=r.length),e(f,0,ut,0,f.length),ut.length=f.length,tt}function kt(n,t,i){var r=n,f=t;return o(n,t)>0&&(r=t,f=n),ft(r,f,undefined,undefined,i),u(i)}function dt(n,t,i){var r=new Array(t.length),s=new Array(t.length),f=new Array(t.length),h=ft(n,t,s,r,f);return i=i||[],o(f,p)!==0?(i[0]=NaN,i.length=1):((h&1)==1?rt(t,r,i):(e(r,0,i,0,r.length),i.length=r.length),u(i)),i}function gt(n,t,i,r){if(r=r||[],o(t,k)===0)r[0]=1;else if(o(t,p)===0)e(n,0,r,0,n.length),r.length=n.length;else{var f=new nt(i);u(n,f.s,!0);f.modExp(n,t,r);r.length=i.length}return r}function nt(t){function et(t){for(var f=1,r=2,u=3,e=u&t,o=2;o<=n;o+=1)r<e&&(f+=r),r=r<<1,u=u<<1|1,e=t*f&u;return(~f&i)+1}function b(t,u,f,e){var v,c;e=e||this;for(var l=0,a=e.m.length,b=a-1,k=e.mPrime,d=e.m0,g=t[0],s=0,y,p,h,w,o=0;o<a;o+=1)f[o]=0;for(o=0;o<a;o+=1){for(y=u[o],s=g*y+f[
0],f[0]=s&i,s=Math.floor(s/r),h=1;h<a;h+=1)s=t[h]*y+f[h]+s,f[h]=s&i,s=Math.floor(s/r);for(l=l+s,p=f[0]*k&i,s=Math.floor((f[0]+d*p)/r),h=1,w=0;h<a;h+=1,w++)s=e.m[h]*p+f[h]+s,f[w]=s&i,s=Math.floor(s/r);l+=s;f[b]=l&i;l=Math.floor(l/r)}for(v=e.temp1===f?e.temp2:e.temp1,c=0,o=0;o<a;o+=1)c=f[o]-e.m[o]+(c>>n),v[o]=c&i;for(c=(l&i)+(c>>n),c=(l>>>n)+(c>>n),o=0;o<a;o+=1)f[o]=c&(v[o]^f[o])^v[o];return}function ot(n){var t,i;if(n.length<this.s)for(n.length=this.s,t=0;t<this.s;t++)n[t]=isNaN(n[t])?0:n[t];for(i=f(n.length),this.montgomeryMultiply(n,this.rSquaredModm,i),t=0;t<this.s;t+=1)n[t]=i[t]}function st(n){this.montgomeryMultiply(n,this.one,this.temp1);for(var t=0;t<this.s;t+=1)n[t]=this.temp1[t]}function ht(t,r,f){for(var s=2,b=i>>>n-s,l,a,y,d,o=r.length-1;o>0&&r[o]===0;o--);for(l=o*n+it(r[o])+1,l=l+(s-l%s),a=l%n-s,a<0&&(a+=n),y=b<<a,o=1;o<h.length;o++)ut(h[o-1],t,this.m,h[o],v,c),u(h[o],this.s,!0);var k=new Array(this.s),w=f,p=c;for(e(this.rModM,0,p,0,this.s);l>0;)this.montgomeryMultiply(p,p,w),
this.montgomeryMultiply(w,w,k),d=(r[Math.floor((l-1)/n)]&y)>>>a,this.montgomeryMultiply(k,h[d],p),l=l-s,a=a-s,y=y>>>s,y===0&&(y=b<<n-s,a=n-s);return this.montgomeryMultiply(p,this.one,f),f}var a=t,y=a[0],o=a.length,k=f(o),w,ft,h;k[0]=1;var d=et(y),g=f(2*o+1),p=f(o+1),v=f(2*o+1),c=f(2*o+1),nt=p;nt[o]=1;s(nt,a,g,p,v,c);var tt=u(p,o,!0),l=f(2*o+1),rt=l;return rt[o*2]=1,s(rt,a,g,l,v,c),u(l,o,!0),w=f(o),ft={m:a,mPrime:d,m0:y,temp1:v,temp2:c},b(l,l,w,ft),h=new Array(4),h[0]=tt,h[1]=new Array(o),h[2]=new Array(o),h[3]=new Array(o),{m:t,m0:y,mPrime:d,rSquaredModm:l,s:o,rModM:tt,rCubedModm:w,one:k,temp1:v,temp2:c,convertToMontgomeryForm:ot,convertToStandardForm:st,montgomeryMultiply:b,modExp:ht}}function ni(r){function w(n){var i=d(n);if(t.compareDigits(i,this.m_modulus)>=0)throw new Error("The number provided is not an element of this group");return u(i,this.m_digitWidth,!0),s(i,this)}function b(n){var t=l(n,this.m_digitWidth);return s(t,this)}function k(n){return t.normalizeDigitArray(n,this.
m_digitWidth,!0),s(n,this)}function g(n){return o(this.m_modulus,n.m_modulus)===0}function tt(r,u,f){var e,c=this.m_digitWidth,h=f.m_digits,l,s;for(t.add(r.m_digits,u.m_digits,h),l=o(h,this.m_modulus)>=0?i:0,s=0,e=0;e<c;e+=1)s=h[e]-(this.m_modulus[e]&l)+s,h[e]=s&i,s=s>>n;h.length=c}function it(r,u,f){var e,h=this.m_digitWidth,s=f.m_digits,o=t.subtract(r.m_digits,u.m_digits,f.m_digits);if(o===-1)for(o=0,e=0;e<h;e+=1)o+=s[e]+this.m_modulus[e],s[e]=o&i,o=o>>n}function rt(n,i){t.modInv(n.m_digits,this.m_modulus,i.m_digits)}function ut(n,i,r){return t.modMul(n.m_digits,i.m_digits,this.m_modulus,r.m_digits,v,y)}function ft(n,t,i){if(i=i||s([],this),o(t,c)===0)i.m_digits=l(1,this.m_digitWidth);else if(o(t,a)===0){for(var r=0;r<n.m_digits.length;r++)i.m_digits[r]=n.m_digits[r];i.m_digits.length=n.m_digits.length}else this.montmul.modExp(n.m_digits,t,i.m_digits),i.m_digits.length=this.montmul.s;return i}function s(n,t){return{m_digits:n,m_group:t,equals:function(n){return o(this.m_digits,n.m_digits)===
0&&this.m_group.equals(this.m_group,n.m_group)}}}var h=d(r),e=h.length,c=l(0,e),a=l(1,e),v=f(e),y=f(e),p=new nt(h);return{m_modulus:h,m_digitWidth:e,montmul:p,createElementFromInteger:b,createElementFromBytes:w,createElementFromDigits:k,equals:g,add:tt,subtract:it,multiply:ut,inverse:rt,modexp:ft}}for(var k,p,n=24,h=Math.floor(n/8),i=(1<<n)-1,r=1<<n,et=i,v=[1,256],y=2;y<=h;y++)v[y]=v[y-1]*256;return k=[0],p=[1],{DIGIT_BITS:n,DIGIT_NUM_BYTES:h,DIGIT_MASK:i,DIGIT_BASE:r,DIGIT_MAX:et,Zero:k,One:p,normalizeDigitArray:u,swapEndianness:tt,bytesToDigits:d,stringToDigits:ot,digitsToString:st,intToDigits:l,digitsToBytes:pt,sequenceEqual:yt,isZero:w,isEven:vt,powerOfTwo:ht,shiftRight:wt,shiftLeft:g,compareDigits:o,computeBitArray:ct,bitLength:lt,fixedWindowRecode:at,IntegerGroup:ni,add:b,subtract:rt,multiply:a,divRem:s,reduce:bt,modInv:dt,modExp:gt,modMul:ut,MontgomeryMultiplier:nt,gcd:kt}}function ui(){function n(n){var t,i=null;if(arguments.length&&typeof arguments[0]!="number"){if(typeof arguments[
0]=="object")for(i=[],t=0;t<n.length;t+=1)i[t]=n[t]}else for(i=[],t=0;t<n;t+=1)i[t]=0;return i}var i=t.bytesToDigits,u=function(n,i,u,f,e,o){var s=n.length,h=r(this,!1,e,o,null,!1);return{p:n,a:i,b:u,order:f,generator:h,allocatePointStorage:function(){return r(this,!1,t.intToDigits(0,s),t.intToDigits(0,s))},createPointAtInfinity:function(){return r(this,!0,t.intToDigits(0,s),t.intToDigits(0,s))}}},e=function(n){var t=new u(i(n.p),i(n.a),i(n.b),i(n.order),i(n.gx),i(n.gy));return t.type=n.type,t.name=n.name,t.generator.curve=t,t},o=function(n){var r=t.bytesToDigits,i=new u(r(n.p),r(n.a),r(n.d),r(n.order),r(n.gx),r(n.gy));return i.type=n.type,i.type==1&&(i.d=i.b.slice(),delete i.b),i.rbits=n.info[2],i.name=n.name,i.generator.curve=i,i},r=function(i,u,f,e,o,s){function c(n){return n?h.isInfinity&&n.isInfinity?!0:h.z===null&&n.z!==null?!1:h.z!==null&&n.z===null?!1:h.z===null?t.compareDigits(h.x,n.x)===0&&t.compareDigits(h.y,n.y)===0&&h.isInMontgomeryForm===n.isInMontgomeryForm:t.compareDigits(
h.x,n.x)===0&&t.compareDigits(h.y,n.y)===0&&t.compareDigits(h.z,n.z)===0&&h.isInMontgomeryForm===n.isInMontgomeryForm:!1}function l(n,t){if(t.curve=n.curve,t.x=n.x.slice(),t.y=n.y.slice(),t.z=n.z!==null?n.z.slice():null,ct||(t.isAffine=n.isAffine),t.isInMontgomeryForm=n.isInMontgomeryForm,t.isInfinity=n.isInfinity,!t.equals(n))throw new Error("Instances should be equal.");}function a(){var t=r(h.curve,h.isInfinity,n(h.x),n(h.y),h.z?n(h.z):null,h.isInMontgomeryForm);return h.ta&&(t.ta=n(h.ta)),h.tb&&(t.tb=n(h.tb)),t}var h;return typeof o=="undefined"&&(o=null),typeof s=="undefined"&&(s=!1),h={equals:function(n){return c(n)},copy:function(n){l(this,n);return},clone:function(){return a()}},ut(h,"curve",i,(function(){return i}),(function(n){i=n})),ut(h,"x",f,(function(){return f}),(function(n){f=n})),ut(h,"y",e,(function(){return e}),(function(n){e=n})),ut(h,"z",o,(function(){return o}),(function(n){o=n})),ut(h,"isInMontgomeryForm",s,(function(){return s}),(function(n){s=n})),ut(h,"isInfinity",u,(function(){return u})
,(function(n){u=n})),ut(h,"isAffine",o===null,(function(){return o===null})),h},s=function(i){function e(n,t,i){var r=k.createElementFromInteger(0);r.m_digits=i;k.subtract(k.createElementFromDigits(n),k.createElementFromDigits(t),r)}function h(n,t,i){var r=k.createElementFromInteger(0);r.m_digits=i;k.add(k.createElementFromDigits(n),k.createElementFromDigits(t),r)}function yt(n,r){var e=n.length,o=i.p,u,f;if((n[0]&1)==1){for(u=0,f=0;f<e;f+=1)u+=n[f]+o[f],r[f]=u&t.DIGIT_MASK,u=u>>>t.DIGIT_BITS;u=u<<t.DIGIT_BITS-1;t.shiftRight(r,r);r[e-1]|=u}else t.shiftRight(n,r)}function s(n,t,i){v.montgomeryMultiply(n,t,i)}function y(n,t){v.montgomeryMultiply(n,n,t)}function ei(n,t){if(n.isInfinity){t.isInfinity=!0;return}y(n.z,r);s(n.z,n.y,o);h(n.x,r,f);e(n.x,r,r);t.z=o.slice();s(r,f,u);yt(u,f);h(u,f,r);y(n.y,f);y(r,o);s(n.x,f,u);e(o,u,o);e(o,u,t.x);e(u,t.x,o);y(f,u);s(r,o,f);e(f,u,t.y);t.isInfinity=!1;t.isInMontgomeryForm=!0}function oi(n,t){if(n.isInfinity){t.isInfinity=!0;return}y(n.y,u);y(n.x,o);h(o,
o,l);h(l,o,o);s(n.x,u,c);y(u,l);yt(o,r);y(r,u);s(n.y,n.z,et);for(var i=0;i<et.length;i+=1)t.z[i]=et[i];e(u,c,t.x);e(t.x,c,t.x);e(c,t.x,o);s(r,o,f);e(f,l,t.y);t.isInfinity=!1;t.isInMontgomeryForm=!0}function pt(n,t){var o=t.clone(),i,e,r;if(nt(o),!gt(o))throw new Error("Invalid Parameter");i=t.clone();ht(i);var s=[t.clone()],u=i.clone(),f=i.clone();for(ot(i,f),it(f),r=1;r<Math.pow(2,n-2);r++)bt(u,f,u),e=u.clone(),it(e),s[r]=e;return s}function ot(n,t){if(typeof n=="undefined")throw new Error("point undefined");if(typeof t=="undefined")throw new Error("outputPoint undefined");if(n.isAffine)throw new Error("Given point was in Affine form. Use convertToJacobian() first.");if(!n.isInMontgomeryForm)throw new Error("Given point must be in Montgomery form. Use montgomeryize() first.");ui?oi(n,t):ei(n,t)}function wt(n,t,i){var v,a;if(n.isInfinity){t.copy(i);this.convertToJacobianForm(i);return}if(t.isInfinity){n.copy(i);return}for(y(n.z,c),s(n.z,c,w),s(t.x,c,o),s(t.y,w,c),e(o,n.x,r),e(c,n.y,f),
y(f,o),y(r,w),s(w,n.x,c),s(r,w,l),e(o,c,u),e(u,c,u),s(n.z,r,o),e(u,c,u),s(l,n.y,w),e(u,l,u),v=!0,a=0;a<u.length;a++)if(u[1]!==0){v=!1;break}if(v){for(a=0;a<i.x.length;a++)i.x[a]=0,i.y[a]=0,i.z[a]=0;i.y[0]=1;return}h(w,w,r);s(o,u,i.z);s(f,u,o);y(u,l);h(r,o,r);s(l,c,o);y(r,vt);s(l,u,c);e(vt,o,i.x);e(i.x,o,i.x);e(i.x,c,i.x);e(i.x,o,u);s(c,w,l);s(r,u,o);e(o,l,i.y);i.isInfinity=!1;i.isInMontgomeryForm=!0}function bt(n,t,i){var v,p;if(n===null)throw new Error("jacobianPoint");if(t===null)throw new Error("affinePoint");if(i===null)throw new Error("outputPoint");if(n.curve!==t.curve||n.curve!==i.curve)throw new Error("All points must be from the same curve object.");if(n.isAffine)throw new Error("Given jacobianPoint was in Affine form. Use ConvertToJacobian() before calling DoubleJacobianAddAffinePoints().");if(!t.isAffine)throw new Error("Given affinePoint was in Jacobian form. Use ConvertToAffine() before calling DoubleJacobianAddAffinePoints().");if(i.isAffine)throw new Error("Given jacobianPoint was in Jacobian form. Use ConvertToJacobian() before calling DoubleJacobianAddAffinePoints().");
if(!n.isInMontgomeryForm)throw new Error("Jacobian point must be in Montgomery form");if(!t.isInMontgomeryForm)throw new Error("Affine point must be in Montgomery form");if(n.isInfinity){t.copy(i);this.convertToJacobianForm(i);return}if(t.isInfinity){n.copy(i);return}for(y(n.z,r),s(r,n.z,f),s(r,t.x,u),s(f,t.y,o),e(u,n.x,r),e(o,n.y,f),v=0;v<r.length;v+=1)if(r[v]!==0){for(s(n.z,r,l),p=0;p<a;p+=1)i.z[p]=l[p];y(r,u);s(u,r,o);s(u,n.x,c);h(c,c,r);y(f,i.x);e(i.x,r,i.x);e(i.x,o,i.x);e(c,i.x,u);s(f,u,c);s(n.y,o,w);e(c,w,i.y);i.isInfinity=!1;i.isInMontgomeryForm=!0;return}for(v=0;v<f.length;v+=1)if(f[v]!==0){i.isInfinity=!0;i.isInMontgomeryForm=!0;return}t.copy(i);this.convertToJacobianForm(i);this.double(i,i);i.isInMontgomeryForm=!0}function kt(n,r,u,f){var e;if(r.isInfinity||t.isZero(n)){u.isInfinity=!0;return}if(t.compareDigits(n,i.order)>=0)throw new Error("The scalar k must be in the range 1 <= k < order.");if(n=n.slice(),r.curve.type===1)e=typeof r.ta!="undefined",e||lt(r),li(n,r,u,f),e||rt(
r);else{var o=r.isInMontgomeryForm,s=u.isInMontgomeryForm,h=u.isAffine;o||st(r);s||st(u);si(n,r,u);h&&it(u);o||nt(r);s||nt(u)}return}function si(n,i,r){var w=i.clone(),c,o,u,p,h;if(nt(w),!gt(w))throw new Error("Invalid Parameters.");for(c=n[0]&1,o=[],e(i.curve.order,n,o),u=0;u<n.length;u++)n[u]=c-1&(n[u]^o[u])^n[u];var s=a<=8?5:6,k=i.curve.p.length*t.DIGIT_BITS,l=Math.ceil(k/(s-1)),v=t.fixedWindowRecode(n,s,l),b=pt(s,i),y=Math.floor(Math.abs(v[l])-1)/2,f=b[y].clone();for(ht(f),u=l-1;u>=0;u--){for(p=0;p<s-2;p++)ot(f,f);y=Math.floor((Math.abs(v[u])-1)/2);h=hi(b,y);v[u]<0&&dt(h,h);wt(f,h,f)}for(e(i.curve.p,f.y,o),u=0;u<f.y.length;u++)f.y[u]=c-1&(f.y[u]^o[u])^f.y[u];f.copy(r);return}function hi(n,t){for(var u,i=(t+1)%n.length,r=0;r<n.length;r++)u=n[i].clone(),i=(i+1)%n.length;return u}function dt(n,t){n!==t&&n.copy(t);e(n.curve.p,n.y,t.y)}function st(n){if(n.isInMontgomeryForm)throw new Error("The given point is already in Montgomery form.");n.isInfinity||(v.convertToMontgomeryForm(n.x),v.
convertToMontgomeryForm(n.y),n.z!==null&&v.convertToMontgomeryForm(n.z),typeof n.ta!="undefined"&&(v.convertToMontgomeryForm(n.ta),v.convertToMontgomeryForm(n.tb)));n.isInMontgomeryForm=!0}function nt(n){if(!n.isInMontgomeryForm)throw new Error("The given point is not in montgomery form.");n.isInfinity||(v.convertToStandardForm(n.x),v.convertToStandardForm(n.y),n.z!==null&&v.convertToStandardForm(n.z),typeof n.ta!="undefined"&&(v.convertToStandardForm(n.ta),v.convertToStandardForm(n.tb)));n.isInMontgomeryForm=!1}function it(n){var u,r;if(n.isInfinity){n.z=null;ct||(n.isAffine=!0);return}for(t.modInv(n.z,i.p,b),n.isInMontgomeryForm&&(s(b,v.rCubedModm,d),u=b,b=d,d=u),y(b,g),s(n.x,g,d),r=0;r<a;r+=1)n.x[r]=d[r];s(n.y,g,d);s(d,b,n.y);n.z=null;delete n.ta;delete n.tb;ct||(n.isAffine=!0)}function ht(t){if(!t.isAffine)throw new Error("The given point is not in Affine form.");ct||(t.isAffine=!1);for(var u=t.isInMontgomeryForm?ft:fi,r=n(u.length),i=0;i<u.length;i+=1)r[i]=u[i];t.z=r;return}function gt(
n){return n.isInfinity?!1:(t.modMul(n.y,n.y,n.curve.p,r),t.modMul(n.x,n.x,n.curve.p,f),t.modMul(n.x,f,n.curve.p,u),h(u,n.curve.b,f),t.modMul(n.x,n.curve.a,n.curve.p,u),h(f,u,f),e(r,f,r),t.isZero(r)==!1)?!1:!0}function ci(n){return(n.ta&&(n=n.clone(),rt(n)),t.modMul(n.y,n.y,n.curve.p,u),t.modMul(n.x,n.x,n.curve.p,f),t.add(f,u,r),t.reduce(o,n.curve.p,o),t.modMul(f,u,n.curve.p,o),t.modMul(n.curve.d,o,n.curve.p,u),t.add(u,[1],f),t.reduce(f,n.curve.p,f),t.subtract(r,f,r),t.isZero(r)==!1&&(t.reduce(r,n.curve.p,r),t.isZero(r)==!1))?!1:!0}function ni(n,t){var i=t.clone(),f=i.clone(),u=[],r;for(u[0]=ut(t),tt(i,i),f=ut(i),i=t.clone(),r=1;r<n;r++)at(f,i,i),u[r]=ut(i);return u}function lt(n){n.ta=n.x.slice();n.tb=n.y.slice();n.z=[1]}function li(n,i,r,u){var b,s,c,o,v,f,h;if(!ci(i))throw new Error("Invalid Parameter");b=i.curve.rbits;u=typeof u=="undefined"?!0:u;s=a<=8?5:6;c=Math.floor((b+(s-2))/(s-1));n=n.slice();f=i.clone();lt(f);u&&(tt(f,f),tt(f,f));var k=ni(1<<s-2,f),d=n[0]&1,l=[];for(e(i.curve.
order,n,l),o=0;o<n.length;o++)n[o]=d-1&(n[o]^l[o])^n[o];var y=t.fixedWindowRecode(n,s,c),p=Math.floor(Math.abs(y[c])-1)/2,w=k[p];for(f.x=w.x.slice(),f.y=w.y.slice(),f.z=w.z.slice(),o=c-1;o>=0;o--){for(v=0;v<s-1;v++)tt(f,f);p=Math.floor((Math.abs(y[o])-1)/2);h=ai(k,p);y[o]<0&&(e(i.curve.p,h.x,h.x),e(i.curve.p,h.td,h.td));at(h,f,f)}for(e(i.curve.p,f.x,l),o=0;o<f.x.length;o++)f.x[o]=d-1&(f.x[o]^l[o])^f.x[o];rt(f);r.x=f.x.slice();r.y=f.y.slice();return}function ai(n,t){for(var u,i=(t+1)%n.length,r=0;r<n.length;r++)u={x:n[i].x.slice(),y:n[i].y.slice(),z:n[i].z.slice(),td:n[i].td.slice()},i=(i+1)%n.length;return u}function rt(n){t.modInv(n.z,i.p,b);t.modMul(n.x,b,i.p,n.x);t.modMul(n.y,b,i.p,n.y);delete n.ta;delete n.tb;n.z=null;return}function tt(n,i){if(typeof n.ta=="undefined")throw new Error("Point should be in Extended Projective form.");t.modMul(n.x,n.x,n.curve.p,l);t.modMul(n.y,n.y,n.curve.p,r);t.modMul(n.z,n.z,n.curve.p,n.ta);e(r,l,i.tb);h(l,r,l);h(n.ta,n.ta,n.ta);h(n.y,n.y,n.y);e(n.ta,
l,r);t.modMul(n.x,n.y,n.curve.p,i.ta);t.modMul(l,i.tb,n.curve.p,i.y);t.modMul(r,i.ta,n.curve.p,i.x);t.modMul(l,r,n.curve.p,i.z);return}function vi(n,i,r){var f=t,e=n.curve.p,u;if(typeof n.ta=="undefined")throw new Error("Point1 should be in Extended Projective form.");if(typeof i.ta=="undefined")throw new Error("Point2 should be in Extended Projective form.");u=ut(n);at(u,i,r);return}function ut(n){var i=n.curve,r=i.p,u={x:n.x.slice(),y:n.y.slice(),z:n.z.slice(),td:[],curve:n.curve};return t.modMul(n.ta,n.tb,r,g),t.modMul(g,i.d,r,u.td),u}function at(n,i,o){var s=t,c=i.curve.p;r=[];f=[];u=[];s.modMul(i.z,n.z,c,u);s.modMul(i.ta,i.tb,c,r);h(i.x,i.y,i.ta);s.modMul(r,n.td,c,f);h(n.x,n.y,i.tb);e(u,f,r);h(u,f,u);s.modMul(i.ta,i.tb,c,f);s.modMul(i.x,n.x,c,i.z);s.modMul(i.y,n.y,c,i.x);e(f,i.z,f);e(i.x,i.z,o.ta);e(f,i.x,o.tb);s.modMul(o.ta,u,c,o.y);s.modMul(o.tb,r,c,o.x);s.modMul(u,r,c,o.z);return}function yi(n,i){var l=n.curve.a.slice(),a=n.curve.d.slice(),s=n.curve.p,c=t.modMul,v=t.modInv;r=[5];
c(l,r,s,f);e(f,a,f);c(a,r,s,u);e(l,u,r);c(n.y,r,s,u);h(u,f,f);r=[1];e(r,n.y,u);r=[12];c(r,u,s,o);v(o,s,o);c(n.x,u,s,r);h(r,r,u);h(u,u,u);v(u,s,u);c(o,f,s,i.x);r=[1];h(n.y,r,r);e(l,a,f);c(r,f,s,o);c(o,u,s,i.y);return}function pi(n,i){var o=i.curve.a.slice(),s=i.curve.d.slice(),c=i.curve.p,l=t.modMul,a=t.modInv;h(n.x,n.x,r);h(n.x,r,r);h(r,r,r);e(r,o,f);e(f,s,f);h(n.y,n.y,u);h(n.y,u,u);h(u,u,u);a(u,c,u);l(f,u,c,i.x);h(r,r,r);h(r,s,f);h(r,o,r);h(o,o,u);e(f,u,f);e(f,u,f);e(f,o,f);h(s,s,u);e(r,u,r);e(r,u,r);e(r,s,r);a(r,c,r);l(r,f,c,i.y);return}var ti=i,ii=i.type===1,a=i.p.length,v=t.MontgomeryMultiplier(i.p),ri=i.a.slice(),p;v.convertToMontgomeryForm(ri);var ui=t.isZero(i.a),fi=t.One,ft=n(a);ft[0]=1;v.convertToMontgomeryForm(ft);var k=t.IntegerGroup(t.digitsToBytes(v.m),!0),l=n(a),r=n(a),f=n(a),u=n(a),o=n(a),c=n(a),w=n(a),vt=n(a),et=n(a),g=n(a),d=n(a),b=n(a);return p={convertToMontgomeryForm:st,convertToStandardForm:nt,convertToAffineForm:it,convertToJacobianForm:ht,generatePrecomputationTable:
function(n,t){return pt(n,t)}},ii?(p.double=tt,p.add=vi,p.scalarMultiply=kt,p.normalize=rt,p.convertToExtendedProjective=lt,p.convertTedToWeierstrass=yi,p.convertWeierstrassToTed=pi,p.generatePrecomputationTable=function(n,t){return ni(n,t)}):(p.double=ot,p.mixedDoubleAdd=wt,p.mixedAdd=bt,p.scalarMultiply=kt,p.negate=dt),p},h=function(){return{encodePoint:function(i){var f,s,r;if(!i)throw new Error("point");if(!i.isAffine)throw new Error("Point must be in affine form.");if(i.isInMontgomeryForm)throw new Error("Point must not be in Montgomery form.");if(i.isInfinity)return n(1);var e=t.digitsToBytes(i.x),o=t.digitsToBytes(i.y),h=t.digitsToBytes(i.curve.p),u=h.length;if(u<e.length||u<o.length)throw new Error("Point coordinate(s) are bigger than the field order.");for(f=n(2*u+1),f[0]=4,s=u-e.length,r=0;r<e.length;r++)f[r+1+s]=e[r];for(s=u-o.length,r=0;r<o.length;r++)f[u+r+1+s]=o[r];return f},decodePoint:function(i,u){var h,e,o,s,f,c,l;if(i.length<1)throw new Error("Byte array must have non-zero length");
if(h=t.digitsToBytes(u.p),e=h.length,i[0]===0&&i.length===1)return u.createPointAtInfinity();if(i[0]===4&&i.length===1+2*e){for(o=n(e),s=n(e),f=0;f<e;f++)o[f]=i[f+1],s[f]=i[e+f+1];return c=t.bytesToDigits(o),l=t.bytesToDigits(s),r(u,!1,c,l)}throw new Error("Unsupported encoding format");}}},c=function(n){function o(n){var i=t.intToDigits(0,16),f;return(u.modExp(n,r,i),f=[0],t.modMul(i,i,u.m,f),t.compareDigits(n,f)!==0)?null:i}var i=n,r=[],u,f,e;if(typeof n=="undefined")throw new Error("modulus");if(t.isEven(n))throw new Error("Only odd moduli are supported");return u=t.MontgomeryMultiplier(i),i[0]%4==3?(t.add(i,t.One,r),t.shiftRight(r,r,2)):r=null,f=new Array(i.length),e=new Array(i.length),{squareRoot:function(n){if(r!==null)return o(n);throw new Error("GeneralCase not supported.");},jacobiSymbol:function(n){var h=3,r,u,o,s,c,l,a;for(r=n.slice(),u=i.slice(),t.reduce(r,u,r,f,e),o=1;!t.isZero(r);){while(t.isEven(r))t.shiftRight(r,r),s=u[0]&7,(s===3||s===5)&&(o=-o);c=r;r=u;u=c;l=r[0]&h;a=
u[0]&h;l===3&&a===3&&(o=-o);t.reduce(r,u,r,f,e)}return t.compareDigits(u,t.One)===0?o:0}}},f={},l=function(n){var t=f[n.toUpperCase()];if(!t)throw new Error(n+" Unsupported curve.");if(t.type===0)return e(t);if(t.type===1)return o(t);throw new Error(n+" Unsupported curve type.");};return{createCurve:l,curves:f,sec1EncodingFp:h,EllipticCurvePointFp:r,EllipticCurveOperatorFp:s,ModularSquareRootSolver:c}}function wt(){function s(n){for(var t=n.length-1;t>=0;t-=1)if(n[t]+=1,n[t]>=256&&(n[t]=0),n[t])break}function h(){i=r.getVector(32);t=r.getVector(16);e=32;n=48;u=1}function c(t,i){var f,e;if(i=i||[0],i.length>n)throw new Error("Incorrect entropy or additionalEntropy length");for(i=i.concat(r.getVector(n-i.length)),t=t.concat(r.getVector((n-t.length%n)%n)),f=0;f<t.length;f+=n)e=r.xorVectors(t.slice(f,f+n),i),o(e);u=1}function o(u){for(var f=[],c=new tt.aes(i),o,h;f.length<n;)s(t),o=t.slice(0,16),h=c.encrypt(o),f=f.concat(h);f=r.xorVectors(f,u);i=f.slice(0,e);t=f.slice(e)}function l(f,e){var
h,c,l,v;if(f>=65536)throw new Error("too much random requested");if(u>a)throw new Error("Reseeding is required");if(e&&e.length>0){while(e.length<n)e=e.concat(r.getVector(n-e.length));o(e)}else e=r.getVector(n);for(h=[],c=new tt.aes(i);h.length<f;)s(t),l=t.slice(0,t.length),v=c.encrypt(l),h=h.concat(v);return h=h.slice(0,f),o(e),u+=1,h}if(!(this instanceof wt))throw new Error("create MsrcryptoPrng object with new keyword");var f=!1,i,t,e,n,u=1,a=16777216;return h(),{reseed:c,init:function(t,i){if(t.length<n)throw new Error("Initial entropy length too short");h();c(t,i);f=!0},getBytes:function(n,t){if(!f)throw new Error("can't get randomness before initialization");return l(n,t)},getNonZeroBytes:function(n,t){var r,u,i;if(!f)throw new Error("can't get randomness before initialization");for(r=[];r.length<n;)for(u=l(n,t),i=0;i<u.length;i+=1)u[i]!==0&&r.push(u[i]);return r.slice(0,n)}}}function li(){function h(){for(var h=[],a,v,p,y,w,c=0;c<o;c+=1)h[c]=Math.floor(Math.random()*256);if(a=n.
crypto||n.msCrypto,a&&typeof a.getRandomValues=="function"&&n.Uint8Array&&(v=new n.Uint8Array(o),a.getRandomValues(v),h=h.concat(Array.apply(null,v)),f=!0),typeof XMLHttpRequest!="undefined")for(p=new XMLHttpRequest,c=0;c<s.length;c+=1)try{y=p.getResponseHeader(s[c]);y&&(w=r.stringToBytes(y),h=h.concat(w))}catch(b){}!f&&l&&(h=h.concat(t.splice(0,t.length)),e.startCollectors());u?i.reseed(h):i.init(h);u=!0}function c(n){for(var i=0;i<n.length;++i)t.push(n[i]);t.length>=a&&e.stopCollectors()}var o=48,t=[],a=128,v=0,i=new wt,u=!1,f=!1,s=["Cookie","RedirectUri","ETag","x-ms-client-antiforgery-id","x-ms-client-request-id","x-ms-client-session-id","SubscriptionPool"],l=n&&n.addEventListener||typeof document!="undefined"&&document.attachEvent,e=(function(){return{startCollectors:function(){if(!this.collectorsRegistered){if(n.addEventListener)n.addEventListener("mousemove",this.MouseEventCallBack,!0),n.addEventListener("load",this.LoadTimeCallBack,!0);else if(document.attachEvent)document.attachEvent(
"onmousemove",this.MouseEventCallBack),document.attachEvent("onload",this.LoadTimeCallBack);else throw new Error("Can't attach events for entropy collection");this.collectorsRegistered=1}},stopCollectors:function(){this.collectorsRegistered&&(n.removeEventListener?(n.removeEventListener("mousemove",this.MouseEventCallBack,1),n.removeEventListener("load",this.LoadTimeCallBack,1)):n.detachEvent&&(n.detachEvent("onmousemove",this.MouseEventCallBack),n.detachEvent("onload",this.LoadTimeCallBack)),this.collectorsRegistered=0)},MouseEventCallBack:function(n){var t=(new Date).valueOf(),i=n.x||n.clientX||n.offsetX||0,r=n.y||n.clientY||n.offsetY||0,u=[t&255,t>>8&255,t>>16&255,t>>24&255,i&255,i>>8&255,r&255,r>>8&255];c(u)},LoadTimeCallBack:function(){var n=(new Date).valueOf(),t=[n&255,n>>8&255,n>>16&255,n>>24&255];c(t)}}})();return{init:function(){if(h(),!f&&!v&&l)try{e.startCollectors()}catch(n){}},reseed:function(n){i.reseed(n)},read:function(n){if(!u)throw new Error("Entropy pool is not initialized.");
var t=i.getBytes(n);return h(),t}}}var i={},v,t,kt,it,y,u,f,k,p,tt,vt,d,h,w,c,l,nt,e,ft,et,g,ot,a,lt,b,bt,dt,st,gt;i.register=function(n,t,r){i[n]||(i[n]={});var u=i[n];u[t]||(u[t]=r)};i.exists=function(n,t){return i[n]?i[n][t]?!0:!1:!1};var yt=(function(){if(typeof document!="undefined")try{throw new Error;}catch(t){if(t.stack){var n=/\w+:\/\/(.+?\/)*.+\.js/.exec(t.stack);return n&&n.length>0?n[0]:null}}else if(typeof self!="undefined")return self.location.href;return null})(),ni=!1,ti=typeof Worker!="undefined",at=typeof importScripts!="undefined",ii=typeof ArrayBuffer!="undefined",ct=(function(){try{return Object.defineProperty({},"oncomplete",{}),!0}catch(n){return!1}})(),rt=!1,ut=function(n,t,i,r,u){if(!ct){n[t]=i;return}var f={};r&&(f.get=r);u&&(f.set=u);Object.defineProperty(n,t,f)},s={},r=(function(){function e(n){"console"in self&&"log"in console&&console.log(n)}function o(i,r){var a=t(i),o,e,v,h,c,p,w,y,l,s;if(a!="Array"&&a!="Uint8Array"&&a!="ArrayBuffer")throw new Error("invalid input");
if(o="",e=u(i),r||(r=!1),f)e=String.fromCharCode.apply(null,e),o=btoa(e);else for(s=0;s<e.length;s+=3)v=e[s],h=e[s+1],c=e[s+2],p=v>>2,w=(v&3)<<4|h>>4,y=(h&15)<<2|c>>6,l=c&63,isNaN(h)?y=l=64:isNaN(c)&&(l=64),o=o+n.charAt(p)+n.charAt(w)+n.charAt(y)+n.charAt(l);return r?o.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""):o}function i(t){for(t=t.replace(/-/g,"+").replace(/_/g,"/");t.length%4!=0;)t+="=";var r=[],o,s,h,c,f,u,e,i;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),i=0;i<t.length;i+=4)c=n.indexOf(t.charAt(i)),f=n.indexOf(t.charAt(i+1)),u=n.indexOf(t.charAt(i+2)),e=n.indexOf(t.charAt(i+3)),o=c<<2|f>>4,s=(f&15)<<4|u>>2,h=(u&3)<<6|e,r.push(o),u!==64&&r.push(s),e!==64&&r.push(h);return r}function t(n){return Object.prototype.toString.call(n).slice(8,-1)}function s(n,t){var r="",i,u;for(typeof t=="undefined"&&(t=!1),i=0;i<n.length;i++)t&&i%4==0&&i!==0&&(r+="-"),u=n[i].toString(16).toUpperCase(),u.length===1&&(r+="0"),r+=u;return r}function h(n,t){return t=t||0,n[t]<<24|n[t+1]<<16|n[t+2]<<
8|n[t+3]}function c(n){n=n.replace(/\-/g,"");for(var t=[];n.length>=2;)t.push(parseInt(n.substring(0,2),16)),n=n.substring(2,n.length);return t}function l(n){var i={};for(var t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i}function a(n,t,r){var e=i(n),f=[],u;if(isNaN(t))return e;for(u=0;u<e.length;u+=t)f.push(e.slice(u,u+t));if(r)for(u=0;u<f.length;u++)f[u]=(f[u][0]<<24)+(f[u][1]<<16)+(f[u][2]<<8)+f[u][3];return f}function r(n){return[n>>>24&255,n>>>16&255,n>>>8&255,n&255]}function v(n){for(var t=[],i=0;i<n.length;i++)t=t.concat(r(n[i]));return t}function y(n,t){for(var r=Math.min(n.length,t.length),u=new Array(r),i=0;i<r;i+=1)u[i]=n[i]^t[i];return u}function p(n,t){var r,i;for(t||(t=0),r=new Array(n),i=0;i<n;i+=1)r[i]=t;return r}function u(n){var r,i;if(!n)return[];if(n.pop)return n;if(t(n)=="ArrayBuffer"?n=new Uint8Array(n):n.BYTES_PER_ELEMENT>1&&(n=new Uint8Array(n.buffer)),n.length===1)return[n[0]];if(n.length<65536)return Array.apply(null,n);for(r=new Array(n.length),i=0;i<n.length;
i++)r[i]=n[i];return r}function w(n,t,i){while(n.length<i)n.push(t);return n}function b(n,t,i){while(n.length<i)n.unshift(t);return n}function k(n,t){var r=!0,i;for(n.length!==t.length&&(r=!1),i=0;i<n.length;i++)n[i]!==t[i]&&(r=!1);return r}function d(n){var i,r;if(t(n)!=="Array")return!1;for(r=0;r<n.length;r++)if(i=n[r],isNaN(i)||i<0||i>255)return!1;return!0}function g(n,i,r){if(!n)throw new Error(r);if(i&&t(n)!=i)throw new Error(r);return!0}function nt(n){for(var t,i=[],u=0,r=0;u<n.length;u++)t=n.charCodeAt(u),t<128?i[r++]=t:t<2048?(i[r++]=t>>>6|192,i[r++]=t&63|128):t<55296||t>57343?(i[r++]=t>>>12|224,i[r++]=t>>>6&63|128,i[r++]=t&63|128):(t=(t-55296)*1024+(n.charCodeAt(++u)-56320)+65536,i[r++]=t>>>18|240,i[r++]=t>>>12&63|128,i[r++]=t>>>6&63|128,i[r++]=t&63|128);return i}function tt(n){for(var i,f,e,u="",r,t=0;t<n.length;){if(i=n[t++],r=i<128?i:i<224?(i<<6)+n[t++]-12416:i<240?(i<<12)+(n[t++]<<6)+n[t++]-925824:(i<<18)+(n[t++]<<12)+(n[t++]<<6)+n[t++]-63447168,r>65535){f=Math.floor((r-65536)
/1024)+55296;e=(r-65536)%1024+56320;u+=String.fromCharCode(f,e);continue}u+=String.fromCharCode(r)}return u}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=typeof btoa!="undefined";return{consoleLog:e,toBase64:o,fromBase64:i,checkParam:g,getObjectType:t,bytesToHexString:s,bytesToInt32:h,stringToBytes:nt,bytesToString:tt,unpackData:a,hexToBytesArray:c,int32ToBytes:r,int32ArrayToBytes:v,toArray:u,arraysEqual:k,clone:l,xorVectors:y,padEnd:w,padFront:b,getVector:p,verifyByteArray:d}})(),pt=(function(){function n(n){return at&&self.postMessage(n),n}var t,r,u;return{jsCryptoRunner:function(f){t=f.data.workerid;r=f.data.operationType;u=f.data.operationSubType;var o=f.data.operationType,s=i[o][f.data.algorithm.name],e=f.data;if(!i.exists(o,f.data.algorithm.name))throw new Error("unregistered algorithm.");return e.operationSubType?n({type:e.operationSubType,result:s(e)}):n(s(e))},returnResult:n}})();at&&(self.onmessage=function(n){if(n.data.prngSeed){var t=n.data.prngSeed;
return l.init(t),pt.returnResult({initialized:!0})}pt.jsCryptoRunner(n)});v=(function(){function u(n){for(var t=[],i=0;i<n.length;i++)t[i]=n.charCodeAt(i);return t[t.length-1]===0&&t.pop(),t}function i(n){var t=n.algorithm.name.slice(0,3).toLowerCase();return t==="rsa"?"RSA":t==="ecd"?"EC":"oct"}function t(n){return n.hash.name.substring(n.hash.name.indexOf("-")+1)}function e(t,r){var u={},e;if(u.kty=i(t),u.ext=t.extractable,u.alg=f[t.algorithm.name.toLowerCase()](t.algorithm),u.key_ops=t.keyUsage,r.pop)u.k=n.toBase64(r,!0);else for(e in r)r[e].pop&&(u[e]=n.toBase64(r[e],!0));return t.algorithm.namedCurve&&(u.crv=t.algorithm.namedCurve),u}function o(t,r){var f={},e,o;if(f.kty=i(t),f.extractable=t.extractable,r.pop)f.k=n.toBase64(r,!0);else for(e in r)r[e].pop&&(f[e]=n.toBase64(r[e],!0));return t.algorithm.namedCurve&&(f.crv=t.algorithm.namedCurve),o=JSON.stringify(f,null,"\t"),u(o)}function s(t,i,r){for(var e,f=JSON.parse(JSON.stringify(t)),u=0;u<r.length;u+=1)e=f[r[u]],e&&(f[r[u]]=n.fromBase64(
e));return f}var n=r,f={hmac:function(n){return"HS"+t(n)},"aes-cbc":function(n){return"A"+n.length.toString()+"CBC"},"aes-gcm":function(n){return"A"+n.length.toString()+"GCM"},"rsassa-pkcs1-v1_5":function(n){return"RS"+t(n)},"rsa-oaep":function(n){return"RS-OAEP-"+t(n)},"rsa-pss":function(n){return"PS-"+t(n)},ecdsa:function(n){return"EC-"+n.namedCurve.substring(n.namedCurve.indexOf("-")+1)}};return{keyToJwkOld:o,keyToJwk:e,jwkToKey:s}})();t=t||ri();var o=o||ui();typeof o!="undefined"&&(o.curves["P-256"]={name:"P-256",type:0,p:[255,255,255,255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255],a:[255,255,255,255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,252],b:[90,198,53,216,170,58,147,231,179,235,189,85,118,152,134,188,101,29,6,176,204,83,176,246,59,206,60,62,39,210,96,75],order:[255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81],gx:[107,23,209,242,225,44,66,
71,248,188,230,229,99,164,64,242,119,3,125,129,45,235,51,160,244,161,57,69,216,152,194,150],gy:[79,227,66,226,254,26,127,155,142,231,235,74,124,15,158,22,43,206,51,87,107,49,94,206,203,182,64,104,55,191,81,245],cf:1},o.curves["P-384"]={name:"P-384",type:0,p:[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,255,255,0,0,0,0,0,0,0,0,255,255,255,255],a:[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,255,255,0,0,0,0,0,0,0,0,255,255,255,252],b:[179,49,47,167,226,62,231,228,152,142,5,107,227,248,45,25,24,29,156,110,254,129,65,18,3,20,8,143,80,19,135,90,198,86,57,141,138,46,209,157,42,133,200,237,211,236,42,239],order:[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115],gx:[170,135,202,34,190,
139,5,55,142,177,199,30,243,32,173,116,110,29,59,98,139,167,155,152,89,247,65,224,130,84,42,56,85,2,242,93,191,85,41,108,58,84,94,56,114,118,10,183],gy:[54,23,222,74,150,38,44,111,93,158,152,191,146,146,220,41,248,244,29,189,40,154,20,124,233,218,49,19,181,240,184,192,10,96,177,206,29,126,129,157,122,67,29,124,144,234,14,95],cf:1},o.curves["P-521"]={name:"P-521",type:0,p:[16,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],a:[16,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252],b:[81,149,62,185,97,142,28,154,31,146,154,33,160,182,133,64,238,162,218,114,91,153,179,21,243,
184,180,137,145,142,241,144,225,86,25,57,81,236,126,147,123,22,82,192,189,59,177,191,112,53,115,223,136,61,44,52,241,239,69,31,212,107,80,63,0],order:[16,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,16,72,247,144,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,144],gx:[198,133,142,96,183,64,64,233,205,158,62,203,102,35,149,180,66,156,100,129,57,80,63,181,33,248,40,175,96,107,77,61,186,161,75,94,119,239,231,89,40,254,29,193,39,162,255,168,222,51,72,179,193,133,106,66,155,249,126,126,49,194,229,189,102],gy:[16,24,57,41,106,120,154,59,192,64,92,138,95,180,44,125,27,217,152,245,68,73,87,155,68,104,23,175,189,23,39,62,102,44,151,238,114,153,94,244,38,64,197,80,185,16,63,173,112,97,53,60,112,134,162,114,194,64,136,190,148,118,159,209,102,80],cf:1});kt={name:"BN-254",type:0,p:[37,35,100,130,64,0,0,1,186,52,77,128,0,0,0,8,97,33,0,0,0,0,0,19,167,0,0,0,0,0,
0,19],a:[0],b:[2],order:[37,35,100,130,64,0,0,1,186,52,77,128,0,0,0,7,255,159,128,0,0,0,0,16,161,0,0,0,0,0,0,13],gx:[37,35,100,130,64,0,0,1,186,52,77,128,0,0,0,8,97,33,0,0,0,0,0,19,167,0,0,0,0,0,0,18],gy:[1],cf:1};typeof o!="undefined"&&(o.curves["BN-254"]=kt);var fi={info:["NUMSP256D1",256,256,256],name:"NUMSP256D1",type:0,p:[67,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[64,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),b:[129,85,2].reverse(),order:[37,168,81,71,41,32,171,32,96,92,38,234,117,130,60,228,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),gx:[177,172,26,178,30,238,82,188,58,199,212,3,9,155,87,131,9,203,66,79,160,149,122,41,97,219,170,90,182,214,158,188].reverse(),gy:[159,222,132,33,203,185,181,128,187,15,49,21,209,195,85,201,53,224,4,126,247,139,68,115,166,182,153,51,
241,192,143,208].reverse(),cf:1},ei={info:["NUMSP256T1",256,255,256],name:"NUMSP256T1",type:1,p:[67,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[1],d:[85,195,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),order:[245,74,221,238,144,177,71,26,155,67,89,47,165,90,149,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64].reverse(),gx:[218,19,237,46,144,192,222,160,134,53,8,227,14,138,57,12,214,155,32,105,95,61,30,205,125,35,234,106,251,20,117,138].reverse(),gy:[230,137,138,121,231,22,166,47,211,110,133,16,216,97,95,113,16,128,75,166,217,101,150,206,199,37,217,217,159,62,213,68].reverse(),cf:4},oi={info:["numsp384d1",384,384,384],name:"numsp384d1",type:0,p:[195,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
255,255,255].reverse(),a:[192,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),b:[187,119,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),order:[185,97,14,123,246,129,77,96,122,226,55,76,61,157,218,190,129,104,93,235,30,175,30,214,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),gx:[42,21,152,32,4,186,156,235,123,196,97,15,16,237,46,82,66,199,108,42,27,41,189,243,244,249,129,251,205,193,37,2,166,241,5,65,34,202,128,72,28,24,111,177,240,86,121,117].reverse(),gy:[22,7,24,102,236,184,116,92,38,173,244,191,219,180,214,188,126,131,26,18,125,131,32,185,156,115,127,248,119,105,4,176,126,207,132,5,48,61,227,215,56,142,155,225,104,227,222,172].reverse(
),cf:1},si={info:["NUMSP384T1",384,382,384],name:"NUMSP384T1",type:1,p:[195,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[1],d:[159,209,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),order:[125,137,163,230,196,220,185,32,121,200,53,171,90,85,228,97,207,225,107,180,28,26,71,226,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,63].reverse(),gx:[222,107,32,108,228,64,213,80,19,148,69,101,177,146,242,111,64,99,49,243,168,255,99,87,0,76,190,229,70,244,11,179,181,93,229,154,18,162,182,192,108,38,169,69,251,17,177,97].reverse(),gy:[146,147,114,240,225,3,141,157,220,72,236,70,249,176,114,0,75,150,69,246,247,152,15,131,86,95,66,241,116,130,173,22,215,13,
177,35,164,177,56,135,176,238,166,185,103,62,152,130].reverse(),cf:4},hi={info:["NUMSP512D1",512,512,512],name:"NUMSP512D1",type:0,p:[199,253,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[196,253,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),b:[155,217,1].reverse(),order:[93,85,51,4,57,63,21,206,67,210,124,96,54,139,86,59,198,189,208,151,237,88,194,79,27,131,231,148,251,164,60,91,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),gx:[87,174,171,140,149,135,130,220,226,93,111,125,
19,96,93,29,131,21,86,37,134,66,121,147,158,53,107,7,81,161,33,80,249,217,6,83,194,224,6,69,133,246,1,181,59,216,202,152,82,59,61,160,2,112,43,218,147,10,29,20,71,52,192,58].reverse(),gy:[166,39,53,56,96,135,160,35,233,15,253,76,30,92,43,207,2,86,90,178,64,168,33,193,233,237,14,139,218,21,132,162,20,79,209,123,12,38,75,143,140,187,188,171,222,219,151,75,0,177,235,99,220,238,14,206,179,86,173,41,202,84,58,148].reverse(),cf:4},ci={info:["NUMSP512T1",512,510,512],name:"NUMSP512T1",type:1,p:[199,253,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[1].reverse(),d:[239,203,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
255,255,255,255,255,255,255,255].reverse(),order:[109,212,238,27,245,140,70,103,255,236,239,109,120,5,70,42,245,134,182,112,201,216,63,158,186,145,207,47,109,99,240,180,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,63].reverse(),gx:[254,87,236,153,41,171,185,197,21,240,196,124,66,37,229,15,173,4,137,86,146,201,189,120,15,115,70,238,78,193,33,70,71,129,59,39,190,126,161,39,130,163,196,77,159,231,209,47,51,197,211,136,120,203,24,122,156,182,141,18,109,49,142,223].reverse(),gy:[225,245,226,193,192,222,109,50,31,208,241,155,138,211,102,2,253,193,236,42,134,6,26,96,98,53,150,233,242,83,202,32,65,131,158,144,149,107,43,169,34,157,37,216,38,247,118,228,110,37,42,168,119,245,176,152,113,202,73,157,243,191,9,109].reverse(),cf:4};typeof o!="undefined"&&(o.curves.NUMSP256T1=ei,o.curves.NUMSP384T1=si,o.curves.NUMSP512T1=ci,o.curves.NUMSP256D1=fi,o.curves.NUMSP384D1=oi,o.curves.NUMSP512D1=hi);it=function(n,t,i,u,f,e,o){function l(
n){for(var t=Math.floor(n.length/f),i=0;i<t;i++)e(n,i,h,u,y);return c+=t,n.slice(t*f)}function p(){for(var n=[],t=0;t<h.length;t++)n=n.concat(a.int32ToBytes(h[t]));return n.length=o/8,n}function w(n){var t=f-n.length%f,i,r,u;for(t<=f/8&&(t+=f),i=a.getVector(t),i[0]=128,r=(n.length+c*f)*8,u=1;u<=8;u++)i[t-u]=r%256,r=Math.floor(r/256);return n.concat(i)}function b(n){return s=l(n),v()}function k(n){s=s.concat(n);s.length>=f&&(s=l(s));return}function v(){if(l(w(s)).length!==0)throw new Error("buffer.length !== 0");var n=p();return s=[],h=i.slice(),c=0,n}var a=r,h=i.slice(),y=new Array(f),s=[],c=0;return{name:n,computeHash:b,process:k,finish:v,der:t,hashLen:o,maxMessageSize:4294967295}};y=(function(){function i(n,i,r,u,f){for(var s,v,y,l=4294967295,a=r[0],o=r[1],h=r[2],c=r[3],p=r[4],e=0;e<16;e++)f[e]=t.bytesToInt32(n,i*64+e*4);for(s=16;s<80;s++)y=f[s-3]^f[s-8]^f[s-14]^f[s-16],f[s]=y<<1|y>>>31;for(e=0;e<80;e++)v=a<<5|a>>>27,v+=e>=60?o^h^c:e>=40?o&h^o&c^h&c:e>=20?o^h^c:o&h^~o&c,v+=p+u[e]+f[e],
p=c,c=h,h=o<<30|o>>>2,o=a,a=v;return r[0]+=a&l,r[1]+=o&l,r[2]+=h&l,r[3]+=c&l,r[4]+=p&l,r}var t=r,n=t.unpackData,u=n("Z0UjAe/Nq4mYutz+EDJUdsPS4fA=",4,1),f=n("WoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroY8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdY",4,1),e=n("MCEwCQYFKw4DAhoFAAQU");return{sha1:function(){return it("SHA-1",e,u,f,64,i,160)}}})();typeof i!="undefined"&&(y.instances={},y.getInstance=function(n){return y.instances[n]||(y.instances[n]=y.sha1())},y.deleteInstance=function(n){y.instances[n]=null;delete y.instances[n]},y.hash=function(n){if(n.operationSubType==="process"){y.sha1.process(n.buffer);return}return n.operationSubType==="finish"?y.sha1.finish(
):y.sha1().computeHash(n.buffer)},i.register("digest","sha-1",y.hash));s["sha-1"]=y.sha1;u=(function(){function u(n,t,r,u,f){for(var s,p,l,a,e=4294967295,c=r[0],v=r[1],y=r[2],w=r[3],o=r[4],b=r[5],k=r[6],d=r[7],h=0;h<16;h++)f[h]=i.bytesToInt32(n,t*64+h*4);for(s=16;s<64;s++)l=f[s-15],a=f[s-2],f[s]=((a>>>17|a<<15)^(a>>>19|a<<13)^a>>>10)+f[s-7]+((l>>>7|l<<25)^(l>>>18|l<<14)^l>>>3)+f[s-16],f[s]=f[s]&e;for(h=0;h<64;h++)p=d+((o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7))+(o&b^~o&k)+u[h]+f[h],w+=p,p+=((c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10))+(c&(v^y)^v&y),d=k,k=b,b=o,o=w&e,w=y,y=v,v=c,c=p&e;return r[0]+=c&e,r[1]+=v&e,r[2]+=y&e,r[3]+=w&e,r[4]+=o&e,r[5]+=b&e,r[6]+=k&e,r[7]+=d&e,r}var i=r,t,f,e,o,s,n=i.unpackData;return f=n("wQWe2DZ81QcwcN0X9w5ZOf/ACzFoWBURZPmPp776T6Q",4,1),e=n("agnmZ7tnroU8bvNypU/1OlEOUn+bBWiMH4PZq1vgzRk",4,1),t=n("QoovmHE3RJG1wPvP6bXbpTlWwltZ8RHxkj+CpKscXtXYB6qYEoNbASQxhb5VDH3Dcr5ddIDesf6b3AanwZvxdOSbacHvvkeGD8GdxiQMocwt6SxvSnSEqlywqdx2+YjamD5RUqgxxm2wAyfIv1l/x8bgC/PVp5FHBspjURQpKWcntwqFLhshOE0sbfxTOA0TZQpzVHZqCruBwskuknIshaK/6KGoGmZLwkuLcMdsUaPRkugZ1pkGJPQONYUQaqBwGaTBFh43bAgnSHdMNLC8tTkcDLNO2KpKW5zKT2gub/N0j4LueKVjb4TIeBSMxwIIkL7/+qRQbOu++aP3xnF48g",
4,1),o=n("MC0wDQYJYIZIAWUDBAIEBQAEHA"),s=n("MDEwDQYJYIZIAWUDBAIBBQAEIA"),{sha224:function(){return it("SHA-224",o,f,t,64,u,224)},sha256:function(){return it("SHA-256",s,e,t,64,u,256)}}})();typeof i!="undefined"&&(u.instance224=u.instance224||u.sha224(),u.instance256=u.instance256||u.sha256(),u.instances={},u.getInstance224=function(n){return u.instances[n]||(u.instances[n]=u.sha224())},u.getInstance256=function(n){return u.instances[n]||(u.instances[n]=u.sha256())},u.deleteInstance=function(n){u.instances[n]=null;delete u.instances[n]},u.hash256=function(n){if(n.operationSubType==="process")return u.getInstance256(n.workerid).process(n.buffer),null;if(n.operationSubType==="finish"){var t=u.getInstance256(n.workerid).finish();return u.deleteInstance(n.workerid),t}if(n.operationSubType==="abort"){u.deleteInstance(n.workerid);return}return u.instance256.computeHash(n.buffer)},u.hash224=function(n){if(n.operationSubType==="process"){u.getInstance224(n.workerid).process(n.buffer);return}if(n.
operationSubType==="finish")var t=u.getInstance224(n.workerid).finish();if(n.operationSubType==="abort"){msrcryptoSha224.deleteInstance(n.workerid);return}return u.instance224.computeHash(n.buffer)},i.register("digest","sha-224",u.hash224),i.register("digest","sha-256",u.hash256));s["sha-224"]=u.sha224;s["sha-256"]=u.sha256;f=(function(){function n(n,t,i,r,u){var f=t+r|0,e=f>>>0<r>>>0;u[0]=n+i+e|0;u[1]=f;return}function u(t,i,r,u,f){for(var b,a,v,k,d,s,h,e=[],ht=[],w=[],ct,y=r[0],p=r[1],g=r[2],nt=r[3],tt=r[4],it=r[5],rt=r[6],ut=r[7],c=r[8],l=r[9],ft=r[10],et=r[11],ot=r[12],st=r[13],lt=r[14],at=r[15],o=0;o<32;o++)ct=i*128+o*4,f[o]=t.slice(ct,ct+4),f[o]=f[o][0]<<24|f[o][1]<<16|f[o][2]<<8|f[o][3];for(o=32;o<160;o+=2)s=f[o-30],h=f[o-29],a=(s>>>1|h<<31)^(s>>>8|h<<24)^s>>>7,v=(h>>>1|s<<31)^(h>>>8|s<<24)^(h>>>7|s<<25),s=f[o-4],h=f[o-3],k=(s>>>19|h<<13)^(h>>>29|s<<3)^s>>>6,d=(h>>>19|s<<13)^(s>>>29|h<<3)^(h>>>6|s<<26),n(k,d,f[o-14],f[o-13],e),n(a,v,e[0],e[1],e),n(f[o-32],f[o-31],e[0],e[1],e),f[o]=
e[0],f[o+1]=e[1];for(b=0;b<160;b+=2)a=(c>>>14|l<<18)^(c>>>18|l<<14)^(l>>>9|c<<23),v=(l>>>14|c<<18)^(l>>>18|c<<14)^(c>>>9|l<<23),k=c&ft^ot&~c,d=l&et^st&~l,n(lt,at,a,v,e),n(k,d,u[b],u[b+1],ht),n(e[0],e[1],f[b],f[b+1],w),n(ht[0],ht[1],w[0],w[1],w),n(w[0],w[1],rt,ut,e),rt=e[0],ut=e[1],v=(p>>>28|y<<4)^(y>>>2|p<<30)^(y>>>7|p<<25),a=(y>>>28|p<<4)^(p>>>2|y<<30)^(p>>>7|y<<25),d=p&(nt^it)^nt&it,k=y&(g^tt)^g&tt,n(w[0],w[1],a,v,e),a=e[0],v=e[1],n(k,d,a,v,e),a=e[0],v=e[1],lt=ot,at=st,ot=ft,st=et,ft=c,et=l,c=rt,l=ut,rt=tt,ut=it,tt=g,it=nt,g=y,nt=p,y=a,p=v;return n(r[0],r[1],y,p,e),r[0]=e[0],r[1]=e[1],n(r[2],r[3],g,nt,e),r[2]=e[0],r[3]=e[1],n(r[4],r[5],tt,it,e),r[4]=e[0],r[5]=e[1],n(r[6],r[7],rt,ut,e),r[6]=e[0],r[7]=e[1],n(r[8],r[9],c,l,e),r[8]=e[0],r[9]=e[1],n(r[10],r[11],ft,et,e),r[10]=e[0],r[11]=e[1],n(r[12],r[13],ot,st,e),r[12]=e[0],r[13]=e[1],n(r[14],r[15],lt,at,e),r[14]=e[0],r[15]=e[1],r}var l=r,e,f,i,o,s,h,c,t=l.unpackData;return e=t("y7udXcEFnthimikqNnzVB5FZAVowcN0XFS/s2PcOWTlnMyZn/8ALMY60SodoWBUR2wwuDWT5j6dHtUgdvvpPpA==",
4,1),f=t("agnmZ/O8yQi7Z66FhMqnOzxu83L+lPgrpU/1Ol8dNvFRDlJ/reaC0ZsFaIwrPmwfH4PZq/tBvWtb4M0ZE34heQ",4,1),i=t("QoovmNcoriJxN0SRI+9lzbXA+8/sTTsv6bXbpYGJ27w5VsJb80i1OFnxEfG2BdAZkj+CpK8ZT5urHF7V2m2BGNgHqpijAwJCEoNbAUVwb74kMYW+TuSyjFUMfcPV/7Ticr5ddPJ7iW+A3rH+OxaWsZvcBqclxxI1wZvxdM9pJpTkm2nBnvFK0u++R4Y4TyXjD8GdxouM1bUkDKHMd6ycZS3pLG9ZKwJ1SnSEqm6m5INcsKncvUH71Hb5iNqDEVO1mD5RUu5m36uoMcZtLbQyELADJ8iY+yE/v1l/x77vDuTG4AvzPaiPwtWnkUeTCqclBspjUeADgm8UKSlnCg5ucCe3CoVG0i/8LhshOFwmySZNLG38WsQq7VM4DROdlbPfZQpzVIuvY952agq7PHeyqIHCyS5H7a7mknIshRSCNTuiv+ihTPEDZKgaZku8QjABwkuLcND4l5HHbFGjBlS+MNGS6BnW71IY1pkGJFVlqRD0DjWFV3EgKhBqoHAyu9G4GaTBFrjS0MgeN2wIUUGrUydId0zfjuuZNLC8teGbSKg5HAyzxclaY07YqkrjQYrLW5zKT3dj43NoLm/z1rK4o3SPgu5d77L8eKVjb0MXL2CEyHgUofCrcozHAggaZDnskL7/+iNjHiikUGzr3oK96b75o/eyxnkVxnF48uNyUyvKJz7O6iZhnNGGuMchwMIH6tp91s3g6x71fU9/7m7ReAbwZ6pyF2+6CmN9xaLImKYRP5gEvvkNrhtxCzUTHEcbKNt39SMEfYQyyqt7QMckkzyevgoVyb68Qx1nxJwQDUxMxdS+yz5Ctll/KZz8ZX4qX8tvqzrW+uxsRBmMSkdYFw==",4,1),o=t("MEEwDQYJYIZIAWUDBAICBQAEMA"),
s=t("MFEwDQYJYIZIAWUDBAIDBQAEQA"),h=t("MC0wDQYJYIZIAWUDBAIFBQAEHA"),c=t("MDEwDQYJYIZIAWUDBAIGBQAEIA"),{sha384:function(){return it("SHA-384",o,e,i,128,u,384)},sha512:function(){return it("SHA-512",s,f,i,128,u,512)},sha512_224:function(){return it("SHA-512.224",h,f,i,128,u,224)},sha512_256:function(){return it("SHA-512.256",c,f,i,128,u,256)}}})();typeof i!="undefined"&&(f.instances={},f.getInstance384=function(n){return f.instances[n]||(f.instances[n]=f.sha384())},f.getInstance512=function(n){return f.instances[n]||(f.instances[n]=f.sha512())},f.deleteInstance=function(n){f.instances[n]=null;delete f.instances[n]},f.hash384=function(n){if(n.operationSubType==="process"){f.sha384.process(n.buffer);return}return n.operationSubType==="finish"?f.sha384.finish():f.sha384().computeHash(n.buffer)},f.hash512=function(n){if(n.operationSubType==="process"){f.sha512.process(n.buffer);return}return n.operationSubType==="finish"?f.sha512.finish():f.sha512().computeHash(n.buffer)},i.register("digest",
"sha-384",f.hash384),i.register("digest","sha-512",f.hash512));s["sha-384"]=f.sha384;s["sha-512"]=f.sha512;k=function(n,t){function c(n,t){for(var r=new Array(n),i=0;i<n.length;i++)r[i]=n[i]^t[i];return r}function l(n,t){for(var i=n.slice(),r=n.length;r<t;r++)i.push(0);return i}function p(){return n.length===i?n:n.length>i?l(t.computeHash(n),i):l(n,i)}function a(n){o?t.process(n):(o=h.concat(n),t.process(o));return}function v(){var n=t.finish(),i=s.concat(n);return t.computeHash(i)}function y(){n=null;t=null;e=null}var i={"384":128,"512":128}[t.name.replace(/SHA-/,"")]||64,u,f,e=p(),s,h,o,r;for(u=new Array(i),f=new Array(i),r=0;r<i;r++)u[r]=54,f[r]=92;return h=c(e,u),s=c(e,f),{computeHmac:function(n){a(n);var t=v();return y(),t},process:function(n){return a(n),null},finish:function(){var n=v();return y(),n}}};typeof i!="undefined"&&(p={},k.signHmac=function(n){var r=n.keyHandle.algorithm.hash.name.toLowerCase(),u=s[r](),i,t=n.workerid;return(p[t]||(p[t]=k(n.keyData,u)),n.operationSubType===
"process")?(p[t].process(n.buffer),null):n.operationSubType==="finish"?(i=p[t].finish(),p[t]=null,i):(i=p[t].computeHmac(n.buffer),p[t]=null,i)},k.verifyHmac=function(n){var u=n.keyHandle.algorithm.hash.name.toLowerCase(),f=s[u](),t,i=n.workerid;return(p[i]||(p[i]=k(n.keyData,f)),n.operationSubType==="process")?(p[i].process(n.buffer),null):n.operationSubType==="finish"?(t=p[i].finish(),t=r.arraysEqual(t,n.signature),p[i]=null,t):(t=p[i].computeHmac(n.buffer),t=r.arraysEqual(t,n.signature),p[i]=null,t)},k.generateKey=function(n){var t=n.algorithm.length;return t||(t={"sha-256":32,"sha-384":48,"sha-512":64}[n.algorithm.hash.name.toLowerCase()]),{type:"keyGeneration",keyData:l.getBytes(t),keyHandle:{algorithm:n.algorithm,extractable:n.extractable,keyUsage:null||n.keyUsage,type:"secret"}}},k.importKey=function(n){var t,i=n.keyData.length*8;if(n.format=="jwk")t=v.jwkToKey(n.keyData,n.algorithm,["k"]),t.alg=t.alg.replace("HS","SHA-");else if(n.format=="raw"){if(i!==128&&i!==192&&i!=256)throw new
Error("invalid key length (should be 128, 192, or 256 bits)");t={k:r.toArray(n.keyData)}}else throw new Error("unsupported import format");return{type:"keyImport",keyData:t.k,keyHandle:{algorithm:{name:"HMAC",hash:{name:n.algorithm.hash.name}},extractable:n.extractable||t.extractable,keyUsage:n.keyUsage,type:"secret"}}},k.exportKey=function(n){if(n.format=="jwk")return{type:"keyExport",keyHandle:v.keyToJwk(n.keyHandle,n.keyData)};if(n.format=="raw")return{type:"keyExport",keyHandle:n.keyData};throw new Error("unsupported export format");},i.register("importKey","hmac",k.importKey),i.register("exportKey","hmac",k.exportKey),i.register("generateKey","hmac",k.generateKey),i.register("sign","hmac",k.signHmac),i.register("verify","hmac",k.verifyHmac));tt=(function(){var o,n,t,i,u,f,e,s,h,c;return{aes:function(l){var d,b,a,p,v,y;o||(o=r.unpackData("AAIEBggKDA4QEhQWGBocHiAiJCYoKiwuMDI0Njg6PD5AQkRGSEpMTlBSVFZYWlxeYGJkZmhqbG5wcnR2eHp8foCChIaIioyOkJKUlpianJ6goqSmqKqsrrCytLa4ury+wMLExsjKzM7Q0tTW2Nrc3uDi5Obo6uzu8PL09vj6/P4bGR8dExEXFQsJDw0DAQcFOzk/PTMxNzUrKS8tIyEnJVtZX11TUVdVS0lPTUNBR0V7eX99c3F3dWtpb21jYWdlm5mfnZORl5WLiY+Ng4GHhbu5v72zsbe1q6mvraOhp6Xb2d/d09HX1cvJz83DwcfF+/n//fPx9/Xr6e/t4+Hn5QADBgUMDwoJGBseHRQXEhEwMzY1PD86OSgrLi0kJyIhYGNmZWxvaml4e359dHdycVBTVlVcX1pZSEtOTURHQkHAw8bFzM/Kydjb3t3U19LR8PP29fz/+vno6+7t5Ofi4aCjpqWsr6qpuLu+vbS3srGQk5aVnJ+amYiLjo2Eh4KBm5idnpeUkZKDgIWGj4yJiquora6npKGis7C1tr+8ubr7+P3+9/Tx8uPg5ebv7Onqy8jNzsfEwcLT0NXW39zZ2ltYXV5XVFFSQ0BFRk9MSUpraG1uZ2RhYnNwdXZ/fHl6Ozg9Pjc0MTIjICUmLywpKgsIDQ4HBAECExAVFh8cGRoADhwSODYkKnB+bGJIRlRa4O788tjWxMqQnoyCqKa0utvVx8nj7f/xq6W3uZOdj4E7NScpAw0fEUtFV1lzfW9hraOxv5WbiYfd08HP5ev5901DUV91e2lnPTMhLwULGRd2eGpkTkBSXAYIGhQ+MCIslpiKhK6gsrzm6Pr03tDCzEFPXVN5d2VrMT8tIwkHFRuhr72zmZeFi9HfzcPp5/X7mpSGiKKsvrDq5Pb40tzOwHp0ZmhCTF5QCgQWGDI8LiDs4vD+1NrIxpySgI6kqri2DAIQHjQ6KCZ8cmBuREpYVjc5KyUPARMdR0lbVX9xY23X2cvF7+Hz/aepu7WfkYONAA0aFzQ5LiNoZXJ/XFFGS9Ddysfk6f7zuLWir4yBlpu7tqGsj4KVmNPeycTn6v3wa2ZxfF9SRUgDDhkUNzotIG1gd3pZVENOBQgfEjE8Kya9sKeqiYSTntXYz8Lh7Pv21tvMweLv+PW+s6SpioeQnQYLHBEyPyglbmN0eVpXQE3a18DN7uP0+bK/qKWGi5yRCgcQHT4zJClib3h1VltMQWFse3ZVWE9CCQQTHj0wJyqxvKumhYifktnUw87t4Pf6t7qtoIOOmZTf0sXI6+bx/GdqfXBTXklEDwIVGDs2ISwMARYbODUiL2RpfnNQXUpH3NHGy+jl8v+0ua6jgI2alwALFh0sJzoxWFNORXR/Ymmwu6atnJeKgejj/vXEz9LZe3BtZldcQUojKDU+DwQZEsvA3dbn7PH6k5iFjr+0qaL2/eDr2tHMx66luLOCiZSfRk1QW2phfHceFQgDMjkkL42Gm5Chqre81d7DyPny7+Q9NisgERoHDGVuc3hJQl9U9/zh6tvQzcavpLmyg4iVnkdMUVprYH12HxQJAjM4JS6Mh5qRoKu2vdTfwsn48+7lPDcqIRAbBg1kb3J5SENeVQEKFxwtJjswWVJPRHV+Y2ixuqesnZaLgOni//TFztPYenFsZ1ZdQEsiKTQ/DgUYE8rB3Nfm7fD7kpmEj761qKMACRIbJC02P0hBWlNsZX53kJmCi7S9pq/Y0crD/PXu5zsyKSAfFg0Ec3phaFdeRUyrormwj4adlOPq8fjHztXcdn9kbVJbQEk+NywlGhMIAebv9P3Cy9DZrqe8tYqDmJFNRF9WaWB7cgUMFx4hKDM63dTPxvnw6+KVnIeOsbijquzl/vfIwdrTpK22v4CJkpt8dW5nWFFKQzQ9Ji8QGQIL197FzPP64eiflo2Eu7KpoEdOVVxjanF4DwYdFCsiOTCak4iBvrespdLbwMn2/+TtCgMYES4nPDVCS1BZZm90faGos7qFjJee6eD78s3E39YxOCMqFRwHDnlwa2JdVE9GY3x3e/Jrb8UwAWcr/terdsqCyX36WUfwrdSir5ykcsC3/ZMmNj/3zDSl5fFx2DEVBMcjwxiWBZoHEoDi6yeydQmDLBobblqgUjvWsynjL4RT0QDtIPyxW2rLvjlKTFjP0O+q+0NNM4VF+QJ/UDyfqFGjQI+SnTj1vLbaIRD/89LNDBPsX5dEF8Snfj1kXRlzYIFP3CIqkIhG7rgU3l4L2+AyOgpJBiRcwtOsYpGV5HnnyDdtjdVOqWxW9Opleq4IunglLhymtMbo3XQfS72LinA+tWZIA/YOYTVXuYbBHZ7h+JgRadmOlJseh+nOVSjfjKGJDb/mQmhBmS0PsFS7FlIJatUwNqU4v0CjnoHz1/t84zmCmy//hzSOQ0TE3unLVHuUMqbCIz3uTJULQvrDTgguoWYo2SSydluiSW2L0SVy+PZkhmiYFtSkXMxdZbaSbHBIUP3tudpeFUZXp42dhJDYqwCMvNMK9+RYBbizRQbQLB6Pyj8PAsGvvQMBE4prOpERQU9n3OqX8s/O8LTmc5asdCLnrTWF4vk36Bx1325H8RpxHSnFiW+3Yg6qGL4b/FY+S8bSeSCa28D+eM1a9B/dqDOIB8cxsRIQWSeA7F9gUX+pGbVKDS3lep+TyZzvoOA7Ta4q9bDI67s8g1OZYRcrBH66d9Ym4WkUY1UhDH2NAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuN",
256,!1),n=o[0],t=o[1],i=o[2],u=o[3],f=o[4],e=o[5],s=o[6],h=o[7],c=o[8]);d=128;p=4;switch(l.length*8){case 128:b=128;a=4;v=10;break;case 192:b=192;a=6;v=12;break;case 256:b=256;a=8;v=14;break;default:throw new Error("Unsupported keyLength");}var g=function(n){var t=n[1];n[1]=n[5];n[5]=n[9];n[9]=n[13];n[13]=t;t=n[2];n[2]=n[10];n[10]=t;t=n[6];n[6]=n[14];n[14]=t;t=n[15];n[15]=n[11];n[11]=n[7];n[7]=n[3];n[3]=t},nt=function(n){var t=n[13];n[13]=n[9];n[9]=n[5];n[5]=n[1];n[1]=t;t=n[10];n[10]=n[2];n[2]=t;t=n[14];n[14]=n[6];n[6]=t;t=n[3];n[3]=n[7];n[7]=n[11];n[11]=n[15];n[15]=t},ut=function(i){var r=i[0],u=i[1],f=i[2],e=i[3],o=i[4],s=i[5],h=i[6],c=i[7],l=i[8],a=i[9],v=i[10],y=i[11],p=i[12],w=i[13],b=i[14],k=i[15];i[0]=n[r]^t[u]^f^e;i[1]=r^n[u]^t[f]^e;i[2]=r^u^n[f]^t[e];i[3]=t[r]^u^f^n[e];i[4]=n[o]^t[s]^h^c;i[5]=o^n[s]^t[h]^c;i[6]=o^s^n[h]^t[c];i[7]=t[o]^s^h^n[c];i[8]=n[l]^t[a]^v^y;i[9]=l^n[a]^t[v]^y;i[10]=l^a^n[v]^t[y];i[11]=t[l]^a^v^n[y];i[12]=n[p]^t[w]^b^k;i[13]=p^n[w]^t[b]^k;i[14]=p^w^n[b]^t[
k];i[15]=t[p]^w^b^n[k]},ft=function(n){var t=n[0],r=n[1],o=n[2],s=n[3],h=n[4],c=n[5],l=n[6],a=n[7],v=n[8],y=n[9],p=n[10],w=n[11],b=n[12],k=n[13],d=n[14],g=n[15];n[0]=i[t]^f[r]^u[o]^e[s];n[1]=e[t]^i[r]^f[o]^u[s];n[2]=u[t]^e[r]^i[o]^f[s];n[3]=f[t]^u[r]^e[o]^i[s];n[4]=i[h]^f[c]^u[l]^e[a];n[5]=e[h]^i[c]^f[l]^u[a];n[6]=u[h]^e[c]^i[l]^f[a];n[7]=f[h]^u[c]^e[l]^i[a];n[8]=i[v]^f[y]^u[p]^e[w];n[9]=e[v]^i[y]^f[p]^u[w];n[10]=u[v]^e[y]^i[p]^f[w];n[11]=f[v]^u[y]^e[p]^i[w];n[12]=i[b]^f[k]^u[d]^e[g];n[13]=e[b]^i[k]^f[d]^u[g];n[14]=u[b]^e[k]^i[d]^f[g];n[15]=f[b]^u[k]^e[d]^i[g]},tt=function(n,t){return[n[0]^t[0],n[1]^t[1],n[2]^t[2],n[3]^t[3]]},w=function(n,t,i){for(var r=0;r<n.length;r+=1)n[r]^=t[r+i]},et=function(n){var t=n[0];n[0]=n[1];n[1]=n[2];n[2]=n[3];n[3]=t},k=function(n){for(var t=0;t<n.length;t+=1)n[t]=s[n[t]]},it=function(n){for(var t=0;t<n.length;t+=1)n[t]=h[n[t]]},rt=function(n,t){return[n[4*t],n[4*t+1],n[4*t+2],n[4*t+3]]},ot=function(n,t,i,r){n[4*i]=t[4*r];n[4*i+1]=t[4*r+1];n[4*i+2]=t[4*r+2];
n[4*i+3]=t[4*r+3]},st=function(n){for(var i,r=[],t=0,u,f,e;t<4*a;)r.push(n[t++]);for(t=a;t<p*(v+1);)i=rt(r,t-1),t%a==0?(u=t/a,f=[c[u],0,0,0],et(i),k(i),i=tt(i,f)):a>6&&t%a==4&&k(i),e=tt(rt(r,t-a),i),ot(r,e,t,0),t+=1;return r};return y=st(l),{encrypt:function(n){var t=n,i;for(w(t,y,0),i=1;i<=v-1;i+=1)k(t),g(t),ut(t),w(t,y,4*i*p);return k(t),g(t),w(t,y,4*v*p),t},decrypt:function(n){var t=n,i;for(w(t,y,4*v*p),i=v-1;i>=1;i-=1)nt(t),it(t),w(t,y,4*i*p),ft(t);return nt(t),it(t),w(t,y,0),t},clear:function(){},keyLength:b,blockSize:d}}}})();vt=vt||{};vt.pkcsv7=function(n){function t(t){var o=t.length-1>=0?t.length-1:0,i=t[o],f=i.length,s=f===n,r,u,e;if(s){for(r=[],u=0;u<n;u+=1)r.push(n);t.push(r)}else for(e=n-f&255;i.length!==n;)i.push(e)}function i(t){var i=!0,u,f,r,e,o,s;for(t.length%n!=0&&(i=!1),u=t.slice(-n),f=u[u.length-1],r=0;r<n;r++)e=n-r<=f,o=u[r]===f,i=(e?o:!0)&&i;return s=i?f:0,t.length-=s,i}return{pad:t,unpad:i}};d=function(n){function o(n){var f=[],r,i;for(t=t.concat(n),r=Math.floor(
t.length/u),i=0;i<r;i++)f.push(t.slice(i*u,(i+1)*u));return t=t.slice(r*u),f}function s(t){for(var u=[],e,i=0;i<t.length;i++)e=r.xorVectors(f,t[i]),u.push(n.encrypt(e)),f=u[i];return u}function l(t){for(var u=[],e,o,i=0;i<t.length;i+=1)e=t[i].slice(0,t[i].length),o=n.decrypt(e),u.push(r.xorVectors(f,o)),f=t[i];return u}function c(){t=[];i=[];f=null}var u=n.blockSize/8,h=vt.pkcsv7(u),e=function(n){for(var u=[],i,r,t=0;t<n.length;t+=1)for(r=n[t],i=0;i<r.length;i+=1)u.push(r[i]);return u},t=[],i=[],f;return{init:function(n){if(n.length!==u)throw new Error("Invalid iv size");f=n.slice()},encrypt:function(n){var t=s(o(n));return i=i.concat(e(t)),this.finishEncrypt()},processEncrypt:function(n){return e(s(o(n)))},finishEncrypt:function(){var n=t.length===1?[[t[0]]]:[t],r;return h.pad(n),r=i.concat(e(s(n))),c(),r},decrypt:function(n){return this.processDecrypt(n),this.finishDecrypt()},processDecrypt:function(n){var t=l(o(n));i=i.concat(e(t));return},finishDecrypt:function(){var n=i,t=h.unpad(
n);return c(),n}}};typeof i!="undefined"&&(h={},d.workerEncrypt=function(n){var i,t=n.workerid;return(h[t]||(h[t]=d(tt.aes(n.keyData)),h[t].init(n.algorithm.iv)),n.operationSubType==="process")?h[t].processEncrypt(n.buffer):n.operationSubType==="finish"?(i=h[t].finishEncrypt(),h[t]=null,i):(i=h[t].encrypt(n.buffer),h[t]=null,i)},d.workerDecrypt=function(n){var i,t=n.workerid;if(h[t]||(h[t]=d(tt.aes(n.keyData)),h[t].init(n.algorithm.iv)),n.operationSubType==="process"){h[t].processDecrypt(n.buffer);return}return n.operationSubType==="finish"?(i=h[t].finishDecrypt(),h[t]=null,i):(i=h[t].decrypt(n.buffer),h[t]=null,i)},d.generateKey=function(n){if(n.algorithm.length%8!=0)throw new Error;return{type:"keyGeneration",keyData:l.getBytes(Math.floor(n.algorithm.length/8)),keyHandle:{algorithm:n.algorithm,extractable:n.extractable,keyUsage:null||n.keyUsage,type:"secret"}}},d.importKey=function(n){var t;if(n.format=="jwk")t=v.jwkToKey(n.keyData,n.algorithm,["k"]);else if(n.format=="raw")t={k:r.toArray(
n.keyData)};else throw new Error("unsupported import format");return n.algorithm.length=t.k.length*8,{type:"keyImport",keyData:t.k,keyHandle:{algorithm:n.algorithm,extractable:n.extractable||t.extractable,keyUsage:null||n.keyUsage,type:"secret"}}},d.exportKey=function(n){if(n.format=="jwk")return{type:"keyExport",keyHandle:v.keyToJwk(n.keyHandle,n.keyData)};if(n.format=="raw")return{type:"keyExport",keyHandle:n.keyData};throw new Error("unsupported export format");},i.register("importKey","aes-cbc",d.importKey),i.register("exportKey","aes-cbc",d.exportKey),i.register("generateKey","aes-cbc",d.generateKey),i.register("encrypt","aes-cbc",d.workerEncrypt),i.register("decrypt","aes-cbc",d.workerDecrypt));w=function(n){function a(n,t){for(var u=Math.floor(t.length/16),f,r=0;r<u;r++)f=t.slice(r*16,r*16+16),p=tt(i.xorVectors(p,f),n);return k=t.slice(u*16),p}function w(){var n=16*Math.ceil(e/16)-e,t=d(v.length*8),r=d(e*8),u=k.concat(i.getVector(n)).concat(t).concat(r);return a(l,u)}function tt(
n,t){for(var u=i.getVector(16),r=t.slice(),o=[225,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e,f=0;f<128;f++)e=it(n,f),e===1&&(u=i.xorVectors(u,r)),r[15]&1?(g(r),r=i.xorVectors(r,o)):g(r);return u}function g(n){for(var t=n.length-1;t>0;t--)n[t]=(n[t-1]&1)<<7|n[t]>>>1;return n[0]=n[0]>>>1,n}function it(n,t){var i=Math.floor(t/8);return n[i]>>7-t%8&1}function nt(n){for(var i=256,t=1;t<=4;t++)i=(i>>>8)+n[n.length-t],n[n.length-t]=i&255;return n}function o(t,r){var h=Math.ceil(r.length/16),o,e=[],u,s;for(f!==t&&(f=t.slice()),u=0;u<h;u++)o=r.slice(u*16,u*16+16),s=n.encrypt(f.slice()),e=e.concat(i.xorVectors(o,s)),f=nt(f);return e}function d(n){return[0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255]}function rt(n){var t=16*Math.ceil(v.length/16)-v.length;return n.concat(i.getVector(t))}function b(){e=0;t=[];u=[];p=i.getVector(16);k=[];f=s=v=null}function ut(n,t,r){if(v=t||[],h=isNaN(r)?128:r,h%8!=0)throw new Error("DataError");if(s=n,s.length===12)c=s.concat([0,0,0,1]);else{var u=16*Math.ceil(s.length/16)-
s.length;c=a(l,s.concat(i.getVector(u+8)).concat(d(s.length*8)));p=i.getVector(16)}y=nt(c.slice());a(l,rt(v))}function ft(n){var t,i,r;return e=n.length,t=o(y,n),a(l,t),i=w(),r=o(c,i).slice(0,h/8),b(),t.slice().concat(r)}function et(n,t){var r,u,f;return e=n.length,r=o(y,n),a(l,n),u=w(),f=o(c,u).slice(0,h/8),b(),i.arraysEqual(f,t)?r:null}function ot(n){var i,r;t=t.concat(n);i=t.slice(0,Math.floor(t.length/16)*16);e+=i.length;t=t.slice(i.length);r=o(f||y,i);u=u.concat(r);a(l,r)}function st(n){var i,r;t=t.concat(n);i=t.slice(0,Math.floor((t.length-h/8)/16)*16);e+=i.length;t=t.slice(i.length);r=o(f||y,i);u=u.concat(r);a(l,i)}function ht(){var n=o(f,t);u=u.concat(n);e+=t.length;var i=w(),r=o(c,i).slice(0,h/8),s=u.slice().concat(r);return b(),s}function ct(){var n=Math.floor(h/8),s=t.slice(-n),r;t=t.slice(0,t.length-n);r=o(f,t);u=u.concat(r);e+=t.length;var l=w(),a=o(c,l).slice(0,h/8),v=u.slice();if(b(),i.arraysEqual(a,s))return v;throw new Error("OperationError");}var i=r,t=[],s,v,h,c,y,l=
n.encrypt(i.getVector(16)),p=i.getVector(16),k=[],u=[],f,e=0;return{init:ut,encrypt:ft,decrypt:et,processEncrypt:ot,processDecrypt:st,finishEncrypt:ht,finishDecrypt:ct}};typeof i!="undefined"&&(c={},w.encrypt=function(n){var i,t=n.workerid;if(c[t]||(c[t]=w(tt.aes(n.keyData)),c[t].init(n.algorithm.iv,n.algorithm.additionalData,n.algorithm.tagLength)),n.operationSubType==="process"){c[t].processEncrypt(n.buffer);return}return n.operationSubType==="finish"?(i=c[t].finishEncrypt(),c[t]=null,i):(i=c[t].encrypt(n.buffer),c[t]=null,i)},w.decrypt=function(n){var i,t=n.workerid;if(c[t]||(c[t]=w(tt.aes(n.keyData)),c[t].init(n.algorithm.iv,n.algorithm.additionalData,n.algorithm.tagLength)),n.operationSubType==="process"){c[t].processDecrypt(n.buffer);return}if(n.operationSubType==="finish")return i=c[t].finishDecrypt(),c[t]=null,i;var r=Math.floor(n.algorithm.tagLength/8),u=n.buffer.slice(0,n.buffer.length-r),f=n.buffer.slice(-r);return i=c[t].decrypt(u,f),c[t]=null,i},w.generateKey=function(n){if(
n.algorithm.length%8!=0)throw new Error;return{type:"keyGeneration",keyData:l.getBytes(Math.floor(n.algorithm.length/8)),keyHandle:{algorithm:n.algorithm,extractable:n.extractable,keyUsage:null||n.keyUsage,type:"secret"}}},w.importKey=function(n){var t;if(n.format=="jwk")t=v.jwkToKey(n.keyData,n.algorithm,["k"]);else if(n.format=="raw")t={k:r.toArray(n.keyData)};else throw new Error("unsupported import format");return{type:"keyImport",keyData:t.k,keyHandle:{algorithm:n.algorithm,extractable:n.extractable||t.extractable,keyUsage:null||n.keyUsage,type:"secret"}}},w.exportKey=function(n){if(n.format=="jwk")return{type:"keyExport",keyHandle:v.keyToJwk(n.keyHandle,n.keyData)};if(n.format=="raw")return{type:"keyExport",keyHandle:n.keyData};throw new Error("unsupported export format");},i.register("importKey","aes-gcm",w.importKey),i.register("exportKey","aes-gcm",w.exportKey),i.register("generateKey","aes-gcm",w.generateKey),i.register("encrypt","aes-gcm",w.encrypt),i.register("decrypt","aes-gcm",
w.decrypt));l=new wt;var ai=function(n){function i(n){var i=t.digitsToBytes(n);return f.padFront(i,0,s),i}function u(n,i,r){var f=t.bytesToDigits(i),u=t.IntegerGroup(r),e=u.createElementFromBytes(n),o=u.modexp(e,f);return o.m_digits}function h(t){var r=u(t,n.d,n.n);return i(r)}function c(r){var l=n.p,a=n.q,v=n.dp,y=n.dq,p=n.qi,f=t.bytesToDigits(l),o=t.bytesToDigits(a),u=new Array(f.length+o.length),s=new Array(f.length+1),h=new Array(o.length+1),e=t.bytesToDigits(r),c;return t.reduce(e,f,u),t.modExp(u,t.bytesToDigits(v),f,s),t.reduce(e,o,u),t.modExp(u,t.bytesToDigits(y),o,h),c=t.subtract(s,h,u),c!==0&&t.subtract(h,s,u),t.modMul(u,t.bytesToDigits(p),f,e),c!==0&&t.subtract(f,e,e),t.multiply(e,o,u),t.add(h,u,s),i(s)}var f=r,e=n.hasOwnProperty("n")&&n.hasOwnProperty("d"),o=n.hasOwnProperty("p")&&n.hasOwnProperty("q"),s=n.n.length;return{encrypt:function(t){return i(u(t,n.e,n.n))},decrypt:function(n){if(o)return c(n);if(e)return h(n);throw new Error("missing private key");}}},ht={mgf1:function(
n,t,i){for(var u=[],f,e,o=i.hashLen/8,r=0;r<=Math.floor(t/o);r+=1)f=[r>>>24&255,r>>>16&255,r>>>8&255,r&255],e=i.computeHash(n.concat(f)),u=u.concat(e);return u.slice(0,t)},checkMessageVsMaxHash:function(n,t){if(n.length>(t.maxMessageSize||4294967295))throw new Error("message too long");return}},nt=nt||{};return nt.oaep=function(n,t){function e(n,r){var e,c,l,a,o,v,s,y,p,h;if(n.length>u-t.hashLen/4-2)throw new Error("Message too long.");return r||(r=[]),e=t.computeHash(r),c=u-n.length-2*e.length-2,l=i.getVector(c),a=e.concat(l,[1],n),o=f.getBytes(e.length),v=ht.mgf1(o,u-e.length-1,t),s=i.xorVectors(a,v),y=ht.mgf1(s,e.length,t),p=i.xorVectors(o,y),h=[0].concat(p).concat(s),n=h.slice(),h}function o(n,r){var f,s,o,h,c,l,e,a,v=0;if(r||(r=[]),f=t.computeHash(r),n[0]!==0)throw new Error("Encryption Error");if(s=n.slice(1,f.length+1),o=n.slice(f.length+1),h=ht.mgf1(o,f.length,t),c=i.xorVectors(s,h),l=ht.mgf1(c,u-f.length-1,t),e=i.xorVectors(o,l),a=e.slice(0,f.length),!i.arraysEqual(f,a))throw new
Error("Encryption Error");for(e=e.slice(f.length);!e[v++];);return e.slice(v)}var i=r,f=l,u=n.n.length;if(t===null)throw new Error("must supply hashFunction");return{pad:function(n,t){return e(n,t)},unpad:function(n,t){return o(n,t)}}},nt=nt||{},nt.pkcs1Sign=function(n,t){function f(n){var r,e,f;if(e=t.computeHash(n.slice()),r=t.der.concat(e),f=r.length,u<f+11)throw new Error("intended encoded message length too short");return[0,1].concat(i.getVector(u-f-3,255),[0],r)}var i=r,u=n.n.length;return{sign:function(n){return f(n)},verify:function(n,t){var r=f(t);return i.arraysEqual(n,r)}}},nt=nt||{},nt.pss=function(n,t){function f(r,f,e){var l=n.n.length*8-1,o=Math.ceil(l/8),c=t.computeHash(r),h;if(f=e?e.length:f||c.length,o<c.length+f+2)throw new Error("encoding error");e=e||u.getBytes(f);var y=[0,0,0,0,0,0,0,0].concat(c,e),s=t.computeHash(y),p=i.getVector(o-e.length-s.length-2),w=p.concat([1],e),b=ht.mgf1(s,o-s.length-1,t),a=i.xorVectors(w,b),v=0;for(h=0;h<8-(8*o-l);h++)v+=1<<h;return a[0]&=
v,a.concat(s,[188])}function e(r,u,f){var l=n.n.length*8-1,o=Math.ceil(l/8),a=t.computeHash(u),e=a.length,h;if(f=f||e,o<e+f+2)return!1;var c=r.slice(0,o-e-1),v=r.slice(c.length,c.length+e),y=ht.mgf1(v,o-e-1,t),s=i.xorVectors(c,y);for(s[0]&=255>>>8-(8*o-l),h=0;h<o-e-f-2;h++)if(s[h]!==0)return!1;if(s[o-e-f-2]!==1)return!1;var p=s.slice(-f),w=[0,0,0,0,0,0,0,0].concat(a,p),b=t.computeHash(w);return i.arraysEqual(b,v)}var i=r,u=l;return{sign:function(n,t,i){return f(n,t,i)},verify:function(n,t,i){return e(n,t,i)}}},e=function(n,t,i){function o(){if(!i||!i.computeHash)throw new Error("missing hash function");}var e=ai(n),u,f,r;if(!t)throw new Error("padding mode");u=null;f=null;switch(t){case"rsassa-pkcs1-v1_5":o();r=nt.pkcs1Sign(n,i);break;case"rsa-oaep":o();r=nt.oaep(n,i);break;case"rsa-pss":o();r=nt.pss(n,i);break;case"raw":r={pad:function(n){return n},unpad:function(n){return n}};break;default:throw new Error("invalid mode");}return r&&(u=r.pad||r.sign,f=r.unpad||r.verify),{encrypt:function(
n,t){var i;return i=u!==null?u(n,t):n.slice(),e.encrypt(i)},decrypt:function(n,t){var i=e.decrypt(n);return f!==null?f(i,t):i.slice(0)},signData:function(n,t,i){return e.decrypt(u(n,t,i))},verifySignature:function(n,t,i){var r=e.encrypt(n);return f(r,t,i)},mode:t}},typeof i!="undefined"&&(e.sign=function(n){var t,i=n.keyHandle.algorithm.hash.name,r=s[i.toLowerCase()](),u=n.algorithm.saltLength,f=n.algorithm.salt;return t=e(n.keyData,n.algorithm.name,r),t.signData(n.buffer,u,f)},e.verify=function(n){var i=n.keyHandle.algorithm.hash.name,r=s[i.toLowerCase()](),t,u=n.algorithm.saltLength;return t=e(n.keyData,n.algorithm.name,r),t.verifySignature(n.signature,n.buffer,u)},e.workerEncrypt=function(n){var i,r,u,t;switch(n.algorithm.name){case"rsa-oaep":if(t=n.algorithm.hash.name,!t)throw new Error("unsupported hash algorithm");u=s[t.toLowerCase()]();r=e(n.keyData,n.algorithm.name,u);i=r.encrypt(n.buffer);break;default:throw new Error("unsupported algorithm");}return i},e.workerDecrypt=function(
n){var i,r,u,t;switch(n.algorithm.name){case"rsa-oaep":if(t=n.algorithm.hash.name,!t)throw new Error("unsupported hash algorithm");u=s[t.toLowerCase()]();r=e(n.keyData,n.algorithm.name,u);i=r.decrypt(n.buffer);break;default:throw new Error("unsupported algorithm");}return i},e.importKey=function(n){var t=v.jwkToKey(n.keyData,n.algorithm,["n","e","d","q","p","dq","dp","qi"]);return{type:"keyImport",keyData:t,keyHandle:{algorithm:n.algorithm,extractable:n.extractable||t.extractable,keyUsage:null||n.keyUsage,type:t.d||t.dq?"private":"public"}}},e.exportKey=function(n){var t=v.keyToJwk(n.keyHandle,n.keyData);return{type:"keyExport",keyHandle:t}},i.register("sign","rsassa-pkcs1-v1_5",e.sign),i.register("sign","rsa-pss",e.sign),i.register("verify","rsassa-pkcs1-v1_5",e.verify),i.register("verify","rsa-pss",e.verify),i.register("encrypt","rsa-oaep",e.workerEncrypt),i.register("decrypt","rsa-oaep",e.workerDecrypt),i.register("importKey","rsa-oaep",e.importKey),i.register("importKey","rsassa-pkcs1-v1_5",
e.importKey),i.register("importKey","rsa-pss",e.importKey),i.register("exportKey","rsa-oaep",e.exportKey),i.register("exportKey","rsassa-pkcs1-v1_5",e.exportKey),i.register("exportKey","rsa-pss",e.exportKey)),ft=function(n){function i(i,r,u){for(var o,s,h=Math.ceil(u/(n.hashLen/8)),c=1,l=i.concat(r),f=[],e=0;e<h;e++)o=t.int32ToBytes(c++).concat(l),s=n.computeHash(o),f=f.concat(s);return f.slice(0,u)}var t=r;return{deriveKey:i}},et=null,typeof i!="undefined"&&(ft.deriveKey=function(n){var t=r,u=n.algorithm.hash.name,f=s[u.toLowerCase()]();et=ft(f);var i=n.algorithm,e=t.toArray(i.algorithmId).concat(t.toArray(i.partyUInfo),t.toArray(i.partyVInfo),t.toArray(i.publicInfo),t.toArray(i.privateInfo)),o=et.deriveKey(n.keyData,e,n.derivedKeyType.length);return et=null,{type:"keyDerive",keyData:o,keyHandle:{algorithm:n.derivedKeyType,extractable:n.extractable,keyUsage:null||n.keyUsage,type:"secret"}}},ft.deriveBits=function(n){var i=n.algorithm.hash.name,r=s[i.toLowerCase()]();et=ft(r);var t=n.algorithm,
u=t.algorithmId.concat(t.partyUInfo,t.partyVInfo,t.publicInfo||[],t.privateInfo||[]),f=et.deriveKey(n.keyData,u,n.length);return et=null,f},i.register("deriveKey","concat",ft.deriveKey),i.register("deriveBits","concat",ft.deriveBits)),g=function(n){function e(){var e=[],o=l.getBytes(n.order.length*t.DIGIT_NUM_BYTES),f;return t.reduce(t.bytesToDigits(o),r.order,e),f=r.allocatePointStorage(),i.scalarMultiply(e,r.generator,f),{privateKey:{x:u(f.x),y:u(f.y),d:u(e)},publicKey:{x:u(f.x),y:u(f.y)}}}function s(n,u,e){var c=new o.EllipticCurvePointFp(r,!1,f(u.x),f(u.y),null,!1),s=r.allocatePointStorage(),h;if(i.convertToJacobianForm(s),i.convertToMontgomeryForm(s),i.scalarMultiply(f(n.d),c,s),i.convertToAffineForm(s),i.convertToStandardForm(s),h=t.digitsToBytes(s.x),e&&h.length*8<e)throw new Error("DataError");return e?h.slice(0,e/8):h}function h(n){r.generator.isInMontgomeryForm||i.convertToMontgomeryForm(r.generator);var t=r.allocatePointStorage();return i.convertToJacobianForm(t),i.convertToMontgomeryForm(
t),i.scalarMultiply(f(n),r.generator,t),{x:u(t.x),y:u(t.y)}}var f=t.bytesToDigits,u=t.digitsToBytes,r=n,i=new o.EllipticCurveOperatorFp(n);return{generateKey:e,deriveBits:s,computePublicKey:h}},ot=null,typeof i!="undefined"&&(g.deriveBits=function(n){var t=o.createCurve(n.algorithm.namedCurve.toUpperCase()),i=n.keyData,r=n.additionalKeyData;return ot=g(t),ot.deriveBits(i,r,n.length)},g.generateKey=function(n){var i=o.createCurve(n.algorithm.namedCurve.toUpperCase()),t;return ot=g(i),t=ot.generateKey(),{type:"keyPairGeneration",keyPair:{publicKey:{keyData:t.publicKey,keyHandle:{algorithm:n.algorithm,extractable:n.extractable,keyUsage:n.keyUsage,type:"public"}},privateKey:{keyData:t.privateKey,keyHandle:{algorithm:n.algorithm,extractable:n.extractable,keyUsage:n.keyUsage,type:"private"}}}}},g.importKey=function(n){var t=v.jwkToKey(n.keyData,n.algorithm,["x","y","d","crv"]),r,i;return!t.d||t.x&&t.y||(r=o.createCurve(n.algorithm.namedCurve.toUpperCase()),ot=g(r),i=ot.computePublicKey(t.d),
t.x=i.x,t.y=i.y),{type:"keyImport",keyData:t,keyHandle:{algorithm:n.algorithm,extractable:n.extractable||t.extractable,keyUsage:n.keyUsage,type:t.d?"private":"public"}}},g.exportKey=function(n){var t=v.keyToJwk(n.keyHandle,n.keyData);return{type:"keyExport",keyHandle:t}},i.register("importKey","ecdh",g.importKey),i.register("exportKey","ecdh",g.exportKey),i.register("generateKey","ecdh",g.generateKey),i.register("deriveBits","ecdh",g.deriveBits)),a=function(n){function a(n){return s(r(n))}function s(t){var r=n.allocatePointStorage();return i.scalarMultiply(t,n.generator,r),{publicKey:r,privateKey:t}}function h(i){var r=[];return i||(i=l.getBytes(n.order.length*t.DIGIT_NUM_BYTES)),t.reduce(t.bytesToDigits(i),n.order,r),s(r)}function c(i){var f,o;return i.length>u&&(i.length=u),f=r(i),e&&(o=8-n.rbits%8,t.shiftRight(f,f,o)),t.reduce(f,n.order,f),f}function v(i,e,o){o||(o=h());var l=o.publicKey.x,v=o.privateKey,y=r(i.d),p=c(e.slice()),s=[],a=[];return t.reduce(l,n.order,l),t.modMul(l,y,n.order,
s),t.add(s,p,s),t.reduce(s,n.order,s),t.modInv(v,n.order,a),t.modMul(s,a,n.order,s),f(l,!0,u).concat(f(s,!0,u))}function y(u,f,s){var p=Math.floor(f.length/2),w=r(f.slice(0,p)),v=r(f.slice(p)),k=c(s.slice()),l=[],y=[],b=new o.EllipticCurvePointFp(n,!1,r(u.x),r(u.y),null,!1),h,a;return(t.modInv(v,n.order,v),t.modMul(k,v,n.order,l),t.modMul(w,v,n.order,y),h=n.allocatePointStorage(),a=n.allocatePointStorage(),e?(t.add(l,l,l),t.add(l,l,l),t.reduce(l,n.order,l),i.scalarMultiply(l,n.generator,h,!1),i.scalarMultiply(y,b,a,!1),i.convertToExtendedProjective(h),i.convertToExtendedProjective(a),i.add(a,h,h),i.normalize(h)):(i.scalarMultiply(l,n.generator,h),i.scalarMultiply(y,b,a),i.convertToJacobianForm(h),i.convertToMontgomeryForm(h),i.convertToMontgomeryForm(a),i.mixedAdd(h,a,h),i.convertToAffineForm(h),i.convertToStandardForm(h)),h.isInfinity)?!1:(t.reduce(h.x,n.order,h.x),t.compareDigits(h.x,w)===0)}var r=t.bytesToDigits,f=t.digitsToBytes,i=new o.EllipticCurveOperatorFp(n),u=f(n.order).length,
e=n.type===1;return{createKey:a,generateKey:h,sign:v,verify:y}},typeof i!="undefined"&&(a.sign=function(n){r.checkParam(n.algorithm.hash,"Object","algorithm.hash");r.checkParam(n.algorithm.hash.name,"String","algorithm.hash.name");r.checkParam(n.keyHandle.algorithm.namedCurve,"String","p.keyHandle.algorithm.namedCurve");var t=n.algorithm.hash.name,i=o.createCurve(n.keyHandle.algorithm.namedCurve.toUpperCase()),u=s[t.toLowerCase()](),f=u.computeHash(n.buffer),e=a(i);return e.sign(n.keyData,f)},a.verify=function(n){var t=n.algorithm.hash.name,i=o.createCurve(n.algorithm.namedCurve.toUpperCase()),r=s[t.toLowerCase()](),u=r.computeHash(n.buffer),f=a(i);return f.verify(n.keyData,n.signature,u)},a.generateKey=function(n){function f(n){return r.padFront(n,0,Math.ceil(n.length/8)*8)}var h=o.createCurve(n.algorithm.namedCurve.toUpperCase()),c=a(h),i=c.generateKey(),u=t.digitsToBytes,e=f(u(i.publicKey.x)),s=f(u(i.publicKey.y)),l=f(u(i.privateKey));return{type:"keyPairGeneration",keyPair:{publicKey:
{keyData:{x:e,y:s},keyHandle:{algorithm:n.algorithm,extractable:n.extractable,keyUsage:null||n.keyUsage,type:"public"}},privateKey:{keyData:{x:e,y:s,d:l},keyHandle:{algorithm:n.algorithm,extractable:n.extractable,keyUsage:null||n.keyUsage,type:"private"}}}}},a.importKey=function(n){var t=v.jwkToKey(n.keyData,n.algorithm,["x","y","d","crv"]);if(t.d&&(!t.x||!t.y)){var r=a.curves[n.algorithm.namedCurve](),u=a(r),i=u.computePublicKey(t.d);t.x=i.x;t.y=i.y}return{type:"keyImport",keyData:t,keyHandle:{algorithm:n.algorithm,extractable:n.extractable||t.extractable,keyUsage:null||n.keyUsage,type:t.d?"private":"public"}}},a.exportKey=function(n){var t=v.keyToJwk(n.keyHandle,n.keyData);return{type:"keyExport",keyHandle:t}},i.register("sign","ecdsa",a.sign),i.register("verify","ecdsa",a.verify),i.register("generateKey","ecdsa",a.generateKey),i.register("importKey","ecdsa",a.importKey),i.register("exportKey","ecdsa",a.exportKey)),at||(b=r,lt=(function(){function e(){function t(t){try{t.workerid=this.
id;n=pt.jsCryptoRunner({data:t})}catch(i){this.onerror({data:i.description,type:"error"});return}this.onmessage({data:n})}var n;return{postMessage:t,onmessage:null,onerror:null,terminate:function(){}}}function o(n){function u(u){if(u.type==="error"){i&&i.apply(t,[u.message?u.message:u]);return}if(u.data.type==="process"){n(u.data.result,!0);return}if(u.data.type==="finish"){n(u.data.result,!0);return}this.result=n(u.data);r.apply(t,[this.result]);return}var t,r,i;return t=new Promise(function(n,t){r=n;i=t}),{dispatchEvent:u,promise:t,result:null}}function y(){function t(t){var i,r;switch(t.type){case"keyGeneration":case"keyImport":case"keyDerive":return n.add(t.keyHandle,t.keyData),t.keyHandle;case"keyExport":return t.keyHandle;case"keyPairGeneration":return r=t.keyPair.privateKey,i=t.keyPair.publicKey,n.add(i.keyHandle,i.keyData),n.add(r.keyHandle,r.keyData),{publicKey:i.keyHandle,privateKey:r.keyHandle};default:throw new Error("Unknown key operation");}}return o(t)}function p(n){return ii&&
n.pop?new Uint8Array(n).buffer:n}function w(n){function r(n,i){if(n=n&&p(n),i){t.resolve(n);return}return n}var t=[],i=o(r);return i.stream=n.algorithm.stream,t.add=function(n){var r,u,i=new Promise(function(n,t){r=n;u=t});return i.label=n,t.push({resolve:r,reject:u,promise:i}),i},t.resolve=function(n){var i=t.shift();i.resolve.apply(i.promise,[n])},i.process=function(i){return n.operationSubType="process",n.buffer=b.toArray(i),u.continueJob(this,b.clone(n)),t.add("process")},i.finish=function(){return n.operationSubType="finish",n.buffer=[],u.continueJob(this,b.clone(n)),t.add("finish")},i.abort=function(){u.abortJob(this)},i.algorithm=n.algorithm||null,i.key=n.keyHandle||null,i}function k(n,t){if(!i.exists(n,t))throw new Error("unsupported algorithm");}function f(t){var i=n.lookup(t);if(!i)throw new Error("key not found");return i}function d(n,t){var e={operationType:n},o,u,i,f;for(n==="importKey"&&t[0]==="raw"&&(n="importKeyRaw"),n==="importKey"&&t[0]==="jwk"&&(n="importKeyJwk"),o=h[
n],f=0;f<o.length;f+=1){if(u=s[o[f]],i=t[f],!i)if(u.required)throw new Error(u.name);else continue;if(i.subarray&&(i=b.toArray(i)),b.getObjectType(i)==="ArrayBuffer"&&(i=b.toArray(i)),r.getObjectType(i)!==u.type)throw new Error(u.name);u.name==="algorithm"&&(i.name=i.name.toLowerCase(),i.iv&&(i.iv=b.toArray(i.iv)),i.salt&&(i.salt=b.toArray(i.salt)),i.additionalData&&(i.additionalData=b.toArray(i.additionalData)),i.hash&&!i.hash.name&&b.getObjectType(i.hash)==="String"&&(i.hash={name:i.hash}));e.hasOwnProperty(u.name)?e[u.name+"1"]=i:e[u.name]=i}return e}function t(n,t,i){var r=d(n,t),e;return(k(n,r.algorithm.name),r.keyHandle&&(r.keyData=f(r.keyHandle)),r.keyHandle1&&(r.keyData1=f(r.keyHandle1)),r.algorithm&&r.algorithm.public&&(r.additionalKeyData=f(r.algorithm.public)),e=i?y(r):w(r),(i||r.buffer||n==="deriveBits"||n==="wrapKey")&&u.runJob(e,r),e.stream)?Promise.resolve(v(e)):e.promise}var v=function(n){return{process:function(t){return n.process(t)},finish:function(){return n.finish(
)},abort:function(){return n.abort()}}},n=[],u,s,h,c,a;return n.add=function(t,i){n.push({keyHandle:t,keyData:i})},n.remove=function(t){for(var i=0;i<n.length;i+=1)if(n[i].keyHandle===t){n=n.splice(i,1);return}},n.lookup=function(t){for(var i=0;i<n.length;i+=1)if(n[i].keyHandle===t)return n[i].keyData;return null},u=(function(){function k(){o.shift()()}function d(n){o.push(n);setTimeout(k,0)}function g(){nt(!rt);for(var t=0;t<n.length;t++)if(!n[t].busy)return n[t];return null}function nt(t){for(var i=n.length-1;i>=0;i-=1)n[i].isWebWorker===t&&(n[i].terminate(),n.splice(i,1))}function tt(){for(var i=0,t=0;t<n.length;t++)n[t].busy||(i+=1);return i}function it(t){n.push(t)}function s(t){for(var i=0;i<n.length;i++)if(n[i]===t){t.terminate();n.splice(i,1);return}}function h(t){for(var i=0;i<n.length;i++)if(n[i].operation===t)return n[i];return null}function u(n,i){t.push({operation:n,data:i,id:p++})}function c(n){if(n.busy=!1,rt)if(t.length>0){var u=t.shift(),i;if(r(u.operation,u.data),u.data.
operationSubType==="process"){for(i=0;i<t.length;i++)u.operation===t[i].operation&&r(t[i].operation,t[i].data);for(i=t.length-1;i>=0;i--)u.operation===t[i].operation&&t.splice(i,1)}}else tt()>y&&s(n)}function ut(n){var r;if(i==="pending")throw new Error("Creating new worker while workerstatus=pending");if(i==="ready")try{r=new Worker(yt);r.postMessage({prngSeed:l.getBytes(48)});r.isWebWorker=!0}catch(u){rt=!1;i==="failed";r.terminate();r=e();r.isWebWorker=!1}else r=e(),r.isWebWorker=!1;return r.operation=n,r.id=w++,r.busy=!1,r.onmessage=function(n){var u,i,e;if(n.data.initialized!==!0){for(u=r.operation,n.target||(n.target={data:r.data}),i=0;i<t.length;i++)if(t[i].operation===r.operation){e=t[i];t.splice(i,1);f(r,e.data);return}n.data.hasOwnProperty("type")&&n.data.type==="process"||c(r);u.dispatchEvent(n)}},r.onerror=function(n){var t=r.operation;c(r);t.dispatchEvent(n)},it(r),r}function ft(n){function f(n){var e=!!(n.data&&n.data.initialized===!0),o;u.removeEventListener("message",f,
!1);u.removeEventListener("error",f,!1);u.terminate();i=e?"ready":"failed";rt=e;b.consoleLog("web worker initialization "+(e?"succeeded. Now using web workers.":"failed. running synchronously."+(n.message||"")));t.length>0&&(o=t.shift(),r(o.operation,o.data));return}if(i==="unavailable"){b.consoleLog("web workers not available in this browser.");return}if(n!==!1||i!=="ready"){if(n===!1&&i==="ready"){rt=!1;i==="available";b.consoleLog("web workers disabled.");return}i="pending";var u=new Worker(yt);u.addEventListener("message",f,!1);u.addEventListener("error",f,!1);u.postMessage({prngSeed:l.getBytes(48)});return}}function et(n){var t=h(n);t&&s(t)}function a(t,r){var e=null;if(i==="pending"){u(t,r);return}if(e=g(),rt&&e===null&&n.length>=v){u(t,r);return}if(e===null&&(e=ut(t)),e===null){u(t,r);throw new Error("could not create new worker");}e.operation=t;e.busy=!0;r.workerid=e.id;f(e,r)}function r(n,t){var i=h(n);if(i){f(i,t);return}a(n,t)}function f(n,t){if(t.workerid=n.id,rt)n.postMessage(
t);else{var i=(function(t){return function(){return n.postMessage(t)}})(t);d(i)}return}var v=12,y=2,n=[],t=[],p=0,w=0,o=[],i=ti?"available":"unavailable";return{runJob:a,continueJob:r,abortJob:et,useWebWorkers:ft}})(),s=[{name:"algorithm",type:"Object",required:!0},{name:"keyHandle",type:"Object",required:!0},{name:"buffer",type:"Array",required:!1},{name:"signature",type:"Array",required:!0},{name:"format",type:"String",required:!0},{name:"keyData",type:"Object",required:!0},{name:"extractable",type:"Boolean",required:!1},{name:"keyUsage",type:"Array",required:!1},{name:"derivedKeyType",type:"Object",required:!0},{name:"length",type:"Number",required:!1},{name:"extractable",type:"Boolean",required:!0},{name:"keyUsage",type:"Array",required:!0},{name:"keyData",type:"Array",required:!0}],h={encrypt:[0,1,2],decrypt:[0,1,2],sign:[0,1,2],verify:[0,1,3,2],digest:[0,2],generateKey:[0,6,7],importKeyRaw:[4,12,0,10,11],importKeyJwk:[4,5,0,10,11],exportKey:[0,4,1,6,7],deriveKey:[0,1,8,6,7],deriveBits:
[0,1,9],wrapKey:[1,1,0],unwrapKey:[2,0,1,6,7]},c={encrypt:function(){return t("encrypt",arguments,0)},decrypt:function(){return t("decrypt",arguments,0)},sign:function(){return t("sign",arguments,0)},verify:function(){return t("verify",arguments,0)},digest:function(){return t("digest",arguments,0)},generateKey:function(){return t("generateKey",arguments,1)},deriveKey:function(){return t("deriveKey",arguments,1)},deriveBits:function(){return t("deriveBits",arguments,0)},importKey:function(){return t("importKey",arguments,1)},exportKey:function(n,i){return t("exportKey",[i.algorithm,n,i],1)},wrapKey:function(){return t("wrapKey",arguments,0)},unwrapKey:function(){return t("unwrapKey",arguments,1)}},a={useWebWorkers:u.useWebWorkers},{publicMethods:c,internalMethods:a}})()),bt=(function(){function t(t){var p=e(t.keyData1,t.keyHandle1.algorithm.name,s["sha-1"])(),r=128,b=v.keyToJwkOld(t.keyHandle,t.keyData),k={alg:t.keyHandle1.algorithm.name.toUpperCase(),enc:"A128GCM"},u=n.toBase64(JSON.stringify(
k),!0),f=l.getBytes(32),d=p.encrypt(f),o=n.toBase64(d,!0),h=l.getBytes(12),c=n.toBase64(h,!0),g=u.concat(".",o,".",c),a=w(tt.aes(f));a.init(h,n.stringToBytes(g),r);var i=a.encrypt(b),y=i.slice(-(r/8)),nt=n.toBase64(y,!0),it=n.toBase64(i.slice(0,i.length-y.length),!0),rt={recipients:[{header:u,encrypted_key:o,integrity_value:nt}],initialization_vector:c,ciphertext:it};return n.stringToBytes(JSON.stringify(rt))}function i(t){var r=n.fromBase64,i=JSON.parse(String.fromCharCode.apply(null,t.buffer)),d=n.fromBase64(i.recipients[0].header),h=r(i.recipients[0].encrypted_key),c=r(i.recipients[0].integrity_value),l=r(i.initialization_vector),a=r(i.ciphertext),y=s["sha-1"](),p=e(t.keyData,t.keyHandle.algorithm.name,y),b=p.decrypt(h),k=i.recipients[0].header.concat(".",i.recipients[0].encrypted_key,".",i.initialization_vector),f=w(tt.aes(b)),o,u;return f.init(l,n.stringToBytes(k),128),o=f.decrypt(a,c),u=v.jwkToKey(o,t.algorithm,["k"]),{type:"keyImport",keyData:u.k,keyHandle:{algorithm:{name:t.algorithm.
name},extractable:t.extractable||u.extractable,keyUsage:t.keyUsage,type:"secret"}}}var n=r;return{wrapKey:t,unwrapKey:i}})(),typeof i!="undefined"&&(i.register("wrapKey","aes-gcm",bt.wrapKey),i.register("unwrapKey","aes-cbc",bt.unwrapKey)),dt={subtle:lt?lt.publicMethods:null,getRandomValues:function(n){for(var i=l.getBytes(n.length),t=0;t<n.length;t+=1)n[t]=i[t];return n},initPrng:function(n){var t=Object.prototype.toString.call(n);if(t!=="[object Array]"&&t!=="[object Uint8Array]")throw new Error("entropyData must be a Array or Uint8Array");st&&st.reseed(n);l.reseed(st.read(48));ni=!0},toBase64:function(n){return r.toBase64(n,!1)},fromBase64:function(n){return r.fromBase64(n)},textToBytes:function(n){return r.stringToBytes(n)},bytesToText:function(n){return r.bytesToString(n)},url:yt,version:"1.5",useWebWorkers:function(n){return lt?lt.internalMethods.useWebWorkers(n):null}},at||(st=st||new li(n),st.init(),gt=st.read(48),l.init(gt)),dt};return t()})),(function(n,t){typeof Promise=="undefined"&&
(n.Promise=t())})(this,(function(){var n=function(t){function s(n){for(var r,t=0;t<o.length;t+=1)r=o[t](n),r&&r.then?(r.then(i[t]),u[t]&&r["catch"](u[t])):i[t]&&i[t](r);e={result:n};return}function h(n){for(var e,t=0;t<f.length;t+=1)e=f[t](n),e&&e.then?e.then(i[t],u[t]):i[t]&&i[t](e);r={result:n};return}if(!(this instanceof n))throw new Error("use 'new' keyword with Promise constructor");var e=null,r=null,o=[],f=[],u=[],i=[];this.then=function(t,s){var h;return e?(h=t(e.result),h&&h.then)?h:n.resolve(h):r?(h=s?s(r.result):r.result,h&&h.then)?h:n.resolve(h):(o.push(t),s&&f.push(s),new n(function(n,t){i.push(n);u.push(t)}))};this["catch"]=function(t){var e;return r?(e=t(r.result),e&&e.then)?e:n.resolve(e):(f.push(t),new n(function(n,t){i.push(n);u.push(t)}))};t(s,h);return};return n.all=function(t){function u(n,u){return function(f){i[n]=f;r+=1;r===t.length&&u(i)}}var i=[],r=0;return new n(function(i,r){function e(n){r(n)}for(var f=0;f<t.length;f+=1){if(t[f].then){t[f].then(u(f,i));t[f]["catch"](
e);continue}n.resolve(t[f]).then(u(f,i))}})},n.race=function(t){function r(n){return function(t){i||(i=!0,n(t))}}var i=!1;return new n(function(n,i){for(var u=0;u<t.length;u+=1)t[u].then(r(n),r(i))})},n.reject=function(t){return new n(function(n,i){i(t)})},n.resolve=function(t){return new n(function(n){n(t)})},n}))