define("HubsExtension/ArmHelpers/ArmApiEndpoints",["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";function h(n){return t.armEndpoints.first((function(t){return r.Extension.isEqualCloudName(t.cloudName,n)}))}u.defineProperty(t,"__esModule",{value:!0});var e=i.Base.Constants,f=window.fx.environment,o=f.armInvokeApi,s=(f.armEndpoint||"").replace(/\/$/,"");t.armEndpoints=f&&f.armEndpoints||[];r.Extension.multiCloudEnabled||(t.armEndpoints=[{cloudName:e.DefaultCloudName,uri:s,invokeApi:o}]);t.getArmEndpointObject=h}));define("HubsExtension/Common/BrowseCuration",["require","exports","f","i","FxHubs/RpcEndPoints"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function t(n){return i.retryPromise((function(){return e().then(n)}),10,1e3)}var f=i.Base.Constants,e=i.memoizeQ((function(){return Q(u.Curation.getSharedCurationEndpoint.invoke(r.Rpc.client,f.Shell,undefined))}));n.getSearchCuration=i.memoizeQ((function(){return t((function(n){return n.searchCuration||[]}))}));n.getExcludedResourceTypes=
i.memoizeQ((function(n){return t((function(t){var u=(t.resourceTypesExcludedFromBrowse||[]).first((function(t){return r.Extension.isEqualCloudName(t.cloudName||f.DefaultCloudName,n)}));return i.convertArrayToMap(u&&u.types||[],(function(n){return typeof n=="string"?n:n.resourceType}),(function(n){return typeof n=="string"?!0:n.kinds||{}}))}))}));n.getMergedAssetTypes=i.memoizeQ((function(){return t((function(n){return n.mergedAssetTypes||[]}))}))})(f||(f={})),f}));define("HubsExtension/Common/AssetTypeCache",["require","exports","f","i","o","ko","FxHubs/RpcEndPoints","HubsExtension/Common/BrowseCuration"],(function(n,t,i,r,u,f,e,o){"use strict";function rt(){t.partialAssetTypes(!0);h=null;c=r.getCloudMap();s.dispose();s=new r.TriggerableLifetimeManager}function v(n){var t=c.get(n);return t||(t=i.tryImmediateResolve(b(),(function(t){return f.computed(s,(function(){return t.assetTypesInformation().filter((function(t){return a(t.cloudName,n)}))}))})),c.set(n,t)),t}function b(){return h||(h=Q(e.AssetTypes.getAssetTypesInformationObservableEndPoint.
acquireObject(it,tt,undefined)).then((function(n){var i=f.unwrap(n&&n.getValue());return i.isPartialSet.subscribeAndRun(s,(function(n){return t.partialAssetTypes(n)})),i}))),h}function k(n,i,r){return v(n).then((function(n){var u=Q.defer(),f=function(n){if(u.promise.isPending())if(n||r)u.resolve(n);else throw new Error("Did not receive asset type information from the shell");};return n.subscribeAndRun(s,(function(n){var t=i(n);return t&&f(t),!!t})),t.partialAssetTypes.subscribeAndRun(s,(function(n){n||f(null)})),Q.delay(2e4).then((function(){return f(null)})),u.promise}))}function y(n,t){if(!n)return null;var r=n.cloudName||w,u=(n.extensionName||"").toLowerCase(),f=(n.assetType||"").toLowerCase();return k(r,(function(n){return i.find(n,(function(n){return a(r,n.cloudName)&&u===n.lowerCaseExtension&&f===n.lowerCaseAssetType}))}),t)}function d(n,t,r){if(!n)return null;var u=n.toLowerCase();return k(t,(function(n){return i.find(n,(function(n){return n.lowerCaseResourceType===u}))}),r)}function g(n,t,i){return a(
n,i.cloudName||w)&&t.lowerCaseExtension===i.extensionName&&t.lowerCaseAssetType===i.assetType}function ut(n,t){return o.getMergedAssetTypes().then((function(r){return d(n,t).then((function(n){var u=i.find(r,(function(i){return g(t,n,i.base)||i.associated.some((function(i){return g(t,n,i)}))})),o={base:n,associated:[]},f,e;return u?(f={base:n,associated:[],infoTextOverride:u.infoTextOverride},e=[],e.push(y(u.base).then((function(n){f.base=n}))),u.associated.forEach((function(n){e.push(y(n).then((function(n){f.associated.push(n)})))})),Q.allSettled(e).then((function(n){return n.forEach((function(n){n.state!=="fulfilled"&&nt.warning("Failed to find asset type: "+n.reason)})),f}))):o}))}))}function ft(n){return v(n).then((function(n){var t={};return n.subscribeAndRun(s,(function(n){n.forEach((function(n){var i=n.lowerCaseResourceType,r;i&&(r=n.icon||l.Images.Polychromatic.ResourceDefault(),t[i]?t[i](r):t[i]=f.observable(r))}))})),t}))}var h,c,s;u.defineProperty(t,"__esModule",{value:!0});"use strict";var l=i.Base,
p=l.Constants,nt=l.Diagnostics.createLog(n),tt=p.Shell,it=r.Rpc.client,a=r.Extension.isEqualCloudName,w=p.DefaultCloudName;t.partialAssetTypes=f.observable(!0);c=r.getCloudMap();s=new r.TriggerableLifetimeManager;t.flushAssetTypes=rt;t.getAssetTypesInformation=v;t.getAssetTypesInformationPromise=b;t.getAssetTypeInformation=y;t.getResourceTypeAssetTypeInformation=d;t.getMergedResourceTypeAssetTypeInformation=ut;t.getRegisteredResourceTypesIcons=ft}));define("HubsExtension/ArmHelpers/ArmApisStartup",["require","exports","f","i","o","a","Fx/Ajax","FxHubs/RpcEndPoints","HubsExtension/Common/AssetTypeCache","HubsExtension/ArmHelpers/ArmApiEndpoints"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(t){function wi(n){var t=h.getArmEndpointObject(n);return t||k.endpointNotFound(n),t.uri}function bi(n){return h.getArmEndpointObject(n).invokeApi}function ft(n){return n.replace(yi,"")}function d(n){return"/"+ft(n)}function a(n){return(n||"").toLowerCase()}function bt(n){return n.replaceAll(
"'","''")}function ki(n,t){var r=i.trimEnd(t,"/")+i.ensurePrefix(n,"/"),u=vi.exec(r);return u||k.invalidUrlEndpoint(r),r=u[1]?u[1]+"/":"",r+=ft(u[7]).replace(pi,"/"),!u[1]&&u[7].startsWith("/")&&(r="/"+r),r+(u[8]||"")}function di(n){var t=a(n);return!n||t.startsWith("hidden-")||t.startsWith("link:")}function kt(n,i){return rt(n)?n:ki(n,t.getArmEndpointUri(i))}function gi(n){return{reason:n.trim(),extension:tt}}function nr(n){var t,u,r;return n?(t=a(n.extension||it),t=t===a(tt)?"":"("+t+") ",u=n.reason||"unknown",r=""+t+u,r.length<=60)?r:(t=i.replaceMany(t,{azure:"az",extension:"",microsoft:"ms"}),r=""+t+u,r.length<=60)?r:r.substr(0,57)+"...":null}function dt(n,i,r,u){n.length>t.maxBatchCallCount&&k.batchLimitExceeded();var f=n.map((function(n){return rt(n)?{httpMethod:"GET",url:n}:{httpMethod:"GET",url:n}})),e={requests:f},o=t.getAbsoluteArmUri("batch"+li,r);return b({cloudName:r,contentType:l,headers:{accept:l},isBackgroundTask:i,invokeApi:null,setAuthorizationHeader:!0,setTelemetryHeader:
t.shortenTelemetryForAjax(u),type:"POST",uri:o,data:ct(e)}).then((function(n){return(n.content||{}).responses||[]}))}function et(n,i,r,u,f,e){if(!n.length)return Q();var o=n.pop(),s=t.getAbsoluteArmUri(o,f);return b({cloudName:f,contentType:l,headers:{accept:l},isBackgroundTask:u,invokeApi:t.getArmInvokeApi(f),setAuthorizationHeader:!0,setTelemetryHeader:t.shortenTelemetryForAjax(e),type:"GET",uri:s}).then((function(t){var s=t.content,c=s&&s.value,l,h;return s?c?(l=i(c),l===!1?n=[]:(h=s.nextLink,h&&n.push(h))):r({api:o,reason:"Expected response.value not found."}):r({api:o,reason:"Expected response not found."}),et(n,i,r,u,f,e)}),(function(t){return r({api:o,reason:t}),et(n,i,r,u,f,e)}))}function tr(n,t,i,r,u){return et(n,t,i,!1,r,u)}function ir(n){var f=n.armApiOrUri,c=n.httpMethod,u=n.data,v=n.isBackgroundTask,a=n.dataType,o=n.cloudName,y=n.telemetry,p=n.useApiInvoke,w=n.filterEmptyResponse,k=n.performRetry,s=n.noBatch,d=t.getAbsoluteArmUri(f,o),r={cloudName:o,headers:{accept:l},isBackgroundTask:
v,performRetry:k,invokeApi:p!==!1?t.getArmInvokeApi(o):null,setAuthorizationHeader:!0,setTelemetryHeader:t.shortenTelemetryForAjax(y),type:c,uri:d},h;return(u&&(r.contentType=l,r.data=typeof u=="string"?u:ct(u)),w&&(r.dataFilter=function(n,t){return t==="json"&&!n?"{}":n}),a&&(r.dataType=a),h=kt("/",o),s||!rt(f)||~f.indexOf(h)||(s=!0),!s&&!!~["get","post","delete","head"].indexOf(c.toLowerCase())&&i.isEmptyObject(u))?(r.uri=f,e.batch(r,h).then((function(n){return{content:n.content,jqXHR:{responseJSON:n.content,status:n.httpStatusCode,getResponseHeader:function(t){return n.headers[t]}}}}),(function(n){throw{errorThrown:"Unavailable in batch",jqXHR:{responseJSON:n.content,responseText:n.content,status:n.httpStatusCode,getResponseHeader:function(t){return n.headers[t]}}};}))):Q(b(r))}function rr(n,i,r,u,f,e,o,s){return t.callRaw({armApiOrUri:n,httpMethod:i,data:r,dataType:"json",cloudName:u,telemetry:f,useApiInvoke:e,filterEmptyResponse:o,performRetry:s}).then((function(n){return n.content}))}function gt(
n,t,i,r,u,e,o){var s=f.apply(null,{length:n.length}).map((function(n,t){return t})),h;return n=n.slice(0),h=function(){if(n.length){var f=n.slice(0,20),c=f.map((function(n){return typeof n=="string"?n:n.uri}));return dt(c,r,u,e).then((function(r){return r.every((function(r,u){var v;r=r||{};var e=r.content||{},h=e,l=null,a=f[u];if((typeof a!="string"?a.responseIsArrayType:o)&&(h=e.value,l=e.nextLink),!e||!h||r.httpStatusCode>=400)i({api:c[u],reason:r});else{if(v=t(h,s[u]),v===!1)return n=[],!1;l&&(n.push({uri:l,responseIsArrayType:!0}),s.push(s[u]))}return!0})),n.splice(0,f.length),s.splice(0,f.length),h()}),(function(t){return i({api:f.join("|"),reason:t}),n.splice(0,f.length),s.splice(0,f.length),h()}))}return Q()},h()}function ur(n,t,i,r,u){var f=[],e=[],o=Q.defer();return gt(n,(function(n){f=f.concat(n)}),(function(n){e.push(n)}),t,i,r,u).then((function(){e.length?o.reject(e):o.resolve(f)})),o.promise}function fr(n,t){var i={assetTriplet:n,cloudName:t};return o.AssetTypes.mapAssetIdToResourceIdEndPoint.
invoke(ht.client,it,i)}function er(){return"/locations"+pt}function or(){return"/tenants?api-version=2017-08-01"}function sr(n,t,i){return ni(n,t,(function(n){return i&&i("resourcegroup eq '"+n+"'")}))}function ni(n,t,i){var r;return c.isSubscriptionId(t)?[c.parseSubscriptionDescriptor(t).subscription]:lt(t)?(r=c.parseResourceGroupDescriptor(t),i&&i(r.resourceGroup),[r.subscription]):at(t)&&!c.isTenantResource(t)?(r=vt(t),i&&i(r.resourceGroup),[r.subscription]):n||[]}function hr(n,t,u){var f=i.makeArray(n).filter((function(n){return!ei(y,(function(t){return n.cloudName===t.cloudName&&n.extensionName===t.extensionName&&n.assetType===t.assetType&&i.deepEquals(n.assetId,t.assetId)}))})),e;y.push.apply(y,f);e=f.map((function(n){var i=n;return i.reason=t,i}));r.AssetManager.hubsNotifyAssetDeletedDefinition.invoke(u||ht.client,it,e).finally((function(){Q.delay(2e3).then((function(){y.remove.apply(y,f)}))}))}function cr(){return"/subscriptions"+pt}function lr(n){return"/subscriptions/"+n+"/locations"+w}function ar(
n){return"/"+ft(n)+"/providers/microsoft.authorization/permissions?api-version="+si}function ti(n,i,r,f,e){var s;e===void 0&&(e=null);var h="eventTimestamp",c=new u.UriBuilder("/subscriptions/"+i+"/providers/microsoft.insights/eventtypes/management/"+n),o=h+" ge '"+r.toISOString()+"' and "+h+" le '"+f.toISOString()+"'";return e&&e.length&&(o=e+" and "+o),s=c.query,s.setParameter(v,t.eventsApiVersion),s.setParameter("$filter",o),c.toString()}function vr(n,t,i,r){return r===void 0&&(r=null),ti("values",n,t,i,r)}function yr(n,t,i,r){return r===void 0&&(r=null),ti("digestEvents",n,t,i,r)}function pr(n){return"/subscriptions/"+n+"/providers/microsoft.authorization/classicAdministrators"+ai}function g(n){return!!n}function ot(n,t){a(n).split(" ").forEach((function(n){n&&t.push("substringof('"+bt(n)+"', name)")}))}function p(n,t,r,u){var e=u?"ne":"eq",f=i.makeArray(t).filter(g).map((function(t){return n+" "+e+" '"+bt(a(t))+"'"})).join(" or ");f&&r.push(f)}function wr(n,t,i,r,f,e,o){var h=new u.UriBuilder(
"/resources"),s=[n.map((function(n){return"subscriptionId eq '"+n+"'"})).join(" or "),],c;return ot(i,s),p("resourcegroup",e,s,o),p("location",f,s),p("resourceType",t,s),r&&s.push.apply(s,r),h.query.setParameter(v,yt),c=s.filter(g).map((function(n){return"("+n+")"})).join(" and "),c&&h.query.setParameter("$filter",c),h.toString()}function br(n,t,i,r){var e=new u.UriBuilder("/providers/"+n.resourceTypeName),f=[],o;return ot(t,f),p("location",r,f),i&&f.push.apply(f,i),e.query.setParameter(v,n.apiVersion),o=f.filter(g).map((function(n){return"("+n+")"})).join(" and "),o&&e.query.setParameter("$filter",o),e.toString()}function kr(n,t,i,r,f){var o=new u.UriBuilder("/subscriptions/"+n+"/providers/"+t.topLevelResourceTypeAlias),e=[],s;return(t.proxyRoutingFilters||[]).forEach((function(n){switch(n){case 1:ot(i,e);break;case 2:p("resourcegroup",r,e);break;case 3:p("location",f,e);break;default:fi.error("Unhandled proxy routing filter: <"+n+">")}})),o.query.setParameter(v,t.apiVersion),s=e.filter(g).map(
(function(n){return"("+n+")"})).join(" and "),s&&o.query.setParameter("$filter",s),o.toString()}function dr(n){return"/subscriptions/"+n+"/resourcegroups"+w}function gr(n,t){return t?d(n)+ci:d(n)+w}function nu(n,i){var r=new u.UriBuilder(d(n)),f=r.query;return f.getParameter(v)?Q(r.toString()):t.getLatestApiVersion(r.path,i).then((function(n){return f.setParameter(v,n),r.toString()}))}function tu(n){var i,u,r,f;if(!i)for(u=n.split("/"),r=u.length-1;r;){if(f=u.slice(0,r).join("/"),t.resourceTypeApiVersionDictionary[f]){i=t.resourceTypeApiVersionDictionary[f];t.resourceTypeApiVersionDictionary[n]=i;break}r--}return i}function iu(i,r){if(lt(i))return Q.resolve(yt);if(c.isSubscriptionId(i))return Q.resolve(hi);if(at(i)){var u=vt(i),f=a(u.provider+"/"+u.types.join("/")),e;return ut||(ut=s.getAssetTypesInformation(r).then((function(n){n().forEach((function(n){var i=n.resourceType,r=n.apiVersion;i&&r&&(t.resourceTypeApiVersionDictionary[a(i)]=r)}))}))),ut.then((function(){if(e=t.resourceTypeApiVersionDictionary[
f],e)return Q(e);ri.trace({source:tt,action:"MissingApiVersion",actionModifier:f});var o=u.subscription,s=u.provider,h=(!o?"/providers/"+s:"/subscriptions/"+o+"/providers/"+s)+w,c=t.getAbsoluteArmUri(h,r);return Q(b({uri:c,invokeApi:t.getArmInvokeApi(r),type:"GET",headers:{accept:l},setAuthorizationHeader:!0,setTelemetryHeader:"getLatestApiVersion",cloudName:r})).then((function(n){var i=n&&n.content&&n.content.resourceTypes||[];return i.forEach((function(n){var i=n.apiVersions||[],f=i.first((function(n){return n&&oi.test(n)})),r=a(u.provider+"/"+n.resourceType);t.resourceTypeApiVersionDictionary[r]||(t.resourceTypeApiVersionDictionary[r]=f||i[0])})),t.resourceTypeApiVersionDictionary[f]||tu(f)||t.resourceTypeApiVersion}),(function(r){return nt.createLog(n).warning(i+" using api ver "+t.resourceTypeApiVersion+". Error "+r.responseText),t.resourceTypeApiVersion}))}))}return Q.reject("Unexpected id "+i)}function ii(n){n.httpMethod=n.httpMethod||"GET";var i=t.getAbsoluteArmUri(n.armApiOrUri,n.cloudName),
r={headers:{accept:l},setAuthorizationHeader:!0,setTelemetryHeader:t.shortenTelemetryForAjax(n.telemetry),type:n.httpMethod,uri:i};return Q(e.batch(r))}function ru(n){return ii(n).then((function(t){return n.responseFilter=n.responseFilter||function(n){if([200,202,201,204,].indexOf(n.httpStatusCode)===-1)throw r.Azure.buildSimplifiedError(n.content);},n.responseFilter(t,n.armApiOrUri),t.content}))}function uu(n){return d(n)+"/resources"+w}var u=i.Base,st=u.Constants,nt=u.Diagnostics,ht=r.Rpc,ri=nt.Telemetry,ui=u.Net2,c=i.ViewModels.Services.ResourceTypes,fi=nt.createLog(n),tt=st.ExtensionNames.Hubs,it=st.Shell,b=ui.Internal.ajaxExtended,ct=JSON.stringify,lt=c.isResourceGroupId,at=c.isResourceId,rt=u.Resources.isUriAbsolute,vt=c.parseResourceDescriptor,ei=i.find,l="application/json",oi=new RegExp("^[0-9-]+$","ig"),wt,k,ut,y;t.resourceTypeApiVersion="2014-04-01";t.eventsApiVersion="2014-04-01";var yt="2014-04-01-preview",si="2015-07-01",hi="2016-06-01",v="api-version",w="?api-version=2014-04-01-preview",
ci="?api-version=2016-09-01",li="?api-version=2015-11-01",pt="?api-version=2016-06-01",ai="?api-version=2014-07-01-preview",vi=/^((https?:)(\/\/\/?)([\w]*(?::[\w]*)?@)?([\d\w\.-]+)(?::(\d+))?)?([^?]*)?(?:(.*)?)$/i,yi=/^[\s\/\/]*|[\/\/]*$/g,pi=/\/\//g;t.maxBatchCallCount=20;wt={batchLimitExceeded:"",invalidUrlEndpoint:"",endpointNotFound:""};k=r.getErrorMap(wt);t.getArmEndpointUri=wi;t.getArmInvokeApi=bi;t.isHiddenTag=di;t.getAbsoluteArmUri=kt;t.makeResourceManagerTelemetry=gi;t.shortenTelemetryForAjax=nr;t.callBatch=dt;t.callWithContinuation=tr;t.callRaw=ir;t.call=rr;t.callBatchWithContinuation=gt;t.callBatchAndFollowContinuationTokens=ur;t.mapAssetIdFromHubs=fr;t.listLocationsApi=er;t.listTenantsApi=or;t.filterSubscriptionsByScope=sr;t.filterSubscriptionsByScopeByResourceGroup=ni;y=[];t.internalNotifyAssetDeleted=hr;t.listSubscriptions=cr;t.listSubscriptionLocationsApi=lr;t.getPermissionsApi=ar;t.getEventsApi=vr;t.getEventDigestsApi=yr;t.listClassicAdministratorsApi=pr;t.resourceTypeApiVersionDictionary=
{"aspera.transfers/services":"2016-03-25","cloudyn.analytics/accounts":"2016-03-01","conexlink.mycloudit/accounts":"2015-06-15","hive.streaming/services":"2016-03-18","microsoft.bingmaps/mapapis":"2015-07-02","microsoft.visualstudio/account/project":"2014-02-26","pokitdok.platform/services":"2016-05-17","raygun.crashreporting/apps":"2015-01-01","signiant.flight/accounts":"2015-06-29","trendmicro.deepsecurity/accounts":"2015-06-15"};t.resourcesAcrossSubscriptionsApi=wr;t.tenantResourcesApi=br;t.providerProxyResourcesApi=kr;t.resourceGroupsInSubscriptionApi=dr;t.resourceGroupApi=gr;t.resourceApi=nu;t.getLatestApiVersion=iu;t.callRawUsingBatch=ii;t.callUsingBatch=ru;t.resourcesInResourceGroupApi=uu})(c||(c={})),c}));define("HubsExtension/HubsCommon",["require","exports","f","o"],(function(n,t,i,r){"use strict";function v(){var n="HubsExtension.BrowseResources";return o||(i.Data.Metadata.setTypeMetadata(n,{idProperties:["id"]}),o=!0),n}function y(n){var i="";return n?(i=(n.status||n.state||"")
.toLowerCase(),!!~[t.subscriptionEnabledStatus,t.subscriptionActiveStatus,t.subscriptionWarnedStatus,t.subscriptionPastDueStatus].indexOf(i)):!1}function p(){return u||(u={},(a.fx.environment.armSubscriptionQuotaIds||[]).forEach((function(n){u[n.toLowerCase()]=!0}))),u}function w(n,t){if(f.isResourceGroupId(n.id)||f.isSubscriptionId(n.id))return!0;if(!f.isResourceId(n.id))return!1;var e=(n.kind||"").toLowerCase(),r,u,i;return(t.kinds&&t.kinds.forEach((function(n){n.name.toLowerCase()===e&&(i=n);n.isDefault&&(u=n)})),i=i||u,r=i&&i.useResourceMenu,r!==!1&&(c(t,8)||r===!0&&c(t,16)))?!0:!1}var o;r.defineProperty(t,"__esModule",{value:!0});var l=i.Assets,s=i.Base,h=s.Constants.ExtensionNames,f=i.ViewModels.Services.ResourceTypes,a=window,c=l.assetTypeInformationSupportsContract,e=i.isFeatureEnabled,u;t.extensionName=h.Hubs;t.marketplaceExtensionName=h.Marketplace;t.resourceGroupPartName="ResourceGroupMapPinnedPart";t.resourceGroupMapBlade="ResourceGroupMapBlade";t.resourceGroupEventsBlade="ResourceGroupEventsBlade";
t.deploymentDetailsBlade="DeploymentDetailsBlade";t.subscriptionEnabledStatus="enabled";t.subscriptionActiveStatus="active";t.subscriptionWarnedStatus="warned";t.subscriptionDisabledStatus="disabled";t.subscriptionPastDueStatus="pastdue";t.whatsNewFeedUriFormat=s.Resources.getAppRelativeUri("api/WhatsNew?count={0}");t.tagsV2Enabled=e("tagsv2");t.columnChooserV2Enabled=e("columnchooserv2");t.bulkCommandsEnabled=e("bulkcommands");o=!1;t.getBrowseEntityType=v;t.hasValidStatus=y;t.getArmSubscriptionQuotaIds=p;t.resourceUsesResourceMenu=w;t.subsLimitPerResourcesAcrossSubsCall=40}));define("HubsExtension/Common/HubsObservables",["require","exports","f","i","o","a","ko","HubsExtension/Common/CommonClientStrings","HubsExtension/ArmHelpers/ArmApiEndpoints","HubsExtension/ArmHelpers/ArmApisStartup","HubsExtension/HubsCommon"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function p(t,r){return i.require(n.normalize(t)).then((function(n){return r(n)}))}function tt(n,t){var i=(n.status||"").toLowerCase(
),r=(t.status||"").toLowerCase();if(i!==r){if(i===g)return 1;if(r===g)return-1}return n.subscriptionName.localeCompareIgnoreCase(t.subscriptionName)||n.subscriptionID.localeCompareIgnoreCase(t.subscriptionID)}function kt(n){return l.get(n).Subscriptions.dataPromise.then((function(){return yt.getSelectedSubscriptions(b.client,n)})).then((function(t){var e;l.get(n).SelectedSubscriptions.data(t);var r=l.get(n),u=r&&r.Subscriptions,f=u&&u.data();f&&f.subscriptions&&(e=(r.SelectedSubscriptions.data()||[]).map(w),u.data({subscriptions:i.union(e.stableSort(tt),f.subscriptions.stableSort(tt),(function(n,t){return n.subscriptionID.localeCompareIgnoreCase(t.subscriptionID)===0}))}));a.trace({source:"HubsObservables",action:"InitialSelectedSubscriptions",data:{cloudName:n,count:t?t.length:-1}})}))}function st(n){return!!n.first((function(n){return(n.authorizationSource||"").toLowerCase().indexOf("legacy")>=0}))}function dt(n,t){var i=it(n,t);return!!i&&st([w(i)])}function gt(){return t.getTenantsMemo().then(
(function(n){return n.tenants.length}))}function ni(){t.getTenantsMemo().then((function(n){var t=n.tenants=n.tenants||[];return n}),(function(n){wt.error("Failed for tenant info: "+JSON.stringify(n));i.Hubs.Notifications.ClientNotification.publish({title:o.tenantErrorTitle,description:o.tenantErrorDescription,status:i.Hubs.Notifications.NotificationStatus.Error});var t=new HubsExtension.Azure.TenantInfo;return t.tenants=[],t.failure=!0,t})).then((function(n){k.updateTenantInfoEndPoint.invoke(b.client,d,{tenantInfo:n});ot=n.tenants.length}));s.armEndpoints.forEach((function(n){var t=n.cloudName;l.set(t,{Subscriptions:{dataPromise:null,data:e.observable({subscriptions:[]}),map:{}},SelectedSubscriptions:{dataPromise:null,data:e.observable([])}});at(t);l.get(t).SelectedSubscriptions.dataPromise=kt(t)}))}function ti(n){return l.get(n).Subscriptions.data}function ii(n){return l.get(n).Subscriptions.dataPromise}function ri(n){return l.get(n).Subscriptions.map}function it(n,t){if(n){n=n.toUpperCase();var
r=l.get(t).Subscriptions,i=r.map;if(i)return i[n]}}function ui(n,t){return n?l.get(t).Subscriptions.dataPromise.then((function(){var r=it(n,t);if(r)return r;throw new Error("Subscription with id "+i.ViewModels.Services.ResourceTypes.sanitizeId(n)+" not found");})):Q.reject("Invalid subscription id null")}function fi(n){return ct(n).then((function(t){return ht(n).then((function(n){var r=n()||[],i=r.length;return i&&i!==t.length?i===1?r[0].uniqueDisplayName:o.multipleSubscriptionsSelectedText.format(i):o.allSubscriptionsSelectedText}))}))}function ht(n){var t=l.get(n).SelectedSubscriptions;return t.dataPromise.then((function(){return t.data}))}function ei(n,t){l.get(n).SelectedSubscriptions.data(t)}function ct(n){var t=l.get(n).Subscriptions;return t.dataPromise.then((function(){return t.data().subscriptions.map(rt)}))}function lt(n){return nt.get(n)()}function oi(n,t){return lt(n).then((function(n){var r=t?n.filter((function(n){return bt[n.name.toLowerCase()]})):n;return i.extendArrayIntoMap({},r,(function(
n){return n.name}),(function(n){return n.displayName}))}))}function w(n){var t=n.subscriptionPolicies;return{subscriptionName:n.displayName,subscriptionID:n.subscriptionId,tenantID:n.tenantId,status:n.state,subscriptionPolicies:t,requireRdfe:si(t),authorizationSource:n.authorizationSource}}function si(n){return i.getFeatureValue("rdfe")==="false"?!1:!n||!c.getArmSubscriptionQuotaIds()[(n.quotaId||"").toLowerCase()]}function at(n){var r=Q.defer();l.get(n).Subscriptions.dataPromise=r.promise;var o=y("GetSubscriptions"),t=[],f=Q.defer();nt.set(n,(function(){return f.promise}));var s=y("GetLocations"),u=[],e=b.client,g=h.callBatchWithContinuation([h.listSubscriptions(),h.listLocationsApi()],(function(n,i){var r,f;i===0?(r=n,t=t.concat(r)):i===1&&(f=n,u=u.concat(f))}),(function(n){throw n;}),!1,n,ft("fetchSubscriptionsLocationsAndTenants"),!0);g.then((function(){var g,nt,it,ut;a.completeTrace(o);var ft={},et={},st={},y=function(n,t){t=(t||"").toLowerCase();n[t]=(n[t]||0)+1};t.forEach((function(n){y(ft,
n.state);y(et,(n.subscriptionPolicies||{}).quotaId);y(st,n.authorizationSource)}));var ht=t.length,h={subscriptions:[]},b={};ht?(p("./SubsCreditCheck",(function(n){n.checkRemainingCredit(t)})),i.isFeatureEnabled("ci")||(nt=t.filter((function(n){return n.state.toLowerCase()===c.subscriptionPastDueStatus.toLowerCase()})),nt.length&&p("./PastDueSubsCheck",(function(t){t.raiseWarningForPastDueSubs(nt,n)}))),it=function(t){h.subscriptions=t.map(w).stableSort(tt);h.subscriptions.map(rt).forEach((function(n){b[n.subscriptionId.toUpperCase()]=n}));var i=l.get(n).Subscriptions;i.data(h);i.map=b;r.resolve(null);k.updateSubscriptionInfoEndPoint.invoke(e,d,h)},ut=i.getFeatureValue("subscriptions"),ut?p("./FilterSubs",(function(n){var i=n.filterSubs(t,ut);it(i)})):it(t)):(v.Security.getUserInfo().then((function(t){p("./NoSubsChecks",(function(i){i.handleNoSubsInDirectory(t,ot,n)}))})),g=l.get(n).Subscriptions,g.data(h),g.map=b,r.resolve(null),k.updateSubscriptionInfoEndPoint.invoke(e,d,h));a.completeTrace(s);f.resolve(
u)}))}function rt(n,t,i){var f=n.subscriptionID,r=n.subscriptionName,u=n.status&&n.status.toLowerCase()===g?o.disabledSubscriptionLabelFormat.format(r):r;return i.filter((function(n){return n.subscriptionName===r})).length>1&&(u=o.subscriptionNameAndIdLabelFormat.format(u,f)),{subscriptionId:f,uniqueDisplayName:u,displayName:r,tenantId:n.tenantID,state:n.status,subscriptionPolicies:n.subscriptionPolicies,authorizationSource:n.authorizationSource}}var ot,nt;u.defineProperty(t,"__esModule",{value:!0});var v=i.Base,vt=v.Constants,ut=v.Diagnostics,a=ut.Telemetry,yt=r.Azure,pt=v.Resources,b=r.Rpc,k=HubsExtension.Internal.Azure,wt=ut.createLog(n),d=vt.Shell,g=c.subscriptionDisabledStatus.toLowerCase(),ft=function(n){return h.makeResourceManagerTelemetry("HubsObservables."+n)},y=function(n){return a.start({source:"HubsObservables",action:n})},bt=i.extendArrayIntoMap({},window.fx.environment.servicesHealthAllowedRegions||[],(function(n){return n.toLowerCase()})),l=r.getCloudMap(),et=function(n){var
t=y(n);return Q(v.Net2.ajax({uri:pt.getAppRelativeUri("/api/tenants/List"),type:"POST",dataType:"json",contentType:"application/json",performRetry:!0,isBackgroundTask:!0})).then((function(n){return a.completeTrace(t),n})).catch((function(n){a.cancelTrace(t);throw n;}))};t.getTenantsMemo=i.memoizeQ((function(){if(i.isFeatureEnabled("armtenants")){var n=y("GetTenantsFromArm");return Q(h.callUsingBatch({armApiOrUri:h.listTenantsApi(),telemetry:ft("getTenants")})).then((function(t){a.completeTrace(n);var i={failure:!1,tenants:[]};return((t.value||[]).forEach((function(n){(n.domains||[]).length===1&&n.displayName&&i.tenants.push({displayName:n.displayName||"",domainName:(n.domains||[]).length===1?n.domains[0]:"",id:n.tenantId})})),i.tenants.length!==t.value.length)?et("GetTenantsFromArmFallback"):i})).catch((function(t){a.cancelTrace(n);throw t;}))}return et("GetTenants")}));nt=r.getCloudMap();t.isCoadminOnAnySub=st;t.isCoAdminOnSub=dt;t.getTenantsCount=gt;t.initializeObservables=ni;t.getSubscriptionsObservable=
ti;t.getSubscriptionsPromise=ii;t.getSubscriptionsMap=ri;t.getSubscriptionInfo=it;t.getSubscriptionInfoPromise=ui;t.getSelectedSubscriptionsLabel=fi;t.getSelectedSubscriptions=ht;t.pingSelectedSubscriptionsList=ei;t.getSubscriptions=ct;t.getLocations=lt;t.getLocationDisplayNames=oi;t.toHubsExtensionSubscription=w;t.initialize=at;t.toMsPortalFxSubscription=rt}));define("HubsExtension/ArmHelpers/Models/ArmResource",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(t){function o(n){var t=n.id,i,e,o,s,h;return t?(i=n.name,i||(e=t.toLowerCase(),f[e]||(u.warning("ARM returned a resource with no name: "+e),f[e]=!0),o=r.parseResourceDescriptor(t),i=o.resources.join("/")),s=!r.isTenantResource(t)&&r.buildResourceGroupIdFromResourceId(t),h={id:t,location:n.location,name:i,tags:n.tags||{},properties:n.properties||{},resourceGroup:s,type:n.type,kind:n.kind,selfLinkUri:n.selfLinkUri,plan:n.plan,managedBy:n.managedBy,sku:n.sku,identity:n.identity},h):(u.warning("ARM returned a resource with no id: "+
JSON.stringify(n)),null)}var e=i.Base.Diagnostics,r=i.ViewModels.Services.ResourceTypes,u=e.createLog(n),f={};t.toResource=o})(r||(r={})),r}));define("HubsExtension/ArmHelpers/Models/ArmResourceGroup",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(t){function f(n){if(!n.id)return u.warning("ARM returned a resource group with no id: "+JSON.stringify(n)),null;var t=n.properties||{};return{id:n.id,location:n.location,name:n.name,tags:n.tags||{},properties:t,lockState:t.lockState,provisioningState:t.provisioningState,managedBy:n.managedBy}}var r=i.Base.Diagnostics,u=r.createLog(n);t.toResourceGroup=f})(r||(r={})),r}));define("HubsExtension/_generated/ExtensionDefinition",["require","exports","i","HubsExtension/Tags/TagsClientStrings","HubsExtension/ServicesHealth/ServicesHealthClientStrings","HubsExtension/ResourceMap/ResourceMapClientStrings","HubsExtension/Locks/LocksClientStrings","HubsExtension/ClassicAdmins/ManagementTeamClientStrings","HubsExtension/Browse/BrowseClientStrings",
"HubsExtension/MoveResource/MoveResourceStrings"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){function a(){var w=l.createGalleryServiceDefinition,b=l.createAssetIdSource,k=l.createPermission,v=l.createCommandGroupDefinition,c=l.createPartReferenceDefinition3,a=l.createPartInstanceDefinition,p=l.createDetailsDefinition2,n=l.createReference,i=l.createInputBinding,y=l.createCommandDefinition,d=l.createDefinition3;return d(t,[y("MoveResourceCommand",h.moveResourceCommandText,"MoveResource$MoveResourceCommandVM",[i("resourceId",[n(1,"resourceId")],!1)],p(t,t,t,[i(t,[n(4,"container.selectable")],!1)],t,t,t,[i("actionBarOutput",[n(1,"actionBarOutput")],!1)]),t,t,t,2)],[a("Browse",c("BrowseAllResourcesPinnedPart",t,t,[],4),t,!1),a("ServicesHealthPartStart",c("ServicesHealthPart",t,t,[],1),t,!1),a("GalleryTileStart",c("GalleryTile",t,t,[i("selectedMenuItemId",[n(5,"constant_",t,t,t,"")],!0)],2),t,!1),a("HelpAndSupport",c("HelpAndSupportPart",t,t,[],2),t,!1),a("GettingStarted",
c("GettingStartedPart",t,t,[],5,5,4),t,!1),a("AzureProjectGettingStarted",c("AzureProjectGettingStartedPart",t,t,[],3),t,!1),a("Diagnostics",c("DiagnosticsTile",t,t,[],0),t,!1),a("TourTileStart",c("TourTile",t,t,[],2),t,!1),a("Settings",c("SettingsBladePart",t,t,[],1),t,!1),a("BillingTileStart",c("SubscriptionsTile",t,t,[],0),t,!1),a("WhatsNewTileStart",c("WhatsNewTile",t,t,[],2),t,!1),a("FeedbackTileStart",c("FeedbackTile",t,t,[],1),t,!1),a("AzurePortalTileStart",c("AzurePortalTile",t,t,[],1),t,!1)],[v("RecentResourceBrowseGrid2Commands",[y("DiscardRecentResource",s.discardRecentItem,"BrowseGrid2$DiscardRecentResourceCommand",[i("id",[n(1,"id")],!1)],t,t,t,t,0)]),v("serviceCommandGroup",[]),v("ManagementTeamCommandGroup",[y("ManageUsersCommand",o.manageUsersCommandText,"ClassicAdmins$ManageUsersCommand",[],t,t,t,t,1)]),v("LockCommands",[y("Delete",e.delete,"Locks$DeleteLockCommandViewModel",[i("id",[n(1,"id")],!1)],t,t,t,t,0)]),v("MoveResourceCommands",[y("MoveResourceCommand",h.moveResourceCommandText,
"MoveResource$MoveResourceCommandVM",[i("resourceId",[n(1,"resourceId")],!1)],p(t,t,t,[i(t,[n(4,"container.selectable")],!1)],t,t,t,[i("actionBarOutput",[n(1,"actionBarOutput")],!1)]),t,t,t,2)]),v("ResourceGroupBrowseCommands",[y("OpenResourceGroupDeleteBlade",f.deleteResourceGroupCommandTitle,"ResourceMap$DeleteResourceGroupCommandViewModel",[i("resourceGroup",[n(1,"id")],!1)],p("ResourceGroupDeleteBladeForCommand",t,t,t,t,t,[i("resourceGroup",[n(4,"content.resourceGroup")],!1)],[i("actionBarOutput",[n(1,"actionBarOutput")],!1)]),"ResourceGroups","resourceGroup",[k(t,"ResourceGroups",b(0,"resourceGroup"),"Microsoft.Resources/subscriptions/resourceGroups/delete",0)],2)]),v("ServiceHealth",[y(t,u.ServiceHealth.uriCommandTitle,"ServicesHealth$PublicShdUriCommand",[],t,t,t,t,1)]),v("AddTagCommandGroup",[y("AddTagCommand",r.addCommandText,"Tags$SaveTagCommand",[],t,t,t,t,0)]),v("TagItemCommandGroup",[y("DeleteTagCommand",r.deleteCommandText,"Tags$DeleteTagCommand",[i("key",[n(1,"key")],!1),
i("value",[n(1,"value")],!1),i("resourceId",[n(1,"resourceId")],!1),i("allowEdits",[n(1,"allowEdits")],!1)],t,t,t,t,0)]),v("MoveResourceBladeCommands",[y(t,h.moveDocLabel,"MoveResource$LearnMoreCommandVM",[],t,t,t,t,1)])],{},t,w("Deployments$CustomDeploymentBladeSelector"),t,"HubsExtension","1.0","47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU=%","1.0.0.2","5.0.302.1034 (production#1e50f334ec.180307-1829)")}var t=undefined,l=i.DefinitionBuilder,v,c,y,p,w;n.definitionName="HubsExtension";n.getDefinition=a,(function(n){var t,i,r,u,f,e,o;(function(n){n.name="Microsoft_Azure_Insights"})(t=n.Microsoft_Azure_Insights||(n.Microsoft_Azure_Insights={})),(function(n){n.name="Microsoft_Azure_Monitoring";var t;(function(n){var t,i,r,u;(function(n){n.name="EventsBrowseBlade"})(t=n.EventsBrowseBlade||(n.EventsBrowseBlade={})),(function(n){n.name="DiagnosticsLogsBlade"})(i=n.DiagnosticsLogsBlade||(n.DiagnosticsLogsBlade={})),(function(n){n.name="AlertsBlade"})(r=n.AlertsBlade||(n.AlertsBlade={})),(function(n){
n.name="MetricsBladeV2"})(u=n.MetricsBladeV2||(n.MetricsBladeV2={}))})(t=n.Blades||(n.Blades={}))})(i=n.Microsoft_Azure_Monitoring||(n.Microsoft_Azure_Monitoring={})),(function(n){n.name="Microsoft_Azure_Resources";var t;(function(n){var t,i,r;(function(n){n.name="QuotasBlade";var t;(function(n){n.bladeInputs="bladeInputs"})(t=n.Inputs||(n.Inputs={}))})(t=n.QuotasBlade||(n.QuotasBlade={})),(function(n){n.name="ArmPolicyBlade";var t;(function(n){n.bladeInputs="bladeInputs"})(t=n.Inputs||(n.Inputs={}))})(i=n.ArmPolicyBlade||(n.ArmPolicyBlade={})),(function(n){n.name="ArmPolicyAddBlade"})(r=n.ArmPolicyAddBlade||(n.ArmPolicyAddBlade={}))})(t=n.Blades||(n.Blades={}))})(r=n.Microsoft_Azure_Resources||(n.Microsoft_Azure_Resources={})),(function(n){n.name="Microsoft_Azure_Marketplace";var t;(function(n){var t,i;(function(n){var t,i;n.name="GalleryFeaturedMenuItemBlade",(function(n){n.selectedMenuItemId="selectedMenuItemId"})(t=n.Inputs||(n.Inputs={})),(function(n){n.resetMenuId="resetMenuId";n.createTriggeredSignal=
"createTriggeredSignal"})(i=n.Outputs||(n.Outputs={}))})(t=n.GalleryFeaturedMenuItemBlade||(n.GalleryFeaturedMenuItemBlade={})),(function(n){var t,i;n.name="GalleryResultsListBlade",(function(n){n.selectedSubMenuItemId="selectedSubMenuItemId"})(t=n.Inputs||(n.Inputs={})),(function(n){n.inlineGalleryCreateOutputs="inlineGalleryCreateOutputs"})(i=n.Outputs||(n.Outputs={}))})(i=n.GalleryResultsListBlade||(n.GalleryResultsListBlade={}))})(t=n.Blades||(n.Blades={}))})(u=n.Microsoft_Azure_Marketplace||(n.Microsoft_Azure_Marketplace={})),(function(n){n.name="Microsoft_Azure_Billing";var t;(function(n){var t,i,r,u;(function(n){n.name="SubscriptionsBlade"})(t=n.SubscriptionsBlade||(n.SubscriptionsBlade={})),(function(n){n.name="AccountBlade"})(i=n.AccountBlade||(n.AccountBlade={})),(function(n){n.name="BillingNoSubscriptionsBlade"})(r=n.BillingNoSubscriptionsBlade||(n.BillingNoSubscriptionsBlade={})),(function(n){n.name="UpgradeSubscriptionBlade";var t;(function(n){n.subscriptionId="subscriptionId"})(t=n.Inputs||
(n.Inputs={}))})(u=n.UpgradeSubscriptionBlade||(n.UpgradeSubscriptionBlade={}))})(t=n.Blades||(n.Blades={}))})(f=n.Microsoft_Azure_Billing||(n.Microsoft_Azure_Billing={})),(function(n){n.name="Microsoft_Azure_Policy";var t;(function(n){var t,i,r,u;(function(n){n.name="ArmPolicyBlade";var t;(function(n){n.bladeInputs="bladeInputs"})(t=n.Inputs||(n.Inputs={}))})(t=n.ArmPolicyBlade||(n.ArmPolicyBlade={})),(function(n){n.name="AssignmentBlade"})(i=n.AssignmentBlade||(n.AssignmentBlade={})),(function(n){n.name="EditPolicySetDefinitionBlade";var t;(function(n){n.id="id"})(t=n.Inputs||(n.Inputs={}))})(r=n.EditPolicySetDefinitionBlade||(n.EditPolicySetDefinitionBlade={})),(function(n){n.name="PolicyMenuBlade"})(u=n.PolicyMenuBlade||(n.PolicyMenuBlade={}))})(t=n.Blades||(n.Blades={}))})(e=n.Microsoft_Azure_Policy||(n.Microsoft_Azure_Policy={})),(function(n){n.name="Microsoft_Azure_AD";var t;(function(n){var t,i,r,u;(function(n){var t,i;n.name="SelectMember",(function(n){n.collectorBindingInternals_inputs="collectorBindingInternals-inputs";
n.collectorBindingInternals_errors="collectorBindingInternals-errors";n.stepInput="stepInput"})(t=n.Inputs||(n.Inputs={})),(function(n){n.collectorBindingInternals_outputs="collectorBindingInternals-outputs";n.collectorBindingInternals_commit="collectorBindingInternals-commit";n.stepOutput="stepOutput"})(i=n.Outputs||(n.Outputs={}))})(t=n.SelectMember||(n.SelectMember={})),(function(n){n.name="SelectMemberV3";var t;(function(n){n.title="title";n.subtitle="subtitle"})(t=n.Inputs||(n.Inputs={}))})(i=n.SelectMemberV3||(n.SelectMemberV3={})),(function(n){n.name="RolesListBlade";var t;(function(n){n.scope="scope"})(t=n.Inputs||(n.Inputs={}))})(r=n.RolesListBlade||(n.RolesListBlade={})),(function(n){n.name="UserAssignmentsBlade";var t;(function(n){n.scope="scope"})(t=n.Inputs||(n.Inputs={}))})(u=n.UserAssignmentsBlade||(n.UserAssignmentsBlade={}))})(t=n.Blades||(n.Blades={}))})(o=n.Microsoft_Azure_AD||(n.Microsoft_Azure_AD={}))})(v=n.External||(n.External={})),(function(n){var t,i,r,u,f,e,o,s,h,c,l,a,v,
y,p,w,b,k,d;(function(n){n.name="ArmExplorer"})(t=n.ArmExplorer||(n.ArmExplorer={})),(function(n){n.name="NonAssetResource"})(i=n.NonAssetResource||(n.NonAssetResource={})),(function(n){n.name="BrowseInstanceLink"})(r=n.BrowseInstanceLink||(n.BrowseInstanceLink={})),(function(n){n.name="BrowseResource"})(u=n.BrowseResource||(n.BrowseResource={})),(function(n){n.name="BrowseAllResources"})(f=n.BrowseAllResources||(n.BrowseAllResources={})),(function(n){n.name="BrowseRecentResources"})(e=n.BrowseRecentResources||(n.BrowseRecentResources={})),(function(n){n.name="BrowseResourceGroup"})(o=n.BrowseResourceGroup||(n.BrowseResourceGroup={})),(function(n){n.name="BrowseAll"})(s=n.BrowseAll||(n.BrowseAll={})),(function(n){n.name="BrowseAllWithType"})(h=n.BrowseAllWithType||(n.BrowseAllWithType={})),(function(n){n.name="BrowseService"})(c=n.BrowseService||(n.BrowseService={})),(function(n){n.name="BrowseDynamicAsset"})(l=n.BrowseDynamicAsset||(n.BrowseDynamicAsset={})),(function(n){n.name="BrowseDynamicResource"})(a=
n.BrowseDynamicResource||(n.BrowseDynamicResource={})),(function(n){n.name="Dashboard"})(v=n.Dashboard||(n.Dashboard={})),(function(n){n.name="WhatsNew"})(y=n.WhatsNew||(n.WhatsNew={})),(function(n){n.name="Deployments"})(p=n.Deployments||(n.Deployments={})),(function(n){n.name="ResourceGroups";var t;(function(n){n.read="Microsoft.Resources/subscriptions/resourceGroups/read";n.deleteObject="Microsoft.Resources/subscriptions/resourceGroups/delete";n.write="Microsoft.Resources/subscriptions/resourceGroups/write";n.writeDeployments="Microsoft.Resources/subscriptions/resourceGroups/deployments/write";n.readDeployments="Microsoft.Resources/subscriptions/resourceGroups/deployments/read";n.readEvents="Microsoft.Insights/events/read"})(t=n.Permissions||(n.Permissions={}))})(w=n.ResourceGroups||(n.ResourceGroups={})),(function(n){n.name="ResourceGroupEvents"})(b=n.ResourceGroupEvents||(n.ResourceGroupEvents={})),(function(n){n.name="Settings"})(k=n.Settings||(n.Settings={})),(function(n){n.name="Tag"})(d=n.Tag||
(n.Tag={}))})(c=n.AssetTypes||(n.AssetTypes={})),(function(n){n.armExplorer=c.ArmExplorer.name;n.nonAssetResource=c.NonAssetResource.name;n.browseInstanceLink=c.BrowseInstanceLink.name;n.browseResource=c.BrowseResource.name;n.browseAllResources=c.BrowseAllResources.name;n.browseRecentResources=c.BrowseRecentResources.name;n.browseResourceGroup=c.BrowseResourceGroup.name;n.browseAll=c.BrowseAll.name;n.browseAllWithType=c.BrowseAllWithType.name;n.browseService=c.BrowseService.name;n.browseDynamicAsset=c.BrowseDynamicAsset.name;n.browseDynamicResource=c.BrowseDynamicResource.name;n.dashboard=c.Dashboard.name;n.whatsNew=c.WhatsNew.name;n.deployments=c.Deployments.name;n.resourceGroups=c.ResourceGroups.name;n.resourceGroupEvents=c.ResourceGroupEvents.name;n.settings=c.Settings.name;n.tag=c.Tag.name})(y=n.AssetTypeNames||(n.AssetTypeNames={})),(function(n){n.armExplorerBlade="ArmExplorerBlade";n.unauthorizedAssetBlade="UnauthorizedAssetBlade";n.notFoundAssetBlade="NotFoundAssetBlade";n.unavailableAssetBlade=
"UnavailableAssetBlade";n.noCreateFlowBlade="NoCreateFlowBlade";n.resources="Resources";n.browseAllResourcesBlade="BrowseAllResourcesBlade";n.browseResourceBlade="BrowseResourceBlade";n.browseInstanceLinkBlade="BrowseInstanceLinkBlade";n.browseResourceGroupBlade="BrowseResourceGroupBlade";n.browseRecentResourcesBlade="BrowseRecentResourcesBlade";n.mapResourceGroupBlade="MapResourceGroupBlade";n.resourceProperties="ResourceProperties";n.resourceGroupPickerV3Blade="ResourceGroupPickerV3Blade";n.browseAllBlade="BrowseAllBlade";n.browseAllBladeWithType="BrowseAllBladeWithType";n.browseServiceBlade="BrowseServiceBlade";n.browseDynamicAssetBlade="BrowseDynamicAssetBlade";n.browseDynamicResourceBlade="BrowseDynamicResourceBlade";n.managementTeamBlade="ManagementTeamBlade";n.dashboardBlade="DashboardBlade";n.deployToAzure="DeployToAzure";n.deployFromTemplateBlade="DeployFromTemplateBlade";n.parametersEditorBlade="ParametersEditorBlade";n.parametersFileEditorBlade="ParametersFileEditorBlade";n.
templateEditorBlade="TemplateEditorBlade";n.templateViewerBlade="TemplateViewerBlade";n.errorDetailsBlade="ErrorDetailsBlade";n.armActionsContextPane="ArmActionsContextPane";n.armActionsResultJsonBlade="ArmActionsResultJsonBlade";n.armDataContextPane="ArmDataContextPane";n.armDataJsonBlade="ArmDataJsonBlade";n.armDataResultJsonBlade="ArmDataResultJsonBlade";n.whatsNewBlade="WhatsNewBlade";n.noSubscriptionsBlade="NoSubscriptionsBlade";n.noMsdnOfferOnSubscriptionsBlade="NoMsdnOfferOnSubscriptionsBlade";n.subCertsBlade="SubCertsBlade";n.locationPickerV3Blade="LocationPickerV3Blade";n.locksBlade="LocksBlade";n.lockEditBlade="LockEditBlade";n.moveResourceBlade="MoveResourceBlade";n.regionPickerBlade="RegionPickerBlade";n.resourceGroupPickerBlade="ResourceGroupPickerBlade";n.createResourceGroupBlade="CreateResourceGroupBlade";n.subscriptionPickerBlade="SubscriptionPickerBlade";n.createEmptyResourceGroupBlade="CreateEmptyResourceGroupBlade";n.deploymentsListBlade="DeploymentsListBlade";n.deploymentDetailsOverviewBlade=
"DeploymentDetailsOverviewBlade";n.deploymentInputsBlade="DeploymentInputsBlade";n.deploymentOutputsBlade="DeploymentOutputsBlade";n.deploymentOperationPropertiesBlade="DeploymentOperationPropertiesBlade";n.resourceGroupQuickStartBlade="ResourceGroupQuickStartBlade";n.resourceGroupEventsBlade="ResourceGroupEventsBlade";n.resourceGroupCostsBlade="ResourceGroupCostsBlade";n.resourceGroupDeleteBlade="ResourceGroupDeleteBlade";n.resourceGroupDeleteBladeForCommand="ResourceGroupDeleteBladeForCommand";n.resourceMenuBlade="ResourceMenuBlade";n.servicesHealthBlade="ServicesHealthBlade";n.settingsBlade="SettingsBlade";n.languageSelectionBlade="LanguageSelectionBlade";n.localeSelectionBlade="LocaleSelectionBlade";n.myAccessBlade="MyAccessBlade";n.rPStatusBlade="RPStatusBlade";n.azureProvisioningResultsBlade="AzureProvisioningResultsBlade";n.subscriptionPickerV3Blade="SubscriptionPickerV3Blade";n.resourcesWithTagBlade="ResourcesWithTagBlade";n.resourceTagsListBlade="ResourceTagsListBlade";n.subscriptionTagsListBlade=
"SubscriptionTagsListBlade";n.bulkDeleteBlade="BulkDeleteBlade";n.chooseColumnsBlade="ChooseColumnsBlade";n.browseV2Blade="BrowseV2Blade";n.deploymentDetailsBlade="DeploymentDetailsBlade";n.resourceGroupMapBlade="ResourceGroupMapBlade";n.contactInfoBlade="ContactInfoBlade";n.assignTagsBlade="AssignTagsBlade";n.editTagsBlade="EditTagsBlade";n.clockContextPane="ClockContextPane";n.videoContextPane="VideoContextPane";n.markdownContextPane="MarkdownContextPane";n.armErrorsBlade="ArmErrorsBlade"})(p=n.BladeNames||(n.BladeNames={})),(function(n){n.recentResourceBrowseGrid2Commands="RecentResourceBrowseGrid2Commands";n.serviceCommandGroup="serviceCommandGroup";n.managementTeamCommandGroup="ManagementTeamCommandGroup";n.lockCommands="LockCommands";n.moveResourceCommands="MoveResourceCommands";n.resourceGroupBrowseCommands="ResourceGroupBrowseCommands";n.serviceHealth="ServiceHealth";n.addTagCommandGroup="AddTagCommandGroup";n.tagItemCommandGroup="TagItemCommandGroup"})(w=n.CommandGroupNames||(n.CommandGroupNames=
{}))})(c||(c={})),c}));define("HubsExtension/Common/CloudNameHelpers",["require","exports","f","i","HubsExtension/_generated/ExtensionDefinition","HubsExtension/Common/AssetTypeCache"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function h(n,t){if(!s.readFromInputs(t))return s.addToModel(n,t)}function c(n,t){t.detailBladeInputs=t.detailBladeInputs||{};h(n,t.detailBladeInputs)}function a(n,t){var r=t,h=t.detailBlade,l=t.assetType,u=t.resourceId,s;return h||l?(t.extension&&t.extension.toLowerCase()!==e?r.cloudName=n:c(n,r),Q(r)):u?(s=void 0,s=o.isResourceGroupId(u)?i.Base.Constants.ResourceTypes.ResourceGroups:o.buildResourceTypeFromResourceId(u),f.getResourceTypeAssetTypeInformation(s,n).then((function(t){return t.lowerCaseExtension===e?c(n,r):r.cloudName=n,r}))):Q(t)}function v(n,t){var i=t;return i.extensionName&&i.extensionName.toLowerCase()!==e?i.cloudName=n:(i.parameters=i.parameters||{},h(n,i.parameters)),i}var l=i.Base.Diagnostics,o=i.ViewModels.Services.ResourceTypes,
s=r.Extension.CloudName,e=u.definitionName.toLowerCase(),y=l.createLog(n);t.addCloudNameToDynamicSelection=a;t.addCloudNameToBladeReference=v})(e||(e={})),e}));define("HubsExtension/Notifications/EventSubscriptionService",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function o(n,r,u){if(!n.operationNameRegex&&!n.source&&!n.status&&!n.subStatus)throw new Error("At least one criteria must be specified.");var f=i.getUniqueId();return t.push({cookie:f,criteria:n,callback:r,eventLimit:u}),f}function s(n){var i=t.filter((function(t){return t.cookie!==n}));t=i}function r(n,t){return!n==!t&&n.toLowerCase()===t.toLowerCase()}function h(n,t){var i=t.operationNameRegex,u;if(i&&(u=new RegExp(i,"ig"),!u.test(n.operationName)))return!1;var f=t.source,o=t.status,s=t.subStatus;return f&&!r(n.source,f)||o&&!r(n.status,o)||!e(s)&&!r(n.subStatus,s)?!1:!0}function f(n,i){var r=t.slice();r.forEach((function(t){var r=[];n.forEach((function(n){h(n,t.criteria)&&r.push(n)}));t.callback(
r.slice(0,t.eventLimit||r.length),i)}))}function c(n){var t="microsoft.resources",e=t+"/subscriptions/resourcegroups",i="/delete",r=function(n,i,r){f([{operationName:r,status:"succeeded",source:t,correlationId:null,timestamp:new Date,assetId:n,isLocalEvent:!0}],i)};return n.forEach((function(n){u.isResourceGroupId(n.assetId)?r(n.assetId,n.cloudName,e+i):u.isResourceId(n.assetId)&&r(n.assetId,n.cloudName,i)})),Q(!0)}var u=i.ViewModels.Services.ResourceTypes,e=i.isNullOrUndefined,t=[];n.subscribeToArmEvent=o;n.removeArmEventSubscription=s;n.matchEvents=f;n.createResourceDeletedEvent=c})(r||(r={})),r}));define("HubsExtension/Common/AssetViewModelCommon",["require","exports","f","i","o"],(function(n,t,i,r){"use strict";var u;return (function(n){function o(n,i,r){var e={type:l.ViewModel,name:n.viewModel,initialState:null,createSelectable:!1};return r&&(e.earlyExecTasks=r),u.getViewModelsDefinition.acquireObject(h.client,u.getWindowId({name:n.extensionName,cloudName:i}),e).then((function(i){var r=new
t(n,i,function(){delete f[n.resourceType]});return f[n.resourceType]=r,r}))}function a(n,t){return o(n,t)}function v(n,t,i){return o(n,t,i)}var s=i.Base,h=r.Rpc,c=i.Assets,u=r.Extension,l=s.Constants.ViewModelTypes,f={},e=(function(){function n(n,t){this._acquiredObject=n;this._onDispose=t}return n.prototype.getValue=function(){return this._acquiredObject.getValue()},n.prototype.dispose=function(){this._onDispose&&this._onDispose();i.disposeViewModelProperties(this.getValue());this._acquiredObject.dispose()},n})(),t;n.AcquiredObjectWrapperImpl=e;t=(function(n){function t(t,i,r){var u=n.call(this,i,r)||this;return u._assetTypeInformation=t,u}return __extends(t,n),t.prototype._getContentForContract=function(n){return c.assetTypeInformationSupportsContract(this._assetTypeInformation,n)?this.getValue().content:null},t.prototype.getBrowseConfigContract=function(){return this._getContentForContract(2)},t.prototype.getSupplementalDataContract=function(){return this._getContentForContract(4)},t.prototype.
getResourceMenuConfigContract=function(){return this._getContentForContract(8)},t.prototype.getProvidesResourcesContract=function(){return this._getContentForContract(64)},t})(e);n.AssetTypeViewModelWrapperImpl=t;n.getAssetTypeViewModel=a;n.getAssetTypeViewModelAndExec=v})(u||(u={})),u}));define("HubsExtension/ResourceMap/ResourceMapCommon",["require","exports","f","i","o","ko","HubsExtension/ResourceMap/ResourceMapClientStrings","HubsExtension/ArmHelpers/ArmApisStartup","HubsExtension/ArmHelpers/Models/ArmResource","HubsExtension/ArmHelpers/Models/ArmResourceGroup","HubsExtension/Common/AssetViewModelCommon","HubsExtension/Common/HubsObservables"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function a(n){return n.toLowerCase()}function st(n,t){return b(n,(function(n,i,r){var u=t&&i&&typeof i=="object";r[n]=f.observable(u?st(i):i)}),{})}function k(n,t){return a((t||"")+":"+n)}function ht(t){return i.require(n.normalize("../ArmHelpers/ArmApis")).then((function(n){return t(n)}))}function li(
n){var t=i.getUniqueId();return y[t]=n,t}function ai(n){y[n]&&delete y[n]}function vi(n,t){b(y,(function(i,r){r.resourceGroupDeleteStarted(n,t)}))}function yi(n,t){b(y,(function(i,r){r.resourceGroupDeleteFailed(n,t)}))}function pi(n,t,i){if(t){var r=t,u=r.subscriptionId||r.subscriptionID;return vt.Internal.validateResourceGroupName(n,u,i,null,(function(){return it(ft(ui.buildResourceGroupIdFromSubscriptionAndResourceGroupName(u,n)),"HEAD",undefined,i,ot("validateResourceGroupName")).then((function(){return yt(ri.ResourceGroup.Validation.alreadyExistsMessage.format(r.displayName||r.subscriptionName||u))}),(function(){return yt()}))}))}return vt.Internal.validateResourceGroupName(n,null,i)}function ti(n,t,i,r){return ut(o.callRaw({armApiOrUri:t,httpMethod:n,cloudName:i,telemetry:r}).then((function(n){var t=n.jqXHR;return{status:t.status,operationId:t.getResponseHeader("Location"),retryAfterInSeconds:parseInt(t.getResponseHeader("Retry-After"))}})),r)}function ut(n,t){var i=Q(n);return i.catch((function(
n){var i=w(r.Azure.buildSimplifiedError(n&&n.jqXHR||n),t,!0),u=i.stack;if(t.extension&&t.extension!==g.ExtensionNames.Hubs)throw u?d.Diagnostics.createIgnoreUnhandledRejectionError(i.message,u):d.Diagnostics.createIgnoreUnhandledRejectionError(i.message);else throw i;}))}var oi,ct,rt,si,hi,ci,y;u.defineProperty(t,"__esModule",{value:!0});var lt=i.Azure,d=i.Base,g=d.Constants,ii=g.AssetNames,nt=g.ResourceTypes,p=d.Images.StatusBadge,ri=i.Resources.Strings,at=i.ViewModels,ui=at.Services.ResourceTypes,v=lt.ResourceManager.DeploymentStates,vt=lt.ResourceGroups;t.resourceGroupsTypeKey=a(nt.ResourceGroups);t.recentResourcesTypeKey=a(nt.RecentResources);t.allResourcesTypeKey=a(nt.AllResources);t.subscriptionsTypeKey=a(nt.Subscriptions);t.resourceGroupAssetType=ii.ResourceGroups;var tt=f.utils.peekObservable,w=i.extend,fi=404,b=i.forEachKey,ft=o.resourceGroupApi,ei=o.resourceApi,it=o.call,yt=at.getValidationResult,et=Q.isRejected,ot=function(n){return o.makeResourceManagerTelemetry(n+"ResourceMap")}
,pt=v.Running,wt=v.Deploying,bt=v.Accepted,kt=v.Canceled,dt=v.Failed,gt=v.Deleting,ni=v.Succeeded;t.deploymentStatusIconLookup={};t.deploymentStatusIconLookup[pt]=t.deploymentStatusIconLookup[wt]=t.deploymentStatusIconLookup[bt]=t.deploymentStatusIconLookup[v.Waiting]=p.Pending();t.deploymentStatusIconLookup[kt]=p.Canceled();t.deploymentStatusIconLookup[dt]=p.Error();t.deploymentStatusIconLookup[gt]=p.Disabled();t.deploymentStatusIconLookup[ni]=p.Success();t.deploymentStatusDisplayTextLookup={};t.deploymentStatusDisplayTextLookup[pt]=t.deploymentStatusDisplayTextLookup[wt]=e.deploymentRunningState;t.deploymentStatusDisplayTextLookup[bt]=e.deploymentAcceptedState;t.deploymentStatusDisplayTextLookup[kt]=e.deploymentCanceledState;t.deploymentStatusDisplayTextLookup[dt]=e.deploymentFailedState;t.deploymentStatusDisplayTextLookup[gt]=e.deploymentDeletingState;t.deploymentStatusDisplayTextLookup[ni]=e.deploymentSucceededState;t.DeleteResourceGroupConfigType="ResourceGroupDeleteWarningPartViewModel_DeleteResourceGroupConfig";
i.Data.Metadata.setTypeMetadata(t.DeleteResourceGroupConfigType,{name:t.DeleteResourceGroupConfigType,properties:{resourceGroup:null,resourceGroupName:null},entityType:!0}),(function(n){n.ResourceMap="ResourceMap";var t;(function(n){n.OpenedBlade="OpenedBlade";n.ResultOpened="ResultOpened"})(t=n.Action||(n.Action={}))})(oi=t.Telemetry||(t.Telemetry={}));ct=1e4;rt=(function(){function n(n){this._cache={};this._timeout=n}return n.prototype.store=function(n,t){return this._cache[n]={value:t,accessTime:Date.now()},t},n.prototype.remove=function(n){delete this._cache[n]},n.prototype.fetch=function(n){var t=this._cache[n];if(t){if(t.accessTime>=Date.now()-this._timeout)return t.value;delete this._cache[n]}return},n.prototype.touch=function(n){var t=this._cache[n];t&&(t.accessTime=Date.now())},n.prototype.trim=function(){var n=this;this._trimPromise&&this._trimPromise.isPending||(this._trimPromise=Q.delay(100).then((function(){var t=Date.now()-n._timeout;b(n._cache,(function(i,r){r.accessTime<t&&delete
n._cache[i]}))})))},n.prototype.flushCache=function(){this._cache={}},n.prototype.flushCacheWithPrefix=function(n){var t=this;b(this._cache,(function(i){i.startsWith(n)&&delete t._cache[i]}))},n})();t.Cache=rt,(function(n){function u(n,u,f,e,o){var c=k(n,u),s,l;return(i.trim(),s=i.fetch(c),s&&!et(s)&&!e)?s:(l=ut(it(ft(n,o),"GET",null,u,f).then((function(t){return t.id=t.id||n,h.toResourceGroup(t)})),f),i.store(c,l).catch((function(i){i&&i.status===fi&&r.AssetManager.notifyAssetDeleted(t.resourceGroupAssetType,n,g.ExtensionNames.Hubs,u);throw i;})))}function s(n,t,i,r){return u(n,t,i,r).then((function(n){return l.getLocationDisplayNames(t).then((function(t){return e(n,t)}))}))}function c(n,t,i,r){return u(n,t,i,r).then((function(n){var i=st(n,!0);return l.getLocationDisplayNames(t).then((function(n){return o(i,n)}))}))}function v(n){n?i.flushCacheWithPrefix(n+":"):i.flushCache()}function y(n,t){var r=k(n,t);i.remove(r)}function p(n,t){return ti("DELETE",ft(n),t,ot("deleteResourceGroup"))}function e(n,t){
var i=n.location||"";return w({locationString:t[a(i)]||i},n)}function o(n,t){var i=tt(n.location)||"";return w({locationString:f.observable(t[a(i)]||i)},n)}var i=new rt(ct);n.getResourceGroup=u;n.getResourceGroupWithStrings=s;n.getResourceGroupObservableWithStrings=c;n.flushCache=v;n.uncacheResourceGroup=y;n.deleteResourceGroup=p;n.mapResourceGroupToResourceGroupWithStrings=e;n.mapResourceGroupObservableToResourceGroupObservableWithStrings=o})(si=t.ResourceGroupClient||(t.ResourceGroupClient={})),(function(n){function t(n,t){return ti("GET",n,t,ot("getOperationResponse"))}n.getOperationResponse=t})(hi=t.ResourceManagerOperationsClient||(t.ResourceManagerOperationsClient={})),(function(n){function r(n,t,i){var r=[];return ut(o.callWithContinuation([n],(function(n){r=r.concat(n.map(s.toResource).filter((function(n){return!!n})))}),(function(n){throw n;}),t,i).then((function(){return r})),i)}function u(n,i,r,u){var e=k(n,i),f,o;return(t.trim(),f=t.fetch(e),f&&!et(f)&&!u)?f:(o=ut(ei(n,i).then((function(
t){return it(t,"GET",null,i,r).then((function(t){return t.id=t.id||n,s.toResource(t)}))})),r),t.store(e,o))}function e(n,i,r,u,f){var o=k(n,r),e,s;return(t.trim(),e=t.fetch(o),e&&!et(e)&&!f)?e:(s=Q(c.getAssetTypeViewModel(i,r)).then((function(t){var i=t.getProvidesResourcesContract();return Q(i&&i.getResource(n))})),t.store(o,s))}function p(n,t,r,f){return u(n,t,r,f).then((function(n){return l.getLocationDisplayNames(t).then((function(t){return i(n,t)}))}))}function b(n,t,r,u,f){return e(n,t,r,u,f).then((function(n){return l.getLocationDisplayNames(r).then((function(t){return i(n,t)}))}))}function d(n,t,i,r){return u(n,t,i,r).then((function(n){var i=st(n,!0);return l.getLocationDisplayNames(t).then((function(n){return y(i,n)}))}))}function h(n,t,i){return r(o.resourcesInResourceGroupApi(n),t,i)}function g(n,t,i,u){return ht((function(f){var e=f.resourcesInSubscriptionApi(n,u);return u?it(e,"GET",null,t,i).then((function(n){return n.value&&n.value.map(s.toResource).filter((function(n){return!!n}))})):r(e,t,i)})
)}function nt(n,t,i){return ht((function(u){return r(u.classicResourcesInSubscriptionApi(n),t,i)}))}function ft(n,t,r){return h(n,t,r).then((function(n){return l.getLocationDisplayNames(t).then((function(t){return n.map((function(n){return i(n,t)}))}))}))}function v(n,t,i,u){return ht((function(f){return r(f.resourcesLinkedToResourceApi(n,t),i,u)}))}function ot(n,t,r,u){return v(n,t,r,u).then((function(n){return l.getLocationDisplayNames(r).then((function(t){return n.map((function(n){return i(n,t)}))}))}))}function lt(n,i){n?t.flushCacheWithPrefix(a(n+":"+(i||""))):t.flushCache()}function at(n,i){var r=k(n,i);t.remove(r)}function i(n,t){var i=n.location||"";return w({locationString:t[a(i)]||i,trimmedName:(n.name||n.id||"").split("/").last()},n)}function y(n,t){var i=tt(n.location)||"";return w({locationString:f.observable(t[a(i)]||i),trimmedName:f.observable((tt(n.name)||tt(n.id)||"").split("/").last())},n)}var t=new rt(ct);n.getResource=u;n.getExtensionResource=e;n.getResourceWithStrings=p;n.getExtensionResourceWithStrings=
b;n.getResourceObservableWithStrings=d;n.getResourcesInResourceGroup=h;n.getResourcesInSubscription=g;n.getClassicResourcesInSubscription=nt;n.getResourcesInResourceGroupWithStrings=ft;n.getResourcesLinkedToResource=v;n.getResourcesLinkedToResourceWithStrings=ot;n.flushCache=lt;n.uncacheResource=at;n.mapResourceToResourceWithStrings=i;n.mapResourceObservableToResourceObservableWithStrings=y})(ci=t.ResourceClient||(t.ResourceClient={}));y={};t.registerResourceGroupDeleteWatcher=li;t.unregisterResourceGroupDeleteWatcher=ai;t.notifyResourceGroupDeleting=vi;t.notifyResourceGroupDeleteFailed=yi;t.validateResourceGroupName=pi}));define("HubsExtension/_generated/BladeReferences",["require","exports","Fx/Composition/Selectable"],(function(n,t,i){"use strict";var r;return (function(n){function r(n,t,i){return{onClosed:n,parameters:t,callbacks:i}}var t="HubsExtension",yt=(function(n){function i(i,u){return n.call(this,"NoCreateFlowBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference),
u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt;n.NoCreateFlowBladeReference=yt;u=(function(n){function i(i,u){return n.call(this,"Resources",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.ResourcesReference=u;f=(function(n){function i(i,u){return n.call(this,"BrowseAllResourcesBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.BrowseAllResourcesBladeReference=f;e=(function(n){function i(i,u){return n.call(this,"BrowseResourceBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.BrowseResourceBladeReference=e;o=(function(n){function i(i,u){return n.call(this,"BrowseResourceGroupBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.BrowseResourceGroupBladeReference=o;s=(function(n){function i(i,u){return n.call(this,"BrowseRecentResourcesBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.BrowseRecentResourcesBladeReference=s;h=(function(n){function i(i,u){return n.
call(this,"ResourceProperties",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.ResourcePropertiesReference=h;c=(function(n){function i(i){return n.call(this,"ParametersFileEditorBlade",t,i)||this}return __extends(i,n),i})(i.ParameterProviderBladeReference);n.ParametersFileEditorBladeReference=c;l=(function(n){function i(i){return n.call(this,"TemplateEditorBlade",t,i)||this}return __extends(i,n),i})(i.ParameterProviderBladeReference);n.TemplateEditorBladeReference=l;a=(function(n){function i(i,u,f){return n.call(this,"TemplateViewerBlade",t,r(f,i,u),{outputParameters:["stepOutput"]})||this}return __extends(i,n),i})(i.PdlBladeReference);n.TemplateViewerBladeReference=a;v=(function(n){function i(i,u){return n.call(this,"ArmActionsContextPane",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.ArmActionsContextPaneReference=v;y=(function(n){function i(i,u){return n.call(this,"ArmDataContextPane",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.
ArmDataContextPaneReference=y;p=(function(n){function i(i,u){return n.call(this,"ArmDataJsonBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.ArmDataJsonBladeReference=p;w=(function(n){function i(i,u){return n.call(this,"LocksBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.LocksBladeReference=w;b=(function(n){function i(i,u){return n.call(this,"DeploymentsListBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.DeploymentsListBladeReference=b;k=(function(n){function i(i,u){return n.call(this,"DeploymentDetailsOverviewBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.DeploymentDetailsOverviewBladeReference=k;d=(function(n){function i(i,u){return n.call(this,"DeploymentInputsBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.DeploymentInputsBladeReference=d;g=(function(n){function i(i,u){return n.call(this,"DeploymentOutputsBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);
n.DeploymentOutputsBladeReference=g;nt=(function(n){function i(i,u){return n.call(this,"DeploymentOperationPropertiesBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.DeploymentOperationPropertiesBladeReference=nt;tt=(function(n){function i(i,u){return n.call(this,"ResourceGroupQuickStartBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.ResourceGroupQuickStartBladeReference=tt;it=(function(n){function i(i,u){return n.call(this,"ResourceGroupCostsBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.ResourceGroupCostsBladeReference=it;rt=(function(n){function i(i,u){return n.call(this,"ResourceMenuBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.ResourceMenuBladeReference=rt;ut=(function(n){function i(i,u){return n.call(this,"MyAccessBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.MyAccessBladeReference=ut;ft=(function(n){function i(i,u){return n.call(this,"RPStatusBlade",t,r(
u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.RPStatusBladeReference=ft;et=(function(n){function i(i,u){return n.call(this,"ArmErrorsBlade",t,r(u,i),{isContextBlade:!0})||this}return __extends(i,n),i})(i.PdlBladeReference);n.ArmErrorsBladeReference=et;ot=(function(n){function i(i,u){return n.call(this,"ResourceTagsListBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.ResourceTagsListBladeReference=ot;st=(function(n){function i(i,u){return n.call(this,"BulkDeleteBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.BulkDeleteBladeReference=st;ht=(function(n){function i(i,u){return n.call(this,"ChooseColumnsBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.ChooseColumnsBladeReference=ht;ct=(function(n){function i(i,u){return n.call(this,"DeploymentDetailsBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.DeploymentDetailsBladeReference=ct;lt=(function(n){function i(i,u){return n.call(this,
"ResourceGroupMapBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.ResourceGroupMapBladeReference=lt;at=(function(n){function i(i,u){return n.call(this,"AssignTagsBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.AssignTagsBladeReference=at;vt=(function(n){function i(i,u){return n.call(this,"EditTagsBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.EditTagsBladeReference=vt})(r||(r={})),r}));define("HubsExtension/_generated/Microsoft_Azure_Marketplace/BladeReferences",["require","exports","Fx/Composition/Selectable"],(function(n,t,i){"use strict";var r;return (function(n){function r(n,t,i){return{onClosed:n,parameters:t,callbacks:i}}var t="Microsoft_Azure_Marketplace",f=(function(n){function i(i,u,f){return n.call(this,"GalleryFeaturedMenuItemBlade",t,r(f,i,u),{outputParameters:["resetMenuId","createTriggeredSignal"]})||this}return __extends(i,n),i})(i.PdlBladeReference),u;n.GalleryFeaturedMenuItemBladeReference=f;u=(function(
n){function i(i,u,f){return n.call(this,"GalleryResultsListBlade",t,r(f,i,u),{outputParameters:["inlineGalleryCreateOutputs"]})||this}return __extends(i,n),i})(i.PdlBladeReference);n.GalleryResultsListBladeReference=u})(r||(r={})),r}));define("HubsExtension/Browse/BrowseArea",["require","exports","f","i","o","ko","Fx/Composition/Selectable","FxHubs/MarketplaceRpc","FxHubs/RpcEndPoints","HubsExtension/_generated/BladeReferences","HubsExtension/_generated/ExtensionDefinition","HubsExtension/_generated/Microsoft_Azure_Marketplace/BladeReferences","HubsExtension/ArmHelpers/ArmApisStartup","HubsExtension/Common/CloudNameHelpers","HubsExtension/Common/HubsObservables","HubsExtension/Notifications/EventSubscriptionService","HubsExtension/ResourceMap/ResourceMapCommon"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function b(n){return(n||"").toLowerCase()}function ut(n){return b(n).trim()}function tt(n,t){var i=ut(n);return!t||!t.length||t.some((function(n){return ut(n)===i}))}function ct(
n,t){var i=ut(t&&t.name);return!n||b(n).split(" ").every((function(n){return i.indexOf(n)!==-1}))}function at(n,t){return function(i,u){var f=i.filter((function(n){return!n.isLocalEvent})).map((function(n){return{assetId:n.assetId,assetType:r.AssetManager.resourceAssetType,extensionName:null,cloudName:u}}));f.length&&a.internalNotifyAssetDeleted(f,"The event service notified "+n+" deleted.",t)}}function ei(n){var t=new kt;return t.attachEventWatch(w.allResourcesTypeKey,{resourceGroupDeleted:at("resource group",n),resourceDeleted:at("resource",n)}),t}function oi(n,t,i,r){return r===void 0&&(r=!0),v.addCloudNameToDynamicSelection(n,{cloudName:n,extension:c.definitionName,detailBlade:r?c.BladeNames.resourceMenuBlade:c.BladeNames.resourceProperties,detailBladeInputs:{id:t,referrerInfo:i}})}function si(n){return n&&n.resourceType&&!n.bladeName}function ft(n,t,i,r){var u=new ii.PdlBladeReference(i,t,{parameters:r});return t&&b(t)!==b(c.definitionName)&&(u.cloudName=n),u}function hi(n,t){return Q(s.
AssetTypes.mapAssetIdToDynamicSelectionAndIconEndPoint.invoke(et.client,d.Shell,{assetTriplet:n,cloudName:t})).then((function(n){return ft(t,n.selection.extension,n.selection.detailBlade,n.selection.detailBladeInputs)}))}function ci(n,t){return Q(s.AssetTypes.mapResourceIdToDynamicSelectionAndIconEndPoint.invoke(et.client,d.Shell,{resourceId:n,cloudName:t,forceBladeSelection:!0})).then((function(n){return ft(t,n.selection.extension,n.selection.detailBlade,n.selection.detailBladeInputs)}))}function dt(n,t){return!t||k.isResourceManagerId(t)&&(n||"").startsWith(b(t)+"/")}function li(n,t,i,r){var h=b(n.type),o=b(n.kind),u=t.excludedResourceTypes&&t.excludedResourceTypes[h],f,s,e;return!r&&u&&(u===!0||u[o]===!0)?!1:(f=b(t.kind),s=f===fi?"":f,t.kind&&b(s)!==o)?!1:(e=b(n.id),!dt(e,t.scope))?!1:!t.scope&&!ui(e)&&!i(n.id)?!1:ct(t.filter,n)&&tt(n.location,t.selectedLocations)}function ai(n,t,i){var r=b(n.id);return dt(r,t.scope)?!t.scope&&!i(n.id)?!1:ct(t.filter,n)&&tt(n.location,t.selectedLocations):
!1}var lt,nt,gt,ni,ti;u.defineProperty(t,"__esModule",{value:!0});var it=i.Base,et=r.Rpc,d=it.Constants,k=i.ViewModels.Services.ResourceTypes,ii=r.Composition.Selectable,g=i.Extension.ResourceRoutingType,vi=window,yi=it.Diagnostics.createLog(n),ri=k.isResourceId,ot=k.isResourceGroupId,ui=k.isTenantResource,pi=k.isSubscriptionId,st=k.parseResourceManagerDescriptor,ht=r.Extension.CloudName.addToModel,rt=a.filterSubscriptionsByScope,fi="(none)",wi=encodeURIComponent;lt=(function(){function n(){}return n})();t.DataContext=lt;t.getCreateBlade=i.memoizeQ((function(n){var t=n.sourceBladeOrPartName||c.BladeNames.resources,s,u,i,f;return n.marketplaceItemId?(s={cloudName:n.cloudName,extension:c.definitionName,detailBlade:c.BladeNames.noCreateFlowBlade,detailBladeInputs:ht(n.cloudName,{marketplaceItemId:n.marketplaceItemId})},u=n.createFlowPromise||Q(o.getCreateFlow({marketplaceGalleryItemId:n.marketplaceItemId,launchingContext:{source:[t,n.resourceType]},dontDiscardJourney:!0},n.cloudName)),n.onCreateFlowPromise&&
n.onCreateFlowPromise(u),i=new h.NoCreateFlowBladeReference(s.detailBladeInputs),u.then((function(r){if(r.isOldCreate)return it.Diagnostics.Telemetry.trace({action:"OldCreateFlowLaunched",source:t,data:{marketplaceItemId:n.marketplaceItemId}}),i.parameters.notSupported=!0,Q.resolve(i);var f=r.bladeSelection.detailBladeInputs,u=new e.ParameterProviderBladeReference(r.bladeSelection.detailBlade,r.bladeSelection.extension,{parameters:f,supplyInitialData:function(){return{}},receiveResult:function(){return{}},supplyProviderConfig:function(){return f.internal_bladeCallerParams&&f.internal_bladeCallerParams.providerConfig}});return r.bladeSelection.extension===c.definitionName?u.parameters=ht(n.cloudName,u.parameters):u.cloudName=n.cloudName,Q(u)})).catch((function(){return Q(i)}))):n.marketplaceMenuItemId?(f=void 0,f=ot(n.listScope)?n.marketplaceMenuItemId.indexOf("/")!==-1?new l.GalleryResultsListBladeReference({selectedSubMenuItemId:{menuItemId:n.marketplaceMenuItemId,dontDiscardJourney:!0,resourceGroup:
n.listScope,resourceGroupLocation:n.listScopeLocation,launchingContext:{source:"AddResourceCommand"}}},null):new l.GalleryFeaturedMenuItemBladeReference({selectedMenuItemId:n.marketplaceMenuItemId,dontDiscardJourney:!0,resourceGroup:n.listScope,resourceGroupLocation:n.listScopeLocation,launchingContext:{source:"AddResourceCommand"}},null):n.marketplaceMenuItemId.indexOf("/")!==-1?new l.GalleryResultsListBladeReference({selectedSubMenuItemId:{menuItemId:n.marketplaceMenuItemId,dontDiscardJourney:!0,launchingContext:{source:t+" "+n.resourceType}}},null):n.marketplaceMenuItemId===d.GalleryMenuItems.HomeMenuItem?v.addCloudNameToBladeReference(n.cloudName,new r.Composition.Selectable.PdlBladeReference(d.BladeNames.Hubs.CreateHubBlade,d.ExtensionNames.Marketplace,{parameters:{"package":null,additionalConfig:null,dontDiscardJourney:!0,selectedMenuItemId:null,createLanding:null}})):new l.GalleryFeaturedMenuItemBladeReference({selectedMenuItemId:n.marketplaceMenuItemId,dontDiscardJourney:!0,launchingContext:
{source:t+" "+n.resourceType}},null),Q(f)):void 0}));t.watchForResourceDeletes=ei;var vt="/write",yt="microsoft.resources/subscriptions/resourcegroups/write",pt="/delete",wt="microsoft.resources/subscriptions/resourcegroups/delete",bt="succeeded",kt=(function(){function n(){}return n.prototype.attachEventWatch=function(n,t){var i,r,u;this.disposeEventWatcher();i=vt;r=pt;b(n)===w.resourceGroupsTypeKey&&(i=yt,r=wt);u=function(n,t,i,r){return p.subscribeToArmEvent({source:null,operationNameRegex:n},(function(n,u){var f,e;r.resourceGroupCallback&&(f=n.filter((function(n){return b(n.status)===bt&&n.operationName===t&&ot(n.assetId)})),f.length&&r.resourceGroupCallback(f,u));r.resourceCallback&&(e=n.filter((function(n){return b(n.status)===bt&&n.operationName.endsWith(i)&&ri(n.assetId)})),e.length&&r.resourceCallback(e,u))}),100)};(t.writeToResourceGroup||t.writeToResource)&&(this._writeEventSubscription=u(i,yt,vt,{resourceGroupCallback:t.writeToResourceGroup,resourceCallback:t.writeToResource}));(t.
resourceGroupDeleted||t.resourceDeleted)&&(this._deleteEventSubscription=u(r,wt,pt,{resourceGroupCallback:t.resourceGroupDeleted,resourceCallback:t.resourceDeleted}))},n.prototype.disposeEventWatcher=function(){this._writeEventSubscription&&p.removeArmEventSubscription(this._writeEventSubscription);this._writeEventSubscription=null;this._deleteEventSubscription&&p.removeArmEventSubscription(this._deleteEventSubscription);this._deleteEventSubscription=null},n})();t.ArmEventWatcher=kt;t.makeResourceBladePromise=oi;t.checkNoBladeName=si;t.makeBladeReference=ft;t.mapAssetIdToBladeReference=hi;t.mapResourceIdToBladeReference=ci;t.showResource=li;t.showResourceGroup=ai;nt=(function(){function n(){this._currentSubscriptionMap={}}return n.prototype._getResourcesWithUris=function(n,t){var u=this,r=[];return Q(a.callBatchWithContinuation(t,(function(t){var f=i.makeArray(t);return n.sourceHandler(n,f,u,r)}),(function(){return n.partialErrors(!0)}),!1,n.cloudName,n.telemetry,!0)).then((function(){return r})
)},n.prototype._getSubscriptions=function(n,t){return n.scope?Q(f.observable([st(n.scope).subscription])):n.selectedSubscriptions?Q(f.pureComputed((function(){return n.selectedSubscriptions().map((function(n){return n.subscriptionId}))}))):t?Q(y.getSubscriptions(n.cloudName).then((function(n){return f.observable(n.map((function(n){return n.subscriptionId})))}))):Q(y.getSelectedSubscriptions(n.cloudName)).then((function(n){return f.pureComputed((function(){return n().map((function(n){return n.subscriptionId}))}))}))},n.prototype._updateSubscriptionMap=function(n){this._currentSubscriptionMap=i.extendArrayIntoMap({},n,b,i.wrap(!0))},n.prototype._buildResourceProcessor=function(n,t,i,r){var u=this,e=f.observable([]);return this._getSubscriptions(t,i).then((function(i){var f=function(){var n=[];u._getResourcesWithUris(t,r&&r(i())||[]).then((function(t){function u(n){var t=b(n.id);i[t]||(r.push(n),i[t]=!0)}var i={},r=[];n.forEach(u);t.forEach(u);e(r)})).finally((function(){t.loading(!1)}))};return i.subscribeAndRun(
n,(function(n){u._updateSubscriptionMap(n);f()})),Q(e)}))},n.prototype.matchSubscription=function(n){return this._currentSubscriptionMap[b(st(n).subscription)]},n})();t.BaseResourcesSource=nt;gt=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getResources=function(n,t){return this._buildResourceProcessor(n,t,!1,(function(n){for(var r=[],u=function(i){var u=[],f=rt(n.slice(i,i+20),t.scope,(function(n){u.push(n)}));f.length&&r.push({uri:a.resourcesAcrossSubscriptionsApi(f,t.selectedTypes,t.filter,u,t.selectedLocations,t.selectedResourceGroups,t.invertResourceGroupFilter),responseIsArrayType:!0})},i=0;i<n.length;i+=20)u(i);return r}))},t})(nt);t.AllResourcesSource=gt;ni=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getResources=function(n,t){return this._buildResourceProcessor(n,t,!1,(function(n){var i=[],r=rt(n,t.scope);return i.push.apply(i,r.map((function(n){return{uri:a.resourceGroupsInSubscriptionApi(
n),responseIsArrayType:!0}}))),i}))},t})(nt);t.ResourceGroupsSource=ni;ti=(function(n){function t(t){var i=n.call(this)||this;return i.usesSelectedSubs=!0,i._assetTypes=t,i.usesSelectedSubs=i._assetTypes.some((function(n){return n.routingType!==g.Tenant})),i}return __extends(t,n),t.prototype.getResources=function(n,t){var r=this;return this._buildResourceProcessor(n,t,!1,(function(n){var u=[],e=r._assetTypes.filter((function(n){return(n.routingType||g.Default)===g.Default&&tt(n.resourceType,t.selectedTypes)})).map((function(n){return n.resourceType})),o,f,s;if(e.length)for(o=function(i){var r=[],f=rt(n.slice(i,i+20),t.scope,(function(n){r.push(n)}));f.length&&u.push({uri:a.resourcesAcrossSubscriptionsApi(f,e,t.filter,r,t.selectedLocations,t.selectedResourceGroups,t.invertResourceGroupFilter),responseIsArrayType:!0})},f=0;f<n.length;f+=20)o(f);return s=r._assetTypes.filter((function(n){return n.routingType===g.ProviderProxy&&tt(n.resourceType,t.selectedTypes)})),s.forEach((function(r){for(var e=function(
f){var e=[],o=a.filterSubscriptionsByScopeByResourceGroup(n.slice(f,f+20),t.scope,(function(n){if(t.selectedResourceGroups&&t.selectedResourceGroups.length){var i=b(n);t.selectedResourceGroups.first((function(n){return b(n)===i}))&&e.push(n)}else e.push(n)}));t.scope||(e=i.union(e,t.selectedResourceGroups));o.length&&o.forEach((function(n){u.push({uri:a.providerProxyResourcesApi(n,r,t.filter,e,t.selectedLocations),responseIsArrayType:!0})}))},f=0;f<n.length;f+=20)e(f)})),r._assetTypes.filter((function(n){return n.routingType===g.Tenant})).forEach((function(n){u.push({uri:a.tenantResourcesApi({resourceTypeName:n.topLevelTenantAlias,apiVersion:n.apiVersion},t.filter,null,t.selectedLocations),responseIsArrayType:!0})})),u}))},t})(nt);t.ResourcesSource=ti}));define("HubsExtension/Common/UserSettingsHelper",["require","exports","f","i","o","FxHubs/CloudNameCommon","FxHubs/HubsSettingsSchema"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function v(n){return f.removeCloudNameFromId(n)}function s(
n,t){return f.addCloudNameToId(n,t,!1)}var t=i.Base,c=t.Diagnostics,l=r.Extension,a=r.Rpc,o=t.Constants.Shell,h;n.addCloudNameToUserSettingKey=s;h=(function(){function n(){}return n.initialize=function(t){if(n._rpcClient)throw new Error("rpcClient already initialized.");n._rpcClient=t||a.client},n.readSettings=function(t,i){return e.readHubsUserSettings.invoke(n._rpcClient,o,{settingsKeys:t,useShellGeneralStore:i})},n.writeSettings=function(t,i){return e.writeHubsUserSettings.invoke(n._rpcClient,o,{settings:t,priority:i})},n.readSettingsRpc=function(t,i){var f=l.getDescriptor(i.srcWindowId).cloudName,o=t.map((function(n){return s(n,f)})),r=t.first((function(n){return!~e.allowedUserSettingsKeys.indexOf(n)}));if(r)throw c.createIgnoreUnhandledRejectionError(i.srcWindowId+" is not allowed to read the user setting "+r+".");return n.readSettings(o).then((function(n){var t={};return u.getOwnPropertyNames(n).forEach((function(i){t[v(i)]=n[i]})),t}))},n})();n.UserSettingsHelper=h})(o||(o={})),o}));define(
"HubsExtension/Common/RecentResources",["require","exports","f","i","o","a","ko","FxHubs/HubsSettingsSchema","HubsExtension/ArmHelpers/ArmApisStartup","HubsExtension/Browse/BrowseArea","HubsExtension/HubsCommon","HubsExtension/ResourceMap/ResourceMapCommon","HubsExtension/Common/AssetTypeCache","HubsExtension/Common/HubsObservables","HubsExtension/Common/UserSettingsHelper"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";function rt(){if(!g)g=new it(1e4);return g}function k(n){return"/cloud/"+(n||d.Constants.DefaultCloudName).toLowerCase()}function w(n,t){return k(n)+t.toLowerCase()}function ut(n){return n?n.toLowerCase():n}function ft(){return Q(y.UserSettingsHelper.readSettings([o.Keys.recentResourcesSettings])).then((function(n){var t=n[o.Keys.recentResourcesSettings];return t?t:(t={version:1,data:[]},y.UserSettingsHelper.readSettings(["AssetMruList"],!0).then((function(n){var i=n.AssetMruList;return i&&i.forEach((function(n){typeof n.removedTimeStamp!="number"&&p.isResourceManagerId(
n.assetId)&&t.data.push({cloudName:n.cloudName,resourceId:n.assetId,timeStamp:n.timeStamp})})),t})))})).then((function(n){return n.version===1?n.data:[]}))}function tt(n,t){var u,f,r;if(!(i.keysLength(n)<=t))for(u=[],i.forEachKey(n,(function(t){u.push({timeStamp:n[t].timeStamp,key:t})})),f=i.stableSort(u,(function(n,t){return t.timeStamp-n.timeStamp})),r=t;r<f.length;r++)delete n[f[r].key]}var it;u.defineProperty(t,"__esModule",{value:!0});var d=i.Base,p=i.ViewModels.Services.ResourceTypes,b=i.tryImmediateResolve,nt=50,g;t.getRecentsManager=rt;it=(function(){function n(n){var t=this,f,o,u;this.initialLoad=e.observable(!1);this._sourceMap={};this._map={};this._assetTypesInformation={};this._logDelay=n;f=new r.TriggerableLifetimeManager;this._initialLoadPromise=a.getAssetTypesInformationPromise().then((function(n){return ft().then((function(r){t._sourceMap=i.convertArrayToMap(r,(function(n){return w(n.cloudName,n.resourceId)}));n.assetTypesInformation.subscribeAndRun(f,(function(n){t._assetTypesInformation=
i.convertArrayToMap(n,(function(n){return k(n.cloudName)+"/"+n.lowerCaseResourceType}),i.identity);t._validateEntriesFromSettings().then((function(){return tt(t._map,nt)})).then((function(){t._updateListFromMap();t.initialLoad(!a.partialAssetTypes())}))}))}))}));o=new h.ArmEventWatcher;u=function(n,i){n.forEach((function(n){t.removeRecent(i,n.assetId,!0)}))};o.attachEventWatch(l.allResourcesTypeKey,{resourceGroupDeleted:u,resourceDeleted:u})}return n.prototype._updateListFromMap=function(){if(this._list){var n=i.forEachKey(this._map,(function(n,t,i){i.push(t)}),[]);this._list(i.stableSort(n,(function(n,t){return t.timeStamp-n.timeStamp})))}},n.prototype._validateEntriesFromSettings=function(){var n=this,t={},f=[],e=[];return i.forEachKey(this._sourceMap,(function(r,u){var o,h,c,a,y,w,b;n._map[r]||(o=u.resourceId,h=k(u.cloudName)+"/",p.isSubscriptionId(o)?(c=n._assetTypesInformation[h+l.subscriptionsTypeKey],c&&(a=p.parseSubscriptionDescriptor(o),e.push(Q(v.getSubscriptionInfoPromise(a.subscription,u.cloudName)).
then((function(t){n._map[r]=i.extend2(n._sourceMap[r],{key:r,name:t.uniqueDisplayName,lowerCaseResourceId:o.toLowerCase(),assetTypeInformation:c})})).catch((function(){delete n._sourceMap[r]}))))):p.isResourceGroupId(o)?(y=n._assetTypesInformation[h+l.resourceGroupsTypeKey],y&&(t[r]=Q(s.resourceGroupApi(o)),f.push(t[r]))):(p.isResourceId(o)||p.isTenantResource(o))&&(w=p.buildResourceTypeFromResourceId(o).toLowerCase(),b=n._assetTypesInformation[h+w],b&&(t[r]=Q(s.resourceApi(o,u.cloudName)),f.push(t[r]))))})),Q.allSettled(f.concat(e)).then((function(){var u=r.getCloudMap();return i.forEachKey(t,(function(t,i){var r=n._sourceMap[t],f;i.isFulfilled()?(f=u.getOrSet(r.cloudName,{cloudName:r.cloudName,uriMap:{}}),f.uriMap[i.valueOf()]=r):delete n._sourceMap[t]})),u})).then((function(t){var r=[],f=s.makeResourceManagerTelemetry("cleanrecents");return t.all().forEach((function(t){var e=t&&u.keys(t.uriMap);e&&r.push(Q(s.callBatchWithContinuation(e,(function(r,u){var o=t.uriMap[e[u]],f=w(o.cloudName,o.resourceId),
h=k(o.cloudName)+"/",a,v,s;return p.isResourceGroupId(r.id)?(a=n._assetTypesInformation[h+l.resourceGroupsTypeKey],n._map[f]=i.extend2(n._sourceMap[f],{key:f,name:r.name,lowerCaseResourceId:r.id.toLowerCase(),assetTypeInformation:a,location:r.location})):p.isResourceId(r.id)&&(v=p.buildResourceTypeFromResourceId(r.id).toLowerCase(),s=n._assetTypesInformation[h+v],c.resourceUsesResourceMenu(r,s)?n._map[f]=i.extend2(n._sourceMap[f],{key:f,name:r.name,resourceId:r.id,resourceKind:ut(r.kind),lowerCaseResourceId:r.id.toLowerCase(),assetTypeInformation:s,location:r.location}):delete n._sourceMap[f]),!0}),(function(i){var r=t.uriMap[i.api];if(i.reason)switch(i.reason.httpStatusCode){case 404:delete n._sourceMap[w(r.cloudName,r.resourceId)];break;case 403:delete n._sourceMap[w(r.cloudName,r.resourceId)]}}),!1,t.cloudName,f,!1)))})),Q.allSettled(r)}))},n.prototype._storeToSettings=function(){var t,r,n;return this._list&&this._updateListFromMap(),t=i.forEachKey(this._map,(function(n,t,i){i.push({cloudName:
t.cloudName||d.Constants.DefaultCloudName,resourceId:t.resourceId,timeStamp:t.timeStamp})}),[]),r=(n={},n[o.Keys.recentResourcesSettings]={version:1,data:t},n),Q(y.UserSettingsHelper.writeSettings(r))},n.prototype._addResourceAccess=function(n){var t=this;return b(this._initialLoadPromise,(function(){return n.forEach((function(n){var i=t._map[n.key];i?(i.resourceKind=n.resourceKind,i.timeStamp=n.timeStamp):(i=n,t._map[n.key]=i);tt(t._map,nt)})),t._storeToSettings()}))},n.prototype.addRecent=function(n,t,i,r,u,f){var e=this;return b(this._initialLoadPromise,(function(){var h=p.buildResourceTypeFromResourceManagerId(i).toLowerCase(),s=e._assetTypesInformation[k(t)+"/"+h],o;return s?(o={key:w(t,i),cloudName:t,resourceId:i,timeStamp:Date.now(),name:r,resourceKind:f,lowerCaseResourceId:i.toLowerCase(),assetTypeInformation:s,location:u},e._logDelay&&n)?d.Promises.cancelOnDispose(n,Q.delay(e._logDelay)).then((function(){return e._addResourceAccess([o])})):e._addResourceAccess([o]):Q(!1)}))},n.prototype.
removeRecent=function(n,t,i){var r=this;return b(this._initialLoadPromise,(function(){var f=w(n,t),o=r._map[f],e=!1;return o&&(delete r._map[f],e=!0),i&&u.keys(r._map).filter((function(n){return n.startsWith(f+"/")})).forEach((function(n){delete r._map[n];e=!0})),e?r._storeToSettings():Q(!1)}))},n.prototype.clear=function(){var n=this;return b(this._initialLoadPromise,(function(){return n._map={},n._storeToSettings()}))},u.defineProperty(n.prototype,"recentsList",{get:function(){var t=this,n=this._list;return n||(n=this._list=e.observableArray([]),b(this._initialLoadPromise,(function(){t._updateListFromMap()}))),n},enumerable:!0,configurable:!0}),n})()}));define("HubsExtension/Common/BrowseData",["require","exports","f","i","o","HubsExtension/ArmHelpers/ArmApiEndpoints","HubsExtension/ArmHelpers/ArmApisStartup","HubsExtension/ArmHelpers/Models/ArmResource","HubsExtension/ArmHelpers/Models/ArmResourceGroup","HubsExtension/Common/HubsObservables","HubsExtension/ResourceMap/ResourceMapCommon"],(function(
n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(t){function ut(n,t,i,r,u){return e.call(n,t,i,r,u)}function ft(n){return new p(n)}function et(n){var i="unknown error",r,u,f,t;return n.length<1?{error:i,message:i}:(t=n[0],t&&t.statusText&&(r=t.statusText,f=t.status,u=t.code),{error:t,message:r||JSON.stringify(t),status:f,code:u,stack:t.stack})}function v(n){return n.resourceTypes&&n.resourceTypes.length===1&&n.resourceTypes[0].toLowerCase()===c.resourceGroupsTypeKey}function l(n){return n.resourceGroupId!==undefined}function ot(n){return v(n)?1:l(n)?0:20}function st(n){var t=n.token.skipSubs||0,s=n.token.typeIndex||0,r,h,f,o;if(v(n))return r=w(n.subscriptions.slice(t,t+n.subscriptionGroupSize),n.scope),r.length?e.resourceGroupsInSubscriptionApi(r[0]):null;if(l(n))return h=n,e.resourcesInResourceGroupApi(h.resourceGroupId);var u=n,c=n.resourceTypes,a=n.filter;if(u.routingType===y.Tenant){var i=(u.assetTypeInformation||[])[s],p=i&&i.apiVersion,b=i&&i.topLevelTenantAlias;return e.
tenantResourcesApi({resourceTypeName:b||c[s],apiVersion:p},a)}if(f=[],o=w(n.subscriptions.slice(t,t+n.subscriptionGroupSize),n.scope,(function(n){f.push(n)})),u.routingType===y.ProviderProxy)throw new Error("Unhandled provider proxy routing");return o.length?e.resourcesAcrossSubscriptionsApi(o,c,a,f,n.locations,n.resourceGroups):null}function ht(n){var i=n.resourceTypes,r=n.locations,u=n.cloudName,o=n.scope,f=n.telemetry,e,t;return v(n)?{resourceTypes:i,locations:r,scope:o,cloudName:u,telemetry:f}:l(n)?(e=n,{resourceTypes:i,locations:r,resourceGroupId:e.resourceGroupId,showHiddenKinds:e.showHiddenKinds,cloudName:u,telemetry:f}):(t=n,{resourceTypes:i,locations:r,scope:o,kind:t.kind,assetTypeInformation:t.assetTypeInformation,cloudName:u,routingType:t.routingType,excludedTypes:t.excludedTypes,telemetry:f})}function b(n,t,i){var e=(t.type||"").toLowerCase(),u=(t.kind||"").toLowerCase(),r=n.excludedTypes&&n.excludedTypes[e],f;return r===!0?!1:(f=!i&&r&&r[u]===!0,a.isResourceId(n.scope)&&!t.id.
toLowerCase().startsWith(n.scope.toLowerCase()+"/"))?!1:n.kind&&(!t.kind&&n.kind!=="(none)"||t.kind&&n.kind!==u)?!1:!f}function ct(n,t){var i,r;return v(n)?a.isResourceGroupId(n.scope)||a.isResourceId(n.scope)?!1:(i=n.filter?t.name.toLowerCase().indexOf(n.filter.toLowerCase())!==-1:!0,!!i&&n.locations&&n.locations.length&&(i=n.locations.some((function(n){return t.location.toLowerCase()===n.toLowerCase()}))),i):l(n)?a.isResourceId(t.id)?(r=n,b(n,t,r.showHiddenKinds)&&(n.filter?t.name.toLowerCase().indexOf(n.filter.toLowerCase())!==-1:!0)):!1:b(n,t,!1)}var k=i.Base,d=k.Diagnostics,g=r.Extension,a=i.ViewModels.Services.ResourceTypes,nt=i.Data,y=i.Extension.ResourceRoutingType,tt=window,it=tt.HubsExtensionBrowseMockAjax||ut,rt=d.createLog(n),w=e.filterSubscriptionsByScope,p;t.bladeMessageWrapper={queryErrors:{},bladeInfoMessage:{}};t.createBrowseDataForEntity=ft;p=(function(){function n(n,t){t===void 0&&(t=6e4);var e=r.getCloudMap(),p=r.getCloudMap();f.armEndpoints.forEach((function(n){var t=h.
getLocationDisplayNames(n.cloudName).then((function(t){e.set(n.cloudName,t)}));p.set(n.cloudName,t)}));this.resourceCache=new nt.QueryCache({entityTypeName:n,evictionDelay:t,sourceUri:function(n){return n.token&&n.token.serverToken||st(n)},httpMethod:"GET",navigation:{loadByContinuationToken:function(n,t,r){var u=r?null:n.metadata()?n.metadata().continuationToken:null,f=n.fetch(i.extend({filter:t.filter?t.filter.trim():null,token:u?JSON.parse(u):{},subscriptions:t.subscriptions||[],subscriptionGroupSize:t.subscriptionGroupSize||ot(t)},ht(t))),e=!t.refresh?Q.resolve(null):Q(n.refresh());return Q(f).then((function(){return e}))}},serializeParams:function(n){var s,t;n.cloudName=g.normalizeCloudName(n.cloudName);var r=JSON.stringify(n.token),f=n.filter,e=n.cloudName,h=n.subscriptions,c=n.scope,o=n.refreshId||"";return v(n)?JSON.stringify([o,e,c,r,f].concat(h).concat(n.resourceTypes).concat(n.locations)):l(n)?(s=n,JSON.stringify([o,e,r,f,s.resourceGroupId,s.showHiddenKinds])):(t=n,JSON.stringify(
i.merge([o,t.routingType,e,c,t.kind,r,f],h,t.resourceTypes,t.locations,u.keys(t.excludedTypes||{}))))},supplyData:function(n,t,u,f,e){var o=e&&e.cloudName,s=e&&e.telemetry;return!t||e.subscriptions.length===0&&!l(e)?Q(i.clone({params:e})):p.get(o).then((function(){return Q(it(t,n,null,o,s)).catch((function(n){throw r.Azure.buildSimplifiedError(n&&n.jqXHR||n);}))})).then((function(n){return i.extend({response:n},{params:e})})).catch((function(){for(var n,t,u=[],r=0;r<arguments.length;r++)u[r]=arguments[r];return n=et(u),t=n.status,t!==0&&t!==404&&t!==403&&rt.warning("Failed to get browse data: {0} - {1} - {2} {3}".format(n.error,n.message,t||"",n.stack||"")),i.extend({error:{}},{params:e})}))},processServerResponse:function(n){var t=n.params,w=n.error&&[n.error],h=t.token||{},i,v=[],r,p,u,f;return n.response&&(i=n.response.nextLink,n.response.value&&(v=n.response.value.map((function(n){return a.isResourceGroupId(n.id)?s.toResourceGroup(n):o.toResource(n)})).filter((function(n){return n&&ct(t,n)})).
map((function(n){return a.isResourceGroupId(n.id)?c.ResourceGroupClient.mapResourceGroupToResourceGroupWithStrings(n,e.get(t.cloudName)):c.ResourceClient.mapResourceToResourceWithStrings(n,e.get(t.cloudName))})))),p=t,p.routingType!==y.Tenant?(u=h.skipSubs||0,i?r={skipSubs:u,serverToken:i}:!l(t)&&!t.scope&&t.subscriptionGroupSize>0&&u+t.subscriptionGroupSize<t.subscriptions.length&&(r={skipSubs:u+t.subscriptionGroupSize})):(f=h.typeIndex||0,i?r={typeIndex:f,serverToken:i}:f+1<t.resourceTypes.length&&(r={typeIndex:f+1})),{data:v,partialErrors:w,navigationMetadata:{continuationToken:JSON.stringify(r)}}}})}return n})();t.BrowseData=p})(l||(l={})),l}))