define("MsPortalImpl/Base/JQueryExtensions",["require","exports","f","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f){"use strict";var e;return (function(){function l(t,r,f){var e=i.find(t,(function(t){var r=n(t);return!r.hasClass(s)&&!r.hasClass("fxs-display-none")&&!i.startsWith(r.attr("tabindex"),"-")&&u.isVisible(r)&&(!f||f(r))}),r?-1:0);return n(e||[])}function e(t){return function(i){var r=this;return[h,c].reduce((function(u,f){if(!(u&&u.length)){var e=n(f,r).toArray();return l(e,t,i)}return u}),null)}}var r=u.findByClassName,o=window,n=jQuery,s="msportalfx-skip-initial-focus",t=n.fn,h="select, button, [tabindex=0], input, textarea",c="a";t.setEvents=function(){for(var n,i,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return n=this,i=function(t){var i=function(){return n[t].apply(n,arguments)};r.forEach((function(n){var u=n[0],t=n[1],r;typeof t=="function"?i(u,t):(r=n[2],r&&i(u,t,r))}))},i("on"),{dispose:function(){n&&(i("off"),n=null)}
}};t.findByClassName=function(n){return r(this,n)};t.findFirstTabbable=e();t.findLastTabbable=e(!0);t.isInScrollView=function(n){var u,t=n?this.closest("."+n):u=this.scrollParent();if(!t.length||!t[0].offsetParent||!t.is(u||this.scrollParent())&&!this.isInScrollView())return!1;var i=t.offset().top,f=i+t.height(),r=this.offset().top,e=r+this.height(),o=r>=i&&r<=f,s=e<=f&&e>=i;return o&&s};t.handleTransitionEndOnce=function(t,i,r){var s=this,u,h=!1,e;this.on(f.default.transitionend,u=function(n){for(var e,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];(e=n&&n.originalEvent,e&&e.propertyName!==t)||h||(h=!0,s.off(f.default.transitionend,u),r.apply(s,[n].concat(o)))});return e=function(){var i=n.Event("transitionend",{originalEvent:{propertyName:t}});u(i)},n.fx.off?e():o.setTimeout(e,i),this};n.enableAnimations=function(t){var i="fxs-transition-off-style-head-marker",f=n("<style/>").addClass(i).append("* {transition: none !important;-webkit-animation-iteration-count: .5 !important;animation-iteration-count: .5 !important;-webkit-animation-duration: 0s !important;animation-duration: 0s !important;-webkit-animation-delay: 0s !important;animation-delay: 0s !important;}"),
u=n("head");n.fx.off=!t;t?r(u,i).remove():r(u,i).length===0&&u.append(f)}})(e||(e={})),e}));define("MsPortalImpl/Extension/Extension.DefinitionValidator",["require","exports","f","o","a","ko"],(function(n,t,i,r,u,f){"use strict";function s(n,t){g(n,(function(n,i){i!==undefined&&t(n,i)}))}function nt(n){var i=new h,t=i.errors;return n?(s(n,(function(i,r){switch(i){case"name":e("Extension name",r,t);break;case"version":case"hash":case"schemaVersion":case"sdkVersion":case"buildDescription":e(i,r,t);break;case"isPreview":a(i,r,t);break;case"assetTypes":o(i,r,t);break;case"blades":tt(n,r,t);break;case"startBoardParts":et(r,t);break;case"partsCatalog":pt(r,t);break;case"commandsCatalog":yt(r,t);break;case"commandGroups":at(r,t);break;case"htmlTemplates":st(r,t);break;case"styleSheets":ht(r,t);break;case"galleryService":ct(r,t);break;case"dashboardProvider":lt(r,t);break;case"requireConfig":break;default:t.push("Unexpected attribute '{0}' on definition.".format(i))}})),i):(t.push("Definition is null or undefined."),
i)}function e(n,t,i){typeof t!="string"&&i.push("{0} is not a valid string.".format(n))}function a(n,t,i){typeof t!="boolean"&&i.push("{0} is not a valid boolean.".format(n))}function o(n,t,i){var r=u.isArray(t);return r||i.push("The '{0}' property is not a valid array.".format(n)),r}function tt(n,t,i){t&&o("blades",t,i)&&t.forEach((function(t,r){v(n,t,r,i)}))}function v(n,t,i,r){var u=t.name;t.inputs&&o("Blade: {0}. Property: blades[{1}].inputs".format(u,i),t.inputs,r);t.optionalInputs&&o("Blade: {0}. Property: blades[{1}].optionalInputs".format(u,i),t.optionalInputs,r);o("Blade: {0}. Property: blades[{1}].lenses".format(u,i),t.lenses,r)&&t.lenses.forEach((function(n,t){var f="Blade: {0}. Lens: {1}. Property: blades[{2}].lenses[{3}].".format(u,n.name,i,t);n.partInstances&&o(f,n.partInstances,r)&&n.partInstances.forEach((function(f,e){var o="Blade: {0}. Lens: {1}. Part: {2}. Property: blades[{3}].lenses[{4}].partInstances[{5}]".format(u,n.name,f.name,i,t,e);p(o,f,r)}))}));t.permissions&&o("Blade: {0}. Property: blades[{1}].permissions".
format(u,i),t.permissions,r)&&t.permissions.forEach((function(n,t){c("Blade: {0}. Property: blades[{1}].permissions[{2}]".format(u,i,t),n,t,r)}));it(t.toolbar,"Blade: {0}. Property: blades[{1}].toolbar".format(u,i),r);rt(t.actionBar,"Blade: {0}. Property: blades[{1}].actionBar".format(u,i),r)}function it(n,t,i){n&&(n.source?y(n.source,t+".source",i):i.push("Source not specified for toolbar. "+t))}function rt(n,t,i){n&&n.source&&y(n.source,t+".source",i)}function y(n,t,i){n.property&&e(t+".property",n.property,i);n.optional&&typeof n.optional!="boolean"&&i.push("The attribute 'optional' should be of type boolean. "+t);n.isIdentityInput&&typeof n.isIdentityInput!="boolean"&&i.push("The attribute 'isIdentityInput' should be of type boolean. "+t);o(t+".valuesFrom",n.valuesFrom,i)&&n.valuesFrom.forEach((function(n,r){ut(t+".valuesFrom[{0}]".format(r),n,i)}))}function ut(n,t,i){switch(t.referenceType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;default:i.push("Unknown reference type '{0}' found for {1}.referenceType.".
format(t.referenceType,n))}e(n+".property",t.property,i);t.part&&e(n+".part",t.part,i)}function ft(n,t,i){switch(t.sourceType){case 0:t.providerKey&&i.push("Asset ID source source type of FromInput with provider key (should be null) found for {0}.sourceType.".format(n));break;case 1:t.providerKey||i.push("Asset ID source source type of FromProvider with missing provider key found for {0}.sourceType.".format(n));e(n+".providerKey",t.providerKey,i);break;case 2:t.providerKey||i.push("Asset ID source source type of FromSourceProvider with missing provider key found for {0}.sourceType.".format(n));e(n+".providerKey",t.providerKey,i);break;default:i.push("Unknown asset ID source source type '{0}' found for {1}.sourceType.".format(t.sourceType,n))}e(n+".property",t.property,i)}function c(n,t,i,r){var u,f;switch(t.permissionType){case 0:u=t;u.extensionName&&e(n+".extensionName",u.extensionName,r);e(n+".assetType",u.assetType,r);u.assetId?ft(n+".assetId",u.assetId,r):r.push("Permission missing assetId found for {0}.assetId.".
format(n));e(n+".action",u.action,r);break;case 1:f=t;switch(f.requirement){case l.All:case l.Any:break;default:r.push("Unknown permission set requirement '{0}' found for {1}.requirement.".format(f.requirement,n))}o(n+".permissions",f.permissions,r)&&f.permissions.forEach((function(t,i){c("{0}.permissions[{1}]".format(n,i),t,i,r)}));break;default:r.push("Unknown permission type '{0}' found for {1}.permissionType.".format(t.permissionType,n))}}function et(n,t){o("startBoardParts",n,t)&&n.forEach((function(n,i){p("startBoardParts[{0}]".format(i),n,t)}))}function p(n,t,i){t.reference||t.inline?t.reference&&t.inline?i.push("'reference' and 'inline' properties cannot be set at the same time on PartInstanceDefinition. Property: {0}".format(n)):t.reference&&!t.reference.partTypeName?i.push("'partTypeName' property is required on part reference. Property: {0}".format(n)):t.inline&&w(n,t.inline,i):i.push("'reference' or 'inline' property required on PartInstanceDefinition. Property: {0}".format(n))}
function w(n,t,i){t&&(ot(n,t.partState,i),t.permissions&&o("{0}.permissions".format(n),t.permissions,i)&&t.permissions.forEach((function(t,r){c("{0}.permissions[{1}]".format(n,r),t,r,i)})))}function ot(n,t,i){if(t){var e=t.inputIdentityProperties||[],f=t.sharedProperties||[],o=e.concat(f.map((function(n){return n.property}))),s=f.map((function(n){return n.key})),r=b(o),u=b(s);r&&r.length>0&&i.push("Part view model properties cannot be used in multiple part settings. Duplicated properties: '{0}'. Path: '{1}'.".format(JSON.stringify(r),n));u&&u.length>0&&i.push("Shared key settings cannot be used in multiple part settings. Duplicated keys: '{0}'. Path: '{1}'.".format(JSON.stringify(u),n))}}function b(n){var t={},i=[];return(n||[]).forEach((function(n){!t[n]||i.push(n);t[n]=!0})),i}function st(n,t){s(n,(function(n,i){typeof i!="string"&&(e("htmlTemplates['{0}'].file".format(n),i.file,t),e("htmlTemplates['{0}'].content".format(n),i.content,t))}))}function ht(n,t){u.isArray(n)?n.forEach((function(n,i)
{e("StyleSheet at position {0}".format(i),n,t)})):t.push("Invalid type for 'styleSheets' property on definition.")}function ct(n,t){var i;s(n,(function(n,r){switch(n){case"serviceViewModel":i=r;break;default:t.push("Unexpected properties on 'galleryService' property of definition.")}}));e("galleryService.serviceViewModel",i,t)}function lt(n,t){var i=n.viewModel;i&&typeof i=="string"||t.push("The view model of dashboard provider must be non-empty string.")}function at(n,t){n&&o("commandGroups",n,t)&&n.mapMany((function(n){return n.commands})).forEach((function(n){n.reference&&vt(n,t)}))}function vt(n,t){if(n&&n.reference){var i=!1;s(n,(function(n){n!=="name"&&n!=="bindings"&&n!=="reference"&&(i=!0)}));i?t.push("Command reference can only define 'name' and 'bindings' properties. Definition: {0}".format(f.toJSON(n))):n.reference.commandType||t.push("Command reference must specify the 'commandType' property. Definition: {0}".format(f.toJSON(n)))}}function yt(n,t){n&&o("commandsCatalog",n,t)&&n.forEach(
(function(n){var i="Commands in 'commandsCatalog' ";n.name||t.push(i+"must have names.");!n.reference||t.push(i+"cannot specify a 'reference' property.")}))}function pt(n,t){n&&o("partsCatalog",n,t)&&n.forEach((function(n){k(n,t)}))}function wt(n,t){e("name",n.name,t);e("moduleId",n.moduleId,t)}function k(n,t){n.inputDefinitions&&o("PartType: {0}. Property: inputDefinitions".format(n.name),n.inputDefinitions,t);n.reference&&bt(n,t);w("PartType: {0}".format(n.name),n,t)}function bt(n,t){(n.reference.bindings||[]).forEach((function(i){(i.valuesFrom||[]).forEach((function(i){i.referenceType!==7&&i.referenceType!==9&&i.referenceType!==5&&t.push("Adapted Part: {0} can only have Adapter, AdapterInput and Constant bindings for its referenced part.".format(n.name))}))}))}var h;r.defineProperty(t,"__esModule",{value:!0});var d=i.Extension,l=d.SetRequirement,g=i.forEachKey;h=(function(){function n(){this.errors=[]}return n.prototype.valid=function(){return!this.errors.length},n})();t.ValidationResult=h;t.
validateDefinition=nt;t.validateIsString=e;t.validateIsBoolean=a;t.validateIsArray=o;t.validateBlade=v;t.validateControl=wt;t.validatePartType=k}));define("MsPortalImpl/Extension/Extension.Manifest",["require","exports","f","MsPortalImpl/Extension/Extension.DefinitionValidator"],(function(n,t,i,r){"use strict";var u;return (function(n){function f(n){var t=new r.ValidationResult,i,f;return n?((typeof n.name!="string"||u(n.name)||n.name.indexOf("!")>=0)&&(f="The extension manifest should specify a valid name. This name is obtained from the <Extension> tag in PDL. This name should be a string and cannot be empty or whitespace. It also cannot contain the ! character. The recommended naming convention for an extension name is to follow the pattern {Company}_{BrandOrSuite}_{ProductOrComponent} (e.g. Microsoft_Azure_Insights).",t.errors.push(f)),n.assetTypes&&r.validateIsArray("manifest.assetTypes",n.assetTypes,t.errors)&&n.assetTypes.forEach((function(i){e(i,n.name,t.errors)})),n.initializationUris||
(n.initializationUris=[]),t):(i="Manifest was not specified for the extension. Ensure that you passing a valid manifest to the FxExtension.register/FxExtension.registerAmd call that is used to register your extension with the portal.",t.errors.push(i),t)}function t(n,t,i,r){n.push(t.format(i,r))}function e(n,r,f){var e=n.name;if(u(e)&&t(f,"The name for the asset type in manifest '{0}' was not specified.",r),n.browseType!==undefined&&typeof n.browseType!="number"&&t(f,"The browse type for the asset type '{0}' in manifest '{1}' was not a number.",e,r),n.browseServiceViewModel&&typeof n.browseServiceViewModel!="string"&&t(f,"The browse service view model for the asset type '{0}' in manifest '{1}' was not a string.",e,r),n.browseLinkUri&&typeof n.browseLinkUri!="string"&&t(f,"The browse link URI for the asset type '{0}' in manifest '{1}' was not a string.",e,r),n.privateBrowse!==undefined&&typeof n.privateBrowse!="boolean"&&t(f,"The private browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",
e,r),n.browseRequiresRdfe!==undefined&&typeof n.browseRequiresRdfe!="boolean"&&t(f,"The requires RDFE browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",e,r),n.browseRequirements!==undefined&&typeof n.browseRequirements!="number"&&t(f,"The browse requirements was present for the asset type '{0}' in manifest '{1}' was not a number.",e,r),n.browseType!==undefined){switch(n.browseType){case 0:n.browseServiceViewModel||t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to use a service view model but there was no service view model.",e,r);break;case 1:n.browseServiceViewModel&&t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's resource type but there was a service view model.",e,r);break;case 2:n.browseServiceViewModel&&t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's blade but there was a service view model.",e,r);break;case 3:n.browseLinkUri||t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to be a service link but there was no link URI.",
e,r)}n.privateBrowse!==undefined&&n.browseType===undefined&&t(f,"The private browse flag was present for the asset type '{0}' in manifest '{1}' but there was browse type.",e,r);n.browseType!==0&&n.browseServiceViewModel&&t(f,"The asset type '{0}' in manifest '{1}' has a browse service but doesn't have service view model browse type.",e,r);u(n.pluralDisplayName)&&u(n.text)&&t(f,"The pluralDisplayName for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",e,r);i.isNullOrUndefined(n.icon)&&t(f,"The icon for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",e,r)}else n.browseServiceViewModel!==undefined?n.browseType=0:n.privateBrowse!==undefined&&t(f,"The asset type '{0}' in manifest '{1}' has a private blade flag but no browse type.",e,r);n.gridColumnsServiceViewModel&&typeof n.gridColumnsServiceViewModel!="string"&&t(f,"The grid columns service view model for the asset type '{0}' in manifest '{1}' was not a string.",
e,r);n.dynamicBladeServiceViewModel&&typeof n.dynamicBladeServiceViewModel!="string"&&t(f,"The dynamic blade service view model for the asset type '{0}' in manifest '{1}' was not a string.",e,r);n.propertyProviderServiceViewModel&&typeof n.propertyProviderServiceViewModel!="string"&&t(f,"The property provider service view model for the asset type '{0}' in manifest '{1}' was not a string.",e,r)}var u=i.isNullOrWhiteSpace;n.validate=f})(u||(u={})),u}));define("MsPortalImpl/Extension/ViewModelManager",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function e(n,i,r){t[n]={name:n,modulePath:i,factory:r}}function o(n,t,i){r[n]={name:n,modulePath:t,factoryWithState:i}}function s(n,t,i){u[n]={name:name,modulePath:t,factoryWithPrefix:i}}function h(n,e,o){var s=null,h=null,c=i.Helpers.Deferred();return(e in t?(s=t[e].modulePath,h=t[e].factory):e in r&&(s=r[e].modulePath,h=function(n){return r[e].factoryWithState(n,o)}),f(u,(function(t,i){e.startsWith(t)&&(s=i.modulePath,
h=function(t){return i.factoryWithPrefix(t,o,e,n)})})),s)?(i.require(s).then((function(n){c.resolve(h(n))}),(function(n){c.reject(n.message)})),c.promise()):null}var t={},r={},u={},f=i.forEachKey;n.register=e;n.registerWithState=o;n.registerPrefix=s;n.resolve=h})(r||(r={})),r}));define("MsPortalImpl/Extension/Extension",["require","exports","f","i","o","ko","MsPortalImpl/UI/Compositions/UI.Composition.CloudName","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.DefinitionValidator","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Extension/Extension.Manifest","MsPortalFx/Globalization","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Parts/Parts","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Base/JQueryExtensions"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function pr(n,t){if(!lr)return!1;var i=t&&t.supportsWebWorkers&&
t.supportsWebWorkers.toLowerCase()==="true",r=Math.random()<(t&&t.flightWebWorkers||0);return n=n.toLowerCase(),ar==="true"?ci.indexOf(n)!==-1||i||r:!1}function wr(n){return n&&n.formatCulture===ir&&n.displayLanguage===tr}function br(n){return n.replace(/\\/g,"\\\\").replace(/\'/g,"\\'")}function kr(n,t){var i=new gt;return new kt(n,t,i)}function dr(n){return bt[n]||(bt[n]={})}function gr(n){for(var r=oi["*"].slice()||[],u=0,t=n.obsoleteBundlesBitmask;t;t>>=1,u++)t%2&&i.pushUnique(r,oi[u]);return r}function li(n,r){var u=dr(n.name);return u[r]||(u[r]=i.union(r&1&&gr(n),r&2&&i.union(sr,t.patchUris)))}function nu(n,t,i){for(var r=[],u=Q(),f=function(){r.length<t&&(u=u.then((function(){if(r.length<t)return i().then((function(n){r.push(n)})).catch((function(n){nt.error(n,6)}))})))},e=0;e<t;e++)f();return{getItem:function(){return Q.delay(or).then(f),r.pop()},size:function(){return r.length}}}function tu(n,t,i){n.styleSheets&&v.injectStyles(t,{extensionWindowId:i,styleSheets:n.styleSheets.map((function(
n){return{file:"",content:n}}))})}var b,k,lt,bt,kt,ft,dt,ai,gt,at;u.defineProperty(t,"__esModule",{value:!0});var it=r.Extension,vi=r.TelemetryContext,st=i.Base,yi=st.UriBuilder,ut=MsPortalEarly.ExtensionLoader,et=st.Constants,pi=et.ExtensionNames.Hubs,vt=st.Diagnostics,wi=vt.Telemetry,ni=r.Rpc,bi=i.Hubs.Notifications.NotificationStatus,ti=i.Helpers.Deferred;t.patchUris=[];var g=window,ot=g.fx.getTimestamp,ki=i.isNullOrUndefined,di=$("head"),nt=vt.createLog(n),d=g.fx.environment,gi=d.cdn,nr="FxCdnIndex"+gi.index,tr=l.displayLanguage,ir=l.formatCulture,rr=!!d.trace.extensionmanager,iu=rr?function(n){nt.verbose(n)}:i.noop,ii=st.getVersionFromString,ri=ii(d.sdkVersion),ui=i.getFeatureValue("extloadtimeout"),yt=ui&&parseInt(ui)||9e4,ur=d.relex,fi=a.Shell,fr="data-extensionname",ht="ExtensionManager",pt=3,ct=(pt+1)*2,rt=wi,er=vi,ei=2e4,or=4e3,oi=d.extensionScripts,sr=d.postScripts,si=0,hi=0,hr=ot(),cr=i.forEachKey,wt=i.startTimer,lr=[g.Worker,g.fetch,g.Promise,g.Blob].indexOf(undefined)===-1,
ci=(d.features.webworker||"").toLowerCase().split(","),ar=ci.shift(),vr=document.getElementById("extensionIframes"),tt=ut.ExtensionLoadTracePoints,yr=i.getFeatureValue("prefetchinit")&&d.clientOptimizations==="true";t.canUseManifest=wr;t.escapeSingleQuote=br;t.initialRetryDelay=yt,(function(n){n[n.NotLoaded=0]="NotLoaded";n[n.FirstResponseReceived=1]="FirstResponseReceived";n[n.ManifestReceived=2]="ManifestReceived";n[n.Initialized=3]="Initialized";n[n.Error=4]="Error"})(b=t.ExtensionReadyState||(t.ExtensionReadyState={})),(function(n){n[n.None=0]="None";n[n.FirstResponseNotReceived=1]="FirstResponseNotReceived";n[n.ManifestNotReceived=2]="ManifestNotReceived";n[n.InvalidExtensionName=3]="InvalidExtensionName";n[n.InvalidManifest=4]="InvalidManifest";n[n.InvalidDefinition=5]="InvalidDefinition";n[n.FailedToInitialize=6]="FailedToInitialize";n[n.TooManyRefreshes=7]="TooManyRefreshes";n[n.TooManyBootGets=8]="TooManyBootGets";n[n.TimedOut=9]="TimedOut";n[n.MaxRetryAttemptsExceeded=10]="MaxRetryAttemptsExceeded";
n[n.HomePageTimedOut=11]="HomePageTimedOut";n[n.Unexpected=12]="Unexpected"})(k||(k={})),(function(n){n[n.Default=0]="Default";n[n.Part=1]="Part"})(lt=t.ViewModelType||(t.ViewModelType={}));t.create=kr;bt={};t.getScriptUris=li;kt=(function(){function n(n,t,r){var o=this,u,e;this.initializedExtension=f.observable();this._readyState=b.NotLoaded;this._errorState=k.None;this._manifests=new i.Map;this._initializedDeferred=Q.defer();this._manifestLoaded=Q.defer();this._perfData={};this._initializeRequired=!1;this._bootGetCount=0;this._scriptErrors=[];this._bladeRedirectMap={};this._performanceData={};this._isEarlyLoaded=!1;this._alwaysInitialize=!1;this._prefetchScripts=[];this._rpcClient=n;this.metadata=t;this._hostingContext=r;this._useWebWorker=pr(t.name,t.features);u=ut.earlyExtensionMap[t.name];u&&(this._loadTimer=wt(),e=u.frame,this._uri=e.src,this._window=new at(e.contentWindow,this.metadata.trustedHost,function(n){return e.setAttribute("src",n)},u.messagePort),this._transitionStateTo(b.FirstResponseReceived),
this._performanceData=u.performanceData,this._isEarlyLoaded=!0,this._alwaysInitialize=!0,u.initializeReceived.then((function(n){o._parseInitializationMessage(n)})))}return u.defineProperty(n.prototype,"cloudName",{get:function(){return this.metadata.cloudName},enumerable:!0,configurable:!0}),n.prototype.getVersion=function(){return this._extVersion},u.defineProperty(n.prototype,"initializeRequired",{get:function(){return this._initializeRequired},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"unloaded",{get:function(){return!this._window},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"name",{get:function(){return this.metadata.name},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"isTestExtension",{get:function(){return!!this.metadata.isTestExtension},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"isTestStamp",{get:function(){return!!this.metadata.isTestStamp},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"readyState",
{get:function(){return this._readyState},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),n.prototype.getBladeRedirect=function(n){return this._bladeRedirectMap[n&&n.toLowerCase()]},n.prototype.getManifest=function(n){return this._manifests.get(n)},n.prototype.setManifest=function(n,t){var r=this,i=t;return i.cloudName=this.cloudName,(i.redirects||[]).forEach((function(n){switch(n.type){case 2:case 3:var t=n.fromBlade;t&&(r._bladeRedirectMap[t.toLowerCase()]=n);break;case 4:case 5:h.addPartRedirect(r.name,n)}})),this._manifests.set(n,i),i},n.prototype._getBootScript=function(n){var i=JSON.stringify(ut.getBootEnvironment(this.effectiveFeatureFlags,n,this._prefetchScripts)),t=d.extensionEntryPointText+(";FxImpl.bootInitialize("+i+");");return this._useWebWorker&&(t=d.webWorkerPreambleText+"(window, "+JSON.stringify(t)+");"),t},n.prototype.getManifestAsync=function(){return this._manifestLoaded.promise},n.prototype.
whenInitialized=function(){return this._initializedDeferred.promise},n.prototype.onManifestReceived=function(n){var r=this._validateAndSetManifest(n,!1),t;return r&&!this._alwaysInitialize?(t=this._rpcClient.gcWindow(this.getWindowId()),t&&i.disposeDisposable(this._window),this._alwaysInitialize=!0,t):!1},n.prototype._parseInitializationMessage=function(n){i.extend(this._perfData,n.bootstrapTelemetry);this.onManifestReceived(n.manifest)||this._loadDefinition(n.definition)},n.prototype._loadDefinition=function(n){var e=this.getManifest("assetTypes"),r=s.validateDefinition(n),t;if(r.valid()){var u=o.preprocessDefinition(n,e,h.redirects()),c=this._perfData.totalTime=this._loadTimer(),f=new ai(this._rpcClient,this,u,c);tu(u,document,this.getWindowId());this._clearExtensionReloadHandle();this._extensionInitializedTraceKey=rt.startTrace({source:ht,action:"ExtensionInitialized",name:this.name});this._transitionStateTo(b.Initialized);this.initializedExtension(f);this._initializedDeferred.resolve(
f)}else return t="The extension definition has validation errors. Errors: {0}".format(JSON.stringify(r.errors)),this._onError(k.InvalidDefinition,t),Q.reject(new i.Errors.Error(t))},n.prototype._addTracePoint=function(n,t,i){var u=tt[n],f=this._performanceData[u]||0,r=0;switch(t){case 0:r=ot();break;case 1:r=f+1;break;case 2:r=f-1;break;case 3:r=i?1:0;break;case 4:r=i}this._performanceData[u]=r},n.prototype.getOrLoadWindow=function(){var n=this;if(!this._window){this._addTracePoint(tt.LoadRequested,0);this._bootGetCount=0;this._retryAttempt=0;var t=this.metadata,i=t.features,f=d.trace.nonsecure||i&&i.nonsecure==="true",r=0,u=ut.createUri(t,this._extVersion);this._uri=u.uri;this.effectiveFeatureFlags=u.effectiveFeatureFlags;this._addTracePoint(tt.ExtensionUriUsed,4,this._uri);this._window=this._hostingContext.createExtensionWindow({getWindowId:function(){return it.getWindowId(t)},trustedHost:t.trustedHost,frameUri:this._uri,createIframe:function(){n._addTracePoint(tt.IFrameCreationBegin,
0);var t=ut.createIframe(f);return n._addTracePoint(tt.IFrameCreationEnd,0),t},onLoad:function(){return n._readyState=b.NotLoaded,n._errorState=k.None,r++,r>ct?(n._onError(k.TooManyRefreshes,"The iframe for extension '{0}' refreshed/reloaded more than '{1}' times and has been unloaded.".format(n.name,ct)),!1):!0},onError:function(){n._reloadFrame("Extension Index page failed to load timed out in '{0}'ms.".format(ei),k.HomePageTimedOut)}});this._window.onDispose((function(){n._clearExtensionReloadHandle();n._initializedDeferred=Q.defer();n.initializedExtension(void 0);rt.trace({source:ht,action:"ExtensionUnloaded",name:n.name,data:{currentState:n._readyState}});n._extensionInitializedTraceKey&&(rt.completeTrace(n._extensionInitializedTraceKey),n._extensionInitializedTraceKey=null);var t="style[{0}='{1}']".format(fr,n.name);di.remove(t);n._window=null}));this._loadTimer=wt();this._startTime=ot();this._extensionReloadHandle=g.setTimeout((function(){n._addTracePoint(tt.IFrameReloadCount,1);n.
_reloadFrame()}),yt)}return this._window},n.prototype.noteScriptError=function(n){this._scriptErrors.push(n)},n.prototype._reloadFrame=function(n,t){var r=this,i;if(!this.unloaded&&this._readyState!==b.Initialized){if(!n&&!t){t=k.None;n="Failed to load extension after {1} attempts over {0} secs.";switch(this._readyState){case b.NotLoaded:t=k.FirstResponseNotReceived;n="First response was not received after a time of {0} secs.";break;case b.FirstResponseReceived:t=k.ManifestNotReceived;n="Manifest not received after {0} secs.";break;case b.ManifestReceived:t=k.TimedOut;n="Manifest was received, however failed to initialize the extension after {0} secs."}}this._retryAttempt>=pt&&(t=k.MaxRetryAttemptsExceeded);n=n.format(Math.round(this._loadTimer()/1e3),this._retryAttempt+1);this._clearExtensionReloadHandle();this._cleanupFrameForReload();this._retryAttempt<pt?(this._loadTimer=wt(),this._startTime=ot(),i=new yi(this._uri),this._retryAttempt++,i.query.setParameter(d.retryAttemptName,this._retryAttempt),
this._window.refresh(i.toString()),this._onExtensionLoadingRetry&&this._onExtensionLoadingRetry(),this._extensionReloadHandle=g.setTimeout((function(){r._reloadFrame()}),yt),nt.warning("Reloading extension '{0}' from '{1}'. Retry attempt: {4}. ErrorState: {2}. Error: {3}.".format(this.name,this.uri,k[t],n,this._retryAttempt))):this._onError(t,n)}},n.prototype._cleanupFrameForReload=function(){this._transitionStateTo(b.NotLoaded);this._useWebWorker=!1;this._window.reloadChannel()},n.prototype.getWindow=function(){return this._window},n.prototype.getTrustedHost=function(){var n=this._window;return n&&n.getTrustedHost()},n.prototype.getWindowId=function(){return it.getWindowId(this)},n.prototype.loadAsync=function(n){if(!this.unloaded)return this.whenInitialized();n||(n={});var t=n.manifest;return t&&this._validateAndSetManifest(t,!0)||this.getOrLoadWindow(),this._initializedDeferred.promise},n.prototype.dispose=function(){this._window&&(this._window.dispose(),this._window=null)},n.prototype.
processBootMessage=function(n){var t=!1,i=n.sdkVersion,s=n.extVersion,f,r,e,o,u;if(i&&s){this._addTracePoint(tt.BootGetReceived,0);f=n.bootVersion||1;r=void 0;try{r=ii(i);d.features.checksdkversion&&r.compareTo(ri)===1&&(e="The '{0}' extension at '{1}' was compiled with a newer version of the SDK ('{2}') than the shell ('{3}'). You may see unexpected results.",nt.warning(e.format(this.name,this.uri,r,ri)))}catch(h){nt.error("Invalid version information '{0}' specified by '{1}'.".format(i,this.name),0,h)}this._readyState!==b.NotLoaded&&(nt.warning("Unexpected bootget from '{0}' specified by '{1}', unexpected reload.".format(this.name,i)),this._cleanupFrameForReload());this._transitionStateTo(b.FirstResponseReceived);this._bootGetCount++;this._bootGetCount>ct&&this._onError(k.TooManyBootGets,"The iframe '{0}' sent more than '{1}' handshake messages over '{2}' attempts without making progress. it has been unloaded.".format(this.name,ct,this._retryAttempt));o=li(this.metadata,3);u=this._getBootScript(
o);f===2?this._window.postMessage({data:u,kind:1},[this._window.getExternalPort()]):this._window.postMessage({signature:d.bootMessageSignature,kind:1,data:{scripts:[{data:u,kind:1}],stopListening:!0}});t=!0}else n.kind===5?(this._addTracePoint(tt.BootGetPortReceived,0),this._window.postMessage({},[this._window.getExternalPort()]),t=!0):n.kind===3&&(this._isEarlyLoaded||this._parseInitializationMessage(n.initializationMessage),t=!0);return t},n.prototype._validateAndSetManifest=function(n,t){var h=this,r=!1,e=c.validate(n),o,u,s,f;if(e.valid())if(this.name.toLowerCase()!==n.name.toLowerCase())o="The extension name defined in the manifest '{0}' (obtained from the <Extension> tag in PDL) does not match the name '{1}' used to identify the extension with the portal. Ensure that the name you specify in the <Extension> tag in PDL matches the one used in the extensions.json file to identify the extension with the portal.",this._onError(k.InvalidExtensionName,o.format(n.name,this.name));else try{
ki(n.isPreview)&&(u=this.metadata.features,n.isPreview=(u&&u.preview||"").toLowerCase()==="true");t||cr(ur.cachedManifestTypes,(function(t){h.setManifest(t,n)}));s=this.setManifest("assetTypes",n);this._transitionStateTo(b.ManifestReceived);this._manifestLoaded.resolve(s);this._prefetchScripts=yr?n.initializationUris:[];r=!0}catch(l){f="_validateAndSetManifest throws";nt.error(new i.Errors.Error({message:f,data:n,innerErrors:l}));this._onError(k.Unexpected,f)}else e.errors.forEach(nt.error,nt),this._onError(k.InvalidManifest,"The extension manifest has validation errors.");return(r||!t)&&(this._addTracePoint(tt.ManifestReceived,0),this._addTracePoint(tt.InWebWorker,3,this._useWebWorker),this._window?rt.trace({source:ht,action:"ExtensionLoad",name:this.name,data:this._performanceData}):this._transitionStateTo(b.NotLoaded),this._extVersion=n.pageVersion),r},n.prototype._onError=function(n,t){var f="Failed to initialize extension '{0}' at '{1}'. ErrorState: {2}. Error: {3}.".format(this.name,
this.uri,k[n],t),i=r.createError(f,{data:{previousState:this._readyState,hasInitializeTraceKey:this._initializeTraceKey?1:0,successfulExtensionLoads:hi,failedExtensionLoads:si,timeThisFileLoaded:hr,scriptErrors:this._scriptErrors,extVersion:this._extVersion,timeThisExtensionStartedLoading:this._startTime,timeThisExtensionFailed:ot(),timeToFail:this._loadTimer()}}),u;nt.error(i,1);vt.Upload.flush();this._manifestLoaded.reject(i);this._initializedDeferred.reject(i);this._readyState!==b.Error&&(this._transitionStateTo(b.Error,n),u=p.getNotificationManager(),u&&u.addClientNotification({title:fi.extensionError,description:fi.loadingError.format(this.name),status:bi.Error,timestamp:new Date,cloudName:et.DefaultCloudName}));this._addTracePoint(tt.ErrorCount,1);this.dispose()},n.prototype._transitionStateTo=function(n,t){var i=this;this._readyState=n;n===b.ManifestReceived?this._initializeRequired&&(this._initializeTraceKey=rt.startTrace({source:ht,action:"InitializeExtensions",name:this.name,
data:{fxcdn:nr}})):n===b.Initialized?this._initializeTraceKey&&(this._perfData.extVersion=this._extVersion,rt.completeTrace(this._initializeTraceKey,this._perfData),this._initializeTraceKey=null,hi++):n===b.Error&&(si++,this._initializeTraceKey&&(rt.cancelTrace(this._initializeTraceKey,{errorState:t}),this._initializeTraceKey=null));t&&(this._errorState=t)},n.prototype._clearExtensionReloadHandle=function(){this._extensionReloadHandle&&(g.clearTimeout(this._extensionReloadHandle),this._extensionReloadHandle=null)},n})();t.ExtensionImpl=kt;ft=et.BladeNames.Hubs.ResourceMenuBlade;dt={};dt[pi]=[{partName:ft+"$"+ft,locator:h.resourceMenu.withLens(ft).withPartInstance(ft),getPartDefinition:function(n){return n.getBladeDefinition(ft).then((function(n){return n.lenses[0].partInstances[0].inline}))}}];ai=(function(){function n(n,t,i,u){var o=this,s,h;this.outstandingObjectCount=f.observable(0);this.metadataCount=f.observable(0);this._proxiedObjects=[];this._pools={};this._bladeDefMap={};this._partDefMap=
{};this._controlDefMap={};this._rpcClient=n;s=this._lifetime=new r.TriggerableLifetimeManager;s.registerForDispose(this._extension=t);this.cloudName=t.cloudName;h=this.name=t.name;this.definition=i;this.loadTime=u;(dt[h]||[]).forEach((function(n){o._pools[n.locator.toString()]=nu(s,5,(function(){return n.getPartDefinition(o).then((function(t){var i=t.details;return Q(o.getPartViewModel(n.partName,{initialState:{},createSelectable:y.needContainerSelectable(i),createHubsInternalCloudNameProperty:e.needInternalProperty(h,i),partSize:t.initialSize,partLocation:2,collapsed:null,containerType:0}))}))}))}))}return u.defineProperty(n.prototype,"extension",{get:function(){return this._extension},enumerable:!0,configurable:!0}),n.prototype.canUseInputsSetParameters=function(n){var t=this._pools[n.toString()];return!t||!t.size()},n.prototype.getBladeRedirect=function(n){return this._extension.getBladeRedirect(n)},n.prototype.getWindow=function(){return this._extension.getWindow()},n.prototype.processMessages=
function(){return it.pingEndPoint.invoke(this._rpcClient,this._extension.getWindowId(),undefined)},n.prototype.dispose=function(){this._lifetime.dispose()},n.prototype.getManifest=function(n){return this._extension.getManifest(n)},n.prototype.getBladeDefinition=function(n){var f=this,r=this.definition,t=n.toLowerCase(),u=r.bladeMap[t],i;return u?Q(u):(i=this._bladeDefMap,i[t]||(i[t]=Q(it.getBladeDefinitionEndPoint.invoke(this._rpcClient,this._extension.getWindowId(),n)).then((function(n){return o.processBlade(r,f.getManifest("assetTypes"),n,h.redirects())})).then((function(n){var t=[];if(s.validateBlade(r,n,null,t),t.length)throw new Error("Invalid blade definition. Errors: "+t.join("\n"));return n})).finally((function(){delete i[t]}))))},n.prototype.getPartDefinition=function(n){var f=this,r=this.definition,t=n.toLowerCase(),u=r.partTypeMap[t],i;return u?Q(u):(i=this._partDefMap,i[t]||(i[t]=Q(it.getPartDefinitionEndPoint.invoke(this._rpcClient,this._extension.getWindowId(),n)).then((function(
n){return o.processPart(r,f.getManifest("assetTypes"),n,h.redirects())})).then((function(n){var t=[];if(s.validatePartType(n,t),t.length)throw new Error("Invalid part type definition. Errors: "+t.join("\n"));return n})).finally((function(){delete i[t]}))))},n.prototype.getControlDefinition=function(n){var i=this,t=this._controlDefMap;return t[n]||(t[n]=Q(it.getControlDefinitionEndPoint.invoke(this._rpcClient,this._extension.getWindowId(),n)).then((function(n){return o.processControl(i.definition,i.getManifest("assetTypes"),n)})).then((function(n){var t=[];if(s.validateControl(n,t),t.length)throw new Error("Invalid control definition. Errors: "+t.join("\n"));return n})).catch((function(i){return delete t[n],Q.reject(i)})))},n.prototype.getViewModel=function(n,t){return this._getViewModel(lt.Default,n,t)},n.prototype.getPartViewModel=function(n,t){var f,r,u;return t&&t.locator&&(f=this._pools[t.locator.toString()])&&!t.onInputsSetParameters&&!i.keysLength(t.initialState)&&(r=f.getItem(),r)?(u=t&&t.
onViewModelAcquired,u&&u(r),ti().resolve(r).promise()):this._getViewModel(lt.Part,n,t)},n.prototype._getViewModel=function(n,t,i){var o=this,u,r,e;return(i=i||{},u=w.resolve(this,t,i.initialState,i.createSelectable),u)?u.then((function(n){if(i.onViewModelAcquired)i.onViewModelAcquired(n);return typeof i.partSize=="number"&&n&&n.content&&f.isObservable(n.content.size)&&n.content.size(i.partSize),i.onInputsSetParameters&&n&&n.updatePartInputValues&&(n.onInputsSetPromise=Q().then((function(){return n.updatePartInputValues(i.onInputsSetParameters.inputs,i.onInputsSetParameters.settings,i.onInputsSetParameters.traceOptions)}))),n})):(r=ti(),e=n===lt.Part?et.ViewModelTypes.PartViewModel:et.ViewModelTypes.ViewModel,it.getViewModelsDefinition.acquireObject(this._rpcClient,this._extension.getWindowId(),{type:e,containerType:i.containerType||0,name:t,initialState:i.initialState,createSelectable:i.createSelectable,createHubsInternalCloudNameProperty:i.createHubsInternalCloudNameProperty,telemetryContext:
er.getState(),partSize:i.partSize,partLocation:i.partLocation,onInputsSetParameters:i.onInputsSetParameters,collapsed:i.collapsed,flags:i.flags},i.onViewModelAcquired&&function(n){return i.onViewModelAcquired(n&&n.getValue())}).then((function(n){return o._proxiedObjects.push(n),n.getValue()})).then((function(n){r.resolve(n)}),(function(n){r.reject(n)})),r.promise())},n.prototype.releaseViewModel=function(n){i.disposeDisposable(n);var t=i.findIndex(this._proxiedObjects,(function(t){return t.getValue()===n}));t!==-1&&this._proxiedObjects.splice(t,1)[0].dispose()},n.prototype.isPreview=function(){return this.getManifest("assetTypes").isPreview},n})();gt=(function(){function n(){}return n.prototype.createExtensionWindow=function(n){var t=(n.createIframe||ut.createIframe)(),u=g.setTimeout(n.onError,ei),r,i;t.addEventListener("load",(function(t){g.clearTimeout(u);n.onLoad(t.originalEvent)}));t.addEventListener("error",(function(n){var t=n.originalEvent;nt.error(t.error,3,{message:t.message,filename:t.filename,
colno:t.colno,lineno:t.lineno})}));t.setAttribute("src",n.frameUri);r=t.contentWindow;i=new at(r,n.trustedHost||"*",function(n){t.setAttribute("src",n)});i.onDispose((function(){g.setTimeout((function(){try{vr.removeChild(t)}catch(n){}}),1e3)}));return i},n})();t.BrowserHostingContext=gt;at=(function(n){function t(t,i,r,u){var f=n.call(this,t)||this;f._resettingChannel=!1;f._trustedHost=(i||"*").toLowerCase();f.refresh=r;f._resetChannel();u&&f._rpcChannel.swapPort(u);f.onDispose((function(){f._resettingChannel||f._resetChannel()}));return f}return __extends(t,n),t.prototype.postMessage=function(n,t){this.getValue().postMessage(n,this._trustedHost,t)},t.prototype.getTrustedHost=function(){return this._trustedHost},t.prototype.getChannel=function(){return this._rpcChannel},t.prototype.getExternalPort=function(){return this._externalPort},t.prototype.reloadChannel=function(){var n=new MessageChannel;this._rpcChannel.swapPort(n.port1);this._externalPort=n.port2},t.prototype._resetChannel=function()
{var n=this;this._resettingChannel=!0;var t=this._rpcChannel,i=new MessageChannel,r=this._rpcChannel=new ni.RpcChannel(i.port1);this._externalPort=i.port2;t&&t.dispose();this._resettingChannel=!1;this._rpcChannel.onDispose((function(){r===n._rpcChannel&&n.dispose()}))},t})(ni.DisposableValue);t.ExtensionWindow=at}));define("MsPortalImpl/Extension/ExtensionManager",["require","exports","f","i","o","$","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u,f,e,o,s){"use strict";function w(n){return u.keys(n||{}).filter((function(t){var i=n[t];return i&&!!i.manifest})).length}function et(n,t,i){p.Log.writeEntry2(2,n,t,i)}function ot(){return new d.ExtensionManagerImpl({createExtension:e.create})}var v,d;u.defineProperty(t,"__esModule",{value:!0});var y=r.Extension,c=i.Base,g=c.Constants.ExtensionNames.Hubs,p=c.Diagnostics,nt=p.Telemetry,a=r.Rpc,l=window,b=l.fx,tt=b.early,h=p.createLog(n),it=n.normalize(undefined),
rt=b.environment,k=nt.trace,ut=i.startTimer,ft="###BOOT###";(function(n){function r(n,i){var r={};return n&&(r["x-ms-effective-locale"]=n),Q(c.Net2.ajax({uri:t.getUri(n,i),performRetry:!0,type:"GET",dataType:"json",contentType:"application/json",headers:r}))}function u(r){var u;return u=r==="assetTypes"?i=i||Q(t.promise).catch((function(n){return h.warning(n,6),null})).then((function(t){return w(t)?t:n.getManifestsAjax(undefined,r)})):n.getManifestsAjax(undefined,r),u.then((function(n){return n||{}})).catch((function(n){return h.error(n,7),{}}))}var t=tt.manifestCache,i;n.getManifestsAjax=r;n.getManifests=u})(v=t.Relex||(t.Relex={}));t.create=ot,(function(n){function t(n,t,i){return n.count=i.count-t.count,n.chars=i.chars-t.chars,n}var e=(function(){function n(n){var t=this;this.initializedExtensions=[];this._messageHandlers=[];this._isRpcStarted=!1;this._callbacksMap=new i.Map;this._callbacks=f.Callbacks();this._unloadCallbacks=f.Callbacks();this._allManifestsLoaded=Q.defer();this._manifestLoadStarted=
Q.defer();this._ltm=new r.TriggerableLifetimeManager;this.manifestLoadComplete=!1;this._manifestsMap={};this._initializedExtensionMap={};this._createExtension=n.createExtension;this._addExtensionBootReceiver();this.getHubsExtension=function(){return t.getExtensionByName(g,y.getHubsCloudName())}}return n.prototype.getExtension=function(n,t){return this._getExtensionByDescriptor({cloudName:t,name:n})},n.prototype.getManifestByName=function(n,t){var u=this,i=this._manifestsMap,r=JSON.stringify([].slice.call(arguments));return i[r]||(i[r]=this._manifestLoadStarted.promise.then((function(){return u.getExtension(n,t).getManifestAsync()})).catch((function(n){return delete i[r],Q.reject(n)})))},n.prototype.getExtensionByName=function(n,t,i){var f=this,r,u;return i=i||{},r=this._initializedExtensionMap,u=JSON.stringify([].slice.call(arguments)),r[u]||(r[u]=this._manifestLoadStarted.promise.then((function(){var i=f._getExtensionByDescriptor({cloudName:t,name:n});if(!i)throw new Error("extension {0}, in cloud {1} was not found".
format(n,t));return i})).then((function(t){var o=t.getWindowId(),e;return i.onlyIfLoaded||a.internalClient.acquireWindow(o,12e4),e=t.whenInitialized(),i.timeout>0&&(e=Q(e).timeout(i.timeout,"Timed out waiting for extension '{0}' to load.".format(n))),e.then((function(){var n=f._getLoadedExtensionByWindowId(o),t;return n&&(t=f._ltm.createChildLifetime(),n.extension.initializedExtension.subscribe(t,(function(n){n||(delete r[u],t.dispose())}))),n}))})).catch((function(n){return delete r[u],Q.reject(n)})))},n.prototype.initialize=function(n){var t=this,u,h,r,l;this._extensionsMap={};var p=this._createExtension,f={},b=i.isFeatureEnabled("extensionredirect")?n.extensions.filter((function(n){return!(f[n.name]=n.redirectTo)})):n.extensions,d=function(n){if(n){t.initializedExtensions.push(n);t._callbacks.fire(n);n.getWindow().onDispose((function(){i.remove(t.initializedExtensions,n);t._unloadCallbacks.fire(n)}))}},e=b.map((function(n){var i=p(a.internalClient,n),r=i.getWindowId().toLowerCase();if(t._getExtensionByWindowId(
r))throw new Error("Extension with window ID '"+r+"' has already been registered.");return i.initializedExtension.subscribeAndRun(t._ltm,d),t._extensionsMap[r]=i}));return o.redirects(f),this.startRpc(),u=this._getExtensionByWindowId(y.getHubsWindowId()),u&&a.internalClient.acquireWindow(u.getWindowId()),h=ut(),n.useCachedManifests?(r=v.getManifests("assetTypes"),this._callbacksMap.has("assetTypes")||this._callbacksMap.set("assetTypes",{initialPromise:r,callbacks:new c.Callbacks})):r=Q({}),r.then((function(n){k({source:"ExtensionManager",action:"CachedManifestCount",actionModifier:s.ActionModifier.Default,data:w(n),duration:h()});e.forEach((function(t){var i=n[t.name];t.isTestExtension||t.isTestStamp?t.loadAsync():t.loadAsync(i)}))})),l=e.map((function(n){var i=n.getManifestAsync();return i.then((function(n){t._callbacksMap.has("assetTypes")&&t._callbacksMap.get("assetTypes").callbacks.fire(n)})),i})),this._manifestLoadStarted.resolve(),Q.any([Q.allSettled(l),Q.delay(6e4)]).then((function(){t._allManifestsLoaded.
resolve();t.manifestLoadComplete=!0}))},n.prototype.startRpc=function(){var n=this;this._isRpcStarted||(this._isRpcStarted=!0,a.start({originId:"fx",loadChannelFunction:function(t){var i=n._getExtensionByWindowId(t);if(!i)throw new Error("Failed to load extension '{0}'.".format(t));return i.getOrLoadWindow().getChannel()}}))},n.prototype.unloadExtension=function(n){n.dispose()},n.prototype.on=function(n,t){var u=this,f,i,r;return this._callbacksMap.has(n)||(f=void 0,f=rt.relex.cachedManifestTypes[n]?v.getManifests(n).then((function(t){k({source:"ExtensionManager",action:"CachedManifestTypeCount",actionModifier:n,data:w(t)});var i=u.getExtensions().map((function(i){var e=i.isTestExtension||i.isTestStamp?null:t[i.name],r=e&&e.manifest,f;if(r)i.setManifest(n,r),u._callbacksMap.get(n).callbacks.fire(r);else return i.loadAsync(),f=i.getManifestAsync(),f.then((function(t){u._callbacksMap.get(n).callbacks.fire(t)})),f.timeout(2e3)})).filter((function(n){return!!n}));return Q.allSettled(i)})):this._allManifestsLoaded.
promise,this._callbacksMap.set(n,{initialPromise:f,callbacks:new c.Callbacks})),i=this._callbacksMap.get(n),t&&(r=function(n){try{t(n)||i.callbacks.remove(r)}catch(u){h.error(u,11)}},i.callbacks.add(r),this.getExtensions().forEach((function(t){var i=t.getManifest(n);i&&r(i)}))),i.initialPromise},n.prototype.onLoad=function(n){var i=this,r=this.initializedExtensions.slice(0),t=function(r){try{n(r)||i._callbacks.remove(t)}catch(u){h.error("onLoad event callback has thrown an exception.",2,u)}};this._callbacks.add(t);r.forEach((function(t){n(t)}))},n.prototype.onUnload=function(n){var i=this,t=function(r){try{n(r)||i._unloadCallbacks.remove(t)}catch(u){h.error("onUnload event callback has thrown an exception.",3,u)}};this._unloadCallbacks.add(t)},n.prototype.refreshManifests=function(n){return v.getManifestsAjax(n)},n.prototype.dispose=function(){this._ltm.dispose();this._messageHandlers&&(this._messageHandlers.forEach((function(n){l.removeEventListener("message",n)})),this._messageHandlers=[])}
,n.prototype._getExtensionByWindowId=function(n){var t=this._extensionsMap;return t&&t[n.toLowerCase()]},n.prototype._getExtensionByDescriptor=function(n){return this._getExtensionByWindowId(y.getWindowId(n))},n.prototype._getLoadedExtensionByWindowId=function(n){return this.initializedExtensions.first((function(t){return t.extension.getWindowId()===n}))},n.prototype._getExtensionByWindow=function(n){return this.getExtensions().first((function(t){var i=t.getWindow();return!!i&&i.getValue()===n}))},n.prototype.getExtensions=function(){var n=this;return u.keys(this._extensionsMap||{}).map((function(t){return n._extensionsMap[t]}))},n.prototype._addExtensionBootReceiver=function(){var n=this,t=function(t){var r=n._getExtensionByWindow(t.source),u=t.data||{},i=u.data||u,s=i.signature||u.signature,f,e,o;if(s===ft){if(t.source===l.window){h.error("Portal Load Error: Error loading script",i.kind,JSON.stringify(i));return}if(!r){f=n.getExtensions().map((function(n){return n.name}));e=l.location.origin;
h.error("Received a boot message from '"+t.origin+"' which is not associated to an extension("+f+"). ShellOrigin: ("+e+")",9,JSON.stringify(i));return}if(o=r.processBootMessage(i),!o){var c="{0} Origin: {1}".format(JSON.stringify(u),t.origin),a=r&&"/"+r.getWindowId(),v=it+a;et(v,c,10);r.noteScriptError({kind:2,error:i});return}}};l.addEventListener("message",t,!1);this._messageHandlers.push(t)},n.prototype.getMessageTelemetry=function(n){var i=this._m;return n&&i?{sent:t({startOffBy:n.sent.startOffBy,stopOffBy:i.sent.startOffBy},n.sent,i.sent),recv:t({},n.recv,i.recv)}:i},n})();n.ExtensionManagerImpl=e})(d=t.Internal||(t.Internal={}))}));define("MsPortalImpl/Svg/Startup/Ellipsis.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><circle cx='14.4' cy='7.6' r='1.6'/><circle cx='8' cy='7.6' r='1.6'/><circle cx='1.6' cy='7.6' r='1.6'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/Search.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M21.8.6c1.5.4 2.8 1 4.1 1.7 1.2.8 2.4 1.7 3.4 2.7 1 1.1 1.9 2.2 2.7 3.5.7 1.3 1.3 2.6 1.7 4.1.4 1.5.6 3 .6 4.6 0 2-.3 4-1 5.8s-1.7 3.6-3 5.1l19.1 19.2c.3.3.5.7.5 1.1 0 .4-.2.8-.5 1.1-.3.3-.7.5-1.1.5-.4 0-.8-.2-1.1-.5l-19-19.1c-1.6 1.3-3.3 2.3-5.1 3-1.9.7-3.8 1-5.8 1-1.6 0-3.1-.2-4.6-.6-1.5-.4-2.8-1-4.1-1.7-1.3-.7-2.4-1.6-3.5-2.7-1-1.1-1.9-2.2-2.7-3.5-.7-1.3-1.3-2.6-1.7-4.1-.4-1.5-.6-3-.6-4.6 0-1.6.2-3.1.6-4.6.4-1.5 1-2.8 1.7-4.1C3.1 7.3 4 6.1 5 5c1-1 2.2-1.9 3.5-2.7C9.8 1.6 11.1 1 12.6.6c1.5-.4 3-.6 4.6-.6s3.1.2 4.6.6zm.9 29.5c1.7-.7 3.2-1.7 4.5-3s2.3-2.8 3-4.5c.7-1.7 1.1-3.5 1.1-5.5 0-1.9-.4-3.8-1.1-5.5-.7-1.7-1.7-3.2-3-4.5s-2.8-2.3-4.5-3C21 3.4 19.2 3 17.2 3s-3.8.4-5.5 1.1C10 5 8.5 6 7.3 7.3S5 10 4.2 11.7c-.7 1.7-1.1 3.5-1.1 5.5 0 1.9.4 3.8 1.1 5.5.7 1.7 1.7 3.2 3 4.5s2.8 2.3 4.5 3c1.7.7 3.5 1.1 5.5 1.1s3.7-.4 5.5-1.2z'/><\/g><\/svg>"}})
);define("_generated/Less/MsPortalImpl.Controls/Controls/SimpleButton.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxc-simplebutton{display:inline-block;-webkit-user-select:none;min-width:80px;text-align:center;line-height:22px;position:relative}.fxs-button-icon{display:inline-block;height:12px;width:12px}.fxs-button-icon-left{margin-right:5px}.fxs-button-icon-right{margin-left:5px}.fxs-button-spinner{height:10px;width:10px;display:inline-block;position:absolute;right:8px}.fxs-button-text-hide{display:none}")}));define("MsPortalImpl.Controls/Controls/SimpleButton",["require","exports","f","o","ko","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl.Controls/Controls/Base/OptionsBase","_generated/Less/MsPortalImpl.Controls/Controls/SimpleButton.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var h=i.disposeDisposable,t="fxc-simplebutton",
s="fxs-button-text",c="<span>"+i.encodeAttribute(e.Button.validating)+"<\/span><div class='fxs-button-spinner' data-bind='image: MsPortalFx.Base.Images.Loading.Spinner()'><\/div>",l='<div class=\'fxs-button fxt-button\' role=\'button\' data-bind=\'visible: data.visible, css: { "fxs-button-disabled": $disabled, "fxs-portal-button-primary": data.primary, "fxs-button-default": !ko.unwrap(data.primary), "fxs-inner-dotted-border": !ko.unwrap($disabled) }, attr: { tabindex: $tabIndex, "aria-disabled": $disabled, title: data.text }\'><!-- ko if: data.icon() && data.icon().position === 0 --><div class=\'fxs-button-icon fxs-button-icon-left\' data-bind=\'image: MsPortalFx.Base.Images.CustomImageWithOptions(data.icon().image, {customClass: "fxs-escapeShadow"})\'><\/div><!-- /ko -->'+("<span class="+s+" data-bind='text: data.text'><\/span>")+"<!-- ko if: data.icon() && data.icon().position === 1 --><div class='fxs-button-icon fxs-button-icon-right' data-bind='image: MsPortalFx.Base.Images.CustomImageWithOptions(data.icon().image, {customClass: \"fxs-escapeShadow\"})'><\/div><!-- /ko --><!-- ko if: data.loading -->"+
("<div class=fxs-button-validating>"+c+"<\/div>")+"<!-- /ko --><\/div>",a=(function(n){function i(i,r,u){var f=n.call(this,i,r,u)||this,e;return f._events=[],f.element.addClass(t).html(l),e=f.element.findByClassName("fxs-button"),f.options.ariaLabel.subscribeAndRun(f.ltm,(function(n){e.attr("aria-label",n?n:null)})),f.options.loading.subscribeAndRun(f.ltm,(function(n){e.findByClassName(s).toggleClass("fxs-button-text-hide",n)})),f._attachEvents(),f._bindDescendants(),f}return __extends(i,n),r.defineProperty(i.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._detachEvents(),this._cleanElement(t),n.prototype.dispose.call(this))},i.prototype._attachEvents=function(){var n=this,t,i;this._detachEvents();t=function(n){return u.isObservable(n)?n():n};i=function(i){i.stopPropagation();i.preventDefault();!t(n.$disabled)&&n.options.onClick&&t(n.options.onClick)()};this.
_events.push(this.element.setEvents([f.default.click,i],[f.default.keypress,function(n){(n.keyCode===13||n.keyCode===32)&&i(n)}]))},i.prototype._detachEvents=function(){h(this._events);this._events=[]},i})(o.Widget);n.Widget=a})(s||(s={})),s}));define("MsPortalImpl/Svg/Startup/Close.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14 3.3L12.7 2 8 6.7 3.3 2 2 3.3 6.7 8 2 12.7 3.3 14 8 9.3l4.7 4.7 1.3-1.3L9.3 8z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Library/Feedback.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 15 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M13.903 2.152a2.626 2.626 0 0 0-.936-.651c-1.62-.674-3.959.165-5.425 2.246C5.289 1.028 2.594.517 1.094 2.152c-2.997 3.264.756 7.552 3.717 9.987 1.167.96 2.211 1.632 2.67 1.84V14l.016-.008s.016.007.022.008v-.021c1.62-.735 10.561-7.277 6.384-11.827z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Library/LaunchCurrent.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 15 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8.883.942v1.586h3.118L6.314 8.214a.792.792 0 1 0 1.121 1.122l5.545-5.545v2.833h1.586V.942H8.883z'/><path d='M12.01 6.064a.316.316 0 0 0-.344.068l-.946.946a.316.316 0 0 0-.092.223v3.746c0 .601-.489 1.09-1.09 1.09H3.272c-.601 0-1.09-.489-1.09-1.09V6.07c0-.601.489-1.09 1.09-1.09h4.762a.315.315 0 0 0 .223-.092l.946-.946a.316.316 0 0 0-.223-.539H3.272A2.67 2.67 0 0 0 .605 6.07v4.977a2.67 2.67 0 0 0 2.667 2.667h6.266a2.67 2.67 0 0 0 2.667-2.667V6.355a.319.319 0 0 0-.195-.291z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Library/Person.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M35.859 10.269c0 5.671-4.638 10.269-10.359 10.269S15.142 15.94 15.142 10.269 19.779 0 25.5 0c5.721 0 10.359 4.598 10.359 10.269m-2.785 13.789L25.5 34.578l-7.574-10.52H7.001V50H44V24.058z' class='msportalfx-svg-c15'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Library/Signout.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 15 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M12.133 3.033a.995.995 0 1 0-1.408 1.408 4.543 4.543 0 0 1 1.336 3.225 4.544 4.544 0 0 1-1.336 3.225A4.547 4.547 0 0 1 7.5 12.227a4.54 4.54 0 0 1-3.224-1.336A4.544 4.544 0 0 1 2.94 7.666a4.543 4.543 0 0 1 1.336-3.225.995.995 0 1 0-1.408-1.408 6.537 6.537 0 0 0-1.92 4.633 6.535 6.535 0 0 0 1.92 4.633A6.537 6.537 0 0 0 7.5 14.218h.004a6.53 6.53 0 0 0 4.628-1.919 6.534 6.534 0 0 0 1.919-4.633 6.534 6.534 0 0 0-1.918-4.633zM7.5 8.662c.55 0 .996-.446.996-.996V1.655a.996.996 0 0 0-1.992 0v6.011c0 .55.446.996.996.996z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/AllServices.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M19.432 22.112h27.119v6.307H19.432zm0 13.875h27.119v6.307H19.432zm0-27.75h27.119v6.307H19.432z' class='msportalfx-svg-c04'/><circle opacity='.6' cx='6.818' cy='39.152' r='3.784' class='msportalfx-svg-c15'/><circle opacity='.6' cx='6.818' cy='11.907' r='3.784' class='msportalfx-svg-c15'/><circle cx='6.818' cy='25.53' r='3.784' class='msportalfx-svg-c16'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/CaretUp.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M1 8.1l.7.8L6 4.6l4.3 4.3.7-.8-5-5z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Console.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M22.988 42.926h25v3.5h-25zM2.412 8.075L4.887 5.6l17.677 17.677-2.475 2.475z'/><path d='M2.578 38.777L20.256 21.1l2.475 2.474L5.053 41.252z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/DoubleChevron.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 8 8.4' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><g data-name='Layer 1'><path d='M4 3.7l-4 4 .7.7L4 5l3.3 3.4.7-.7-4-4z'/><path d='M4 0L0 4l.7.7L4 1.4l3.3 3.3L8 4 4 0z'/><\/g><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/Error.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 9 9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><circle cx='4.5' cy='4.5' r='4.5' class='msportalfx-svg-c22'/><circle cx='4.5' cy='6.438' r='.697' class='msportalfx-svg-c01'/><path d='M4.604 2.186h-.729l.186 3.232h.878l.186-3.232z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Hamburger.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M0 3h18v1H0zm0 5h18v1H0zm0 5h18v1H0z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Help.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 22 22' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M11 0C4.93 0 0 4.93 0 11s4.93 11 11 11 11-4.93 11-11S17.07 0 11 0zm0 20.43c-5.2 0-9.43-4.23-9.43-9.43S5.8 1.57 11 1.57 20.43 5.8 20.43 11 16.2 20.43 11 20.43zm3.14-11.79c0 1.13-.52 2.18-1.46 2.96-.58.48-.89 1.1-.89 1.75v.79h-1.57v-.79c0-1.13.52-2.18 1.46-2.96.58-.48.89-1.1.89-1.75 0-.87-.7-1.57-1.57-1.57-.95 0-1.85.46-2.54 1.29l-1.21-1C8.24 6.16 9.57 5.5 11 5.5c1.73 0 3.14 1.41 3.14 3.14zm-2.35 7.86c0 .43-.35.79-.79.79s-.79-.35-.79-.79.35-.79.79-.79.79.36.79.79z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/Hyperlink.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M4.992 9.819l8.018-7.991v4.005H14V0H8.167v1h4.038L4.232 8.987l.76.833z'/><path d='M12.993 13.03H1.01V1.028h4.823V0H0v14h14V8.167h-1.007v4.863z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Notifications.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 22 22' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path opacity='.9' d='M18.86 17.29V7.86C18.86 3.52 15.33 0 11 0S3.14 3.52 3.14 7.86v9.43H1.57v1.57h6.29C7.86 20.59 9.27 22 11 22s3.14-1.41 3.14-3.14h6.29v-1.57h-1.57zm-14.15 0V7.86c0-3.47 2.82-6.29 6.29-6.29s6.29 2.82 6.29 6.29v9.43H4.71zM11 20.43c-.87 0-1.57-.7-1.57-1.57h3.14c0 .86-.7 1.57-1.57 1.57z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/Plus.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8 18h2v-8h8V8h-8V0H8v8H0v2h8z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Settings.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 22 22' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M19.2 10.6v.8l2.8 1.7-1.7 4.1-3.2-.7-.5.5.7 3.2-4.2 1.8-1.7-2.8h-.8L8.9 22l-4.1-1.7.7-3.2-.5-.5-3.2.7L0 13.1l2.8-1.7v-.8L0 8.9l1.7-4.1 3.2.7.5-.5-.7-3.3L8.9 0l1.7 2.8h.8L13.1 0l4.1 1.7-.7 3.2.5.5 3.2-.7L22 8.9l-2.8 1.7zM17.9 12v-2l2.6-1.6-.9-2.2-2.9.7c-.2-.3-.5-.5-.7-.8-.2-.2-.5-.5-.8-.7l.7-2.9-2.2-.9L12 4.1h-2L8.4 1.5l-2.3.9.7 2.9c-.3.3-.5.5-.7.8-.3.2-.5.4-.7.7l-3-.7-.9 2.3L4.1 10v2l-2.6 1.6.9 2.2 2.9-.7c.2.3.5.5.7.8.2.2.5.5.8.7l-.7 2.9 2.2.9 1.6-2.6h2l1.6 2.6 2.2-.9-.7-2.9c.3-.2.5-.5.8-.7.2-.2.5-.5.7-.8l2.9.7.9-2.2-2.4-1.6zM11 6.9c.6 0 1.1.1 1.6.3s.9.5 1.3.9.7.8.9 1.3.3 1 .3 1.6-.1 1.1-.3 1.6-.5.9-.9 1.3-.8.7-1.3.9-1 .3-1.6.3-1.1-.1-1.6-.4-.9-.5-1.3-.9-.7-.8-.9-1.3-.3-1-.3-1.6.1-1 .4-1.5.5-.9.9-1.3.8-.7 1.3-.9.9-.3 1.5-.3zm0 7c.4 0 .8-.1 1.1-.2.3-.1.6-.4.9-.6.3-.3.5-.6.6-.9.1-.3.2-.7.2-1.1s-.1-.8-.2-1.1c-.1-.5-.3-.8-.6-1-.3-.3-.6-.5-.9-.6-.3-.1-.7-.2-1.1-.2s-.8.1-1.1.2c-.4.1-.7.3-.9.6-.3.2-.5.5-.6.9-.1.3-.2.7-.2 1.1s.1.8.2 1.1c.1.4.3.7.6.9.3.3.6.5.9.6.3.2.7.3 1.1.3z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/SmileyHappy.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 32 32' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M16 0C7.16 0 0 7.16 0 16s7.16 16 16 16 16-7.16 16-16S24.84 0 16 0zm0 30C8.28 30 2 23.72 2 16S8.28 2 16 2s14 6.28 14 14-6.28 14-14 14zm6-16c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-12 0c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm14.93 6.47C23.29 23.74 19.91 26 16 26s-7.29-2.26-8.93-5.53l1.79-.89C10.17 22.19 12.87 24 16 24s5.83-1.81 7.15-4.43l1.78.9z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Star.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M6 .3l1.5 4.3 4.5.1-3.6 2.7 1.3 4.3L6 9.1l-3.7 2.6 1.3-4.3L0 4.7l4.5-.1z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Base/Base.KnockoutExtensions",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e){"use strict";r.defineProperty(t,"__esModule",{value:!0});u.bindingHandlers.commands={update:function(n,t){var i=u.unwrap(t()),r,o;if(i&&i.group){r=f(n);o=function(n){var o=u.unwrap(i.viewModel),t=f.Event(e.default.fxrightclick);t.clientX=n.clientX;t.clientY=n.clientY;r.trigger(t,{commandGroup:i.group,viewModel:o,entityType:2});n.preventDefault();n.stopPropagation()};r.on(e.default.fxcontextmenurequest,o);u.utils.domNodeDisposal.addDisposeCallback(n,(function(){r.off(e.default.fxcontextmenurequest,o)}))}}};u.bindingHandlers.fxclick={init:function(n,t,r,f,e){var o=function(){return u.unwrap(t())};i.tryImmediateResolve(i.require("MsPortalImpl/UI/Compositions/UI.Composition.Selectable2Registrar"),(function(t){t.attachFxClickHandler(n,e.$data,o)}))}}}));define("MsPortalImpl/Controls/ControlBindings",["require","exports","ko"],(function(n,t,i){"use strict";
var r;return (function(){function n(n,i){t[n]=i}function f(n,t){var r=i.unwrap(n()),f;if(r){if(f=t[r.controlType],!f)throw new Error("Unsupported ControlType in formControl binding handler: "+r.controlType+".");return u[f]}}function e(n,t,i,r,u,e){var s=f(t,e),o;if(s)return o=$(n),o.attr("data-formelement",o.attr("data-bind")),s.init(n,t,i,r,u)}function o(n,t,i,r,u,e){if(n){var o=f(t,e);if(o)return o.update(n,t,i,r,u)}}var u=i.bindingHandlers,t={},r;n(127,"pcAccordion");n(20,"pcArtifactLinks");n(106,"pcAsyncFileUpload");n(16,"pcAttachment");n(38,"pcButton");n(63,"pcChart");n(7,"pcCheckBoxField");n(75,"pcConsole");n(40,"pcCopyableLabel");n(83,"pcCreatorAndSelector");n(85,"pcCreatorAndSelectorV2");n(23,"pcCustomHtmlField");n(91,"pcCustomValueSlider");n(111,"pcCustomRangeSlider");n(25,"pcDatePickerField");n(26,"pcDateTimePickerField");n(27,"pcDateTimeRangePickerField");n(92,"pcDayPickerField");n(76,"pcDeleteAssetConfirmation");n(33,"pcDiffEditor");n(32,"pcDockedBalloon");n(65,"pcDonut");n(
3,"pcDropDownField");n(99,"pcDurationPickerField");n(15,"pcSection");n(37,"pcEditor");n(120,"pcEssentials");n(82,"pcFileDownloadButton");n(28,"pcFileUpload");n(81,"pcFileUploadWidget");n(12,"pcFilterComboField");n(55,"pcGallery");n(67,"pcGraph");n(103,"pcGrid2");n(125,"pcEditableGrid");n(130,"pcArrayGrid");n(131,"pcDataGrid");n(132,"pcPagedDataGrid");n(133,"pcSequentialDataGrid");n(98,"pcGroupDropDownField");n(77,"pcHeroBanner");n(19,"pcHistory");n(84,"pcHotSpot");n(108,"pcIFrame");n(113,"pcIFrame2");n(78,"pcInfoBox");n(121,"pcIntuneAppFileUpload");n(118,"pcLegend");n(88,"pcHotSpot");n(87,"pcInfoBox");n(104,"pcList2");n(58,"pcLogStream");n(68,"pcMap");n(109,"pcMediaPlayer");n(115,"pcMenu");n(69,"pcMetrics");n(122,"pcMonitorChart");n(126,"pcMonitorChartV2");n(13,"pcMultiLineTextField");n(8,"pcMultiselectDropDownField");n(79,"pcNotice");n(10,"pcNumericTextBoxField");n(29,"pcOAuthButtonField");n(4,"pcOptionsGroupField");n(70,"pcPairedTimeline");n(94,"pcPairedTimelineBadges");n(5,"pcPasswordField");
n(39,"pcCheckBox");n(42,"pcDropDown");n(43,"pcFilterCombo");n(54,"pcGrid");n(56,"pcListView");n(110,"pcMarkdown");n(45,"pcMultiLineTextBox");n(46,"pcMultiselectDropDown");n(47,"pcNumericTextBox");n(48,"pcOptionPicker");n(49,"pcPassword");n(50,"pcRangeSlider");n(52,"pcSlider");n(53,"pcTextBox");n(57,"pcTreeView");n(112,"pcPartPinner");n(80,"pcPicker");n(128,"pcPill");n(129,"pcPillCollection");n(123,"pcPillList");n(89,"pcPreviewTag");n(71,"pcProgressBar");n(31,"pcQueryBuilder");n(72,"pcQuotaGauge");n(9,"pcRangeSliderField");n(93,"pcSearchBox");n(114,"pcResourceFilter");n(1,"pcFormSection");n(11,"pcSelectorField");n(60,"pcSettings");n(100,"pcSimpleButton");n(97,"pcChart");n(61,"pcSingleSetting");n(73,"pcSingleValueGauge");n(6,"pcSliderField");n(95,"pcSpecComparisonTable");n(21,"pcSplitter");n(17,"pcStringListField");n(124,"pcResourceDropDown");n(101,"pcTextBlock");n(2,"pcTextField");n(24,"pcTimePickerField");n(30,"pcTokenComboBox");n(62,"pcToolbar");n(105,"pcTree2");n(22,"pcTriStateCheckBox");
n(116,"pcVideo");n(107,"pcWizard");n(119,"pcHeatMap");n(201,"pcFileShareDropDown");r={};[127,20,16,7,83,85,23,91,111,25,26,27,92,3,99,15,120,201,81,12,98,124,19,108,113,110,13,8,10,29,4,5,128,129,123,89,9,1,11,6,21,17,2,112,24,30,22].forEach((function(n){return r[n]=t[n]}));u.pcControl={init:function(n,i,r,u,f){return e(n,i,r,u,f,t)},update:function(n,i,r,u,f){return o(n,i,r,u,f,t)}};u.formElement={init:function(n,t,i,u,f){return e(n,t,i,u,f,r)},update:function(n,t,i,u,f){return o(n,t,i,u,f,r)}}})(r||(r={})),r}));define("MsPortalImpl/Controls/ControlBindings.Async",["require","exports","ko","MsPortalImpl/Widgets/Widgets.Common"],(function(n,t,i,r){"use strict";var u;return (function(n){function o(n,t,i,r){e.push({name:t,moduleId:n+i,initOptions:r})}function t(n,t,i){o("MsPortalImpl.Controls/",n,t,i)}function u(n,t,i){o("MsPortalImpl/Controls/",n,t,i)}function s(t){n.portalControlBindings.forEach((function(n){i.bindingHandlers[n.name]=r.getAsyncBindingHandler(n.moduleId,n.initOptions,t)}))}var e=
[],f={controlsDescendantBindings:!1};t("pcAccordion","Controls/Accordion");t("pcButton","Controls/Forms/Button",f);t("pcChart","Controls/Visualization/Chart");t("pcCheckBoxField","Fields/CheckBoxField");t("pcConsole","Controls/Console");t("pcCopyableLabel","Controls/Forms/CopyableLabel");t("pcCreatorAndSelector","Fields/CreatorAndSelectorField");t("pcCreatorAndSelectorV2","Fields/CreatorAndSelectorFieldV2");t("pcCustomHtmlField","Fields/CustomHtmlField");t("pcCustomValueSlider","Fields/CustomValueSliderField");t("pcCustomRangeSlider","Fields/CustomRangeSlider");t("pcDatePickerField","Fields/DatePickerField");t("pcDateTimePickerField","Fields/DateTimePickerField");t("pcDateTimeRangePickerField","Fields/DateTimeRangePickerField");t("pcDayPickerField","Fields/DayPickerField");t("pcDiffEditor","Controls/Documents/DiffEditor");t("pcDockedBalloon","Controls/DockedBalloon");t("pcDonut","Controls/Visualization/Donut");t("pcDropDownField","Fields/DropDownField");t("pcDurationPickerField","Fields/DurationPickerField");
t("pcEditor","Controls/Documents/Editor");t("pcFileUpload","Controls/Forms/FileUpload");t("pcFilterComboField","Fields/FilterComboField");t("pcFormSection","Fields/SectionField",f);t("pcGallery","Controls/Lists/List1/Gallery");t("pcGraph","Controls/Visualization/Graph");t("pcGrid","Controls/Lists/Grid1/Grid1");t("pcGrid2","Controls/Lists/Grid2/GridB");t("pcEditableGrid","Controls/Lists/Grid2/Grid2.EditableGrid.ctl");t("pcArrayGrid","Controls/Lists/Grid2/Grid2.ArrayGrid.ctl");t("pcDataGrid","Controls/Lists/Grid2/Grid2.DataGrid.ctl");t("pcPagedDataGrid","Controls/Lists/Grid2/Grid2.PagedDataGrid.ctl");t("pcSequentialDataGrid","Controls/Lists/Grid2/Grid2.SequentialDataGrid.ctl");t("pcHeatMap","Controls/HeatMap");t("pcIFrame","Controls/IFrame");t("pcIFrame2","Controls/IFrameV2");t("pcLegend","Controls/Visualization/Legend");t("pcListView","Controls/Lists/List1/ListView");t("pcLogStream","Controls/LogStream");t("pcMap","Controls/Visualization/Map");t("pcMediaPlayer","Controls/AzureMediaPlayer");
t("pcMenu","Controls/Lists/Menu");t("pcMetrics","Controls/Visualization/Metrics");t("pcMonitorChart","Controls/Visualization/MonitorChart/MonitorChart");t("pcMonitorChartV2","Controls/Visualization/MonitorChartV2/MonitorChartV2");t("pcMultiLineTextField","Fields/MultiLineTextField");t("pcMultiselectDropDownField","Fields/MultiselectDropDownField");t("pcNumericTextBoxField","Fields/NumericTextBoxField");t("pcOAuthButtonField","Fields/OAuthButtonField");t("pcOptionsGroupField","Fields/OptionsGroupField");t("pcPairedTimeline","Controls/Visualization/PairedTimeline");t("pcPairedTimelineBadges","Controls/Visualization/PairedTimelineBadges");t("pcPartPinner","Controls/PartPinner");t("pcPasswordField","Fields/PasswordField");t("pcPreviewTag","Controls/PreviewTag");t("pcProgressBar","Controls/Visualization/ProgressBar");t("pcQueryBuilder","Controls/Data/QueryBuilder");t("pcQuotaGauge","Controls/Visualization/QuotaGauge");t("pcRangeSliderField","Fields/RangeSliderField");t("pcSearchBox","Controls/SearchBox");
t("pcResourceFilter","Controls/ResourceFilter");t("pcSection","Fields/Section");t("pcSelectorField","Fields/SelectorField");t("pcSettings","Controls/Settings");t("pcSimpleButton","Controls/SimpleButton");t("pcSingleSetting","Controls/SingleSetting");t("pcSingleValueGauge","Controls/Visualization/SingleValueGauge");t("pcSliderField","Fields/SliderField");t("pcSpecComparisonTable","Controls/SpecComparisonTable");t("pcSplitter","Fields/Splitter",f);t("pcStringListField","Fields/StringListField");t("pcTextBlock","Controls/TextBlock");t("pcTextBox","Controls/Forms/TextBox");t("pcTextField","Fields/TextField");t("pcTimePickerField","Fields/TimePickerField");t("pcToolbar","Controls/Toolbars/Toolbar");t("pcTreeView","Controls/Lists/Tree1/TreeView");t("pcTriStateCheckBox","Fields/TriStateCheckBox");t("pcMarkdown","Controls/Markdown");t("pcVideo","Controls/Video");u("pcAsyncFileUpload","Forms/AsyncFileUpload");u("pcDeleteAssetConfirmation","Controls.DeleteAssetConfirmation");u("pcEssentials","Controls.Essentials");
u("pcFileDownloadButton","Controls.FileDownloadButton");u("pcFileUploadWidget","Forms/Controls.FileUpload");u("pcGroupDropDownField","Forms/GroupDropDown");u("pcResourceDropDown","Forms/ResourceDropDown");u("pcHeroBanner","Controls.HeroBanner");u("pcHotSpot","Controls.HotSpot",f);u("pcInfoBox","Controls.InfoBox");u("pcNotice","Controls.Notice");u("pcPicker","Controls.Picker");u("pcPickerV3","Controls.PickerV3");u("pcPill","Controls.Pill");u("pcPillCollection","Controls.PillCollection");u("pcPillList","Controls.PillList");u("pcTokenComboBox","Forms/Controls.TokenComboBox");u("pcWizard","Controls.Wizard");u("pcIntuneAppFileUpload","Forms/IntuneAppFileUpload");u("pcFileShareDropDown","Storage/FileShareDropDown");n.portalControlBindings=e;n.initialize=s})(u||(u={})),u}));define("MsPortalImpl/Services/Services.PortalIdleState",["require","exports","o"],(function(n,t,i){"use strict";function f(){return new r.PortalIdleStateServiceImpl(window,u)}var r,u;i.defineProperty(t,"__esModule",{value:!0}),
(function(n){var t=(function(){function n(n,t){var i=this;this._win=n;this._defaultPollMS=t;this._state=0;this._handleId=1;this._iteration=0;this._actions=[];this._win.addEventListener("blur",this._blurFunc=function(){i._blurStartTime=new Date;i._state=1;i._processCallbacks(i._defaultPollMS)});this._win.addEventListener("focus",this._focusFunc=function(){i._blurStartTime=null;i.signalBusy()})}return n.prototype.dispose=function(){var n=this._win;return n?(this._win=null,n.removeEventListener("blur",this._blurFunc),n.removeEventListener("focus",this._focusFunc),this._state=0,!0):!1},n.prototype.addCallbacks=function(n){var t=this._handleId++;return this._actions.push({key:t,value:n}),t},n.prototype.removeCallbacks=function(n){var t=this._actions,i=t.firstIndex((function(t){return n===t.key}));return i!==-1?(t.splice(i,1),!0):!1},n.prototype.signalBusy=function(){this._state===1&&(this._state=2,this._processCallbacks(5e3))},n.prototype.signalIdle=function(){this._blurStartTime||(this._blurStartTime=
new Date);this._state=1;this._processCallbacks(0)},n.prototype._processCallbacks=function(n){var t=this,i;this._win&&(i=this._timeoutHandle,i&&this._win.clearTimeout(i),this._timeoutHandle=this._win.setTimeout((function(){t._timeoutHandle=null;try{t._processIteration()}finally{t._state!==0&&t._processCallbacks(t._defaultPollMS)}}),n))},n.prototype._processIteration=function(){var i=this,t,n;switch(this._state){case 2:this._state=0;t=function(n){n.onBusy(new Date)};break;case 1:this._state=1;t=function(n){return n.onIdle(new Date,i._blurStartTime)};break;default:case 0:return}var r=function(n){var r=i._actions[n];r&&t(r.value)},u=this._actions.length,f=this._iteration%u;for(this._iteration++,n=f;n<u;n++)r(n);for(n=0;n<f;n++)r(n)},n})();n.PortalIdleStateServiceImpl=t})(r=t.Internal||(t.Internal={}));u=9e5;t.createInstance=f}));define("_generated/Less/MsPortalImpl/Widgets/CopyField.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});
window.fx.injectCss(r,".fxs-copyfield{display:none;position:absolute;width:24px;top:0;right:0}.fxs-copyfield .fxc-copyablelabel{padding:0}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox{display:none}.fxs-copyfield-container .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-textbox{display:block}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{padding:0;border:0;margin:0;height:auto;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button{padding:0;margin:0;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button:hover{background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button .fxc-copyablelabel-copyimage{padding:2px 6px 6px 2px}.fxs-copyfield-container .fxs-copyfield-wrapper{position:absolute;top:0;right:0;width:24px;height:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxc-copyablelabel{padding-right:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield-wrapper{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-copybutton{margin-right:-24px}.fxs-part-resourcesummary .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{font-size:13px}")})
);define("MsPortalImpl/Base/Base.KnockoutExtensions.Copy",["require","exports","f","i","o","ko","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/CopyField.css"],(function(n,t,i,r,u,f,e){"use strict";function a(n,t,r,u){var l="fxs-copyfield",a="fxs-copyfield-copied",s=$(t),o=$('<div class="'+l+'-wrapper" data-bind="stopBindings: true"><\/div>'),v=$('<div data-bind="pcCopyableLabel: $data" class="'+l+'"><\/div>'),h;v.appendTo(o);o.appendTo(s);h=new c.Forms.CopyableLabel.ViewModel(n,u);h.disabled(!0);f.reactor(n,(function(){var n=f.unwrap(r);h.value(n);s.toggleClass("fxs-copyfield-container",!i.isNullOrWhiteSpace(n))}));f.applyBindingsToDescendants(h,o[0]);n.registerForDispose([s.setEvents([e.default.fxcopybuttonclick,function(){s.addClass(a)}],[e.default.mouseleave,function(){s.removeClass(a)}]),function(){o&&(f.utils.cleanDescendantNodes(o),o.remove())}])}function o(n,t,i){function h(){u&&(u.dispose(),u=null);r&&(clearTimeout(r),r=null)}var c=$(n),u,r,o={};o[e.default.
mouseenter]=function(){r||(r=setTimeout((function(){h();a(u=new s,n,t(),i)}),l))};o[e.default.mouseleave]=h;c.on(o);f.utils.domNodeDisposal.addDisposeCallback(n,(function(){h();c.off(o)}))}u.defineProperty(t,"__esModule",{value:!0});var s=r.TriggerableLifetimeManager,h=i.Base,c=i.ViewModels.Controls,v=h.Diagnostics.createLog(n),l=100;t.initializeCopyBinding=o;f.bindingHandlers.copy={init:o}}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Hubs/UI.NotificationManager"],(function(n,t,i,r,u,f,e){"use strict";r.defineProperty(t,"__esModule",{value:!0});var h=i.Azure.ResourceManager,v=i.Base,y=v.Diagnostics,p=i.Services.Gallery,c=p.Constants,s=f.Gallery.Notifications,o=y.createLog(n),l=c.GalleryParametersKey,a=i.clone,w=u.observable,b=(function(){function n(n){this.status=w();this._cloudName=n}return n.prototype.execute=function(t){var f;if("data"in t&&"options"in t){if(f=t.data,l in f.
outputParameters){var i=f.outputParameters[l],r=t.options[c.GalleryOptionsKey],u=r&&r.launchingContext||{},e=this._getGalleryItemId(r.galleryItem);if(e||(o.warning("Null GalleryItemId."),e=i.deploymentName),u=a(u,!0),u.oldCreateApi=!0,u.galleryItemId=u.galleryItemId||e,this._validateOptions(i,r,f)){var y=a(f.outputParameters[i.selectedTemplateId],!0),p=n._findPropInObject(i.selectedTemplateId,r.deploymentTemplateFileUris),w={subscriptionId:i.subscriptionId,deploymentName:i.deploymentName||r.deploymentName,resourceGroupName:i.resourceGroupName,resourceGroupLocation:i.resourceGroupLocation,resourceProviders:JSON.parse(i.resourceProviders||null),parameters:y,templateLinkUri:!i.templateJson&&p||undefined,templateJson:i.templateJson,deploymentMode:1,launchingContext:u,cloudName:this._cloudName},v=new Date;return h.Deployments.deployTemplate(w).then((function(n){if(n===void 0&&(n={}),n.deploymentStatusCode===h.DeploymentStatusCode.Success){var i=(n.deployment||{}).properties||{},t=new Date(i.
timestamp&&i.timestamp.valueOf()||n.timestamp&&n.timestamp.valueOf());return t&&t.getTime()<=v.getTime()&&(t=new Date(v.getTime()+1)),{correlationId:i.correlationId||n.correlationId,timestamp:t}}return Q.reject()}))}return this._notify(s.createArgumentsValidationFailedMessage),Q.reject()}return this._notify(s.createOptionsNotSpecifiedMessage),o.error("Create options are not specified in the output parameters."),Q.reject()}return this._notify(s.createCommandMissingArgumentsMessage),o.error("The data or the options needed by the deployment command are not specified."),Q.reject()},n.prototype._validateOptions=function(t,i,r){var u="CsmCommand was rejected because ";if(t){if(!t.templateJson&&!t.selectedTemplateId)return o.error(u+"neither templateJson nor selectedTemplateId were specified."),!1;if(t.templateJson)try{JSON.parse(t.templateJson)}catch(f){return o.error(u+"templateJson was malformed."),!1}if(!t.subscriptionId)return o.error(u+"subscriptionId not specified."),!1;if(!t.resourceGroupName)
return o.error(u+"resourceGroupName not specified."),!1;if(!t.resourceGroupLocation)return o.error(u+"resourceGroupLocation not specified."),!1;if(i){if("subscriptionId"in i&&i.subscriptionId!==t.subscriptionId)return o.error(u+"subscriptionId was changed in the create process."),!1;if("resourceGroupName"in i&&i.resourceGroupName!==t.resourceGroupName)return o.error(u+"resourceGroupName was changed in the create process."),!1;if("resourceGroupLocation"in i&&i.resourceGroupLocation!==t.resourceGroupLocation)return o.error(u+"resourceGroupLocation was changed in the create process."),!1}}else return o.error(u+"galleryParameters not specified."),!1;if(i){if(i.deploymentTemplateFileUris){if(!t.templateJson&&!n._findPropInObject(t.selectedTemplateId,i.deploymentTemplateFileUris))return o.error(u+"templateJson wasn't defined and selectedTemplateId isn't defined in the deploymentTemplateFileUris."),!1}else return o.error(u+"deploymentTemplateFileUris not specified."),!1;if(!("deploymentName"in
i))return o.error(u+"deploymentName not specified."),!1}else return o.error(u+"configurationOptions not specified."),!1;return r?!0:(o.error(u+"create outputs not specified."),!1)},n._findPropInObject=function(n,t){n=n.toLowerCase();for(var i in t)if(t.hasOwnProperty(i)&&n===(i+"").toLowerCase())return t[i];return null},n.prototype._notify=function(n){var t={title:s.createResourceFailedLabel,description:n,status:i.Hubs.Notifications.NotificationStatus.Error};e.getNotificationManager().addClientNotification(t)},n.prototype._getGalleryItemId=function(n){var t=n&&n.id,r=(n||{}).launchingContext,i;return t=r&&r.galleryItemId||t,t&&(i=t.split("."),i.length>1&&(t="{0}.{1}".format(i[0],i[1]))),t},n.prototype._deployTemplate=function(n){var t=new Date;return h.deployTemplate(n).then((function(n){var i=n&&n.timestamp&&new Date(n.timestamp.valueOf());return i&&i.getTime()<=t.getTime()&&(i=new Date(t.getTime()+1)),{correlationId:n.correlationId,timestamp:i}}))},n})();t.CsmCommand=b}));define("MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector",
["require","exports","f","i","o","ko","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function w(){return c||(c=i.require("MsPortalImpl/UI/Hubs/UI.CreateManager")),c}function b(n,t){f.bindingHandlers.fxParameterCollector={init:function(){return{controlsDescendantBindings:!1}},update:function(i,r,u,e,o){var s=f.unwrap(r());s&&new a($(i),s,n,t,o.$data.cloudName||f.observable())}}}var l,a;u.defineProperty(t,"__esModule",{value:!0});var y=i.Base.Constants.ExtensionNames.Hubs,p=i.Base.Diagnostics.createLog(n),v=h.Part.Provisioning,c;l=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(s.ViewModel);t.ViewModel=l;a=(function(n){function t(t,u,s,h,c){var g=n.call(this,t,u||new l)||this,a=u.privatePcPrBI,b=g.ltm,k,d;return a.triggerProvisioningInStartboardPart.
subscribe(b,(function(n){var t;if(n){var u=a.provisioningPartExtensionName(),f=a.provisioningPartName(),o=e.Locator.forExtension(u,c.peek()).withPartType(f);u===y&&(n=i.clone(n,!0),r.Extension.CloudName.addToModel(c.peek(),n));s.addPartToStartBoard({originPartLocator:o,model:n,modelContainsSensitiveData:!0,initialSize:2});t=s.getActiveJourney();t&&a.forceDiscardJourney()&&s.forceDiscardJourney(t.id)}})),k=function(){a.provisioningCommand(new o.CsmCommand(c.peek()))},a.triggerProvisioningCommand.subscribe(b,k),a.triggerProvisioningCommand.peek()&&f.ignoreDependencies(k),a.provisioningAttempted.subscribe(b,(function(n){if(n){var t=s.getActiveJourney();t&&a.forceDiscardJourney()&&s.forceDiscardJourney(t.id)}})),d=function(n){n&&(n.galleryParameters?w().then((function(t){return t.processResourceGroupChange(h,n.galleryParameters,n.configurationOptions,n.deploymentResponse,c.peek()).then((function(){return a.provisioningCompleted({succeeded:!0})}),(function(n){return a.provisioningCompleted({succeeded:
!1,statusUnavailable:n===v.deploymentStatusUnavailable,pollingFailed:n===v.pollingFailed,errorMessage:n})}))})):p.error("galleryParameters should be specified in the provisioningStarted object."))},a.provisioningStarted.subscribe(b,(function(n){return d(n)})),d(a.provisioningStarted()),g}return __extends(t,n),t})(s.Widget);t.Widget=a;t.initialize=b}));define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding",["require","exports","f","o","a","ko","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(){function h(n,t){var i=f.unwrap(n()),r=l(i,t);return function(){return r}}function l(n,t){var f;if(n&&typeof n=="object")return f={},r.getOwnPropertyNames(n).forEach((function(r){i.isSerializableProperty(r)&&(e.isAllowedCssClassName(r)?f[r]=n[r]:r&&t.push(r))})),f;var o=String(n||""),s=o.split(" "),h=u.prototype.map.call(s,(function(n){return n=String(n||""),e.isAllowedCssClassName(n)?n:(n&&t.push(
n),"")}));return h.join(" ")}function a(t,i){var r=t.getAttribute("data-bind")||"None",u=c.format(String(t.tagName),r,i.join(", "));o.logToExtension(n,t,2,u,{})}var c="Sanitization error found in 'sanitizedCss' binding\nTag name: {0}; Binding attribute: \"{1}\"\nDisallowed class name(s): {2}",s=f.bindingHandlers,t=s.css;s.sanitizedCss={init:function(n,i,r,u,f){if(t.init){var e=h(i,[]);return t.init(n,e,r,u,f)}return null},update:function(n,i,r,u,f){var e=[],o=h(i,e);return e.length&&a(n,e),t.update(n,o,r,u,f)}}})(s||(s={})),s}));define("MsPortalImpl/Base/ClaimsIdentity",["require","exports","f","i","o","a","MsPortalImpl/Services/Services.Storage"],(function(n,t,i,r,u,f,e){"use strict";function h(n){var t=Q.defer(),i=new FileReader,u="data:image/jpeg;base64,";return i.onload=function(n){for(var i=n.target.result,r="",e=new Uint8Array(i),f=0;f<e.byteLength;f++)r+=String.fromCharCode(e[f]);try{atob(r);i=u+r}catch(o){if(o.code===5)i=u+btoa(r);else{t.reject(o);return}}t.resolve(i)},i.onerror=function(
){return t.reject(r.createError("Error reading thumbnail photo. Error:"+i.error))},i.readAsArrayBuffer(n),t.promise}function c(n,t,i,r){var u=t,f,o;return n&&(f=e.ComponentName.Avatar,o=0,u=!r&&i.getValue(f,n,o),!u)?Q(s.ajax({uri:n,type:"GET",dataType:"binary",responseType:"arraybuffer",isBackgroundTask:!0,performRetry:!0,setAuthorizationHeader:{resourceName:"graph"}})).then((function(n){return h(n)})).catch((function(n){var i=n.jqXHR&&n.jqXHR.status;return i===404||i===403?t:Q.reject(n)})).then((function(t){return i.setValue(f,n,t,o),t})):Q(u)}u.defineProperty(t,"__esModule",{value:!0});var o=i.Base,s=o.Net2;t.getAvatarImage=c}));define("MsPortalImpl/Services/Services.AssetManagement",["require","exports","f","i","o","$","MsPortalImpl/Services/Services.AssetTypes"],(function(n,t,i,r,u,f,e){"use strict";function y(n){return new h(n,l.client)}var h;u.defineProperty(t,"__esModule",{value:!0});var o=i.Base,l=r.Rpc,s=i.ViewModels.Services.ResourceTypes,c=o.Constants.ResourceTypes,a=o.Constants.ExtensionNames.
Hubs,v=o.Diagnostics.createLog(n);t.createAssetManager=y;h=(function(){function n(n,t){var o=this,u;this._assetDeletedCallbacks=f.Callbacks();u=function(t,i,u){var f,l,y,h;u.reason=u.reason||"Received asset deletion notification from the extension '"+t+"'";u.extensionName===a&&(i.cloudName=u.cloudName);f=u.assetId;l=u.assetType;l===r.AssetManager.resourceAssetType?(y=i.cloudName,h=s.buildResourceTypeFromResourceId(f),s.isSubscriptionId(f)?h=c.Subscriptions:s.isResourceGroupId(f)&&(h=c.ResourceGroups),h&&n.mapResourceIdToAssetId(f,y).then((function(n){o.handleAssetDeleted({cloudName:y,name:n.extensionName},n.assetType,n.assetId,u.reason)})).catch((function(n){(n&&n.message||"").indexOf(e.failedToFindAssetTypePrefix)!==0&&v.warning(n)}))):o.handleAssetDeleted(i,l,f,u.reason)};t&&(r.AssetManager.notifyAssetDeletedDefinition.register(t,null,(function(n,t){var f=t.srcWindowId,e=r.Extension.getDescriptor(f);i.makeArray(n).forEach((function(n){u(f,e,n)}))})),r.AssetManager.hubsNotifyAssetDeletedDefinition.
register(t,[r.Extension.getHubsWindowId()],(function(n,t){var r=t.srcWindowId;i.makeArray(n).forEach((function(n){u(r,{cloudName:n.cloudName,name:n.extensionName},n)}))})))}return n.prototype.onAssetDeleted=function(n){this._assetDeletedCallbacks.add(n)},n.prototype.markAssetDeleted=function(n,t,i,r){this.handleAssetDeleted(n,t,i,r)},n.prototype.handleAssetDeleted=function(n,t,i,r){this._assetDeletedCallbacks.fire(n,t,i,r)},n})();t.AssetManagerImpl=h}));define("MsPortalImpl/Services/Services.Permissions",["require","exports","f","i","o","FxHubs/Permissions"],(function(n,t,i,r,u,f){"use strict";function b(n,t){return new a(n,t)}function k(n,t,i){return h.hasPermissionsToHubs.invoke(e.client,o,{entityId:n,requestedActions:t,providedActions:null,cloudName:i})}function d(n,t){return h.getPermissionsToHubs.invoke(e.client,o,{entityId:n,cloudName:t})}function g(n){return h.isCoAdminEndpoint.invoke(e.client,o,{cloudName:n})}var a;u.defineProperty(t,"__esModule",{value:!0});var v=r,s=v.Extension,c=i.
Base,y=c.Diagnostics,e=r.Rpc,p=i.ViewModels.Services.ResourceTypes,l=f.PermissionChecker,h=f.Rpc,o=s.getHubsWindowId(),w=y.createLog(n);t.Internal={};t.createPermissionsManager=b;a=(function(){function n(n,t){var r=this,i;this._extensionManager=n;this._assetTypeService=t;i=f.createCachedPermissionsGetter(d);this._cachedPermissionsGetter=i;this._getPermissionsCallback=function(n,t){return i.getPermissions(n,t)};s.hasPermissionsToShell.register(e.client,null,(function(n,t){var i=t.srcWindowId;return i!==o&&i!==c.Constants.Shell&&(n.cloudName&&w.warning("{0} should not pass cloud name".format(i)),n.cloudName=s.getDescriptor(t.srcWindowId).cloudName),r.hasPermission(n.entityId,n.requestedActions,n.cloudName)}))}return n.prototype.isCoAdmin=function(n){return g(n)},n.prototype.hasPermission=function(n,i,r){return t.Internal.hasPermissionOverride?t.Internal.hasPermissionOverride(n,i):l.isRDFEAction(i)?k(n,i,r):p.isResourceManagerId(n,!0)?l.hasPermission(n,i,null,r,this._getPermissionsCallback):
Q("The entity ID for hasPermission must be a resource ID, a subscription ID or a resource group ID")},n.prototype.getCachedPermissions=function(n){return this._cachedPermissionsGetter.getCachedPermissions(n)},n})()}));define("MsPortalImpl/UI/Commands/UI.CommandManager",["require","exports","f","i","ko","$","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(t){function w(n){return new c(n)}function l(n){var r,i,t;if((p?n.metaKey:n.ctrlKey)||(r=v.getSelection(),r.rangeCount&&!r.getRangeAt(0).collapsed)||(i=f(n.target),i.filter("input,textarea").length)||i.add(f(n.target).parents("a")).filter("a[href]:not([href='#']):not([href=''])").length)return!0;n.preventDefault();n.stopPropagation();t=f.Event(h.default.fxcontextmenurequest);t.pageX=n.pageX;t.pageY=n.pageY;t.clientX=n.clientX;t.clientY=n.clientY;i.trigger(t)}var
a=r.TriggerableLifetimeManager,v=window,y="<div class='fxs-commands-contextMenu'><\/div>",p=navigator.platform.indexOf("Mac")!==-1,c;t.createCommandManager=w;t.onContextMenu=l;c=(function(){function t(n){this._previouslyFocusedElement=u.observable();this._ltm=new a;this._body=f("body");this._desktop=n;this._initializeContextMenu()}return t.prototype.dispose=function(){this.stopListeningForEvents();this._ltm.dispose()},t.prototype.startListeningForEvents=function(){var u=this,n=this._body;n.on(h.default.fxcontextmenu,this._fxMenuEventHandler=function(n,t){u._showContextMenu(n,t)}).on(h.default.contextmenu,this._browserMenuEventHandler=function(n){l(n)});var t=this._contextMenuElement,i=this._desktop.portalWidget,r=i&&i.element;return r?r.append(t):n.append(t),this},t.prototype.stopListeningForEvents=function(){var n=this._body;this._fxMenuEventHandler&&(n.off(h.default.fxcontextmenu,this._fxMenuEventHandler),this._fxMenuEventHandler=null);this._browserMenuEventHandler&&(n.off(h.default.contextmenu,
this._browserMenuEventHandler),this._browserMenuEventHandler=null);this._contextMenu.hide();this._contextMenuElement.detach()},t.prototype.getFormTarget=function(){var t=this;return this._formTargetPromise||(this._formTargetPromise=i.require("../UI.PortalFormTarget",n).then((function(n){return new n.PortalFormTarget(t._desktop,t._ltm,t._previouslyFocusedElement)}))),this._formTargetPromise},t.prototype._initializeContextMenu=function(){this._contextMenuElement=f(y);this._contextMenu=new s.Widget(this._contextMenuElement);this._contextMenu.hide()},t.prototype._showContextMenu=function(n,t){var y=this,h=t.contextMenu?t.contextMenu:this._contextMenu,v=h.options.menuItems,r,u,p,c=n.clientX,l=n.clientY,a,i,s;if(t.commands&&t.commands.length!==0){if(t.srcElement){for(a=t.srcElement,i=a,f(a).hasClass("fxs-tile")&&(i=f(a).find(".fxs-part")[0]);i&&typeof i.focus!="function";)i=f(i).closest("[tabindex]")[0];this._previouslyFocusedElement(i)}p=t.formTarget&&t.formTarget.length>0?function(){return Q(
e.getBladeContentWidget(t.formTarget))}:function(){return y.getFormTarget()};h.hide();v.splice(0,v().length);do u=u?u.parentNode:n.target,r=f(u).data(o.CompositionInstanceDataName);while(!r&&u.parentNode);(o.isContextMenuContainer(r)&&r.beforeActivateCommandMenuItems(t),t.commands.forEach((function(t){y._shouldShowCommand(t)&&(t.activate(),t.bind(new e.CompositionInstanceCommandContext(n.target,p,r)),v.push(t))})),h.options.hasVisibleCommands())&&(c||l||(s=n.target.getClientRects()[0],c=s&&s.left||c,l=s&&s.bottom||l),h.show(c,l,t&&t.forceLeft))}},t.prototype._shouldShowCommand=function(n){return this._desktop.mode()!==1||!this._isExtensionCommand(n)},t.prototype._isExtensionCommand=function(n){return!!n._extension},t})();t.PortalCommandManager=c})(c||(c={})),c}));define("MsPortalImpl/UI/Hubs/UI.BrowseManager",["require","exports","f","i","o","ko"],(function(n,t,i,r,u,f){"use strict";function y(n,t){var i=n.toLocaleLowerCase(),r=t.toLocaleLowerCase();return i===r?0:i<r?-1:1}function ut(n,t,i,
r){return new w(n,t,i,r)}function p(n){return function(){l(n||{},(function(n,t){t()}))}}var w;u.defineProperty(t,"__esModule",{value:!0});var o=i.Base,s=o.Constants,b=s.ResourceTypes.ResourceGroups,k=o.Diagnostics,h=i.ViewModels.Services,d=h.Browse,g=h.GridColumns,c=i.getUniqueId,e=k.createLog(n),nt=b.toLowerCase(),l=i.forEachKey,tt=1,a=3,v=0,it=i.isFeatureEnabled("supportthirdpartyresources"),rt=r.getErrorMap({badCriteria:""});t.compareAssetTypeForSort=y;t.createBrowseManager=ut;w=(function(){function n(n,t,u,e){var h=this,s,o;if(this._browsePackages={},this._registeredResourceProviders=f.observableArray(["*"]),this._haveRdfeAccess=!1,this._callbacks={},this._isCoAdmin=!1,this._extensionManager=n,this._assetTypeService=t,this._permissionsService=u,s=this._ltm=new r.TriggerableLifetimeManager,o=p(this._callbacks),this._registeredResourceProviders.subscribe(s,o),this._haveRdfeAccess=e(),e.subscribe(s,(function(n){h._haveRdfeAccess=n;o()})),i.isFeatureEnabled("loadassetsasync"))n.on("assetTypes",
(function(){return o(),t.assetTypes.subscribe(s,o),!0}));else n.on("assetTypes").then((function(){o();t.assetTypes.subscribe(s,o)}));s.registerForDispose((function(){l(h._browsePackages,(function(n,t){t.cancel();t.dispose()}));h._browsePackages=null}))}return n.prototype._assetTypeSupportsCriteria=function(n,t){return n.extension===t.assetOwner&&n.assetTypeManifest.name===t.assetType&&r.Extension.isEqualCloudName(n.cloudName,t.cloudName)},n.prototype._releaseViewModel=function(n,t){i.disposeViewModelProperties(t);n.releaseViewModel(t)},n.prototype._assetTypeMeetsRequirements=function(n){var i,s,r,u,f,e,o,h;if(!n)return!1;var t=n.browseType,c=n.browseRequirements&1,l=!c||this._isCoAdmin;if(t===undefined||!l)return!1;i=this._haveRdfeAccess;s=!n.browseRequiresRdfe||i;switch(t){case a:case v:case tt:if(!s)return!1}return(r=n.resourceType,!r)?!0:(u=r.resourceTypeName,f=u.toLowerCase(),f===nt)?!0:!it&&!i&&!f.startsWith("microsoft.")?!1:(e=u.split("/"),e.length<2)?!1:t===a?!0:(o=this._registeredResourceProviders,
o().some((function(n){return n.toLowerCase()==="*"})))?!0:(h=e[0].toLowerCase(),o().some((function(n){return n.toLowerCase()===h})))},n.prototype.dispose=function(){var n=this._ltm;n&&(n.dispose(),this._ltm=null)},n.prototype.initialize=function(){this._extensionManager.getHubsExtension()},n.prototype.registerAssetTypesUpdateCallback=function(n){var t=c();return this._callbacks[t]=n,t},n.prototype.unregisterAssetTypesUpdateCallback=function(n){var t=this._callbacks;t[n]&&delete t[n]},n.prototype.addRegisteredResourceProvider=function(n){this._registeredResourceProviders.push(n)},n.prototype.initiateBrowse=function(n){var t=this,u;return n||rt.badCriteria(),u=new d.ResultsViewModel(n,[]),i.require("MsPortalImpl/UI/Hubs/UI.BrowseManagerDelayed").then((function(i){var h="All browse operations returned.",l="browse-"+c(),f=new i.BrowsePackage(u,t),p=f.ltm;t._browsePackages[l]=f;var o=0,s=0,a=!1,y=[];return t._assetTypeService.assetTypes().forEach((function(i){var l,c;if(!f.canceled&&t._assetTypeSupportsCriteria(
i,n)&&(l=i.assetTypeManifest,l.browseType===v)){var u=function(){++s;a&&s===o&&(e.verbose(h),f.allOperationsReturned())},w=l.browseServiceViewModel,b=r.Extension.getWindowId({name:i.extension,cloudName:i.cloudName})+"."+l.name+"."+w;e.verbose("Browse provider "+b+" using optimized browse.");c="browse operation from "+b+" browse provider";y.push(t._extensionManager.getExtensionByName(i.extension,i.cloudName).then((function(r){return Q(r.getViewModel(w)).then((function(o){var s=o.content,h,a,l;s?(h=!1,p.registerForDispose((function(){h=!0;t._releaseViewModel(r,o)})),h?(e.verbose("The "+c+" was already disposed."),u()):(a=function(n,t){f.canceled||(e.verbose("Got "+c+"."),f.addOperation(i,n,t));u()},l=void 0,typeof s.onInputsSet=="function"&&(l=s.onInputsSet({criteria:n})),Q(l||!0).then((function(){a(b,s)})).catch((function(n){e.verbose("The "+c+" rejected the load promise: "+n);u()})))):(e.verbose("$Failed to get the "+c+"."),u())})).catch((function(n){e.verbose("Failed to get browse operation "+w+
": "+n+".");u()}))})).catch((function(n){e.error("Failed to get extension for browse operation "+w+": "+n);u()})));e.verbose("Getting "+c+".");++o}})),a=!0,s===o&&(e.verbose(h),f.allOperationsReturned()),Q.all(y).then((function(){return l}))}))},n.prototype.getViewModelForBrowse=function(n){var t=this._browsePackages;return n in t?t[n].viewModel:null},n.prototype.releaseBrowse=function(n){var t=this._browsePackages,i;n in t&&(i=t[n],i.cancel(),i.dispose(),delete t[n])},n.prototype.getFilteredAssetTypes=function(){var n=this,t,r;return this._isCoAdminPromise||(this._isCoAdminPromise=Q(this._permissionsService.isCoAdmin(s.DefaultCloudName)).then((function(t){n._isCoAdmin!==t&&(n._isCoAdmin=t,p(n._callbacks)())}))),t=[],r=[],this._assetTypeService.assetTypes().forEach((function(i){var r=i.assetTypeManifest;n._assetTypeMeetsRequirements(r)&&(r.privateBrowse||t.push(i))})),t.length&&i.stableSort(t,(function(n,t){return y(n.compositeDisplayName.service,t.compositeDisplayName.service)})).forEach((function(n)
{r.push(n)})),r},n.prototype.getGridColumnsPromiseForAssetType=function(n,t){var r=this,i=n.assetTypeManifest.gridColumnsServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension,n.cloudName)).then((function(n){return Q(n.getViewModel(i)).then((function(i){var e=!1,u,f;return(t.registerForDispose((function(){e=!0;r._releaseViewModel(n,i)})),!e)?(u=i.content,f=void 0,typeof u.onInputsSet=="function"&&(f=u.onInputsSet({usage:g.Usage.Default})),f)?f.then((function(){return u})):u:Q.reject("The grid columns service view model was already disposed.")}))})):Q.reject("The asset type does not have a grid columns service view model.")},n.prototype.getDynamicBladePromiseForAssetType=function(n,t){var r=this,i=n.assetTypeManifest.dynamicBladeServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension,n.cloudName)).then((function(n){return Q(n.getViewModel(i)).then((function(i){var u=!1;return(t.registerForDispose((function(){u=!0;r._releaseViewModel(n,i)})),!u)?i.
content:Q.reject("The dynamic blade service view model was already disposed.")}))})):Q.reject("The asset type does not have a dynamic blade service view model.")},n})()}));define("MsPortalImpl/UI/UI.ContextPane",["require","exports","o","ko","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function e(n){return new t(n)}n.create=e;var t=(function(){function n(n){var o=this,i,t,e;this._widget=n;i=this._viewModel=n.options;t=this._containerLifetime=n.ltm;this._contentLifetime=t.createChildLifetime();this.collapsed=i.collapsed;e={dismissFn:function(){o.close()},logName:"contextPane"};r.reactor(t,(function(){i.opened()?u.register(e):u.unregister(e)}));t.registerForDispose(n.element.setEvents([f.default.fxcontextpaneclosing,function(n){n.stopPropagation();o.close()}]))}return i.defineProperty(n.prototype,"opened",{get:function(){return this._viewModel.opened},enumerable:!0,configurable:!0}),n.prototype.
hasContent=function(n){return this._contentProvider===n},n.prototype.getContent=function(){return this._contentProvider},i.defineProperty(n.prototype,"contentLifetime",{get:function(){return this._contentLifetime},enumerable:!0,configurable:!0}),n.prototype.tryOpen=function(n){var r=this,t,i;return this._contentProvider===n?(this._widget.setFocus(),Q(!0)):(t=this._tryRemoveContent(),t)?(this._contentProvider=n,this._previouslyFocusedElement=document.activeElement,i=this._viewModel,i.opened(!0),i.loading(!0),n.onAddingContent(this._widget).finally((function(){i.loading(!1)})).then((function(){return r._widget.setFocus(),t}))):Q(t)},n.prototype.close=function(n){var t=!0,i;return n?this._clearContent():t=this._tryRemoveContent(),t&&(i=this._viewModel,i.opened(!1),i.loading(!1),this._restoreFocus()),t},n.prototype._clearContent=function(){var t=this._contentProvider,n;t&&t.onRemovingContent(this._widget);this._contentProvider=null;n=this._contentLifetime;n&&(n.dispose(),this._contentLifetime=
this._containerLifetime.createChildLifetime())},n.prototype._tryRemoveContent=function(){var n=this._contentProvider,t;return n?(t=!n.canRemoveContent||n.canRemoveContent(),t&&this._clearContent(),t):!0},n.prototype._restoreFocus=function(){var n=this._previouslyFocusedElement;n&&n.focus()},n})();n.ContextPaneImpl=t})(e||(e={})),e}));define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter",["require","exports","f","o"],(function(n,t,i,r){"use strict";var u;return (function(n){var t={pending:"pending"},u=(function(){function n(n,t){this.deferred=i.Helpers.Deferred();this.targetId=n;this.isSource=t}return n})(),f=(function(){function n(n){this._awaitableCompositions=[];this.resolvedCompositions=[];this._trackResolvedCompositions=n}return n.prototype.await=function(n,i){var f=this,r=new u(n&&n.toString(),i),e=this.resolvedCompositions.firstIndex((function(n){return i(n)}));if(e>=0)r.deferred.resolve(this.resolvedCompositions[e]);else if(this._awaitableCompositions.push(r),n)n.onDispose(
(function(){var n;r.deferred.state()===t.pending&&(r.deferred.reject(),n=f._awaitableCompositions.indexOf(r),n>=0&&f._awaitableCompositions.splice(n,1))}));return r.deferred.promise()},n.prototype.resolve=function(n){var r=this,t,i;if(this._trackResolvedCompositions){this.resolvedCompositions.push(n);n.onDispose((function(){var t=r.resolvedCompositions.indexOf(n);t>=0&&r.resolvedCompositions.splice(t,1)}))}for(t=this._awaitableCompositions.length-1;t>=0;t--)i=this._awaitableCompositions[t],i.isSource(n)&&(i.deferred.resolve(n),this._awaitableCompositions.splice(t,1))},r.defineProperty(n.prototype,"waitingCompositions",{get:function(){return this._awaitableCompositions.map((function(n){return n.targetId}))},enumerable:!0,configurable:!0}),n})();n.CompositionAwaiter=f})(u||(u={})),u}));define("MsPortalImpl/UI/Compositions/UI.Composition.DashboardFiltersManager",["require","exports","f","i","o","a","ko","Fx/Composition/DashboardFilters","MsPortalImpl/Base/Languages","MsPortalFx/Globalization","MsPortalImpl.Controls/Controls/ResourceFilterHelper",
"MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function g(n,t){var r,i,u;if(!t)return!1;r=!1;switch(n){case 0:i=t;r=i.absolute&&!!i.absolute.fromDate&&!!i.absolute.toDate||i.relative&&typeof i.relative.duration=="number"&&typeof i.relative.timeUnit=="number";break;case 1:case 2:case 3:case 5:case 4:u=t;r=typeof u.operator=="number"&&(u.values||[]).length>0}return r}function ni(n,t){var r=JSON.parse(t||"{}"),i,u,f;return n===0&&(i=r.absolute,i&&(u=i.fromDate,f=i.toDate,i.fromDate=new Date(u),i.toDate=new Date(f))),r}function ot(n){var r=n&&n.selectedDisplayLanguage||"",u=n&&n.selectableDisplayLanguages||[],t=i.find(u,(function(n){return n.locale&&n.locale.localeCompareIgnoreCase(r)===0}));return t&&t.specificCulture||"en-us"}function nt(n,t,i){if(!t)return"";switch(n){case 0:var r=i,u=r.format;switch(u){case 1:return a.Filtering.Edit.TimeRange.localTime;case 0:return a.Filtering.Edit.TimeRange.
utcTime;default:return a.Filtering.Intrinsics.timeRange}case 1:case 2:case 3:case 5:case 4:return t.displayText;default:return b.error("Unknown filter kind: "+n),""}}function st(n){var i=n&&n.absolute,r=n&&n.relative,t;if(i)return a.Filtering.TimeRange.absolute.format(d.create(d.shortDatePattern).format(new Date(i.fromDate)).toString(),d.create(d.shortDatePattern).format(new Date(i.toDate)).toString());t=r.duration;switch(r.timeUnit){case 0:return a.Filtering.TimeRange.Relative.minutes.format(t);case 1:return t===1?a.Filtering.TimeRange.Relative.hour.format(t):a.Filtering.TimeRange.Relative.hours.format(t);case 2:return t===1?a.Filtering.TimeRange.Relative.day.format(t):a.Filtering.TimeRange.Relative.days.format(t);default:b.error("Unknown Time unit: "+r.timeUnit)}}function k(n){var t=n.kind;return t&&w[t]&&w[t].filterId||n.filterId}function tt(n){var t=n&&i.find(w,(function(t){return t&&t.filterId===n}));return t&&t.kind}function ct(n){var t=n.filterKind;return w[t]?w[t].filterId:n.filterId}
function lt(n){var t=tt(n);return typeof t=="number"&&w[t]}function at(n){return n.map((function(n){return n.text})).join(", ")}function v(n,t,i){var u="Invalid filter value: '"+JSON.stringify(n)+"'; filter id: '"+t+"'; part: '"+i.locator.toString()+"'",r;if(r)throw r;else b.error(u)}var ht,vt,p,it,rt,ut,ft,et;u.defineProperty(t,"__esModule",{value:!0});var yt=i.Base,pt=o.TimeRangeFilter,wt=o.ResourceTypeFilter,bt=i.ViewModels.Services.ResourceTypes.parseResourceGroupDescriptor,kt=i.ViewModels.Services.ResourceTypes.buildResourceGroupIdFromDescriptor,dt=r.Rpc,gt=yt.Diagnostics,b=gt.createLog(n),d=h.DateTimeFormat,y=i.Base.Constants.DefaultCloudName,w=(function(){var n=[{kind:0,filterId:o.TimeRangeFilter.filterId,displayText:a.Filtering.Intrinsics.timeRange},{kind:2,filterId:o.SubscriptionFilter.filterId,displayText:a.Filtering.Intrinsics.subscription},{kind:3,filterId:o.LocationFilter.filterId,displayText:a.Filtering.Intrinsics.location},{kind:5,filterId:o.ResourceGroupFilter.filterId,displayText:
a.Filtering.Intrinsics.resourceGroup},{kind:4,filterId:wt.filterId,displayText:a.Filtering.Intrinsics.resourceType},];return n.reduce((function(n,t){return n[t.kind]=t,n}),[])})();ht={relative:{duration:24,timeUnit:1},format:0,granularity:0};vt=(function(){function n(n){var t=this,f;this._filtersLocale=e.observable();this._children=e.observableArray([]);this._allFilterDefinitions=e.observableArray([]);this._addableFiltersDefinitions=e.observableArray([]);this._appliedFilters=e.observableArray();this._hasMoreFilters=e.observable(!0);this._queryingParts=e.observable(!1);this._hasLoaded=e.observable(!1);this._currentSessionLocale=ot(s.currentLocaleContext);this._staticFilters=e.observableArray([]);this._dynamicFilters=e.observableArray([]);this._equalityFilterRuntimes=[];this._notifyStartboardSettingsChanged=i.throttle((function(){t._parent.widget&&t._parent.widget.trigger("fxstartboardsettingchanged")}),1e3);this._checkAppliedFiltersAreValid=i.debounce((function(){var i=t._allFilterDefinitions.
peek(),n=t._appliedFilters.peek().filter((function(n){return!!n&&n.kind()===0})).first(),r=i.filter((function(n){return!!n&&n.kind===0})).first(),u;!n&&r&&(u={id:e.observable(null),kind:e.observable(null),kindLifetime:t._dashboardLifetime.createChildLifetime(),model:e.observable(null),isApplicable:e.observable(!0),filterIdDisplayText:"",operator:0,filterValueDisplayText:"",warningMessage:e.observable()},t.filtersWidgetViewModel.updateTimeRangeFilter(u,ht,!0));n&&n.isApplicable(!!r);t._hasLoaded()&&t._appliedFilters.peek().forEach((function(n){if(n.kind()!==0){var t=i.some((function(t){return k(t)===n.id()}));n.isApplicable(t)}}))}),200);this._getDynamicFilterDefinitions=i.memoizeQ((function(n){return t._getDynamicFilters(n)}));this._getDynamicFilters=i.debounce((function(n){return t._getDashboardFilteringAPIs(n).then((function(n){var i=Q.all(n.mapMany((function(n){return n&&n.getDynamicFilterDefinitions?[n.getDynamicFilterDefinitions()]:[]}))),t={};return i.then((function(n){n.forEach((function(n){n.forEach(
(function(n){var i=n,r=i&&i.definition&&k(i.definition);r&&(t[r]=i)}))}))})).then((function(){return u.keys(t).map((function(n){var i=t[n],r=lt(n)||i.definition;return{definition:r,logTelemetry:i.logTelemetry}}))}))}))}));this._getStaticFilterDefinitions=i.memoizeQ((function(n){return t._getStaticFilters(n)}));this._getStaticFilters=i.debounce((function(n){return t._getDashboardFilteringAPIs(n).then((function(n){var t=n.reduce((function(n,t){var r=t&&t.staticFilters&&t.staticFilters.map(ct);return r&&i.pushUnique(n,r,null,!0),n}),[]);return Q.all(n.mapMany((function(n){return n&&n.getFilterDefinitions?[n.getFilterDefinitions()]:[]}))).then((function(n){return t.mapMany((function(t){var r=lt(t);return r||n.some((function(n){return!!(r=i.find(n,(function(n){return n&&k(n)===t})))})),r?[r]:[]}))}))}))}));this._parent=n;this._children(n.children.map((function(n){return n})));this._initializeFiltersWidgetsViewModel();e.reactor(n,[this._staticFilters,this._dynamicFilters,this._appliedFilters],(function(n,i){t._allFilterDefinitions(
n.concat(i.map((function(n){return n.definition}))));t._updateState()}));e.reactor(n,this._hasLoaded,(function(){return t._updateState()}));this._children.subscribeArrayBulkChanges(this._parent,(function(){t._hasLoaded(!1);t._getStaticFilterDefinitions(t._children.peek()).then((function(n){t._staticFilters(n)}))}));n.subscribeChildren((function(){t._children(t._parent.children.map((function(n){return n})))}));f={getAllSubscriptions:function(n){return Q(r.Azure.getAllSubscriptions(dt.client,n))},getSelectedSubscriptions:l.getSelectedSubscriptions,selectedSubsUpdateTriggered:l.selectedSubsUpdateTriggered};this._equalityFilterRuntimes[1]=new it;this._equalityFilterRuntimes[2]=new rt(f);this._equalityFilterRuntimes[3]=new ut({getLocations:c.getLocations});this._equalityFilterRuntimes[5]=new ft(f);this._equalityFilterRuntimes[4]=new et(this._parent.services.assetTypeService)}return n.prototype.getFilters=function(){var n=this;return e.ignoreDependencies((function(){return n._appliedFilters().reduce((function(
t,i){var r=i.id(),u=i.model(),f=i.kind(),e=typeof r=="string"&&g(f,u);return e&&(t[r]=n._denormalizeFilterModel(f,u)),t}),{})}))},n.prototype.updateFilters=function(n,t){var r=this,u=[],f=[],o=this._appliedFilters;return t.forEach((function(t){var s=t.filterId,l=i.find(o.peek(),(function(n){return n.id()===s})),v=i.find(r._allFilterDefinitions.peek(),(function(n){return n.filterId===s})),h=tt(s)||1,c=r._normalizeFilterModel(h,t.filterModel),a;l?l.model(c):(a=n.getDashboardFiltering().then((function(i){return r._getValueText(s,h,t.filterModel,n,i).then((function(n){o.push({id:e.observable(t.filterId),kind:e.observable(h),kindLifetime:r._dashboardLifetime.createChildLifetime(),model:e.observable(c),isApplicable:e.observable(!0),filterIdDisplayText:nt(h,v,c),operator:r._getOperator(c),filterValueDisplayText:n,warningMessage:e.observable()})}))})),f.push(a));u.push(s)})),Q.all(f).then((function(){return r._notifyFiltersChanged(u,n)}))},n.prototype.loadDashboard=function(n){var i=this,r,t,f,o;this.dispose(
);r=this._dashboardLifetime=this._parent.createChildLifetime();this._filtersLocale(n&&n.filterlocale||this._currentSessionLocale);t=n&&n.filters||{};f=u.keys(t).map((function(n){var u=t[n],f=u.kind,o=ni(f,u.model),s;if(g(f,o))return s={id:e.observable(n),kind:e.observable(f),kindLifetime:r.createChildLifetime(),model:e.observable(o),isApplicable:e.observable(!0),filterIdDisplayText:u.displaycache.name,filterValueDisplayText:u.displaycache.value,operator:i._getOperator(o),warningMessage:e.observable()},i._activateFilter(s),s})).filter((function(n){return!!n}));(o=this._appliedFilters).push.apply(o,f)},n.prototype.cleanupState=function(){this._dashboardLifetime&&(this._dashboardLifetime.dispose(),this._dashboardLifetime=null);this._getDynamicFilterDefinitions.clear();this._getStaticFilterDefinitions.clear();this._appliedFilters([]);this._staticFilters([]);this._dynamicFilters([]);this._allFilterDefinitions([]);this._addableFiltersDefinitions([]);this._filtersLocale("");this._hasLoaded(!1);this.
_queryingParts(!1)},n.prototype.setFilters=function(n){var i=this,t;this._dashboardLifetime||(this._dashboardLifetime=this._parent.createChildLifetime());t=u.keys(n).map((function(t){var r=n[t];return{id:e.observable(t),kind:e.observable(r.filterKind),kindLifetime:i._dashboardLifetime.createChildLifetime(),model:e.observable(r.filterModel),isApplicable:e.observable(!0),filterIdDisplayText:"",filterValueDisplayText:"",operator:0,warningMessage:e.observable()}}));this._appliedFilters(t)},n.prototype.toJSON=function(){var n={filterlocale:ot(s.currentLocaleContext),filters:{}},t=this._appliedFilters.peek();return t.forEach((function(t){n.filters[t.id()]={model:JSON.stringify(t.model()),kind:t.kind(),displaycache:{name:t.filterIdDisplayText,value:t.filterValueDisplayText}}})),n},n.prototype._initializeFiltersWidgetsViewModel=function(){var n=this;this.filtersWidgetViewModel={sourceChanged:e.observable(!0),filterRequestInProgress:this._queryingParts,canAddFilter:this._hasMoreFilters,filters:this.
_appliedFilters,addableFilterDefinitions:this._addableFiltersDefinitions,updateEqualityFilter:function(t,i,r,u){var f={operator:r,values:u.map((function(n){return n.value}))},e=at(u);n._updateFilter(t,i,f,e)},updateTimeRangeFilter:function(t,i,r){r===void 0&&(r=!1);n._updateFilter(t,pt.filterId,i,st(i),r)},removeFilter:function(t){var i=n._appliedFilters,r=i().firstIndex((function(n){return n.id()===t})),u;r>=0&&(u=i()[r],u.kindLifetime.dispose(),i.splice(r,1),n._notifyFiltersChanged([t]))},updateAllFilterDefinitions:function(t){if(t===void 0&&(t=!1),!t&&n._hasLoaded()||n._queryingParts())return Q();n._queryingParts(!0);var i=n._children.peek();return Q.all([n._getStaticFilterDefinitions(i),n._getDynamicFilterDefinitions(i)]).spread((function(t,i){n._staticFilters(t);n._dynamicFilters(i)})).catch((function(n){b.error(n)})).finally((function(){n._hasLoaded(!0);n._queryingParts(!1)}))},getFilterValues:function(t,u){function o(n){return i.find(n,(function(n){return k(n)===t}))}var e=new r.TriggerableLifetimeManager,
h=n._children.peek(),c=tt(t)||1,s=[],l=h.map((function(n){return n.getDashboardFiltering().then((function(t){var i=t&&t.getFilterDefinitions&&t.getFilterDefinitions(),r=t&&t.getDynamicFilterDefinitions&&t.getDynamicFilterDefinitions();return i&&e.registerForDispose(i.hold()),r&&e.registerForDispose(r.hold()),Q.all([i||Q([]),r||Q([])]).spread((function(i,r){var u=f.isArray(i)&&o(i)||f.isArray(r)&&o(r.map((function(n){return n.definition})));u&&s.push({part:n,getLocalizedFilterValues:t.getLocalizedFilterValues,filterDefinition:u})}))}))}));return Q.allSettled(l).then((function(){return n._getFilterValues(t,c,s,u||"")})).finally((function(){return e.dispose()}))},getFilterDefinition:function(t){return n._allFilterDefinitions.peek().filter((function(n){return n.filterId===t})).first()}}},n.prototype._updateFilter=function(n,t,r,u,f){var h,o,e,s;(f===void 0&&(f=!1),h=i.find(this._allFilterDefinitions.peek(),(function(n){return t===n.filterId})),o=h.kind,g(o,r))&&(e=i.find(this._appliedFilters.peek(),(function(
t){return t.id()===n.id()})),s=!1,e?(e.id()!==t&&(e.kind(o),e.id(t),e.kindLifetime.dispose(),e.kindLifetime=this._dashboardLifetime.createChildLifetime(),this._activateFilter(e),s=!0),JSON.stringify(e.model())!==JSON.stringify(r)&&(e.model(r),e.filterIdDisplayText=nt(o,h,r),e.operator=this._getOperator(r),e.filterValueDisplayText=u,s=!0)):(n.id(t),n.kind(o),n.model(r),n.filterIdDisplayText=nt(o,h,r),n.operator=this._getOperator(r),n.filterValueDisplayText=u,n.kindLifetime=this._dashboardLifetime.createChildLifetime(),this._activateFilter(n),s=!0,n.kind()===0?this._appliedFilters.unshift(n):this._appliedFilters.push(n)),s&&this._notifyFiltersChanged([t],null,f))},n.prototype._getOperator=function(n){return n&&n.operator||0},n.prototype._updateState=function(){var n=this._appliedFilters.peek();this._addableFiltersDefinitions(this._allFilterDefinitions.peek().filter((function(t){var i=n.some((function(n){return!!t&&n.id()===t.filterId}));return!i})));this._hasMoreFilters(!this._hasLoaded()||!!this.
_addableFiltersDefinitions().length);this._checkAppliedFiltersAreValid()},n.prototype._notifyFiltersChanged=function(n,t,i){var u=this,r;return i===void 0&&(i=!1),r=this._children.peek(),this._updateState(),Q.all(r.map((function(n){return n.getDashboardFiltering()}))).then((function(i){var u=[],f=[];return i.forEach((function(t,i){var r;t&&(t.staticFilters||[]).some((function(t){return n.indexOf(ct(t))>=0}))&&(r=!0);u[i]=r;f[i]=!r&&t&&t.getDynamicFilterDefinitions?t.getDynamicFilterDefinitions():Q([])})),Q.all(f).then((function(t){t.forEach((function(t,i){t.some((function(t){var i=t,r=i&&i.definition&&k(i.definition);return r&&n.indexOf(r)>=0}))&&(u[i]=!0)}))})).then((function(){u.forEach((function(n,i){if(n){var u=r[i];u.notifyFiltersChanged(u===t)}}))}))})).finally((function(){i||u._notifyStartboardSettingsChanged()}))},n.prototype._getDashboardFilteringAPIs=function(n){var t=this;return Q.all(n.map((function(n){return i.Base.Promises.cancelOnDispose(t._dashboardLifetime,Q(n.awaitComposed))}))).catchError(
i.Errors.CanceledError,(function(){})).then((function(){return Q.all(n.map((function(n){return n.getDashboardFiltering()})))}))},n.prototype.dispose=function(){this.cleanupState()},n.prototype._getValueText=function(n,t,i,r,u){if(t===0)return Q(st(i));var f=this._equalityFilterRuntimes[t],e=f&&f.createFilterValueViewModels(i,n,r,u.getLocalizedFilterValues)||Q([]).thenReject(new Error("Unknown filter kind: "+t));return e.then(at)},n.prototype._getFilterValues=function(n,t,i,r){var u=this._equalityFilterRuntimes[t];return u&&u.getFilterValues(n,i,r)||Q([]).thenReject(new Error("Unknown filter kind: "+t))},n.prototype._denormalizeFilterModel=function(n,t){return n===0?t:this._equalityFilterRuntimes[n].denormalizeFilterModel(t)},n.prototype._normalizeFilterModel=function(n,t){return n===0?t:this._equalityFilterRuntimes[n].normalizeFilterModel(t)},n.prototype._activateFilter=function(n){var i=n.kind,r=n.kindLifetime,t=i();t!==0&&this._equalityFilterRuntimes[t].activateFilter(r,n)},n})();t.DashboardFiltersManager=
vt;p=(function(){function n(){}return n.prototype.getFilterValues=function(n,t,i){var r=this,u=[],e=t.map((function(t){var f=t.part,e=t.filterDefinition;return Q(r._getFilterValues(e,i)).then((function(t){var e=(t||[]).filter((function(t){var i=r._isValidFilterValue(t);return i||v(t,n,f),i})),i=e.map((function(n){return r._normalizeFilterValue(n)})).filter((function(n){return!u.some((function(t){return r._equalNormalizedFilterValues(n,t)}))}));return u.push.apply(u,i),i}))})),f=[];return Q.allSettled(e).then((function(){return Q.allSettled(e.map((function(i,e){var o=i.inspect();if(o.state==="fulfilled"){var s=t[e],h=s.part,c=s.getLocalizedFilterValues;return r._createFilterValueViewModels(o.value,n,h,c,u).then((function(n){f.push.apply(f,n)}))}return Q([]).thenReject(o.reason)})))})).then((function(){var n=f;return i&&(n=n.filter((function(n){return n.text.indexOf(i)>=0}))),n.sort((function(n,t){return n.text.localeCompare(t.text)}))}))},n.prototype.createFilterValueViewModels=function(n,t,i,r){var u=this.normalizeFilterModel(
n).values;return this._createFilterValueViewModels(u,t,i,r,u)},n.prototype.activateFilter=function(){},n})();t.EqualityFilterRuntimeBase=p;it=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return n},t.prototype.denormalizeFilterModel=function(n){return n},t.prototype._getFilterValues=function(n,t){return Q(n.getFilterValues(t))},t.prototype._isValidFilterValue=function(n){return n&&typeof n=="string"||!!n.valueId},t.prototype._normalizeFilterValue=function(n){return n},t.prototype._equalNormalizedFilterValues=function(n,t){return typeof n=="string"?n===t:n.valueId===t.valueId},t.prototype._createFilterValueViewModels=function(n,t,r,u){var f=n.filter((function(n){return n&&n.valueId})),e=f.length?Q(u(t,f.map((function(n){return n.valueId})))).then((function(n){return f.reduce((function(u,f){var o=f.valueId,e=i.find(n||[],(function(n){return n.valueId===o}));return e&&e.value?u[o]=e.value:v(f,t,r),u}),{})})):
Q({});return e.then((function(i){return n.map((function(n){var u,f=0;return typeof n=="string"?u=n:n.valueId&&(u=i[n.valueId]),u||(v(n,t,r),u=n.valueId,f=3),{text:u,value:n,state:f}}))}))},t})(p);t.EqualityFilterRuntime=it;rt=(function(n){function t(t){var i=n.call(this)||this;return i._subscriptions=t,i}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return{operator:n.operator,values:n.subscriptionIds}},t.prototype.denormalizeFilterModel=function(n){return{operator:n.operator,subscriptionIds:n.values}},t.prototype.activateFilter=function(n,t){var i=this;e.reactor(n,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(function(){Q(i._subscriptions.getSelectedSubscriptions(y)).then((function(n){var i=t.model(),r=i&&i.values||[],u=r.some((function(t){return!n.some((function(n){return n.subscriptionId.toLowerCase()===t.toLowerCase()}))}));t.warningMessage(u?a.Filtering.Subscription.subscriptionFilterUsingExcludedSubscriptions:null)}))}))},t.prototype._getFilterValues=function(n)
{return Q(n.getSubscriptionIds())},t.prototype._isValidFilterValue=function(n){return n&&typeof n=="string"},t.prototype._normalizeFilterValue=function(n){return n.toLowerCase()},t.prototype._equalNormalizedFilterValues=function(n,t){return n===t},t.prototype._createFilterValueViewModels=function(n,t,r){var u=this._subscriptions.getAllSubscriptions(y),f=Q(this._subscriptions.getSelectedSubscriptions(y));return Q.all([u,f]).spread((function(u,f){return n.map((function(n){var e,o,s,h;return n=n.toLowerCase(),e=i.find(u,(function(t){return t.subscriptionId.toLowerCase()===n.toLowerCase()})),e?(o=e.uniqueDisplayName,h=f.some((function(t){return t.subscriptionId.toLowerCase()===n.toLowerCase()})),s=h?0:1):(v(n,t,r),o=n,s=3),{text:o,value:n,state:s}}))}))},t})(p);t.SubscriptionFilterRuntime=rt;ut=(function(n){function t(t){var i=n.call(this)||this;return i._locations=t,i}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return{operator:n.operator,values:n.locations}},t.prototype.denormalizeFilterModel=
function(n){return{operator:n.operator,locations:n.values}},t.prototype._getFilterValues=function(n,t){return Q(n.getLocations(t))},t.prototype._isValidFilterValue=function(n){return n&&typeof n=="string"||!!n.name||!!n.valueId},t.prototype._normalizeFilterValue=function(n){return n},t.prototype._equalNormalizedFilterValues=function(n,t){return typeof n=="string"?typeof t=="string"&&n===t:n.name&&n.name===t.name||n.valueId&&n.valueId===t.valueId},t.prototype._createFilterValueViewModels=function(n,t,r,u){var f=n.filter((function(n){return n&&n.valueId})),e=f.length?Q(u(t,f.map((function(n){return n.valueId})))).then((function(n){return f.reduce((function(u,f){var o=f.valueId,e=i.find(n||[],(function(n){return n.valueId===o}));return e&&e.value?u[o]=e.value:v(f,t,r),u}),{})})):Q({}),o=n.some((function(n){return n&&!!n.name}))?this._locations.getLocations(y):Q([]);return Q.all([o,e]).spread((function(u,f){return n.map((function(n){var e,o=0,s;return typeof n=="string"?e=n:n.name?(s=i.find(u,(function(t)
{return t.name===n.name})),s?e=s.displayName:(v(n,t,r),e=n.name,o=3)):n.valueId&&(e=f[n.valueId],e||(v(n,t,r),e=n.valueId,o=3)),{text:e,value:n,state:o}}))}))},t})(p);t.LocationFilterRuntime=ut;ft=(function(n){function t(t){var i=n.call(this)||this;return i._subscriptions=t,i}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return{operator:n.operator,values:n.resourceGroupIds}},t.prototype.denormalizeFilterModel=function(n){return{operator:n.operator,resourceGroupIds:n.values}},t.prototype.activateFilter=function(n,t){var i=this;e.reactor(n,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(function(){Q(i._subscriptions.getSelectedSubscriptions(y)).then((function(n){var r=t.model(),u=r&&r.values||[],f=u.some((function(t){var r=i._parseResourceGroupId(t),u=r.subscription;return!n.some((function(n){return n.subscriptionId.toLowerCase()===u.toLowerCase()}))}));t.warningMessage(f?a.Filtering.ResourceGroup.resourceGroupFilterUsingExcludedSubscriptions:null)}))}))},t.prototype._getFilterValues=
function(n){return Q(n.getResourceGroupIds())},t.prototype._isValidFilterValue=function(n){return n&&typeof n=="string"},t.prototype._normalizeFilterValue=function(n){return this._normalizeResourceGroupId(n)||n},t.prototype._equalNormalizedFilterValues=function(n,t){return n===t},t.prototype._createFilterValueViewModels=function(n,t,r,u,f){var e=this,o=this._subscriptions.getAllSubscriptions(y),s=Q(this._subscriptions.getSelectedSubscriptions(y));return Q.all([o,s]).spread((function(t,r){var u=f.map((function(n){return e._parseResourceGroupId(n)}));return n.map((function(n){var s=e._parseResourceGroupId(n),f,h,l,v;if(s){var c=s.resourceGroup,o=s.subscription.toLowerCase(),y=u.some((function(n){return n&&n.resourceGroup===c&&n.subscription.toLowerCase()!==o}));y?(l=i.find(t,(function(n){return n.subscriptionId.toLowerCase()===o})),f=a.duplicateResourceGroupFilterValue.format(c,l?l.uniqueDisplayName:o)):f=c;v=r.some((function(n){return n.subscriptionId.toLowerCase()===o}));h=v?0:1}else f=n,h=3;return{
text:f,value:e._normalizeResourceGroupId(n),state:h}}))}))},t.prototype._normalizeResourceGroupId=function(n){var t=this._parseResourceGroupId(n);return t&&kt({subscription:t.subscription.toLowerCase(),resourceGroup:t.resourceGroup})},t.prototype._parseResourceGroupId=function(n){var t,i;try{return bt(n)}catch(u){t=u}if(t&&(b.error("Invalid resource group id '"+JSON.stringify(n)+"', inner exception: "+r.Diagnostics.getLogFriendlyMessage(t)),i=void 0,i))throw i;},t})(p);t.ResourceGroupFilterRuntime=ft;et=(function(n){function t(t){var i=n.call(this)||this;return i._assetTypes=t,i}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return{operator:n.operator,values:n.resourceTypes}},t.prototype.denormalizeFilterModel=function(n){return{operator:n.operator,resourceTypes:n.values}},t.prototype._getFilterValues=function(n){return Q(n.getResourceTypes())},t.prototype._isValidFilterValue=function(n){return n&&typeof n.resourceType=="string"&&!n.resourceKind||typeof n.resourceKind==
"string"},t.prototype._normalizeFilterValue=function(n){var r=n.resourceType,t=n.resourceKind,i={resourceType:r.toLowerCase()};return t&&(i.resourceKind=t.toLowerCase()),i},t.prototype._equalNormalizedFilterValues=function(n,t){return n.resourceType===t.resourceType&&(n.resourceKind?n.resourceKind===t.resourceKind:!t.resourceKind)},t.prototype._createFilterValueViewModels=function(n,t,r){var u=r.extension.cloudName;return this._assetTypes.getResourceTypeAssetTypeInformation(n.map((function(n){return n.resourceType})),u).then((function(u){return n.map((function(n){var f,h=0,c=n.resourceType,e=n.resourceKind,o=i.find(u,(function(n){return n.resourceType.toLowerCase()===c.toLowerCase()})),s;return o&&(e?(s=i.find(o.kinds||[],(function(n){return n.name.toLowerCase()===e.toLowerCase()})),s&&(f=s.pluralDisplayName)):f=o.compositeDisplayName.plural),f||(v(n,t,r),f=e||c,h=3),{text:f,value:n,state:h}}))}))},t})(p);t.ResourceTypeFilterRuntime=et}));define("MsPortalImpl/Svg/Startup/Download.svg",[],(function(
){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M9.6 7.2L14 3v3.4L8 12 2 6.5V3l4.4 4.2V0h3.2zM2 13h11.9v3H2z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Upload.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M6.4 8.8L2 13V9.6L8 4l6 5.5V13L9.6 8.8V16H6.4zM2.1 0H14v3H2.1z'/><\/g><\/svg>"}}));define("_generated/Templates/WidgetsStartboard",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-startboard-loadanimation"> <div class="fxs-splashscreen-loader-container fxs-loading5dots-container"> <div><\/div><div><\/div><div><\/div><div><\/div><div><\/div> <\/div> <\/div> <div class="fxs-startboard-header"> <div class="fxs-startboard-header-item fxs-startboard-title fxs-startboard-title-next fxs-portal-border" id="startboard-title"><\/div> <div class="fxs-startboard-header-item fxs-startboard-dropdown"><\/div> <input type="text" class="fxs-startboard-header-item fxs-startboard-title-edit fxs-hide-in-normal" maxlength="200"> <div class="fxs-startboard-header-item fxs-startboard-migration" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-migrate"><\/button> <\/div> <div class="fxs-startboard-header-item fxs-startboard-actions" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-new"><\/button> <div class="fxs-startboard-button fxs-startboard-button-upload" tabindex="-1"><\/div> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-download" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-edit" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-share" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-fullscreen" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-clone" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-delete" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-filter" tabindex="-1"><\/button> <\/div> <\/div> <div class="fxs-startboard-filter" data-bind="stopBindings: true"><\/div> <div class="fxs-startboard-layout"><\/div> <div class="fxs-startboard-message-container"><\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.StartBoard",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Svg/Startup/Add.svg","MsPortalImpl/Svg/Startup/CaretDown.svg","MsPortalImpl/Svg/Startup/Clone.svg","MsPortalImpl/Svg/Startup/Customize.svg","MsPortalImpl/Svg/Startup/Download.svg","MsPortalImpl/Svg/Startup/Filter.svg","MsPortalImpl/Svg/Startup/Fullscreen.svg","MsPortalImpl/Svg/Startup/Share.svg","MsPortalImpl/Svg/Startup/TrashOutline.svg","MsPortalImpl/Svg/Startup/Upload.svg","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Widgets/Widgets.LayoutBase","_generated/Templates/WidgetsStartboard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Interactions/Interactions.KeyboardNavigation",
"MsPortalImpl/Base/Base.Timers","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht){"use strict";var oi,si;r.defineProperty(t,"__esModule",{value:!0});var hi=i.Base,gt=hi.Diagnostics,ni=gt.Telemetry,ti=nt.Source,ii=nt.Action,ci=window,li=gt.createLog(n),ct=o.Dashboard;t.widgetClass="fxs-startboard";t.headerButtonClass="fxs-startboard-button";var ri="fxs-theme-context-start",ui="fxs-startboard-title-edit",lt="fxs-startboard-button-text",at="fxs-startboard-button-icon",fi="fxs-startboard-button-filter",yt="fxs-startboard-button-browse",pt="fxs-startboard-header-normal",wt="fxs-startboard-header-migration",vt="fxs-startboard-dropdown-item",bt="fxs-startboard-dropdown-dashboard",kt="."+bt+", ."+yt,dt=ci.fx.environment,ai=dt.features.filterdashboard==="true",ei="aria-label";t.fxstartboardtitlechanged="fxstartboardtitlechanged";t.fxmigratestartboard="fxmigratestartboard";oi=(function(n){function t(t,i,
r,f){var e=n.call(this,t)||this,s;return e.commands=[],e.filterButtonText=u.observable(""),e.title=u.observable(o.NavBar.home),e.dashboardList=u.observableArray(),e.loading=u.observable(!1),e.notFound=u.observable(!1),e.isShared=u.observable(!1),e.notFoundMessage=u.observable(""),e.subscriptionsInfo=u.observable(""),e.locked(!1),s=e.flowLayoutOptions=new it.ViewModel("fxs-flowlayout-instanceid"),s.allowReorder=!0,s.allowOverflow=!0,s.allowGaps=!0,s.resolutionGuides=!0,s.resolutionGuidesOffset.y=-88,s.orientation=rt.Orientation.Horizontal,s.minColumns(4),s.minRows(4),s.maxRows(4),s.locked(!1),e.headerMode=u.observable(0),e.filtersWidgetViewModel=f,e.applyViewSettings(i),e}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{layoutSettings:this.flowLayoutOptions.getViewSettings()}}},t.prototype.applyViewSettings=function(n){n&&n.NormalState&&n.NormalState.layoutSettings&&this.flowLayoutOptions.applyViewSettings(n.NormalState.layoutSettings)},t})(ft.ViewModel);t.
ViewModel=oi;si=(function(r){function nt(e,c){var l=r.call(this,e,c)||this,a,v;return l._layout=null,l._setFocusOnAnimationFrame=ht.throttleByAnimationFrame((function(){var i,n,t;l._$lastFocused&&f.contains(l.element[0],l._$lastFocused[0])&&h.isVisible(l._$lastFocused)&&(l._$lastFocused.focus(),i=!0);i||(n=l._layout.element.findFirstTabbable(),n.length===1?n.focus():(t=l._selectorMenu,t&&t.setFocus()))})),a=l.ltm,l._isSharedToArm=c.isShared,e.addClass(ri).addClass(t.widgetClass).html(ut()),u.reactor(a,(function(){var n=c.title();e.findByClassName("fxs-startboard-title").text(n);e.findByClassName(ui).val(n)})),u.reactor(a,(function(){var t=c.headerMode(),n=e.findByClassName("fxs-startboard-header");switch(t){case 1:n.addClass(pt).removeClass(wt);break;case 2:n.removeClass(pt).addClass(wt);break;case 0:default:n.removeClass(pt).removeClass(wt)}})),u.reactor(a,(function(){var n=c.notFound();e.toggleClass("fxs-startboard-notfound",n)})),u.reactor(a,(function(){var n=c.loading();e.toggleClass("fxs-startboard-loading",
n)})),u.reactor(a,(function(){var n=c.title();document.title=o.Portal.windowTitleFormat.format(n,dt.branding.title)})),l._layout=new it.Widget(e.findByClassName("fxs-startboard-layout"),c.flowLayoutOptions),l._initializeCommands(a,e),v=e.findByClassName("fxs-startboard-message-container"),v.html('<div class="fxs-startboard-message-title">'+i.encodeHtml(ct.NotFound.title)+'<\/div><div class="fxs-startboard-message-body" data-bind="text: data.notFoundMessage"><\/div>'),u.applyBindings({data:c},v[0]),l._attachEventHandlers(e),a.registerForDispose([s.setup(e,u.observableArray(c.commands)),new st.KeyboardNavigation(e.find(".fxs-startboard-actions"),12,"> .fxs-startboard-button:not(.fxs-startboard-button-upload), .fxs-startboard-button-upload input[type=file]")]),i.isFeatureEnabled("dashboardfilters")&&c.filtersWidgetViewModel&&i.require("./Widgets.DashboardFilters",n).then((function(n){l._dashboardFiltersWidget=new n.Widget(l.element,c.filtersWidgetViewModel)})),l}return __extends(nt,r),nt.prototype.
dispose=function(){this._layout.dispose();this._cleanElement(t.widgetClass,ri);r.prototype.dispose.call(this)},nt.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");this._layout.addChild(n)},nt.prototype.removeChild=function(n){return this._layout.removeChild(n)},nt.prototype.moveChild=function(n,t,i,r){this._layout.moveChild(n,t,i,r)},nt.prototype.setFocus=function(){i.isFeatureEnabled("skipautofocus")||this._setFocusOnAnimationFrame()},nt.prototype.saveViewSettings=function(){return this.options.getViewSettings()},nt.prototype.discardStateOfUnusedChildren=function(){return li.assert(!!this._layout,"FlowLayout not defined."),this._layout?this._layout.discardStateOfUnusedChildren():{stateDiscarded:!1}},nt.prototype.getDomOrderedChildren=function(){return this._layout.getDomOrderedChildren()},nt.prototype._attachEventHandlers=function(n){var i=this;this.ltm.registerForDispose(n.setEvents([rt.Widget.layoutUpdatedEventName,function(t){n.trigger(ft.Widget.viewSettingsChanged,
i.saveViewSettings());t.stopPropagation()}],[ot.default.focusout,function(n){i._$lastFocused=f(n.target)}],[ot.default.change,".fxs-startboard-fileUpload-overlay",function(n){n.stopPropagation();var t=f.extend(!0,{},n.target.files);i._handleUploadItemClick(t);n.currentTarget.value=null}],[ot.default.focus,".fxs-startboard-fileUpload-overlay",function(n){n.stopPropagation();f(n.target).closest("."+t.headerButtonClass).addClass("fxs-startboard-item-focused")}],[ot.default.blur,".fxs-startboard-fileUpload-overlay",function(n){n.stopPropagation();f(n.target).closest("."+t.headerButtonClass).removeClass("fxs-startboard-item-focused")}]))},nt.prototype._initializeCommands=function(n,r){var gt=this,ft="aria-disabled",bi=ct.create,ki=ct.delete,di=o.ShellCommands.downloadDashboard,ri=o.ShellCommands.uploadDashboard,gi=ct.edit,nr=ct.filter,tr=this._isSharedToArm?ct.unshare:ct.share,oi=ct.fullscreen,ir=ct.clone,s=this.options,pt=function(n,t){n.attr("title",t).findByClassName(lt).html(t)},rr="<div class='"+
at+"'><\/div>"+("<div class='"+lt+"'><\/div>"),ur="<div class='"+at+"'><\/div>"+("<div class='"+lt+'\' id="uploadlabel" aria-hidden="true"><\/div>')+'<input type="file" class="fxs-startboard-fileUpload-overlay" accept=".json" tabindex=\'-1\' role="menuitem" aria-labelledby="uploadlabel"/>',nt=function(n,t,i,u,e,o){e===void 0&&(e=!1);var s=r.findByClassName(n).html(t===ri?ur:rr);pt(s,t);s.findByClassName(at).html(et.getSvgReferenceOrFallBackToData(i,{palette:99}));o=o||function(){u.execute(!1)};s.on(ot.default.click,(function(n){n.stopPropagation();f(n.currentTarget).attr(ft)!=="true"&&o(n);gt.trigger(ot.default.fxdashboardactivity)}));return s.data("commandVM",u),e&&h.hide(s),s},si=nt("fxs-startboard-button-edit",gi,y,s.addPartsCommand,!1,(function(){ni.trace({source:ti.Dashboard,action:ii.CustomizeModeEntered});ni.trace({source:ti.Dashboard,action:ii.DashboardEditCommandClicked});s.addPartsCommand.execute(!1)})),ut,rt,it,hi,ci,li,vi,wt;u.computed(n,(function(){var n=s.addPartsCommand,t=n&&
n.enabled();t?si.removeAttr(ft):si.attr(ft,"true")}));ai||r.findByClassName(fi).remove();ut=r.findByClassName(ui);ut.attr(ei,ct.titleLabel);ut.on(ot.default.change,(function(){s.title(ut.val());r.trigger(t.fxstartboardtitlechanged)}));rt=new tt.ViewModel('<div class="fxs-startboard-title" data-bind="text: data.title, attr: { title: data.title }"><\/div>'+('<div class="'+at+'">'+et.getSvgReferenceOrFallBackToData(a,{palette:99})+"<\/div>"),"<div class='fx-dropmenu-dropdown'>"+('<ul class="fxs-dropmenu-list-system" role="menu" aria-label="'+i.encodeAttribute(ct.recentMenuLabel)+'">')+"<!-- ko ifnot: data.dashboardList -->"+("<li class='"+vt+'\' role="menuitem" tabindex="0">')+'<div class="fxs-tile-progress-transparent"><div><\/div><div><\/div><div><\/div><div><\/div><div><\/div><\/div><\/li><!-- /ko --><!-- ko if: data.dashboardList --><!-- ko ifnot: data.dashboardList().length -->'+("<li class='"+vt+'\' role="menuitem" tabindex="0">')+("<div class='fxs-dropmenu-list-content'>"+i.encodeHtml(
ct.emptynext)+"<\/div>")+"<\/li><!-- /ko --><!-- ko foreach: data.dashboardList -->"+("<li class='"+vt+" "+bt+' fxs-portal-hover msportalfx-tooltip-overflow\' role="menuitem" data-bind="attr: { \'aria-label\': $parent.func.altText(title, id) }, event: { click: $parent.func.clickHandler, keydown: $parent.func.clickHandler }">')+'<div class=\'fxs-dropmenu-list-content fxs-startboard-item-container\'><div class="fxs-startboard-item-icon"><!-- ko if: id.indexOf("private") === -1 -->'+et.getSvgReferenceOrFallBackToData(k)+"<!-- /ko --><\/div><div class=\"fxs-startboard-item-title\" data-bind='text: title'><\/div><\/div><\/li><!-- /ko --><!-- /ko -->"+('<li class="'+vt+' fxs-startboard-dropdown-browseall fxs-portal-hover" role="menuitem">')+'<div class="fxs-startboard-dropdown-subscriptions" data-bind="text: data.subscriptionsInfo"><\/div>'+('<a tabindex=\'-1\' href="#" class="'+yt+' fxs-portal-text-primary">'+i.encodeHtml(ct.browseAll)+"<\/a>")+"<\/li><\/ul><\/div>",kt);it=r.findByClassName(
"fxs-startboard-dropdown");rt.alignMenu=0;hi=this._selectorMenu=new tt.Widget(it,rt);rt.isMenuOpen.subscribe(n,(function(n){n&&s.refreshDashboardList&&(s.dashboardList(undefined),s.refreshDashboardList((function(n){s.dashboardList(n);it.find(".fxs-dropmenu-button")[0]===document.activeElement&&Q.fcall((function(){ht.requestAnimationFrame((function(){it.find(kt).filter("[tabindex='0']").focus()}))}))})))}));u.computed(n,s.dashboardList,(function(){st.resetTabbableItem(it,kt,"."+bt,{force:rt.isMenuOpen()})})).extend({deferred:!0});u.reactor(this.ltm,s.title,(function(n){it.find(".fxs-dropmenu-button").attr(ei,ct.switcherLabel.format(n))}));ci=function(n,t){if(t.type===ot.default.keydown&&!((t.keyCode===13||t.keyCode===32)&&c.getModifierKeys(t)===0))return!0;t.preventDefault();t.stopPropagation();r.findByClassName("fxs-startboard-title-next").text(n.title);s.switchDashboard&&s.switchDashboard(n).then((function(){var n=Math.min(Math.max(it.outerWidth()+50,400),560);it.find(".fxs-dropmenu-content").css(
{minWidth:n})}));rt.close()};u.applyBindings({data:s,func:{clickHandler:ci,altText:function(n,t){return n+" "+(t.indexOf("private")===-1?ct.sharedStatusLabel:"")}}},hi.element[0]);nt("fxs-startboard-button-new",bi,l,s.newCommand);s.filterButtonText(nr);li=nt(fi,s.filterButtonText(),w,s.filterCommand);s.filterButtonText.subscribe(n,(function(n){li.findByClassName(lt).html(n)}));nt("fxs-startboard-button-clone",ir,v,s.cloneCommand);vi=nt("fxs-startboard-button-share",tr,k,s.shareCommand,dt.chrome.hideDashboardShare);u.reactor(n,this._isSharedToArm,(function(n){var t=n?ct.unshare:ct.share;pt(vi,t)}));nt("fxs-startboard-button-delete",ki,d,s.deleteCommand);var fr=nt("fxs-startboard-button-fullscreen",oi,b,s.fullscreenCommand),yi=function(){var n=e.isFullscreen(),t=n?ct.exitFullscreen:oi;f(document.body).toggleClass("fxs-portal-fullscreen",n);pt(fr,t)},pi=f(document),wi=e.fullscreen;pi.on(wi,yi);n.registerForDispose([function(){pi.off(wi,yi)},it.setEvents([ot.default.click,function(){return gt.trigger(
ot.default.fxdashboardactivity)}])]);nt("fxs-startboard-button-migrate",ct.migrate,v,null,!1,(function(){r.trigger(t.fxmigratestartboard)}));wt=i.isFeatureEnabled("dashboardupanddown");nt("fxs-startboard-button-upload",ri,g,s.uploadCommand,!wt,i.noop);nt("fxs-startboard-button-download",di,p,s.downloadCommand,!wt);r.findByClassName(yt).click((function(n){n.preventDefault();s.browseCommand.execute(!1)}))},nt.prototype._handleUploadItemClick=function(n){var t=this.options.uploadCommand.fileInputOptions;t&&t()&&t().files(n);this.trigger("itemSelected",null,{item:this.options.uploadCommand.execute(!1)})},nt})(ft.Widget);t.Widget=si}));define("MsPortalImpl/UI/Compositions/UI.Composition.StartBoard",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter",
"MsPortalImpl/UI/Compositions/UI.Composition.DashboardFiltersManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){"use strict";function rt(n){return n!==o.desktopSettingsKey&&n!==o.startBoardSettingsKey&&!i.startsWith(n,y.partIdentityStatePrefix)}function ct(n){var t=new nt(n);return t.save(),t}function lt(n,t,i){var f=r.keys(t).filter(rt).map((function(i){return w.Instance.fromJSON(n,t[i])})),u=new nt(n,f,i.widgetState);return u.logChildren(),u.loadFromJson(i),u}function at(n,t){var i=[],r=new b.EnterOrganizeMode(n,t,!0);return r.text(e.Dashboard.edit),i.push(new b.ResetStartBoardCommand(n,t),r,new b.ExitOrganizeMode(n,t)),i}var
nt;r.defineProperty(t,"__esModule",{value:!0});var ut=i.Base,tt=ut.Diagnostics,ft=tt.Telemetry,et=i.Parts,ot=c.CompositionType,st=p.ReferenceScope,it=tt.createLog(n),ht=c.getIdMatchFunc;t.fxstartboardsettingchanged="fxstartboardsettingchanged";t.isStartboardPartKey=rt;nt=(function(n){function e(t,r,f){var e=n.call(this,"Startboard",t,null,r,f,o.startBoardSettingsKey)||this;return e._partAwaiter=new a.CompositionAwaiter(!0),e._containerAwaiter=new a.CompositionAwaiter,e.masterContainer=null,e.detailContainers=[],e.notFound=u.observable(!1),e._store=4,i.isFeatureEnabled("dashboardfilters")&&e.registerForDispose(e.dashboardFiltersManager=new v.DashboardFiltersManager(e)),e}return __extends(e,n),e.prototype.getCompositionType=function(){return ot.Startboard},e.prototype.setGetDashboard=function(n){if(this._getDashboard)throw new Error("GetDashboard can only be set once by DashboardManager");this._getDashboard=n},e.prototype.removeGetDashboard=function(){this._getDashboard=null},e.prototype.
getDashboard=function(){var n=this._getDashboard;return n?n():null},e.prototype.onDetailContainersChanged=function(){},e.prototype.getDeepLink=function(){return Q("")},e.fromJSON=function(n,t,i){return c.createCompositionFromJSON(i,(function(){return lt(n,t,i)}),(function(t,i){var r=new e(n);return r.unrecoverableErrorMessage=i,r}))},e.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this),r=this._getDashboard?this._getDashboard():null,f;return r&&(t.dashboardId=r.id,t.dashboardTitle=r.title,f=r.model,t.dashboardModel=f?{model:u.toJS(f.model),metadata:i.clone(f.metadata,!0)}:undefined),delete t.children,t},r.defineProperty(e.prototype,"eligibleForBinding",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.getInputPropertyBindings=function(){throw new Error("Unreachable code");},e.prototype.getViewModel=function(n){var r,t;if(n=i.isNullOrUndefined(n)?8:n,n===8){if(t=this._getDashboard&&this._getDashboard().model,!t)throw new Error("There is no current Dashboard.");
r=t.model}return r||{}},e.prototype.getViewModelAsync=function(n){return f.Deferred().resolve(this.getViewModel(n)).promise()},e.prototype.getCompatibleSourceReferences=function(n){var u=this._getDashboard&&this._getDashboard().model,t=u&&u.metadata,i,f;return t&&(i=n.type,i)?(f=r.keys(t).filter((function(n){var r=t[n];return r===i})),f.map((function(n){return{property:n,modelType:8,scope:st.CurrentContainer,cardinality:p.ReferenceCardinality.OneToOne}}))):null},e.prototype.logChildren=function(){this.children.forEach((function(n){var t=n&&n.widgetState(),i=t&&t.NormalState?et.InternalPartSize[t.NormalState.size]:"";ft.trace({extension:n.locator.getExtensionLocator().name,source:s.Source.StartBoardPart,action:s.Action.StartBoardPartLoaded,name:n.locator.toFriendlyString(),data:i})}))},e.prototype.getFilters=function(){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFilters()},e.prototype.updateFilters=function(n,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.
updateFilters(n,t)||Q()},e.prototype.setFilters=function(n){return this.dashboardFiltersManager&&this.dashboardFiltersManager.setFilters(n)},e.prototype._compose=function(n,r){var s=this,f=new k.ViewModel(this.id,this.widgetState(),this,this.dashboardFiltersManager&&this.dashboardFiltersManager.filtersWidgetViewModel),o=this.services,e=this.createChildLifetime();u.utils.arrayPushAll(f.commands,at(e,this.services));var p=f.addPartsCommand=i.find(f.commands,(function(n){return n.commandName===b.CommandNames.EnterOrganizeMode})),w=f.newCommand=new b.NewDashboard(e,o),nt=f.cloneCommand=new b.CloneDashboard(e,o),tt=f.filterCommand=new b.FilterDashboard(e,o,this),rt=f.fullscreenCommand=new b.FullscreenDashboard(e,o),ut=f.deleteCommand=new b.DeleteDashboard(e,o),ft=f.shareCommand=new b.ShareDashboard(e,o),et=f.browseCommand=new b.OpenBrowseDashboardsPane(e,o),ot=f.uploadCommand=new b.UploadDashboard(e,o),st=f.downloadCommand=new b.DownloadDashboard(e,o),a=this._getDashboard?this._getDashboard().
title:null;a&&f.title(a);var v=this.widget=new k.Widget(n.getStartBoardArea(),f),l=v.element,y=function(n,t){n.bind(new h.CompositionInstanceCommandContext(l.findByClassName(t)[0],null,s))};y(p,k.widgetClass+"-title");[[w,"new"],[nt,"clone"],[tt,"filter"],[rt,"fullscreen"],[ut,"delete"],[ft,"share"],[et,"browse"],[ot,"upload"],[st,"download"],].forEach((function(n){var t=n[0],i=n[1];y(t,k.headerButtonClass+"-"+i)}));l.data(c.CompositionInstanceDataName,this);v.ltm.registerForDispose([e,l.setEvents([d.Widget.viewSettingsChanged,function(n,i){n.stopPropagation();s.widgetState(i);l.trigger(t.fxstartboardsettingchanged)}],[g.default.fxunpin,function(n,t){var i=s.children.first(ht(t.tileId));i&&(it.warning("Part '{0}' is about to be removed due to user unpin operation.".format(i)),s.services.desktop.removeTile(i.id));setTimeout((function(){var n=s.widget;n&&n.setFocus()}),50)}])]);r.resolve()},e.prototype.matchesLocatorAndModel=function(){return!1},e.prototype.resetLayout=function(){this.services.
desktop.resetStartBoard()},e.prototype.dispose=function(){it.warning("UI.Composition.Startboard.dispose() has been called.");n.prototype.dispose.call(this,!0)},r.defineProperty(e.prototype,"journeyPath",{get:function(){return[]},enumerable:!0,configurable:!0}),e.prototype.getComposedParts=function(){return this._partAwaiter.resolvedCompositions},e.prototype.awaitComposedPart=function(n,t){return this._partAwaiter.await(n,t)},e.prototype.notifyPartComposed=function(n){this._partAwaiter.resolve(n)},e.prototype.awaitContainer=function(n,t){return this._containerAwaiter.await(n,t)},e.prototype.notifyContainer=function(n){this._containerAwaiter.resolve(n)},e.prototype.onInvocationStarted=function(){},e.prototype.getDiagnosticsData=function(){return f.extend(n.prototype.getDiagnosticsData.call(this),{detailBlades:this.detailContainers.map((function(n){return n+""}))})},e})(l.Instance);t.Instance=nt;t.create=ct}));define("MsPortalImpl/UI/Dashboard/DashboardClient",["require","exports","f"],(function(
n,t,i){"use strict";var r;return (function(n){function u(n){return new t(new r(n))}var r=(function(){function n(n){this._extensionManager=n}return n.prototype.connect=function(n,t,r,u){var f,e;return this._extensionManager.getExtensionByName(n,t).then((function(n){return f=n,Q(f.getViewModel(r(f)))})).then((function(n){return e=n,Q(u(n.content))})).finally((function(){i.disposeViewModelProperties(e);f&&e&&f.releaseViewModel(e)}))},n})(),t;n.ViewModelConnectorImpl=r;n.create=u;t=(function(){function n(n){this._connector=n}return n.prototype.getDashboard=function(n,t,i){return this._connector.connect(t,i,(function(n){return n.definition.dashboardProvider.viewModel}),(function(t){return t.getDashboard(n)}))},n})();n.DashboardClientImpl=t})(r||(r={})),r}));define("MsPortalImpl/UI/Dashboard/DashboardCompressor",["require","exports","f","i","o","ko","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding",
"MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Widgets/Widgets.FlowLayout"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function rt(n,t){var y=t[b],p=y.widgetState,d=p.NormalState.layoutSettings.positions,r=d.first((function(t){return t.id===n})),v,u;if(!r)return w.warning("Cannot compress part '"+n+"', because it does not have position in startboard."),null;var i=t[n],s=f.toJS(nt(i.containerModel)),g=f.toJS(nt(i.overridesModel)),l=(i.adapterBindings||i.bindings||[]).map((function(n){var t=n.source,e=t&&t.property,l=n.targetProperty,r=t&&t.modelType,u,i,a,v;if(c.isDynamicBindingWithNonLocalSource(n)){if(r!==8)return w.error("For binding for property '{0}', encountered unsupported reference type '{1}'.".format(l,o.referenceTypeMap[r]||r)),
null;u={name:l,binding:e}}else i=void 0,a=h.getModelValue(g,e),a.exists?i=f.unwrap(a.value):r===5?i=t.constantValue:(v=h.getModelValue(s,e),v.exists&&(i=f.unwrap(v.value))),u={name:l,value:i};return!n.optional||(u.isOptional=!0),u}));if(l.firstIndex((function(n){return!n}))>=0)return null;v=s[o.PartContainerModelIdProperty];u={};u[o.PartContainerModelIdProperty]=v;var tt=e.Locator.fromJSON(i.locator),it=a.buildIdentitySettingKey(tt,u),rt=t[it]||undefined,ut=ft(i.locator),et=ot(i.partState),st=ht(i.assetInstanceDefinition);return{position:{x:r.position.col,y:r.position.row,colSpan:k(r.colSpan),rowSpan:k(r.rowSpan)},metadata:{inputs:l,type:ut,settings:rt,isAdapter:i.adapterBindings?!0:undefined,viewState:et,asset:st,defaultMenuItemId:i.defaultMenuItemId}}}function ut(n,t,i,u){var h=n.metadata,p=et(h.type),nt=st(h.viewState),tt=ct(h.asset),w=v.getDefaultSize().name,it={NormalState:{size:w}},c={},k;c[o.PartContainerModelIdProperty]=f.observable(t);var b=e.Locator.fromJSON(p),rt=s.createIdentifier(
o.CompositionType.StartboardPart,b,i),l={locator:p,partState:nt,assetInstanceDefinition:tt,initialSize:w,widgetState:it,id:rt,bindingsInitialized:!0,dontSetupWidget:!1,defaultMenuItemId:h.defaultMenuItemId,childSettings:{},children:[],containerModel:r.toSerializableObject(c),overridesModel:undefined,editScopeId:undefined,bindings:undefined,adapterBindings:undefined,errorMessage:undefined,originalPartLocator:undefined},y=[];return h.inputs.forEach((function(n){var r=n.name,t,i=n.binding,u;i?t={property:i,modelType:8,cardinality:d.OneToOne,scope:g.CurrentContainer}:(u=n.value,t={property:r,constantValue:u,modelType:5,cardinality:d.OneToOne,scope:g.CurrentContainer});y.push({source:t,targetProperty:r,optional:!!n.isOptional,isDynamicBinding:i?!0:undefined})})),h.isAdapter?l.adapterBindings=y:l.bindings=y,h.settings&&(k=a.buildIdentitySettingKey(b,c),u(k,h.settings)),l}function ft(n){var r=encodeURIComponent,f=[],t=n,i,u,o;do i=r(e.LocatorType[t.type]),u=t.cloudName?r(t.cloudName):undefined,
u&&(i=i+"["+u+"]"),o=[i,r(t.name)],f.unshift(o.join("/")),t=t.parent;while(t);return f.join("/")}function et(n){var i=decodeURIComponent,u=[],r=[],t;return n.split("/").forEach((function(n,t){r.push(n);t%2==1&&(u.push(r),r=[])})),u.forEach((function(n){var s=i(n.pop()),r=n.pop(),f,o=r.match(/\[(.*?)\]/),u;o&&(r=r.substring(0,r.lastIndexOf(o[0])),f=i(o[1]));r=i(r);u={name:s,type:e.LocatorType[r]};f&&(u.cloudName=f);t&&(u.parent=t);t=u})),t}function ot(n){n=r.isSerializedObject(n)?r.fromSerializableObject(n):n;var f=u.keys(n).filter((function(n){return n!=="container"&&n!=="internal"})),t={};return i.shallowCopyFromObject(t,n,f),tt(t)?undefined:t}function st(n){return r.toSerializableObject(n||{})}function ht(n){return tt(n)?undefined:{idInputName:n.assetIdInputProperty,type:n.assetType}}function ct(n){return n?{assetIdInputProperty:n.idInputName,assetType:n.type}:{}}function lt(n){if(!n)return undefined;var t=n.model,r=n.metadata,i={};return u.keys(t).forEach((function(n){i[n]={value:t[n],type:
r[n]}})),i}function at(n){if(!n)return undefined;var t={},i={};return u.keys(n).forEach((function(r){var u=n[r];t[r]=u.value;i[r]=u.type})),{model:t,metadata:i}}u.defineProperty(t,"__esModule",{value:!0});var d=h.ReferenceCardinality,g=h.ReferenceScope,nt=c.createContainerModel,tt=i.isEmpty,w=i.Base.Diagnostics.createLog(n),b=y.startBoardSettingsKey,k=function(n){return Math.min(Math.max(n,1),25)},it=(function(){function n(){}return n.prototype.compress=function(n){var t=n.settings,i=n.title,r=u.keys(t).filter((function(n){return l.isStartboardPartKey(n)})).map((function(n){return rt(n,t)})).filter((function(n){return!!n}));return{title:i,model:lt(t[b].dashboardModel),parts:r}},n.prototype.uncompress=function(n,t,r,u){var f={},e=[];t.parts.forEach((function(n,t){var c=r?r(t):i.getUniqueId(),l=u?u(t):undefined,s=ut(n,c,l,(function(n,t){f[n]=t})),o,h;f[s.id]=s;o=n.position;h={id:s.id,colSpan:k(o.colSpan),rowSpan:k(o.rowSpan),position:{col:o.x,row:o.y}};e.push(h)}));try{var o=p.validateGrid(e),h=o.success,
s=o.result;h||w.warning("Part '"+s.misplacedPart+"' is misplaced and overlaps with '"+s.overlappedParts.join(", ")+"'.")}catch(c){w.error(c,1)}var l={NormalState:{layoutSettings:{positions:e}}},a=at(t.model),v={id:b,childSettings:{},locator:null,errorMessage:undefined,widgetState:l,dashboardId:n,dashboardTitle:t.title,dashboardModel:a};return f[b]=v,{id:n,title:t.title,settings:f}},n})();t.DashboardCompressor=it}));define("MsPortalImpl/UI/Dashboard/PrivateDashboardRepository",["require","exports","f","o","MsPortalImpl/UI/Dashboard/DashboardRepository","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Settings.Schema"],(function(n,t,i,r,u,f,e,o){"use strict";function a(n){var i=r.keys(n);if(i.length>=100)throw new Error("There are no more dashboard stores available.");for(var f=i.map((function(t){return n[t].storeName})),u=0,t=w(u);f.indexOf(t)>-1;)t=w(++u);return t}function b(n,t){for(var u=t||p,o=r.keys(n).map((function(t)
{return n[t].title.toLowerCase()})),s=function(n){return o.indexOf(n.toLowerCase())>=0},f=function(n){return n<=1?u:u+" ("+n+")"},e=1,i=f(e);s(i);)i=f(++e);return i}function k(n,t,i,r){var u=r.settings[o.startBoardSettingsKey];u.dashboardId=i;n.setSetting(h(t),i,r);n.setSetting(s,i,{storeName:t,id:r.id,title:r.title});n.flushSettings()}function d(){var n=i.getUniqueId();return""+v+n}function g(n,t){return n[t]&&n[t].storeName}function nt(n){return!!h(n)}function tt(n){return n.queryStore(s).then((function(n){return n||{}}))}var it;r.defineProperty(t,"__esModule",{value:!0});var rt=i.Base,ut=rt.Diagnostics,c=f.Dashboard,ft=ut.createLog(n),v="private/",l="recentDashboards",y=10,s=11,p=c.defaultTitle,w=e.getDashboardStoreName,h=e.getDashboardStoreId,et=i.forEachKey;t.buildNextStoreName=a;t.createDashboardTitle=b;it=(function(){function n(n){this._settingsManager=n}return n.prototype.getTypeName=function(){return u.PrivateDashboardRepository},n.prototype.createDashboard=function(n){var r=this,
t=n.extras&&n.extras.id||d(),i={id:t,title:n.title,settings:n.settings};return this._getDashboards().then((function(n){return k(r._settingsManager,a(n),t,i),i}))},n.prototype.readDashboard=function(n){var t=this;return this._getDashboards().then((function(i){var r=g(i,n);if(r)return t._settingsManager.querySetting(h(r),n)}))},n.prototype.updateDashboard=function(n,t){var r=this;return this.readDashboard(n).then((function(u){if(u){var f={};return i.shallowCopyFromObject(f,u),i.shallowCopyFromObject(f,t),r._getDashboards().then((function(t){var i=g(t,n)||a(t);return k(r._settingsManager,i,n,f),f}))}return r.createDashboard({title:t.title,settings:t.settings,extras:{id:n}})}))},n.prototype.deleteDashboard=function(n){var t=this._settingsManager;return tt(t).then((function(i){var f=i[n],u,e,o;u=f?f.storeName:r.keys(i).filter(nt).first((function(t){return(i[t]||{}).id===n}));u&&t.deleteSettings({store:h(u),keys:[n]});e=u&&i[u]&&i[u].id===n;o=e?[u,n]:[n];t.deleteSettings({store:s,keys:o});t.flushSettings(
)}))},n.prototype.readDashboards=function(){return this._getDashboards().then((function(n){return r.keys(n).map((function(t){return n[t]}))}))},n.prototype.identifyDashboard=function(n){return i.startsWith(n,v)},n.prototype.isDashboardWritable=function(){return Q(!0)},n.prototype.getNotFoundMessage=function(n){return c.NotFound.privateMessageFormat.format(n.title)},n.prototype.canCreateNewDashboard=function(){return this._getDashboards().then((function(n){return r.keys(n).length<100}))},n.prototype.cloneDashboard=function(n,t){return this.createDashboard({settings:n,title:c.cloneTitleFormat.format(t)})},n.prototype.getRecentDashboards=function(){return this._settingsManager.querySetting(s,l).then((function(n){var t=(n||[]).slice(0,y).filter((function(n){return!!n.id}));return i.unique(t,(function(n,t){return n.id.toLowerCase()===t.id.toLowerCase()}))}))},n.prototype.addToRecent=function(n){var t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase(
)===n.id.toLowerCase()}));return u===0?r:(u>0&&r.splice(u,1),r.unshift({id:n.id,title:n.title}),r=r.slice(0,y),t._settingsManager.setSetting(s,l,r),r)}))},n.prototype.removeFromRecent=function(n){var t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase()===n.toLowerCase()}));return u>=0&&(r.splice(u,1),t._settingsManager.setSetting(s,l,r)),r}))},n.prototype.createDefaultDashboard=function(n){var t;return t=n?Q(n):this._getDashboards().then((function(n){return b(n)})).catch((function(n){return ft.error(n,0,"Failed to generate a dashboard title with index."),p})),t.then((function(n){var t=d();return{id:t,title:n}}))},n.prototype._getDashboards=function(){var n=this;return tt(this._settingsManager).then((function(t){return et(t,(function(t,i,r){if(i){var u;n.identifyDashboard(t)?(u=i,r[u.id]=u):nt(t)&&(u=i,r[u.id]||(r[u.id]=u))}}),{})}))},n})();t.PrivateDashboardRepository=it}));define("MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository",
["require","exports","f","i","MsPortalImpl/UI/Dashboard/DashboardRepository","FxHubs/CloudNameCommon"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function e(n){var i=n.substr(t.length),u=f.getCloudNameFromId(i),r;return i=f.removeCloudNameFromId(i),r=i.split("/"),{cloudName:u,dashboardParam:r.slice(1).join("/"),extensionName:r[0]}}var t="recommended/",o;n.parseDashboardId=e;o=(function(){function n(n,t){this._dashboardClient=n;this._compressor=t}return n.prototype.createDashboard=function(){return r.QReject("Cannot create a recommended dashboard")},n.prototype.readDashboard=function(n){var i=this,t=e(n);return this._dashboardClient.getDashboard(t.dashboardParam,t.extensionName,t.cloudName).then((function(t){return i._compressor.uncompress(n,t)}))},n.prototype.updateDashboard=function(){return r.QReject("Cannot update a recommended dashboard")},n.prototype.deleteDashboard=function(){return Q()},n.prototype.readDashboards=function(){return Q([])},n.prototype.getTypeName=function(
){return u.RecommendedDashboardRepository},n.prototype.identifyDashboard=function(n){return i.startsWith(n,t)},n.prototype.isDashboardWritable=function(){return Q(!1)},n})();n.RecommendedDashboardRepository=o})(e||(e={})),e}));define("MsPortalImpl/Svg/Startup/DirectoryFilter.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 19.337 19.746' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M4.603.249h1v16.408h-1zM0 4h3.32v1H0zm0 8h3.32v1H0z'/><path d='M9.32 16H3.195a.842.842 0 0 1-.342-.068.894.894 0 0 1-.277-.188.924.924 0 0 1-.188-.277A1.948 1.948 0 0 1 2.324 15V1.875a.7.7 0 0 1 .076-.314 1.081 1.081 0 0 1 .482-.482A.7.7 0 0 1 3.195 1H14.32v6h1V0H3.07a1.545 1.545 0 0 0-.656.146 1.951 1.951 0 0 0-.557.391 1.93 1.93 0 0 0-.391.561 1.544 1.544 0 0 0-.146.652v13.5a1.7 1.7 0 0 0 .137.68 1.771 1.771 0 0 0 .376.558 1.743 1.743 0 0 0 .558.376A1.712 1.712 0 0 0 3.07 17h6.25z'/><path d='M6.887 8.8v1.6l4.5 4.5v4.849h3.45V14.9l4.5-4.5V8.8zm6.975 5.691v4.283h-1.5v-4.287l-4.5-4.5v-.216h10.5v.217z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 19.337 19.746' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M4.603.249h1v16.408h-1zM0 4h3.32v1H0zm0 8h3.32v1H0z'/><path d='M9.32 16H3.195a.842.842 0 0 1-.342-.068.894.894 0 0 1-.277-.188.924.924 0 0 1-.188-.277A1.948 1.948 0 0 1 2.324 15V1.875a.7.7 0 0 1 .076-.314 1.081 1.081 0 0 1 .482-.482A.7.7 0 0 1 3.195 1H14.32v6h1V0H3.07a1.545 1.545 0 0 0-.656.146 1.951 1.951 0 0 0-.557.391 1.93 1.93 0 0 0-.391.561 1.544 1.544 0 0 0-.146.652v13.5a1.7 1.7 0 0 0 .137.68 1.771 1.771 0 0 0 .376.558 1.743 1.743 0 0 0 .558.376A1.712 1.712 0 0 0 3.07 17h6.25z'/><path d='M6.887 8.8v1.6l4.5 4.5v4.849h3.45V14.9l4.5-4.5V8.8zm6.975 5.691v4.283h-1.5v-4.287l-4.5-4.5v-.216h10.5v.217z'/><path fill='#8a2da5' d='M12.399 18.767h1.5v-4.283l4.5-4.5v-.217h-10.5v.217l4.5 4.5v4.283z'/><\/g><\/svg>"}})
);define("_generated/Templates/WidgetsAvatarMenu",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-dropdown"> <ul class="fxs-avatarmenu-list-system" role="presentation"> <li class="fxs-portal-hover" role="presentation"> <a href="" class="fxs-avatarmenu-signout" role="menuitem" data-bind=\'attr: { title: text.signOutLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: text.signOutLabel"><\/div> <div class="fxs-dropmenu-image fxs-fill-error" data-bind="image: data.icons.signout"><\/div> <\/a> <\/li> <\/ul> <div class="fxs-avatarmenu-scrollviewer"> <div class="fxs-avatarmenu-list-system"> <ul role="presentation"> <li class="fxs-portal-hover" data-bind="visible: changePasswordLink" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-changepassword" role="menuitem" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: changePasswordLink, title: text.changePasswordLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: text.changePasswordLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.launchCurrent"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: !!data.links.accessDetails" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-myaccess" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.accessDetails, title: data.text.myAccessLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.myAccessLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.person"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: !!data.links.giveFeedback" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-feedback" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.giveFeedback, title: data.text.feedbackLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.feedbackLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.feedback"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: data.links.accountPortal" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-billing" role="menuitem" href="" rel="noopener noreferrer"> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.billingLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="visible: data.links.accountPortal && data.links.accountPortal.startsWith(\'#\')"><\/div> <\/a> <\/li> <\/ul> <\/div> <div class="fxs-avatarmenu-list-tenant fxs-portal-border fxs-dropmenu-line-separator" data-bind="visible: listOfTenants().length" role="presentation"> <!-- ko if: listOfTenants().length --> <div class="fxs-avatarmenu-dropdown-title" id="avatarMenuTenantListId" data-bind="text: text.tenant" role="presentation"><\/div> <ul data-bind="foreach: listOfTenants" aria-labelledby="avatarMenuTenantListId" role="group"> <li class="fxs-portal-hover" role="presentation"> <a tabindex="-1" role="menuitemradio" data-bind="css: { \'fxs-avatarmenu-current-tenant fxs-portal-selected fxs-portal-activated\': $index() === 0 }, attr: { href: $index() === 0 ? \'#\' : \'\', \'aria-checked\': $index() === 0 }"> <div class="fxs-avatarmenu-tenant-name fxs-portal-text" data-bind="text: displayName, attr: { title: displayName }"><\/div> <div data-bind="text: domainName, attr: { title: domainName }" class="fxs-avatarmenu-tenant-uri"><\/div> <\/a> <\/li> <\/ul> <!-- /ko --> <\/div> <\/div> <\/div>'}
}));define("_generated/Templates/WidgetsAvatarMenuButton",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-header fxs-trim-hover" data-bind="attr: { title: tooltip }"> <div class="fxs-avatarmenu-tenant-container"> <div class="fxs-avatarmenu-username" data-bind="text: displayName"><\/div> <div class="fxs-avatarmenu-tenant" data-bind="text: currentTenantDisplayName"><\/div> <\/div> <img class="fxs-avatarmenu-tenant-image" data-bind="attr: { src: avatarUri }" alt=""/> <\/div>'}}));define("MsPortalImpl/Widgets/Widgets.AvatarMenu",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Telemetry","_generated/Templates/WidgetsAvatarMenu","_generated/Templates/WidgetsAvatarMenuButton","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Svg/Library/Feedback.svg","MsPortalImpl/Svg/Library/LaunchCurrent.svg","MsPortalImpl/Svg/Library/Person.svg",
"MsPortalImpl/Svg/Library/Signout.svg","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function b(n){return(n||"").toLowerCase()}function k(n,t,i){var r=n.element.findByClassName(t);return i&&r.on(it,i),r}function kt(n){var t=n.userIdentity(),i=t&&(t.displayName||dt(t));return i||n.text.defaultDisplayName}function dt(n){var t=n.firstName||"",i=n.lastName||"";return!t&&!i?"":rt.test(t)&&rt.test(i)?"":e.AvatarMenu.displayNameFormat.format(t,i)}function gt(n,t){return t().first((function(t){return n().tenantId===t.id}))}function ni(n,t){return u.pureComputed((function(){var u=n(),r=u&&b(u.tenantId),i=t();return i.length===1&&i[0]&&b(i[0].id)===r?[]:i.sort((function(n,t){var e=b(n.id),f,i,u;return e===r?-1:(f=b(t.id),f===r)?1:(i=n.displayName,u=t.displayName,i<u?-1:i>u?1:0)}))}))}var rt,pt;r.defineProperty(t,"__esModule",{value:!0});var ut=i.Base,ft=ut.Images,wt=window,d=o.Source.TopBar,g=o.Action,nt=ut.Diagnostics.Telemetry.
trace,et="fxs-avatarmenu",ot="fxs-avatarmenu-list-tenant",tt="fxs-avatarmenu-signout",st="fxs-avatarmenu-billing",ht="fxs-avatarmenu-feedback",ct="fxs-avatarmenu-myaccess",lt="signOut",at="switchedTenant",vt="showDiagnostics",it=a.default.click,yt="a[role=menuitem], a[role=menuitemradio]",bt=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.dropMenu=new l.ViewModel(h(),s(),yt),t.userIdentity=u.observable(),t.userInfo=u.observable(),t.hideTenant=u.observable(),t.listOfTenants=u.observableArray(),t.showDiagnostics=null,t.openMenu=null,t.signOut=null,t.signedOut=null,t.switchTenant=null,t.switchedTenant=null,t.text=e.AvatarMenu,t.links=wt.fx.environment.links,t.icons={feedback:v,signout:ft.CustomImageWithOptions(w,{isLogo:!0}),person:ft.CustomImageWithOptions(p,{palette:99}),launchCurrent:y},t.avatarImage=u.observable(),t.showDiagnosticsDelay=3e3,t}return __extends(t,n),t})(c.ViewModel);t.ViewModel=bt;rt=/^(f(irst)?|l(ast)?)\s?name$/i;pt=(function(n){function t(
t,i){var r=n.call(this,t,i)||this,c,f;r._lastTouchMillis=0;var o=r.element,s=r.ltm,h=i.dropMenu;o.addClass(et);c=u.pureComputed((function(){return kt(i)}));f=u.pureComputed((function(){var n=i.userInfo();return i.hideTenant()||!n?"":n.uniqueDirectoryName}));h.buttonClass="fxs-menu-account";u.computed(s,(function(){var n=f()?e.AvatarMenu.label+" "+i.text.userWithTenantLabel.format(f()):e.AvatarMenu.label+" "+i.text.userLabel.format(c());h.buttonLabel(n)}));r._dropMenuWidget=new l.Widget(o,h);var y=u.pureComputed((function(){var n=i.userIdentity(),u,e,o,s;if(!n)return"";var f=i.text.Tooltip,h=f.tenant,t=[];return(n.firstName||n.lastName)&&t.push(f.name.format(n.firstName||"",n.lastName||"")),n.displayName&&t.push(f.email.format(n.displayName)),u=gt(i.userIdentity,i.listOfTenants),u&&!i.hideTenant()&&(t.push(h.format(u.displayName,u.id)),e=u.domainName||"",o=n.tenantDomain,t.push(o&&b(e)!==b(o)?h.format(e,o):f.domain.format(e))),s=t.join("\n"),r._dropMenuWidget.options.buttonTooltip(s),s})),a=u.observable(
MsPortalImpl.Resources.Images.getAvatarMenu().defaultAvatarSmall),v=u.observable();return u.reactor(s,(function(){var n=i.userIdentity(),t;n&&(v(n.changePasswordUri),n.isAnonymous||(a(n.defaultAvatarUri),t=i.avatarImage(),t&&t.then((function(n){return a(n)}))))})),u.applyBindingsToDescendants({data:i,func:r,displayName:c,listOfTenants:ni(i.userIdentity,i.listOfTenants),text:i.text,currentTenantDisplayName:f,tooltip:y,avatarUri:a,changePasswordLink:v},o[0]),u.reactor(s,i.dropMenu.isMenuOpen,(function(n){n&&r._reactToMenuOpen()})),r._attachEventHandlers(),r}return __extends(t,n),t.prototype.dispose=function(){this._dropMenuWidget.dispose();this._cleanElement(et);n.prototype.dispose.call(this)},t.prototype._signOut=function(n){(nt({source:d,action:g.AvatarMenuSignOut}),this.trigger(lt,f.Event(lt),{completed:!!n}))&&this.trigger("signedOut")},t.prototype._switchTenant=function(n){var t=this.options.userIdentity();if(b(n.id)!==(t&&b(t.tenantId))){if(nt({source:d,action:g.AvatarMenuSwitchTenant}),
!this.trigger("switchTenant"))return;this.trigger(at,f.Event(at),{tenant:n})}},t.prototype._attachEventHandlers=function(){var n=this,t=this.options,i=t.links,o=function(){return n._lastTouchMillis=Date.now()},s=function(i){if(n._lastTouchMillis){var r=Math.abs(Date.now()-n._lastTouchMillis);n._lastTouchMillis=0;r>t.showDiagnosticsDelay&&(n.trigger(vt,f.Event(vt)),i.preventDefault())}},r=function(n){t.openAccountPortal();i.accountPortal.startsWith("#")&&n.preventDefault()},u=function(n){t.giveFeedback();i.giveFeedback.startsWith("#")&&n.preventDefault()},e=k(this,"fxs-avatarmenu-header");e.on([a.default.touchstart,a.default.mousedown].join(" "),o);e.on([a.default.touchend,a.default.mouseup].join(" "),s);k(this,st,r);k(this,ht,u);this.ltm.registerForDispose((function(){var t=function(t,i){return n.element.off(it,t,i)};t(tt,n._signOutHandler);t(st,r);t(ht,u);t(ot,n._tenantHandler);t(ct,n._myAccessHandler)}))},t.prototype._reactToMenuOpen=function(){var n=this,t=this.options,i;this.element.
find(yt).attr("tabindex","-1");i=k(this,tt);i.attr("tabindex","0").focus();nt({source:d,action:g.AvatarMenuOpen});this._signOutHandler||k(this,tt,this._signOutHandler=function(t){n._signOut(!1);t.preventDefault()});this._tenantHandler||k(this,ot).on(it,"a",this._tenantHandler=function(t){t.preventDefault();n._switchTenant(u.dataFor(t.target))});this._myAccessHandler||k(this,ct,this._myAccessHandler=function(n){t.links.accessDetails.startsWith("#")&&n.preventDefault();t.showMyAccessBlade()})},t})(c.Widget);t.Widget=pt}));define("_generated/Templates/WidgetsTopBar",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-topbar-exit-customize"> <div class="fxs-topbar-exit-customize-message" data-bind="text: data.text.exitCustomizeText"><\/div> <button type="button" class="fxs-topbar-exit-customize-button fxs-button fxs-portal-button-primary" data-bind="text: data.text.exitCustomizeButton"><\/button> <\/div> <div class="fxs-topbar-content fxs-hide-in-customize" role="banner" aria-labelledby="bannerlabel"> <div class="fxs-topbar-internal fxs-bg-warning" data-bind="visible:data.showPreview, text: data.text.internalText"><\/div> <a href="#" id="bannerlabel" class="fxs-topbar-home fxs-trim-text-primary fxs-trim-hover" data-bind="text: data.productName, attr: { title: data.dashboardTooltip }"><\/a> <div class="fxs-topbar-placeholder"><\/div> <!-- ko if: data.inDevMode --> <a class="fxs-topbar-exitdevmode fxs-trim-hover fxs-bg-warning" href="#" role="button" data-bind="text: data.text.exitDevModeLinkText, click: func._exitDevMode"><\/a> <!-- /ko --> <!-- ko if: data.canReportBug --> <a href="#" class="fxs-topbar-reportbug fxs-trim-hover fxs-bg-warning" role="button" data-bind="text: data.text.reportBug, click: func._reportBug, attr: { title: data.text.reportBugTitle, \'aria-label\': data.text.reportBug }"><\/a> <!-- /ko --> <div class="fxs-topbar-search" data-bind="stopBindings: true" role="presentation"><\/div> <div class="fxs-topbar-notifications fxs-trim-hover"> <a href="#" class="fxs-trim-svg fxs-topbar-button" role="button" data-bind="image: data.icons.notifications, attr: { title: data.text.notifications, \'aria-label\': data.text.notifications }"><\/a> <div class=\'fxs-notificationspane-progressbar fxs-display-none\'><div><\/div><\/div> <\/div> <div class="fxs-topbar-toast" role="presentation"><\/div> <a href="#" role="button" class="fxs-topbar-console fxs-topbar-button fxs-trim-hover fxs-trim-svg" data-bind="attr: { title: data.text.console }, image: data.icons.console"><\/a> <a href="#" class="fxs-topbar-settings fxs-menu-settings fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.settings }, image: data.icons.settings"><\/a> <!-- ko if: data.showFeedbackButton --> <a href="#" class="fxs-topbar-feedback fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.feedback }, image: data.icons.feedback"><\/a> <!-- /ko --> <a href="#" class="fxs-topbar-helpmenu fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.help }, image: data.icons.help"><\/a> <a href="#" class="fxs-topbar-peekmode fxs-topbar-button fxs-trim-hover fxs-trim-svg fxs-display-none" role="button" data-bind="attr: { title: data.text.peek }, image: peekModeIcon"><\/a> <!-- ko if: data.directoryPaneEnabled --> <a href="#" class="fxs-topbar-directory fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.directory }, image: data.directoryFilterIcon"><\/a> <!-- /ko --> <div class="fxs-topbar-avatarmenu" data-bind="stopBindings: true"><\/div> <\/div> <div class="fxs-topbar-dashboard"> <div class="fxs-topbar-dashboard-message" data-bind="text: data.dashboardMessage"><\/div> <button type="button" class="fxs-button fxs-topbar-dashboard-done-customize" data-bind="text: data.text.exitCustomizeButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-view" data-bind="text: data.text.viewDashboardButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-save" data-bind="text: data.dashboardSaveButtonText"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-discard" data-bind="text: data.text.discardDashboardButton"><\/button> <\/div> <div class="fxs-loading5dots-container fxs-blade-progress-translucent" data-bind="visible: loading"> <div><\/div> <div><\/div> <div><\/div> <div><\/div> <div><\/div> <\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.TopBar",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.AvatarMenu","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsTopBar","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Svg/Startup/Settings.svg","MsPortalImpl/Svg/Startup/Console.svg","MsPortalImpl/Svg/Startup/DirectoryFilter.svg","MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg","MsPortalImpl/Svg/Startup/Star.svg","MsPortalImpl/Svg/Startup/SmileyHappy.svg","MsPortalImpl/Svg/Startup/Help.svg","MsPortalImpl/Svg/Startup/Notifications.svg","MsPortalImpl/Services/Services.SelectedSubscriptions","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){"use strict";var at,vt;r.defineProperty(t,"__esModule",{value:!0});var ft=i.Base,tt=ft.Images,et=o.findByClassName,ot=window.fx.environment,rt=
ot.features,st="fxs-topbar",ht="fxs-topbar-notifications",ct="fxs-topbar-dashboard-done-customize",lt="fxs-topbar-console",ut=a.default.fxexitorganizemode,it=i.isFeatureEnabled;t.fxfinishdashboardedit="fxfinishdashboardedit";at=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.avatarMenu=new h.ViewModel,t.directoryPaneEnabled=it("directorypane"),t.productName=ot.branding.productName,t.showPreview=u.observable(i.isNullOrUndefined(rt.internalonly)||rt.internalonly==="true"),t.text=e.TopBar,t.dashboardTooltip=e.KeyboardShortcuts.GoTo.dashboard,t.canReportBug=u.observable(!1),t.reportBug=f.noop,t.showFeedbackButton=rt.feedback==="true",t.inDevMode=u.observable(!1),t.exitDevMode=f.noop,t.icons={settings:tt.CustomImageWithOptions(v,{isLogo:!0}),help:tt.CustomImageWithOptions(d,{isLogo:!0}),console:tt.CustomImageWithOptions(y,{isLogo:!0}),notifications:tt.CustomImageWithOptions(g,{isLogo:!0}),feedback:tt.CustomImageWithOptions(k,{isLogo:!0}),directory:tt.CustomImageWithOptions(
b,{isLogo:!0})},t.directoryFilterIcon=u.observable(tt.CustomImageWithOptions(p,{isLogo:!0})),t.dashboardMessage=u.observable(""),t.dashboardSaveButtonText=u.observable(""),t.dashboardChanged=u.observable(!1),t.dashboardWritable=u.observable(!1),t.dashboardVisible=u.observable(!1),t.isInOrganizeMode=u.observable(!1),t.peekMode=u.observable(!1),t}return __extends(t,n),t})(c.ViewModel);t.ViewModel=at;vt=(function(n){function r(t,r,e){var s=n.call(this,t,r)||this,c,v,y;if(s._loadingIdList=u.observableArray([]),c=s.ltm,t.addClass(st).attr("role","presentation").html(l()),c.registerForDispose(new h.Widget(t.findByClassName("fxs-topbar-avatarmenu"),s.options.avatarMenu)),it("directorypane")&&u.reactor(c,(function(){var n=nt.allSubscriptionsSelected()?p:w;r.directoryFilterIcon(tt.CustomImageWithOptions(n,{isLogo:!0}))})),u.reactor(c,(function(){t.toggleClass("fxs-topbar-devmode",!!r.inDevMode()).toggleClass("fxs-bg-warning",!!r.inDevMode())})),u.reactor(c,(function(){var t=r.dashboardWritable(),n=r.text;
r.dashboardSaveButtonText(t?n.saveDashboardButton:n.saveDashboardCopyButton);r.dashboardMessage(t?n.saveMessage:n.saveCopyMessage)})),u.reactor(c,(function(){f(".fxs-portal-main").add(t).toggleClass("fxs-topbar-dashboard-changed",!!r.dashboardChanged());t.toggleClass("fxs-topbar-dashboard-visible",!!r.dashboardVisible());o.toggle(et(t,ct),!!r.isInOrganizeMode());var i="fxs-portal-button-primary",u="fxs-button-default",n=et(t,"fxs-topbar-dashboard").findByClassName("fxs-button").filter(o.getUnhideSelector());n&&n.length&&(n.slice(1).removeClass(i).addClass(u),n.first().removeClass(u).addClass(i))})),v=u.observable(),s._bindDescendants({loading:u.computed(s.ltm,(function(){return s._loadingIdList().length>0})),peekModeIcon:v}),s._attachEventHandlers(t),it("azureconsole")){y=i.memoizeQ((function(){var n;return i.require("MsPortalImpl/Widgets/Widgets.Console").then((function(t){return n=t})).then((function(){return s.options.getConsoleViewModel()})).then((function(i){return i.isVisible.subscribeAndRun(
c,(function(n){t.findByClassName(lt).attr("aria-expanded",n)})),new n.Widget(e,i)}))}));t.findByClassName(lt).css("display","flex").attr({"aria-controls":e.attr("id"),"aria-expanded":"false"}).on(a.default.click,(function(n){n.preventDefault();n.stopPropagation();y().then((function(n){return n.toggle()}))}))}t.findByClassName("fxs-topbar-feedback").on(a.default.click,(function(n){n.preventDefault();r.feedbackButtonClick&&r.feedbackButtonClick()}));t.findByClassName("fxs-topbar-directory").on(a.default.click,(function(n){n.preventDefault();r.directoryButtonClick&&r.directoryButtonClick()}));t.findByClassName("fxs-topbar-helpmenu").on(a.default.click,(function(n){n.preventDefault();r.helpButtonClick&&r.helpButtonClick()}));t.findByClassName(ht).on(a.default.click,(function(){r.notificationButtonClick&&r.notificationButtonClick()}));return!it("reservehozscroll")&&it("peekblades")&&(o.unhide(t.findByClassName("fxs-topbar-peekmode").on(a.default.click,(function(n){s.trigger(a.default.fxpeekmode);n.preventDefault(
)}))),s.options.peekMode.subscribeAndRun(c,(function(n){v((n?tt.Shell.ExitPeekMode:tt.Shell.PeekMode)({isLogo:!0}))}))),s}return __extends(r,n),r.prototype.loadingHint=function(n,t){t?this._loadingIdList.push(n):this._loadingIdList(this._loadingIdList().filter((function(t){return t!==n})))},r.prototype.dispose=function(){this._cleanElement(st);n.prototype.dispose.call(this)},r.prototype._reportBug=function(n,t){t.preventDefault();n.data.reportBug()},r.prototype._exitDevMode=function(n,t){t.preventDefault();n.data.exitDevMode()},r.prototype._attachEventHandlers=function(n){function r(t,i){n.trigger(t,i&&{action:i}||undefined)}function i(t,i){n.on(a.default.click,t,i)}function u(n,t){ft.Diagnostics.Telemetry.trace({source:s.Source.TopBar,action:n,data:t})}function f(n,t,i){return function(f){f.preventDefault();t&&u(t,i);r(n)}}var e=this.options;i(".fxs-topbar-exit-customize-button, ."+ct,f(ut,s.Action.CustomizeModeExited,{dashboardChanged:!!e.dashboardChanged(),onDashboard:!!e.dashboardVisible(
)}));i(".fxs-topbar-home",f(a.default.fxhomebuttonclick,s.Action.HomeButtonClicked));i("."+ht,(function(n){n.preventDefault()}));i(".fxs-topbar-settings",f(a.default.fxsettingsbuttonclick));i(".fxs-topbar-dashboard-save",(function(){var n=e.dashboardWritable(),i=n?1:2,f=n?s.Action.DashboardPublish:s.Action.DashboardSaveACopy;u(f);r(t.fxfinishdashboardedit,i);i===1&&r(ut)}));i(".fxs-topbar-dashboard-discard",(function(){u(s.Action.DashboardDiscard);r(t.fxfinishdashboardedit,3);r(ut)}));i(".fxs-topbar-dashboard-view",(function(){u(s.Action.DashboardView);r(a.default.fxhomebuttonclick)}))},r})(c.Widget);t.Widget=vt}));define("MsPortalImpl/UI/Dashboard/DashboardManager",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.Router","MsPortalImpl/UI/Dashboard/ArmDashboardRepository","MsPortalImpl/UI/Dashboard/DashboardCompressor","MsPortalImpl/UI/Dashboard/DashboardRepository","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Dashboard/PrivateDashboardRepository",
"MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/Dashboard/DashboardClient","MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.TopBar"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st){"use strict";function li(n){var r=n||{},u=r.model,f=r.metadata;return{model:i.extend2(t.defaultDashboardModelJson.model,u),metadata:i.
extend2(t.defaultDashboardModelJson.metadata,f)}}function lt(n,t,i){return new gt(n,t||new Error,i)}function di(n){var t=n.services,e=new pi(t.settings),o=new ei(t),i=new h.DashboardCompressor,r=new oi(e,n.services.desktop.portalWidget.getTopBarWidget(),n.lifetime,o,i,n.services.storageService),c=new s.ArmDashboardRepository(n.lifetime,t.extensionManager,t.permissionsManager,i),u,f;return r.addRepository(c),u=rt.create(t.extensionManager),f=new ut.RecommendedDashboardRepository(u,i),r.addRepository(f),r}function ai(n){return n.id.toLowerCase().replace(/\/\/+/g,"/")}function bt(n,t){return ai(n)===ai(t)}function fi(n){return Q(n)}function ni(n,t){return nt.buildIdentitySettingKey(n,t)}function ti(n){return yt.start({source:w.Source.Dashboard,action:n,actionModifier:yt.ActionModifier.Start})}function vi(n,t,i,r){var u=i.id;return Q.allSettled(r.children.map((function(n){return Q(n.awaitComposed()).then((function(){return n.awaitOnInputsSetComplete()})).then((function(){return n}),(function(){return n})
)}))).then((function(i){yt.completeTrace(n,{success:!0,dashboardId:u,parts:i.map((function(n){var t=n.value;return{name:t.locator.toFriendlyString(),visible:et.isElementFullyInViewport(t.widget.element[0]).fullyVisible}})),interactionSource:t})}))}function yi(n){var t=n&&n.widgetState||{};return t.NormalState&&t.NormalState.layoutSettings||{}}function gi(n){var t={},r=n[wt],e=yi(r),o=[];return u.keys(n).filter((function(n){return tt.isStartboardPartKey(n)})).forEach((function(r){var u=n[r],a=l.Locator.fromJSON(u.locator),v=g.createContainerModel(u.containerModel),tt=ni(a,v),w=f.toJS(v),y,s,p,d,nt,h,c;w[b.PartContainerModelIdProperty]=i.getUniqueId();y=ui(w);u.containerModel=g.getSerializableContainerModel(y,!1);s=k.createIdentifier(b.CompositionType.StartboardPart,a);u.id=s;t[s]=u;p=n[tt];p&&(d=ni(a,y),t[d]=p);u.flags&2&&(nt=l.Locator.fromJSON(u.originalPartLocator),h=ni(nt,v),n[h]&&(t[h]=n[h]));c=(e.positions||[]).first((function(n){return n.id===r}));c&&(c.id=s,o.push(c))})),e.positions=o,t[wt]=
r,JSON.parse(JSON.stringify(t))}function nr(n){var r=n&&n.relative,f=n&&n.absolute,t="",i,u;if(r){i=r.duration;u=r.timeUnit;switch(u){case 3:i===1&&(t=kt.pastWeek);break;case 1:i===1?t=kt.pastHour:i===24&&(t=kt.past24Hours)}}else f&&(t=kt.custom);return t}function tr(n){var t=n&&n.model&&n.model.model;return t&&t.timeRange}function at(n,t){n&&o.updateDashboardUri(n.id,t)}function ht(n,t){n._startboard.widget.options.loading(t)}var gt,ei,oi;u.defineProperty(t,"__esModule",{value:!0});var ii=i.Base,pi=v.PrivateDashboardRepository,wi=i.Composition.Configuration,yt=ii.Diagnostics.Telemetry,ri=w.Action,bi=window,pt=bi.fx,ct=ii.Diagnostics.createLog(n),wt=p.startBoardSettingsKey,ki=10,vt=a.Dashboard,kt=a.Filter.Option,dt=ii.Constants.DefaultCloudName,ui=d.CompositionBinder.createObservableModel,si="create",hi="clone",ci="unpublish";t.defaultDashboardModelJson={model:{timeRange:{relative:{duration:24,timeUnit:1}}},metadata:{timeRange:wi.TimeRangeValueType}};t.backfillDashboardModel=li;gt=(function(
n){function t(t,i,r){return n.call(this,{code:t,data:r||{},message:i.message,stack:i.stack,innerErrors:i})||this}return __extends(t,n),t})(i.Errors.Error);gt.TypeName="MsPortalImpl.UI.DashBoardError";t.create=di;t.isSameDashboard=bt;t.startTrace=ti;ei=(function(){function n(n){this._desktopManager=n.desktop;this._settingsManager=n.settings;this._notificationManager=n.notificationManager}return n.prototype.collectDashboardSettings=function(n){var h=this,u={},f=n.toJSON(),o=n.dashboardFiltersManager&&n.dashboardFiltersManager.toJSON(),t=n.children.filter((function(n){return!n.dontSetupWidget&&!n.isDisposed()})),s=n.widget.getDomOrderedChildren(),r;return t.length!==s.length&&ct.error("There should be the same number of composed parts to save ("+t.length+") as the number of positioned elements in the layout ("+s.length+"). The settings will be incorrect."),r=[],s.forEach((function(n){var u=i.remove(t,(function(t){return t.id===n}));if(u.length!==1){ct.error("There should be a composed part with ID '"+
n+"' yet none was found. The saved content will be incorrect. The settings will be incorrect.");return}r.push(h.getPartSettings(u[0]))})),t.length>0&&t.forEach((function(n){ct.error("Part '"+n.id+"' should have a position defined in the layout, yet none was found. The settings will be incorrect.");r.push(h.getPartSettings(n))})),Q.allSettled(r).then((function(n){return n.forEach((function(n){e.extend(u,n.value)})),o&&(f.dashboardModel.model.filterlocale=o.filterlocale,f.dashboardModel.model.filters=o.filters),u[wt]=f,JSON.parse(JSON.stringify(u))}))},n.prototype.getPartSettings=function(n){var t=this;return Q(n.awaitComposed()).then((function(){var o;if(n.isDisposed())return{};var s={},r=n.toJSON(),u=n.containerModel;return u[b.PartContainerModelIdProperty]||(o=f.toJS(g.createContainerModel(r.containerModel)),o[b.PartContainerModelIdProperty]=i.getUniqueId(),u=ui(o),r.containerModel=g.getSerializableContainerModel(u,!1)),s[r.id]=r,t.getPartIdentitySettings(n,u).then((function(n){return e.extend(
s,n)}))})).catch((function(t){return ct.error(t,8,"part: '"+n.id+"'."),{}}))},n.prototype.getPartIdentitySettings=function(n,t){var r=n.partDefinition,i;return!r||!r.partState?Q({}):(i=ni(n.locator,t),n.getPartSettingsManager().getStartboardPartIdentitySettings().then((function(n){if(!n)return{};var t={};return t[i]=n,t})).catch((function(t){return ct.error(t,9,"Failed to get part '"+n.id+"' identify settings for key '"+i+"'."),{}})))},n.prototype.clearStartboard=function(n,t){var i=this._desktopManager;n.children.filter((function(n){return!n.dontSetupWidget})).forEach((function(n){return i.removeTile(n.id,{force:!0,skipSave:t})}))},n.prototype.renderStartboard=function(n,t,r){var o=r.delayRendering,f=u.keys(t),s={},c=function(n,t){var r={};return i.shallowCopyFromObject(r,n,t),r},a=f.filter((function(n){return i.startsWith(n,nt.partIdentityStatePrefix)})),h,e;return this._settingsManager.setSettings({store:13,settings:c(t,a)}),h=t[wt],n.widget.options.applyViewSettings(h.widgetState),f=f.filter((function(
n){return tt.isStartboardPartKey(n)})),e=[],f.forEach((function(i){var u=t[i],r,f,o;try{r=l.Locator.fromJSON(u.locator)}catch(h){ct.error("Error derialization locator for part setting.\r\nError:'"+h+"'\r\nKey:'"+i+"'\r\nJSON:'"+u+"'")}r&&(f=r.getExtensionLocator(),(r.type===l.LocatorType.PartType||r.type===l.LocatorType.PartInstance&&r.parent&&r.parent.type===l.LocatorType.Lens&&r.parent.parent&&r.parent.parent.type===l.LocatorType.Blade)&&(o=n.services.extensionManager.getManifestByName(f.name,f.cloudName).then((function(){var h=r.type===l.LocatorType.PartType?l.Locator.forPartTypeRedirect(f.name,r.name):l.Locator.forPartInstanceRedirect(f.name,r.name,r.parent.parent.name,r.parent.name),e={},t,o;n.services.finder.tryLocate(h,e)&&(t=e.value,s[i]=t.bindings,f=t.toExtension?l.Locator.forExtension(t.toExtension,f.cloudName):f,o=f.withPartType(e.value.toPart),u.originalPartLocator=u.locator,u.flags||(u.flags=0),u.flags|=2,u.locator=o.toJSON(),yt.trace({source:w.Source.Dashboard,action:ri.Redirect,
name:r.toFriendlyString(),data:{to:o.toFriendlyString()}}))})).catch((function(n){ct.error("Error locating or applying part redirect.\r\nError:'"+n+"'\r\nKey:'"+i+"'\r\nJSON:'"+u+"'")})),e.push(o)))})),Q.all(e).then((function(){var i=[];f.forEach((function(u){var o=t[u],f=it.Instance.fromJSON(n.services,o,s[u]),e=f.locator.getExtensionLocator(),h=n.services.extensionManager.getExtension(e.name,e.cloudName);(h||!r.isDefault)&&i.push(f)}));i.length&&(n.addChildren(i),o||i.forEach((function(t){t.compose(n.widget);t.save()})));o||(n.discardWidgetStateOfUnusedChildren(),n.save())}))},n.prototype.readDashboardsOfMaxCount=function(n,t,i,r){n=n.slice();i=i.slice();var u=[],e=i.map((function(n){return n.id.toLowerCase()})),f=function(){var i=n.shift();return i.readDashboards().then((function(n){return r(n,i.getTypeName()),n.filter((function(n){return e.indexOf(n.id.toLowerCase())<0})).slice(0,t-u.length)})).catch((function(n){var t=i.getTypeName();return ct.error(n,10,"Failed to read dashboards from '"+t+"' repository."),
[]})).then((function(i){return u.push.apply(u,i),u.length>=t||!n.length?Q():f()}))};return f().then((function(){return u}))},n.prototype.enterOrganizeMode=function(n){var t=this._desktopManager;t.mode(1);n&&t.portalWidget.options.sideBarViewModel.isCollapsed(!n)},n.prototype.isStartboardReady=function(){return this._desktopManager.startBoardPartsLoaded()},n.prototype.getStartboardReadyPromise=function(){return this._desktopManager.getStartboardPartsLoadedPromise()},n.prototype.popNotification=function(n,t,r){r===void 0&&(r=i.Hubs.Notifications.NotificationStatus.Error);this._notificationManager.addClientNotification({title:n,description:t,cloudName:dt,status:r,timestamp:new Date})},n})();t.DashboardHelperImpl=ei;oi=(function(){function n(n,t,r,u,e,o){var s=this;this.currentDashboardId=f.observable("");this._notifyDashboardChanged=i.throttle((function(){if(!s._startboard.notFound()){var n=s._privateRepo.identifyDashboard(s._curDashboard.id);n?s.saveCurrentDashboard():s._topbarWidget.options.dashboardChanged(
!0)}}));this._privateRepo=n;this._topbarWidget=t;this._lifetime=r;this._helper=u;this._compressor=e;this._storage=o;this._otherRepos=[];this._isStartboardChanging=!1;this._isMigrated=!1;this._armDashboardCache=[];this._isStartboardShared=f.observable(!1)}return n.prototype.resetLayout=function(n){var t=this._helper,i=s.normalizedDashboard(pt.environment.defaultDashboard||{}),r=this._compressor.uncompress(vt.defaultTitle,i);return t.clearStartboard(n),t.renderStartboard(n,r.settings,{delayRendering:!1,isDefault:!0,isCurrentDashboardShared:this.isCurrentDashboardShared()})},n.prototype.isCurrentDashboardShared=function(){var n=this._curDashboard&&this._findOwningRepo(this._curDashboard.id);return n&&n.getTypeName()===c.ArmDashboardRepository},n.prototype.isCurrentDashboardWritable=function(){return this._isWritable(this._curDashboard.id)},n.prototype.getCurrentDashboardProperties=function(){var n=this._curDashboard,t=this._findOwningRepo(n.id);return t&&t.getDashboardProperties?t.getDashboardProperties(
n):{id:n.id,title:n.title}},n.prototype.initialize=function(n,t,r,u,f){var e=this,h,s;return this._startboard=n,this._registerEventHandlers(this._lifetime),h=i.isFeatureEnabled("addsessiondashboardrepository")?i.require("MsPortalImpl/UI/Dashboard/SessionDashboardRepository").then((function(n){var t=new n.SessionDashboardRepository(e._storage);e.addRepository(t)})):Q(),s=h.then((function(){return t?(e._isMigrated=!0,e._initDashboard(t,f)):e._migrateStartboard().then((function(){return f.dashboardMigration=pt.getTimestamp(),r?e.switchDashboard({id:r,title:r},"DeepLinkAfterMigration"):Q()}))})).then((function(){f.dashboardInitialized=pt.getTimestamp();(o.isDashboardRoute()||o.isDashboardUri()&&!t)&&at(e._curDashboard,!0)})).catch((function(n){e._handleError(n,"initializeDashboard")})).finally((function(){vi(u,"PortalLoad",e._curDashboard,e._startboard).then((function(){f.dashboardRevealed=pt.getTimestamp()}))})),s.finally((function(){e._preloading()})),s},n.prototype.addRepository=function(n){this._otherRepos.
push(n)},n.prototype.readDashboardsForType=function(n){return this._getRepositoryByType(n).readDashboards()},n.prototype.startNewDashboard=function(){var n=this;return this._privateRepo.canCreateNewDashboard().then((function(n){if(n)return Q();throw lt(6,null,{action:si});})).then((function(){return ht(n,!0),n._addToRecent(n._curDashboard)})).then((function(){return n._privateRepo.createDefaultDashboard()})).then((function(t){return n._setCurDashboard(t,!0),at(t),n._isStartboardChanging=!0,n._helper.clearStartboard(n._startboard),n._isStartboardChanging=!1,n._startboard.save(),n._saveDashboard(n._curDashboard)})).then((function(){n._helper.enterOrganizeMode(!0)})).catch((function(t){n._handleError(t,"startNewDashboard")})).finally((function(){ht(n,!1)}))},n.prototype.importDashboard=function(n){var t=this;return this._privateRepo.canCreateNewDashboard().then((function(n){if(!n)throw lt(6,null,{action:hi});t._isStartboardChanging=!0;ht(t,!0)})).then((function(){return Q.all([t._addToRecent(t._curDashboard),
t._privateRepo._getDashboards()])})).then((function(r){var f=r[1],e=i.getUniqueId(),u=t._compressor.uncompress("private/"+e,n);return t._privateRepo.createDashboard({settings:u.settings,title:v.createDashboardTitle(f,u.title)})})).then((function(n){return at(n),t._loadDashboard(n,!1,!0)})).catch((function(n){t._handleError(n,"importDashboard")})).finally((function(){t._isStartboardChanging=!1;ht(t,!1)}))},n.prototype.getArmDashboardJson=function(){var n=this;return this._collectDashboardSettings(!0,!0).then((function(t){var i=n._compressor.compress({id:"",title:t[wt].dashboardTitle,settings:t}),r={};return i.parts.forEach((function(n,t){r[t]=n})),{properties:{lenses:{"0":{order:0,parts:r}}},id:t[wt].dashboardId,name:"",type:"Microsoft.Portal/dashboards",location:"",tags:{"hidden-title":i.title}}})).then((function(t){var r=s.getArmDashboardId(t.id),u=n._otherRepos[0];return u.readArmDashboards().then((function(n){return n.filter((function(n){return i.ViewModels.Services.ResourceTypes.compareResourceId(
n.id,r)})).first()})).then((function(i){var r=n._isStartboardShared();return t.location=r&&i?i.location:"INSERT LOCATION",t.name=r&&i?i.name:t.tags["hidden-title"],t}))}))},n.prototype.saveCurrentDashboard=function(){var n=this;return this._saveDashboard(this._curDashboard).catch((function(t){n._handleError(t,"saveCurrentDashboard")}))},n.prototype.cloneCurrentDashboard=function(n){var t=this;return n===void 0&&(n=!0),this._privateRepo.canCreateNewDashboard().then((function(n){if(n)return Q();throw lt(6,null,{action:"import"});})).then((function(){return t._isStartboardChanging=!0,ht(t,!0),t._collectDashboardSettings(n,!0)})).then((function(n){return t._addToRecent(t._curDashboard).then((function(){return t._privateRepo.cloneDashboard(n,t._curDashboard.title)}))})).then((function(n){return at(n),t._loadDashboard(n,!1,!0)})).then((function(){t._helper.enterOrganizeMode()})).catch((function(n){t._handleError(n,"cloneCurrentDashboard")})).finally((function(){t._isStartboardChanging=!1;ht(t,!1)}))},n.prototype.deleteCurrentDashboard=
function(n){var t=this,i="deleteCurrentDashboard";return this._isStartboardChanging=!0,ht(this,!0),this._readNextDashboards(1).then((function(n){if(n.length<=0)throw lt(2);return n[0]})).then((function(r){return t._deleteDashboard(t._curDashboard,n).catch((function(n){return t._handleError(n,i)})).then((function(){return r}))})).then((function(n){return at(n,!0),t._loadDashboard(n)})).catch((function(n){t._handleError(n,i)})).finally((function(){t._isStartboardChanging=!1;ht(t,!1)}))},n.prototype.restoreCurrentDashboard=function(){var n=this;return this._isStartboardChanging=!0,ht(this,!0),this._loadDashboard(this._curDashboard).catch((function(t){n._handleError(t,"restoreCurrentDashboard")})).finally((function(){n._isStartboardChanging=!1;ht(n,!1)}))},n.prototype.switchDashboard=function(n,t){var i=this,r=bt(this._curDashboard,n),u;return(at(n,r),r)?Q():(u=ti("DashboardRevealed"),ht(this,!0),Q(this._switchDashboard(n,!1)).finally((function(){ht(i,!1);vi(u,t,i._curDashboard,i._startboard)})))},n.prototype.
populateQuickDashboards=function(n){var t=this;return this._readNextDashboards(ki,(function(i){i=t._curDashboard.id?[t._curDashboard].concat(i):i;n(i)}))},n.prototype.shareCurrentDashboard=function(n,t,i){var r=this,u=this._curDashboard;return ht(this,!0),this.shareCurrentDashboardToArm(n,t,i).then((function(n){return at(n,!0),r._switchDashboard(n,!0)})).then((function(){return r._deleteDashboard(u,2)})).finally((function(){ht(r,!1)}))},n.prototype.unshareCurrentDashboard=function(){var n=this,i="unshareCurrentDashboard",t=this._curDashboard;return this._privateRepo.canCreateNewDashboard().then((function(t){if(t)return Q();var r=lt(6,null,{action:ci});n._handleError(r,i);throw r;})).then((function(){return ht(n,!0),n._shareCurrentDashboard(c.PrivateDashboardRepository,t.title)})).then((function(t){return at(t,!0),n._switchDashboard(t)})).then((function(){return n._deleteDashboard(t,3)})).finally((function(){ht(n,!1)}))},n.prototype.shareCurrentDashboardToArm=function(n,t,i){var r=this,u=ti(ri.DashboardPublishNew);
return this._shareCurrentDashboard(c.ArmDashboardRepository,n,{subscriptionId:t,resourceGroupName:i}).then((function(n){return yt.completeTrace(u,{success:!0,dashboardId:n.id}),n})).catch((function(f){yt.completeTrace(u,{success:!1});var e=lt(7,f,{dashboardId:r._curDashboard.id,dashboardTitle:n,subscriptionId:t,resourceGroupName:i});r._handleError(e,"shareCurrentDashboardToArm");throw e;}))},n.prototype.shareCurrentDashboardToSession=function(n){var t=this;return this._shareCurrentDashboard(c.SessionDashboardRepository,n).catch((function(i){var r=lt(7,i,{dashboardId:t._curDashboard.id,dashboardTitle:n});t._handleError(r,"shareCurrentDashboardToSession");throw r;}))},n.prototype._registerEventHandlers=function(n){var t=this,e=this._startboard,c=this._topbarWidget.element,s=this._topbarWidget.options,o=e.widget,l=o.element;e.setGetDashboard((function(){return i.clone(t._curDashboard)}));f.reactor(n,(function(){var n,i,r;t.currentDashboardId();n=tr(t._curDashboard);i=nr(n&&n());i&&(r=vt.filterButtonTextFormat.
format(i),o.options.filterButtonText(r))}));var a=function(n){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&!t._isStartboardChanging&&t._notifyDashboardChanged()},v=function(n){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&!t._isStartboardChanging&&t._notifyDashboardChanged()},h=function(n,i){var r,u,f;n.stopPropagation();r=i.part;r.getCompositionType()===b.CompositionType.StartboardPart&&(u=r.getViewModel(),u&&!u.container.operations.inProgress.peek()&&(f=t._privateRepo.identifyDashboard(t._curDashboard.id),(s.dashboardVisible()||f)&&t._notifyDashboardChanged()))},p=function(n){n.stopPropagation();var i=o.options;i.title().length===0&&(e.services.desktop.mode(1),i.title(vt.untitled));t._notifyDashboardChanged()},w=function(n,i){if(n.stopPropagation(),s.dashboardChanged(!1),!e.notFound())switch(i.action){case 1:t.saveCurrentDashboard();break;case 2:t.cloneCurrentDashboard(!1);break;case 3:t.restoreCurrentDashboard()}},k=function(n){n.stopPropagation(
);t._migrateStartboard()},u=o.options;u.refreshDashboardList=function(n){return t.populateQuickDashboards(n)};u.updateDashboardUri=at;u.switchDashboard=function(n){return t.switchDashboard(n,"RecentList")};u.title.subscribe(n,(function(n){t._curDashboard.title=n}));e.notFound.subscribe(n,(function(n){u.notFound(n)}));u.isShared(this.isCurrentDashboardShared());this._isStartboardShared.subscribe(n,u.isShared,(function(n){u.isShared(n)}));y.selectedSubsUpdateTriggered.subscribe(n,(function(){var n=r.Azure.getAllSubscriptions(r.Rpc.client,dt),t=y.getSelectedSubscriptions(dt);Q.all([n,t]).spread((function(n,t){var i=n.length,r=t.length;u.subscriptionsInfo(r>=i?vt.browseForAllSubs.format(i):vt.browseForSelectedSubs.format(r,i))}))})).callback(null);n.registerForDispose([function(){e.removeGetDashboard()},l.setEvents([tt.fxstartboardsettingchanged,a],[b.fxreplacedpartcomposing,v],[nt.fxpartsettingchanged,h],[g.fxpartinputchanged,h],[ot.fxstartboardtitlechanged,p],[ot.fxmigratestartboard,k]),c.setEvents(
[st.fxfinishdashboardedit,w])])},n.prototype._setCurDashboard=function(n,t,i){var r,u,f,e;i===void 0&&(i=!1);n=n||{id:"",title:a.NavBar.home};n&&(u=n.settings,f=u&&u[wt],r=f&&f.dashboardModel);r=li(r);e={model:ui(r.model),metadata:r.metadata};this._curDashboard={id:n.id,title:n.title,isWritable:t,model:e};this._startboard.widget.options.title(n.title);this._topbarWidget.options.dashboardWritable(t);this.currentDashboardId(n.id);this._startboard.notFound(i);this._isStartboardShared(this.isCurrentDashboardShared());this._startboard.dashboardFiltersManager&&this._startboard.dashboardFiltersManager.loadDashboard(r&&r.model)},n.prototype._switchDashboard=function(n,t){var i=this;return this._isStartboardChanging=!0,this._addToRecent(this._curDashboard).then((function(){return i._loadDashboard(n,!1,t)})).catch((function(n){i._handleError(n,"switchDashboard")})).finally((function(){i._isStartboardChanging=!1}))},n.prototype._findOwningRepo=function(n){var t=[this._privateRepo];return t.concat(this.
_otherRepos).first((function(t){return t.identifyDashboard(n)}))},n.prototype._getRepositoryByType=function(n){var t=[this._privateRepo];return t.concat(this._otherRepos).first((function(t){return t.getTypeName()===n}))},n.prototype._readDashboard=function(n){var i=this,t=n.id;return fi(this._findOwningRepo(t)).then((function(n){return n.readDashboard(t)})).then((function(n){if(!n)throw new Error("It succeeded in reading dashboard '"+t+"'. But the result is "+n+".");return n})).catch((function(r){throw lt(1,r,{dashboardId:t,dashboardTitle:n.title,initDashboardIdFromStore:i.initDashboardIdFromStore});}))},n.prototype._collectDashboardSettings=function(n,t){var r=this,u=n?this._readDashboard(this._curDashboard):Q(null);return Q(u).catch(i.noop).then((function(n){return n?n.settings:r._helper.collectDashboardSettings(r._startboard)})).then((function(n){return t?gi(n):n}))},n.prototype._saveDashboard=function(n){var u=this,t=n.id,r=n.title,f=i.getCurrentCallStack(!0);return this._collectDashboardSettings(
).then((function(n){return fi(u._findOwningRepo(t)).then((function(i){var e=n&&n.Startboard,u=yi(e),o=u.positions&&u.positions.length;return o||ct.warning("Saving empty dashboard.",0,f),i.updateDashboard(t,{settings:n,title:r})}))})).catch((function(t){throw lt(5,t,{dashboardId:n.id,dashboardTitle:r});}))},n.prototype._deleteDashboard=function(n,t){var e=this,r=n.id,f,u;return i.remove(this._armDashboardCache,(function(n){return n.id.toLowerCase()===r.toLowerCase()})),f=ti(ri.DashboardDelete),u=!0,this._removeFromRecent(r).then((function(){var n=e._findOwningRepo(r);return n.deleteDashboard(r)})).catch((function(t){u=!1;throw lt(4,t,{dashboardId:r,dashboardTitle:n.title});})).finally((function(){yt.completeTrace(f,{success:u,dashboardId:r,reason:t})}))},n.prototype._readNextDashboards=function(n,t){var r=this;t||(t=i.noop);var u=function(t,i){return t=i?s.filterDashboards(t,i):t,t.filter((function(n){return!bt(n,r._curDashboard)})).slice(0,n)},f=y.getSelectedSubscriptions(dt).catch((function(){return[]})
),e=this._privateRepo.getRecentDashboards().catch((function(){return[]}));return Q.all([f,e]).spread((function(f,e){var o=f.map((function(n){return n.subscriptionId}));return(e=u(e,o),e.length>=n)?(t(e),Q(e)):r._privateRepo.readDashboards().catch((function(){return[]})).then((function(f){var s=i.union(e,f,bt);return(s=u(s),s.length>=n)?(t(s),s):(s=i.union(s,r._armDashboardCache,bt),s=u(s,o),t(s),s.length>=n)?s:r._helper.readDashboardsOfMaxCount(r._otherRepos,n-s.length,s,(function(n,f){f===c.ArmDashboardRepository&&(r._armDashboardCache=n);s=i.union(s,n,bt);s=u(s);t(s)})).then((function(){return s}))}))}))},n.prototype._preloading=function(){var n=this;return this.readDashboardsForType(c.ArmDashboardRepository).then((function(t){n._armDashboardCache=t}))},n.prototype._isWritable=function(n){return fi(this._findOwningRepo(n)).then((function(t){return t.isDashboardWritable(n)})).catch((function(){return!0}))},n.prototype._addToRecent=function(n){return this._startboard.notFound()?Q():this._privateRepo.addToRecent(
n).catch(e.noop)},n.prototype._removeFromRecent=function(n){return this._privateRepo.removeFromRecent(n).catch(e.noop)},n.prototype._loadDashboard=function(n,t,i,r){var u=this,f=n.id,o=i?Q(n):this._readDashboard(n),e=this._helper;return r=r||{},Q.all([this._removeFromRecent(f).then((function(){r.dashboardRemoveFromRecent=pt.getTimestamp()})),this._isWritable(f).then((function(n){return r.dashboardIsWritable=pt.getTimestamp(),n})),Q(o).then((function(n){return r.dashboardRead=pt.getTimestamp(),n}))]).spread((function(n,i,r){return u._setCurDashboard(r,i),e.clearStartboard(u._startboard),e.renderStartboard(u._startboard,r.settings,{delayRendering:t,isCurrentDashboardShared:u.isCurrentDashboardShared()})})).catch((function(t){u._setCurDashboard(n,!0,!0);u._startboard.notFound()||u._startboard.save();throw t;}))},n.prototype._migrateStartboard=function(){var n=this,t=this._startboard.widget.options,i=a.NavBar.home;return this._helper.getStartboardReadyPromise().then((function(){return n._privateRepo.
createDefaultDashboard(i)})).then((function(t){return n._setCurDashboard(null,!0),n._startboard.save(),n._saveDashboard(t).then((function(){return t}))})).then((function(i){t.headerMode(1);n._setCurDashboard(i,!0);n._startboard.save();n._isMigrated=!0})).catch((function(n){throw lt(3,n);}))},n.prototype._initDashboard=function(n,t){var i=this,r=this._startboard.widget.options;return r.headerMode(1),this._loadDashboard(n,!0,!1,t).then((function(){i._startboard.logChildren()}))},n.prototype._shareCurrentDashboard=function(n,t,i){var r=this._getRepositoryByType(n);return this._collectDashboardSettings(!0,!0).then((function(n){return r.createDashboard({title:t,settings:n,extras:i})}))},n.prototype._handleError=function(n,t){var o=this,e=this._startboard.widget.options,r=this._helper,u=vt.Notification.errorTitle,i=vt.Error,f=function(n,i){ct.error(n,n.code,t+": "+i)},s=function(n){var u=n.data,i=u.dashboardId,f=u.dashboardTitle;ct.warning(n,n.code,t+": Failed to find dashboard '"+i);var r=o._findOwningRepo(
i),s={id:i,title:f},h=r&&r.getNotFoundMessage?r.getNotFoundMessage(s):vt.NotFound.defaultMessageFormat.format(f);e.notFoundMessage(h)},h=function(){r.popNotification(u,i.cannotDelete)},c=function(n){f(n,"Failed to migrate startboard.");e.headerMode(2)},l=function(n){var t=n.data;f(n,"Failed to delete dashboard '"+t.dashboardId+"'");r.popNotification(u,i.failToDeleteFormat.format(t.dashboardTitle,n.message))},a=function(n){var t=n.data;f(n,"Failed to save dashboard '"+t.dashboardId+"'.");r.popNotification(u,i.failToSaveFormat.format(t.dashboardTitle))},v=function(n){var f=n.data.action,t="";switch(f){case si:t=i.cannotCreate;break;case hi:t=i.cannotClone;break;case ci:t=i.cannotUnpublish}r.popNotification(u,t)},y=function(n){var t=n.data,e=t.dashboardId,o=t.dashboardTitle,s=t.resourceGroupName,h=t.subscriptionId;f(n,"Failed to publish dashboard '"+e+"'");r.popNotification(u,i.failToPublishFormat.format(o,s,h,n.message))},p=function(){ct.error(n,0,t);r.popNotification(u,i.unknown)};if(n instanceof
gt)switch(n.code){case 1:s(n);break;case 2:h();break;case 3:c(n);break;case 4:l(n);break;case 5:a(n);break;case 6:v(n);break;case 7:y(n)}else p()},n})();t.DashboardManagerImpl=oi}));define("MsPortalImpl/UI/UI.DesktopManagerView",["require","exports","f","i","o","ko","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function a(n,t){s.isTraceEnabled&&y.verbose("[DesktopManager] {0}\n  {1}\n  Model: {2}.".format(n,t.toString(),f.toJSON(t.getInputsOnlyViewModel())))}function p(n,t){return new c(n,t)}var c;u.defineProperty(t,"__esModule",{value:!0});var l=i.Base.Diagnostics,v=window,y=l.createLog(n);t.showConfirmDialog=function(n){return v.confirm(n)};c=(function(){function n(n,t){var i=this;this._portalWidget=n;this._panoramaWidget=n.getPanorama();this._contextPane=t;this._portalWidget.element.on(h.default.fxautosettings,(function(n,t){i._autoOpenedBy=
t}))}return u.defineProperty(n.prototype,"portalWidget",{get:function(){return this._portalWidget},enumerable:!0,configurable:!0}),n.prototype.composeJourney=function(n){n&&n.compose(this._panoramaWidget)},n.prototype.composeStartBoard=function(n){n&&n.compose(this._panoramaWidget)},n.prototype.addPartToStartBoard=function(n){n.compose(this._panoramaWidget.getStartBoardWidget())},n.prototype.addBlade=function(n,t){var u,f;return(a("Adding blade to desktop.",n),u=n.parent.blades,l.Telemetry.trace({action:"JourneyLength",source:o.Source.Desktop,data:{count:u.length,blades:u.map((function(n){var t=n.locator;return{bladeName:t.name,extension:r.Extension.getWindowId(t.getExtensionLocator())}}))}}),n.flags&1)?this._contextPane.tryOpen(n).then(i.noop):(this._autoOpenedBy&&(f=n.masterContainer,f&&f.instanceId===this._autoOpenedBy.masterBladeId&&(t||(t={}),t.autoOpenedByBlade=this._autoOpenedBy.masterBladeId,t.autoOpenedByPart=this._autoOpenedBy.masterPartId),this._autoOpenedBy=null),n.compose(this.
_panoramaWidget.getJourneyWidget(),t),Q())},n.prototype.removeBlade=function(n){a("Removing blade from desktop.",n);var t=this._contextPane;t.hasContent(n)?t.close(!0):this._panoramaWidget.removeChild(n.id)},n.prototype.removeAllBlades=function(n){var t=this._panoramaWidget.getJourneyWidget();t&&t.removeChildren(n);var i=this._contextPane,r=i.getContent(),u=r&&r.locator;u&&u.type===e.LocatorType.Blade&&i.close(!0)},n.prototype.showConfirmDialog=function(n){return!!t.showConfirmDialog(n)},n})();t.DesktopManagerViewImpl=c;t.create=p}));define("MsPortalImpl/UI/UI.DesktopManagerImpl",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.Router","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition",
"MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/Dashboard/DashboardManager","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt){"use strict";function ii(n,t,i,r){return st.startTrace({source:n,action:t,name:i,assetType:r})}function ri(){return at("MsPortalImpl/UI/UI.Desktop.Actions")}function di(n,t){return new fi(tt.create(n,t.contextPane),t)}function gi(n,t){var r={},u=si[si.StartboardPart],f=i.forEachKey(n,(function(n,t,i){var f=k.isStartboardPartKey(n),e=ti(n,u+"-"+bt)||ti(n,u+"-"+kt);!f||e?r[n]=t:i.push(n)}),[]);return f.length&&t.deleteSettings({store:ni,keys:f}),r}function nr(n){var t=n[a.startBoardSettingsKey]||{},i=t.dashboardId;
return!i?null:{id:i,title:t.dashboardTitle||l.NavBar.home}}function pi(n,t){if(!t)return n;if(n){var i=t.toLowerCase(),r=(n.id||"").toLowerCase()===i;return r?n:{id:i,title:i}}return null}function ui(n,t,i){n.removeChild(t,!1,!i&&!t.dontSetupWidget)}function wi(n){return n&&n.locator&&n.locator.toFriendlyString()}function tr(t){var u=r.ViewModels.Part.composePartViewModel,f=it.registerWithState,e=n.normalize("./UI.BladeLauncher"),i;f("Shell$BladeLauncherViewModel",e,(function(n,t){return u((function(i){return new n.BladeLauncher(i,t)}),{initialState:t,createSelectable:!0,logArea:e})}));i=n.normalize("./UI.AssetBladeLauncher");f("Shell$AssetBladeLauncherViewModel",i,(function(n,r){return u((function(i){return new n.AssetBladeLauncher(i,r,t)}),{initialState:r,createSelectable:!0,logArea:i})}))}function ir(n,t,i,r){var u,f="Unable to replace part '"+(n&&n.toString())+"', ";return n&&t?n.isDisposed()?u=f+"it has already been disposed.":n.getPartsContainer()?n.widget&&n.parent&&n.parent.widget||(u=
f+"the part or its parent have not been composed."):u=f+"it is not a child of a PartsContainerComposition.":u="Replace part requires a part and a new locator.",u&&r&&r(u),!!u==!1}var fi;u.defineProperty(t,"__esModule",{value:!0});var bi=c.Locator,ct=c.LocatorType,lt=r.Extension,ei=i.Base,wt=ei.Constants.ExtensionNames.Hubs,oi=ei.Diagnostics,st=oi.Telemetry,ki=i.Parts,si=p.CompositionType,et=nt.DesktopManagerEvents,ot=i.Helpers.Deferred,hi=i.deepEquals,ci=i.getUniqueId,ht=i.tryImmediateResolve,bt="AssetBladeLauncher",kt="BladeLauncher",li=window,at=i.require,ut=oi.createLog(n),vt=y.Source.Desktop,yt=y.Action,pt=l.Desktop,ft={noActiveJourney:"Desktop has no active journey.",noBladeInJourney:"Blade '{0}' does not exist in the current journey.",noTileInDesktop:"Tile with id '{0}' was not found on the desktop."},dt=a.desktopSettingsKey,gt=8,ni=4,ti=i.startsWith,ai=bi.forExtension,vi=et.journeyCreated,yi="./Compositions/UI.Composition.Blade";t.organizeModeModules={dragDrop:"MsPortalImpl/UI/UI.DragDropCompositionManager"};
t.createDesktopManager=di;t.resolveInitialDashboard=pi;fi=(function(){function a(n,t){this._previousActiveJourney="";this._startboardPartsLoadedDeferred=Q.defer();this._loadedStartBoardPartIds={};this._mode=f.observable(0);this._lifetime=new r.TriggerableLifetimeManager;this._hubsCloudName=lt.getHubsCloudName();this._dashboardMgrDeferred=Q.defer();this.activeJourney=f.observable(null);this.commandsEnabled=f.observable(!0);this._loadingJourneyGuid=null;this._view=n;this._services=t;this._initDeferred=ot();this._sharedSettings=t.settings;this._portalServices=t;tr(this._services.assetTypeService)}return a.prototype.startBoardPartsLoaded=function(){return Q.isFulfilled(this.getStartboardPartsLoadedPromise())},a.prototype.getStartboardPartsLoadedPromise=function(){return this._startboardPartsLoadedDeferred.promise},u.defineProperty(a.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),u.defineProperty(a.prototype,"isJourneyLoading",{get:function(){return this.
_loadingJourneyGuid!==null},enumerable:!0,configurable:!0}),a.prototype.initialize=function(n,i,r){var u=this;this._setupOrganizeModeComponents(t.organizeModeModules);this._extensionsMetadata=n;this._services.assetManager.onAssetDeleted((function(n,t,i,r){ri().then((function(f){return f.handleAssetDeleted(u,n,t,i,r)}))}));var o=g.startTrace("DashboardRevealed"),e=s.getDashboardIdFromUri(),f=this._dashboardMgr=g.create({services:this._services,lifetime:this._lifetime});return i.then((function(n){r.startboardSettingsLoaded=li.fx.getTimestamp();var t,i=n&&n[ni]||{},s=nr(i);return(r.dayZero=!i[dt])?(u._startBoard=k.create(u._createCompositionServices()),u._view.composeStartBoard(u._startBoard),u._populateStartBoardFromManifests().then((function(){u._startboardPartsLoadedDeferred.resolve()})),u._initDeferred.resolve()):(t=pi(s,e),u.load(n&&n[gt]||{},i,t&&t.id)),f.initDashboardIdFromStore=s?s.id:"",f.initialize(u._startBoard,t,e,o,r).finally((function(){r.dashboardManagerInitialized=li.fx.getTimestamp(
);u._dashboardMgrDeferred.resolve(f);u._initDeferred.resolve()}))})),Q(this._initDeferred.promise())},a.prototype.resetStartBoard=function(n){var t=this,i;return i=n?Q(6):this._services.getService("DialogManager").then((function(n){return n.showModalDialog({title:l.Startboard.resetConfirmationTitle,description:l.Startboard.resetConfirmationText,buttons:4})})),i.then((function(n){var r,i;if(n===6){for(r=t.startBoard.children,i=r.length-1;i>=0;i--)t.removeTile(r[i].id,{force:!0});return t._populateStartBoardFromManifests()}}))},a.prototype._populateStartBoardFromManifests=function(){var n=this;return this._dashboardMgr.resetLayout(this._startBoard).then((function(){n.save();var t=n._services.extensionManager.getExtensions().map((function(t){var r=n._extensionsMetadata.first((function(n){return lt.isEqualDescriptor(n,t)})),i=r.startBoardParts;if(r.isTestExtension||i&&i.length)return t.getManifestAsync().then((function(t){n._addStartBoardPartsFromManifest(t,i);n.save()}))})).filter((function(n){return!!n})
);return Q.allSettled(t)}))},a.prototype._getExtensionEmailAddress=function(n){var t=this._extensionsMetadata.first((function(t){return t.name===n}));return t&&t.feedbackEmail},a.prototype.getCurrentBladeInfo=function(){var n=this._getBreadCrumb(),i=this._getExtensionEmailAddress(wt),r=n[n.length-1],t=r&&r.extensionName||"",u=t?this._getExtensionEmailAddress(t):i;return{extensionName:t,feedbackTo:u,feedbackCC:i,breadcrumb:n.map((function(n){return n.title})).join(" > ")}},a.prototype._getBreadCrumb=function(){var t=this.getActiveJourney(),n;return t?(n=t.children,!n||!n.length)?[]:n.map((function(n){return{title:n.isDefaultTitle()?n.id:n.title(),extensionName:n.locator.getExtensionLocator().name,id:n.id}})):[]},a.prototype.createJourney=function(t,i,r){var u=this,s=this._startBoard.children.first((function(n){return n.id===t})),o;return s?(o=ot(),r||(r=ci(),this._loadingJourneyGuid=r,this._createNewJourneyPromise=o.promise()),o.promise().finally((function(){u._loadingJourneyGuid===r&&(u._loadingJourneyGuid=
null,u._createNewJourneyPromise=null)})),ht(Q(s.awaitComposed()),(function(){if(u.tryDeactivateJourney(r)){e(u).trigger(et.journeyCreating,i);var t=u._createCompositionServices(),f=ii(vt,yt.JourneyOpened,wi(s));ht(at("./Compositions/UI.Composition.Journey",n),(function(r){return u.setActiveJourney(r.create(t,s)),ht(at(yi,n),(function(n){var r=n.create(t,i,u._startBoard),s=u._activeJourney;s.addChild(r);u._view.composeJourney(s);u._startBoard.detailContainers=[r];u._view.addBlade(r,{assetType:i.originAssetType,focus:!0}).catch((function(n){ut.error(n)}));u._triggerActiveJourneyChanged();u.save();o.resolve(s);e(u).trigger(vi);st.completeTrace(f);Q.nextTick((function(){u.save()}))}))})).catch((function(n){o.reject(n)}))}else o.reject("tryDeactivateJourney returned false")})),o.promise()):(ut.error(ft.noTileInDesktop.format(t)),ut.verbose(f.toJSON(this.getDiagnosticsData(),null,2)),ot().reject())},a.prototype.createJourneyForBlade=function(n,t){return this._createJourneyWithHiddenPart(wt,kt,n,t,kt,this.
_hubsCloudName,n.cloudName,n.defaultMenuItemId)},a.prototype.createJourneyForAsset=function(n,t,i){return this._createJourneyWithHiddenPart(wt,bt,{extensionName:n.extension,assetType:n.assetType,assetId:i},t,bt,this._hubsCloudName,n.cloudName,n.defaultMenuItemId,n.assetType)},a.prototype._createJourneyWithHiddenPart=function(n,t,r,u,f,o,s,h,c){var l=this,v,y,a,p;return this._loadingJourneyGuid!==u?Q():(v=ii(vt,yt.JourneyOpened,f,c),lt.CloudName.addToModel(s,r),y=ai(n,o).withPartType(t),a=this.addPartToStartBoard({originPartLocator:y,model:r,defaultMenuItemId:h,reuseExistingPart:!1,dontSetupWidget:!0}),p=a.isComposed&&a.isSelected()&&this._activeJourney&&this._activeJourney.originTile===a?Q():a.selectOnReady((function(){return l._loadingJourneyGuid!==u?!1:!a.isSelected()&&l.tryDeactivateJourney(u)}),{timeoutInMilliseconds:9e4}).then((function(n){n&&(l.save(),e(l).trigger(vi),st.completeTrace(v))})),i.tryImmediateFinally(p,(function(){l._loadingJourneyGuid===u&&(l._loadingJourneyGuid=null)})))}
,a.prototype.openSingleBlade=function(n,t){return this._openBlade(n,t,(function(n,i){return i===0&&n.locator.equals(t.locator)}))},a.prototype.openMultipleBlades=function(n,t){var u=this,i=ot(),r;return t&&t.length!==0?(r=t.map((function(t){return u._openBlade(n,t,(function(n){return n.locator.equals(t.locator)&&t.model&&n.getViewModel()&&p.deepSubset(n.getViewModel(),t.model)}))})),e.when.apply(e,r).done((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i.resolve(t)})).fail((function(){i.reject()}))):i.resolve([]),i.promise()},a.prototype.confirmBladesCanClose=function(n){var t=this,f=(n||[]).first((function(n){return!t.canCloseBlade(n)})),r,u;return f?(r=[],n.forEach((function(n){r.push(t._findFirstItem(t.activeJourney().children,n,ft.noBladeInJourney.format(n)))})),u=[],i.pushUnique(u,i.mapMany(r,(function(n){return t._getAlertMessageRecursive(n)}))),this._view.showConfirmDialog(u.join("\n")||pt.confirmEditScopeDiscard)):!0},a.prototype.forceCloseBlade=function(n,t,i){var u,r,f,
e;if(!this._activeJourney)throw new Error(ft.noActiveJourney);u=this._findFirstItemIndex(this._activeJourney.children,n,ft.noBladeInJourney.format(n));r=this._activeJourney.children[u];this._startBoard.detailContainers.length===1&&this._startBoard.detailContainers[0].id===r.id?this.forceDiscardJourney(this._activeJourney.id,t):(r.masterContainer&&(f=r.masterContainer.detailContainers,e=f.indexOf(r),e>=0&&(f.splice(e,1),i&&i.openBlade||r.masterContainer.onDetailContainersChanged())),this._closeBladeRecursive(r,u,t));this._triggerActiveJourneyChanged();this.save()},a.prototype.tryCloseBlade=function(n,t){var i=this.confirmBladesCanClose([n]);return i&&this.forceCloseBlade(n,t),i},a.prototype.closeChildBlades=function(n){var i=this.discardEditsOfBlade(n,{includeSelf:!1,includeDescendants:!0}),t;if(i.successful)for(t=n.detailContainers.length-1;t>=0;t--)this.forceCloseBlade(n.detailContainers[t].id,1);return i},a.prototype.discardEditsOfPart=function(n,t){var r=n.getPartsContainer();return this.
_discardEditsOfContainer(r,t.force,(function(u){var s=u.path,e=r.journeyPath,h=hi(s,n.journeyPath),c=!1,f,o;if(!h&&s.length>e.length){f=void 0;try{f=i.parseSortedString(u.path[e.length])}catch(l){ut.error("Failed to parse journey path segment for blade '{0)'. Path: '{1}'. Error: '{2}'.".format(r.toString(),JSON.stringify(e),l.message))}c=f&&f.master&&f.master.part===n.id}return o=u.value,o&&o.editScope&&(t.includeSelf&&h||t.includeDescendants&&c)}))},a.prototype.discardEditsOfBlade=function(n,t){return this._discardEditsOfContainer(n,t.force,(function(i){var r=i.value,u=i.path,f=n.journeyPath,e=hi(u,f),o=!e&&(r.type===ct.Blade||u.length>=f.length+2);return r&&r.editScope&&(t.includeSelf&&e||t.includeDescendants&&o)}))},a.prototype._discardEditsOfContainer=function(n,t,i){var o=this,u=[],r={confirmationRequired:!1,successful:!1},e=this._activeJourney,f;if(!e)throw new Error(ft.noActiveJourney);return f=e.ambientSettings,(n instanceof k.Instance||n.isInitialized)&&(u=f.getItemsInPath(n.journeyPath).
filter(i)),r.confirmationRequired=!t&&u.filter((function(n){var t=n.value.editScope;return t.dirty&&!t.saving})).length>0,(!r.confirmationRequired||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(r.successful=!0,u.forEach((function(n){f.removeItem(n.path);o._services.editScopeManager.onEditScopeDisposed(n.value.editScope.editScopeId)}))),r},a.prototype.canCloseBlade=function(n){var t=this._activeJourney,r,i;return t?(r=this._findFirstItem(t.children,n,ft.noBladeInJourney.format(n)),i=function(n){if(n.shouldAlertOnClose()||n.isInitialized&&!n.children.some((function(n){return n.children.some((function(n){return n.suppressAlert()}))}))&&t.ambientSettings.getItemsInPath(n.journeyPath).some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving})))return!0;var r=n.detailContainers;return!r||r.length===0?!1:(r||[]).some((function(n){return i(n)}))},!i(r)):!0},a.prototype.addPartToStartBoard=function(n){var i,t,r,u,f;if(!n){ut.error("options should be specified for adding a part to the startboard.");
return}if(!n.originPartLocator){ut.error("options.originPartLocator should be specified for adding a part to the startboard.");return}return i=this._createCompositionServices(),r=n.model,n.reuseExistingPart!==!1&&(t=this._startBoard.children.first((function(t){return t.matchesLocatorAndModel(i.finder,n.originPartLocator,r,n.defaultMenuItemId)}))),t||(t=d.create(i,n.originPartLocator,r,{modelContainsSensitiveData:n.modelContainsSensitiveData}),t.dontSetupWidget=!!n.dontSetupWidget,u=n.defaultMenuItemId,u&&(t.defaultMenuItemId=u),ki.InternalPartSize[n.initialSize]&&(t.initialSize=n.initialSize,n.initialSize===99&&(t.initialHeight=n.initialHeight,t.initialWidth=n.initialWidth)),f=t.id,this._isStartBoardPartLoaded(f)||(this._isStartBoardPartLoaded(f,!0),this._startBoard.addChild(t,undefined,!t.dontSetupWidget),this._view.addPartToStartBoard(t),t.save(),this.save())),t},a.prototype.pinMultipleParts=function(n,t,i,r){var u=this,f=this._createCompositionServices();return ri().then((function(e){return e.
pinMultipleParts(u,f.finder,n,t,i,r)}))},a.prototype.removeTile=function(n,t){var e=this._startBoard,i=e.children.first((function(t){return t.id===n})),r,u;if(i){r=void 0;u=this._activeJourney;u&&u.originTile===i&&(r=u.id);var f=i.editScopeId()&&this._services.editScopeManager.getStateObservable(i.editScopeId()),s=!f||f()===v.EditScopeState.NotDirty||f()===v.EditScopeState.DirtyAndSaving,h=!r||this._canDiscardJourney(r),o=t&&t.force||s&&h;(o||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(r&&this.forceDiscardJourney(r),i.clearIdentitySettings(),ui(e,i,t&&t.skipSave),o||i.dontSetupWidget||ut.warning("Part '{0}' is removed from the start board.".format(i)),this.save())}},a.prototype.replacePart=function(n,t,i){var o=this,f=n&&n.id,r,s=this._createCompositionServices(),u=ot(),h=!0,c,l,e;return i=i||{},ir(n,t,i.newPartContainerModel,(function(n){l=n}))?(n instanceof d.Instance?(r=d.create(s,t,i.newPartContainerModel,{id:f,doNotSaveSettings:i.doNotSaveSettings,overridesModel:i.newPartOverridesModel}),
e=n,r.dontSetupWidget=e.dontSetupWidget,h=!e.dontSetupWidget):r=b.create(s,t,f,i.newPartContainerModel,i.newPartOverridesModel),r.previousLocator=n.previousLocator||n.locator,r.flags|=4,c=n.getPartsContainer(),n.dispose(!0),n.parent.replaceChild(n,r),r instanceof d.Instance&&this._activeJourney&&this._activeJourney.originTile===n?this.tryDiscardJourney(this._activeJourney.id):c.getPartsContainer().detailContainers.slice(0).reverse().forEach((function(n){n.masterPartId===f&&o.tryCloseBlade(n.id,1)})),r.widgetState(n.widgetState()),r.save(),h?(r.widget=n.widget,r.recompose(n.parent.widget)):r.compose(n.parent.widget),r.widget.element.trigger(p.fxreplacedpartcomposing,{part:r}),r.awaitComposed().then((function(){!i.preventNewPartActivation&&r.partDefinition.details&&r.partDefinition.details.length>0?r.selectOnReady((function(){return!o._activeJourney}),{timeoutInMilliseconds:15e3}).then((function(){u.resolve(r)})).catch((function(n){u.reject(n&&n.message||"part.selectOnReady failed")})):u.resolve(
r)}),(function(){return u.reject("Unable to compose the mutated part.")}))):u.reject(l),u.promise()},u.defineProperty(a.prototype,"portalWidget",{get:function(){return this._view.portalWidget},enumerable:!0,configurable:!0}),a.prototype.getDashboardManager=function(){return this._dashboardMgrDeferred.promise},a.prototype.getSettingCollections=function(){var i={},r={},n=this._activeJourney,t=[];return i[dt]=JSON.parse(JSON.stringify(this)),t.push({store:ni,settings:i}),n&&n.children&&(r[n.id]=JSON.parse(JSON.stringify(n)),t.push({store:gt,settings:r})),t},a.prototype.dispose=function(){this._lifetime&&(this._lifetime.dispose(),this._lifetime=null)},a.prototype.save=function(){var n=this;this._initDeferred.promise().finally((function(){n.getSettingCollections().forEach((function(t){n._services.settings.setSettings(t)}))}))},a.prototype.load=function(n,t,i){var r=this,o=this._createCompositionServices(),u=t[dt],f=!1,s,h;u&&u.startBoardId&&t[u.startBoardId]?(s=t[u.startBoardId],f=!!i,f&&(t=gi(t,this.
_sharedSettings)),this._startBoard=k.Instance.fromJSON(o,t,s)):(ut.error("Unable to load StartBoard state from user settings, setting does not exist. Creating a default StartBoard."),this._startBoard=k.create(o));this._removeOrphanedStartboardParts();this._view.composeStartBoard(this._startBoard);f||this._initDeferred.resolve();h=this._view.portalWidget.element;h.one(rt.default.fxshowstartboard,(function(){var n=r._startBoard.children.slice();n.forEach((function(n){r._displayPartOnStartBoardIfAvailable(n)}));r._startBoard.discardWidgetStateOfUnusedChildren();r._startboardPartsLoadedDeferred.resolve()}));e(this).trigger(et.settingsLoaded)},a.prototype._removeOrphanedStartboardParts=function(){var n=this.startBoard;n.children.slice(0).forEach((function(t){t.dontSetupWidget&&ui(n,t)}))},u.defineProperty(a.prototype,"startBoard",{get:function(){return this._startBoard},enumerable:!0,configurable:!0}),a.prototype.getActiveJourney=function(){return this._activeJourney},a.prototype.setActiveJourney=
function(n){this.activeJourney(n);this._activeJourney=n;this.portalWidget.hasActiveJourney=!!n;n&&o.isFullscreen()&&o.exitFullscreen()},a.prototype.generateLoadingJourneyGuid=function(){return this._loadingJourneyGuid=ci(),this._loadingJourneyGuid},a.prototype.tryDeactivateJourney=function(n){var t=this._activeJourney,r,i,u;if(t){if(!this.confirmBladesCanClose(t.children.map((function(n){return n.id}))))return!1;for(r=t.children.filter((function(n){return!n.isRestorable()})),i=r.length-1;i>=0;i--)this.forceCloseBlade(r[i].id);u=ii(vt,yt.JourneyDeactivated,wi(t.originTile));t.save();this._closeActiveJourney(!0);this.save();e(this).trigger(et.journeyDeactivated);st.completeTrace(u)}else this._startBoard&&(this._startBoard.detailContainers=[]);return this._loadingJourneyGuid=n||null,!0},a.prototype.tryDiscardJourney=function(n){var t=!1;return(this._canDiscardJourney(n)||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(this.forceDiscardJourney(n),t=!0),t},a.prototype._triggerActiveJourneyChanged=
function(){var n=this._activeJourney,t=n?JSON.stringify(n):"";this._previousActiveJourney!==t&&(e(this).trigger(et.activeJourneyChanged),this._previousActiveJourney=t)},a.prototype._canDiscardJourney=function(n){var t=this._activeJourney&&this._activeJourney.id===n&&this._activeJourney,i=t&&t.ambientSettings.getObservable().peek().some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving&&t.disposeOnJourneyDiscard}));return!t||!i},a.prototype.forceDiscardJourney=function(n,t){var i=!1;this._deleteJourneySettings(n);this._activeJourney&&this._activeJourney.id===n&&(this._closeActiveJourney(!1,t),i=!0);i&&(this._triggerActiveJourneyChanged(),this.save(),e(this).trigger(et.journeyDiscarded))},a.prototype._deleteJourneySettings=function(n){this._sharedSettings.deleteSettings({store:gt,keys:[n]})},a.prototype.toJSON=function(){return{startBoardId:this._startBoard?this._startBoard.id:null}},a.prototype._addStartBoardPartsFromManifest=function(n,t){var r=this,i=n.startBoardParts;
t||(t=i.map((function(n){return n.name})));i&&i.length&&t.forEach((function(t){var u=i.first((function(n){return n.name===t})),f;u&&(f=ai(n.name,n.cloudName).withStartboardPartInstance(u.name),r.addPartToStartBoard({originPartLocator:f,initialSize:u.initialSize}))}))},a.prototype._createCompositionServices=function(n){return n?i.extend2(this._services,{finder:n,desktop:this,sharedSettings:this._sharedSettings}):this._thisCompositionServices||(this._thisCompositionServices=i.extend2(this._services,{finder:new c.DefinitionFinderImpl(this._services.extensionManager),desktop:this,sharedSettings:this._sharedSettings}))},a.prototype._findPartContainer=function(n){var t,i=this._startBoard;if(i&&i.id===n)t=i;else if(this._activeJourney)t=this._findFirstItem(this._activeJourney.children,n,ft.noBladeInJourney.format(n));else throw new Error(ft.noActiveJourney);return t},a.prototype._openBlade=function(t,i,r){var s=this,o=this._findPartContainer(t),v=o instanceof k.Instance,h=ot(),u,c,y=this._createCompositionServices(
),l,a;return o?((o.detailContainers||[]).forEach((function(n,t){n.locator.equals(i.locator)&&n.masterPartId===i.masterPartId&&n.masterInvocationProperty===i.masterInvocationProperty&&r(n,t)&&(u=n,h.resolve(u))})),u?(a=u.containerWidget,a&&a.setFocus(),nt.isTraceEnabled&&ut.verbose("[DesktopManager] Found a previously opened detail blade."+"\n  Existing blade: {0}. Model: {1}.".format(u.toString(),f.toJSON(u.getInputsOnlyViewModel()))+"\n  Requested Descriptor: {0}.".format(f.toJSON(i)))):(e(this).trigger(et.bladeOpening,{masterContainerId:t,bladeDescriptor:i}),l=function(){v&&o.detailContainers.length===0?s.createJourney(i.masterPartId,i).finally((function(n){n&&n.children&&n.children.length>0?h.resolve(n.children[0]):h.reject()})):ht(at(yi,n),(function(n){return ht(Q(),(function(){u=n.create(y,i,o);o.detailContainers.unshift(u);o.onDetailContainersChanged();c=v?0:1+s._findFirstItemIndex(s._activeJourney.children,o.id,ft.noBladeInJourney.format(o.id));s._activeJourney.addChild(u,c);s._view.addBlade(
u,{assetType:i.originAssetType,index:c,focus:!0}).catch((function(n){ut.error(n)}));s._triggerActiveJourneyChanged();s.save();h.resolve(u)}))})).catch((function(n){h.reject(n)}))},this._createNewJourneyPromise?this._createNewJourneyPromise.always((function(){l()})):l())):h.reject(),h.promise()},a.prototype._closeBladeRecursive=function(n,t,i,r){this._removeBladesFromUIRecursive(n);this._disposeBladesRecursive(n,t,r);r||(n.parent.save(),e(this).trigger(et.bladeClosed,{id:n.id,reason:i}))},a.prototype._getAlertMessageRecursive=function(n){var t=function(n){var t=n.detailContainers,r;return t&&t.length!==0?(r=i.mapMany(t,(function(n){return n.getAlertOnCloseMessages()})),i.union(n.getAlertOnCloseMessages(),r)):n.getAlertOnCloseMessages()};return t(n)},a.prototype._removeBladesFromUIRecursive=function(n){for(var i=n.detailContainers,t=i.length-1;t>=0;t--)this._removeBladesFromUIRecursive(i[t]);this._view.removeBlade(n)},a.prototype._disposeBladesRecursive=function(n,t,i){var u=this,r=n.parent.children.
indexOf(n,t);i?n.dispose(!0):n.parent.removeChildAt(r,undefined);n.detailContainers.forEach((function(n){u._disposeBladesRecursive(n,r,i)}))},a.prototype._closeActiveJourney=function(n,t){var u=this,i=this._activeJourney,r;this.setActiveJourney(null);this._startBoard.detailContainers=[];i&&(i.children.slice(0).forEach((function(i){i.isDisposed()||u._closeBladeRecursive(i,0,t,n)})),r=i.originTile,r&&r.dontSetupWidget&&!n&&this.removeTile(r.id),i.dispose(n));this._view.removeAllBlades((function(n){ut.error("DesktopManager: Found un-tracked blade '{0}' in view after closing active journey. It will be forcefully removed.".format(n))}))},a.prototype._findFirstItem=function(n,t,i){var r=this._findFirstItemIndex(n,t,i);return n[r]},a.prototype._findFirstItemIndex=function(n,t,i){var r=n.firstIndex((function(n){return n.id===t}));if(r===-1){ut.verbose(f.toJSON(this.getDiagnosticsData(),null,2));throw new Error(i);}return r},a.prototype.pinPartComposition=function(n){this._startBoard.addChild(n);this._view.
addPartToStartBoard(n);st.trace({source:vt,action:yt.DashboardPinPart,data:"Part pinned to dashboard: "+(n.extension&&n.extension.name)+"_"+n.id});n.save();this.save()},a.prototype._isStartBoardPartLoaded=function(n,t){return typeof t=="boolean"?this._loadedStartBoardPartIds[n]=t:!!this._loadedStartBoardPartIds[n]},a.prototype._displayPartOnStartBoardIfAvailable=function(n){var r=this;if(!this._isStartBoardPartLoaded(n.id)){this._isStartBoardPartLoaded(n.id,!0);var t=n.locator,i=t.getExtensionLocator(),u=function(t,i){if(ut.warning(t.format(n)),i){var u=r._startBoard;ui(u,n);u.removeChildWidget(n.id)}},f=function(t,i){var f=!1;return t===0?(i||r._view.addPartToStartBoard(n),f=!0):t===1&&(u("[Definition Change] Part '{0}' is not working because it no longer exists in pre-loaded extension definition"),f=!0),f},e=function(i,f){(i.startBoardParts||[]).some((function(n){return n.name===t.name}))?f||r._view.addPartToStartBoard(n):u("[Definition Change] Part '{0}' is not working because it no longer exists in force-loaded extension definition.")}
;this._extensionsMetadata.some((function(n){return lt.isEqualDescriptor(n,i)}))?f(n.definitionExists(),n.isComposed||n.dontSetupWidget)||(this._view.addPartToStartBoard(n),t.type===ct.StartboardPartInstance?this._services.extensionManager.getManifestByName(i.name,i.cloudName).then((function(n){e(n,!0)})):this._services.extensionManager.getExtensionByName(i.name,i.cloudName).then((function(n){var r=h.PinPrefix,u=t.name,f,i;if(ti(u,r))return f=u.substr(r.length),n.getBladeDefinition(f);for(i=t;i;i=i.parent)if(i.type===ct.Blade)return n.getBladeDefinition(i.name);if(t.type===ct.PartType)return n.getPartDefinition(t.name)})).then((function(){f(n.definitionExists(!0),!0)}))):u("[Definition Change] Part '{0}' will be removed because the extension it belongs to is no longer known by the portal.",!0)}},a.prototype.getDiagnosticsData=function(){var n=this._startBoard,t=this._activeJourney;return{startboard:n&&n.getDiagnosticsData(),activeJourney:t&&t.getDiagnosticsData()}},a.prototype.getAssetDiagnosticsData=
function(){var n=this._activeJourney;return n?ri().then((function(t){return t.dumpCompositionAssets(n)})):Q.resolve("No journey")},a.prototype._setupOrganizeModeComponents=function(n){var t=this,r=this._lifetime,u=r.createChildLifetime();this.mode.subscribe(u,(function(f){f===1&&i.require(n.dragDrop).then((function(n){n.create(r,t,t.portalWidget.element);u.dispose()}))}))},a})();t.DesktopManagerImpl=fi}));define("MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop",["require","exports","f","o","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function ti(n){var i=n.target,t=$(i);l&&l.htmlTarget!==i||(l={htmlTarget:i,elementObject:t,width:t.outerWidth(!1),height:t.outerHeight(!1)},y=b=c=ft(t.closest(v),o.Widget),k=t.clone(),k.find("iframe").remove(
),k.css({position:"fixed",pointerEvents:"none",top:n.pageY,left:n.pageX,marginTop:rt.top=-n.offsetY,marginLeft:rt.left=-n.offsetX}),t.parent().append($("<div/>").append(k)),t.css("opacity",0),tt=a=ut({left:n.pageX,top:n.pageY}),f.register(lt,!0))}function at(n){var u;if(l){d.off(h.default.dragover+v+" "+h.default.drop+v+" "+h.default.dragleave+v);var t=l.elementObject,r=t.attr("dragdrop.revert")==="true",i={left:n.pageX,top:n.pageY};f.unregister(lt);r&&t.attr("dragdrop.revert","false");ot();r?pt():yt(n.target,i);k.parent().remove();u=t.css("opacity",1).closest(".fxs-tile").css("transition","none");w.setTimeout((function(){return u.css("transition","")}),0);c?c===b?fi($(n.target),i):ei($(n.target),i):ui();bt()}}function vt(){l.elementObject.attr("dragdrop.revert","true").trigger(h.default.mouseup)}function ii(n,t){var i;(yt(n.target,t),c)&&(i=ut(t),i.col!==a.col||i.row!==a.row)&&(ot(),a=i,(y!==c||c.dropPlaceholder===null)&&(y&&y.disposeDropPlaceholder(),c.createDropPlaceholder(l.width,l.height),
y=c),c.moveDropPlaceholder(i),g=w.setTimeout((function(){g=null;c.moveChild(l.elementObject,a.col,a.row,!1)}),ni))}function ot(){g&&(w.clearTimeout(g),g=null)}function yt(n,t){var i=ri(n,t);c&&c!==i&&pt();c=i}function pt(){c&&(ot(),c.refreshLayout())}function wt(n){return{left:n.left+rt.left,top:n.top+rt.top}}function ri(n,t){var i=wt(t),r=n.parentElement||d.context,u=i.left-r.scrollLeft+Math.floor(it*p.GridSpacingWidth),f=i.top-r.scrollTop+Math.floor(it*p.GridSpacingHeight);return ft($(document.elementFromPoint(u,f)).closest(v),o.Widget)}function ut(n){var t=c.element,i=t.offset(),r=wt(n),u=r.left-i.left+t.scrollLeft(),f=r.top-i.top+t.scrollTop(),e=Math.floor((u+it*p.GridSpacingWidth)/p.GridSpacingWidth),o=Math.floor((f+it*p.GridSpacingHeight)/p.GridSpacingHeight);return{col:e,row:o}}function ui(){b.moveChild(l.elementObject,tt.col,tt.row,!0)}function fi(n,t){a=ut(t);b.moveChild(l.elementObject,a.col,a.row,!0)}function ei(n,t){c.refreshLayout();a=ut(t);var i=s.Widget.getId;c.element.trigger(
h.default.fxrearrange,{partId:i(l.elementObject),sourceId:i(b.element.closest(ct)),targetId:i(c.element.closest(ct)),col:a.col,row:a.row})}function bt(){y&&y.disposeDropPlaceholder();b=null;c=null;tt=null;a=null;y=null;l=null}function kt(){var t=$(v),n=[];return t.each((function(t,i){var r=ft($(i),o.Widget),u=r.options;u.allowReorder&&!u.locked()&&n.push(r.element.findByClassName("fxs-flowlayout-childcontainer"))})),n}function dt(n){vt();c=null;at(n)}var gt;r.defineProperty(t,"__esModule",{value:!0});var p=i.Widgets.AzureGrid,w=window,d=$(w.document.body),ft=e.Widget.getWidget,st="ui-draggable",nt="draggable",ht=st+" fxs-drag-disableTouchAction",et=".fxs-tile:not(.fxs-tilesize-herowidefitheight):not(.fxs-tilesize-fullwidthfitheight):not(.fxs-tilesize-fittocontainer)",v=".fxs-flowlayout",ct=".fxs-lens",lt={dismissFn:vt,logName:"flowlayoutdragdrop"},l,b,c,y,tt,a,g,ni=250,it=.33,k=null,rt={left:0,top:0};gt=(function(){function n(){if(n._singleton)throw new Error("FlowLayoutDragDrop operates as a singleton.");
n._singleton=this}return n.prototype.dispose=function(){this.disableDragDropTargets();bt();n._singleton=null},r.defineProperty(n,"Instance",{get:function(){return n._singleton||(n._singleton=new n),n._singleton},enumerable:!0,configurable:!0}),n.prototype.enableDragDropOnSingleTarget=function(n){if(n.attr(nt)!=="true"){n.attr(nt,"true");var t=n.filter(et).addClass(ht);t.on(h.default.dragstart,(function(n){if(l&&dt(n),u.isFullscreen()||n.target!==n.currentTarget){n.preventDefault();return}d.on(h.default.dragover+v,(function(n){n.preventDefault();var t={left:n.pageX,top:n.pageY};ii(n,t);k.css(t)}));d.on(h.default.drop+v,(function(n){n.preventDefault();at(n)}));d.on(h.default.dragleave+v,(function(n){0<n.clientX&&n.clientX<w.innerWidth&&0<n.clientY&&n.clientY<w.innerHeight||dt(n)}));var t=n.originalEvent.dataTransfer;t.setData("text","fxs-draganddrop");t.effectAllowed="move";ti(n)}))}},n.prototype.enableDragDropTargets=function(){var n=this;kt().forEach((function(t){t.on(h.default.mouseenter,et,(function(
t){var i=$(t.currentTarget);i.attr(nt)!=="true"&&n.enableDragDropOnSingleTarget(i)}))}))},n.prototype.disableDragDropTargets=function(){kt().forEach((function(n){return n.off(h.default.mouseenter,et)}));$("."+st).removeClass(ht).off(h.default.dragstart).removeAttr(nt)},n})();t.FlowLayoutDragDrop=gt}));define("_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-desktop-organize .fxs-tile .fxs-tile-content{z-index:0}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay{display:block;-ms-touch-action:none;touch-action:none}.fxs-desktop-normal .fxs-hide-in-normal,.fxs-desktop-normal .fxs-portal-contextpane-left,.fxs-desktop-organize .fxs-contextpane .fxs-tile .fxs-tile-overlay,.fxs-desktop-organize .fxs-sidebar,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-actions,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-dropdown,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-migration{display:none}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay:hover{border-width:1px;border-style:solid;box-sizing:border-box}.fxs-desktop-organize .fxs-tile.fxs-tilesize-hero.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herotall.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herowide.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-large.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-mini.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-normal.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-small.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-tall.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-wide.fxs-tile-selected .fxs-tile-overlay{cursor:move}.fxs-desktop-organize .fxs-blade-locked .fxs-tile .fxs-tile-overlay:hover{border:none}.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-context .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-help .fxs-tile div.fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-hide-in-customize{visibility:hidden}.fxs-desktop-organize .fxs-startboard-layout>.fxs-flowlayout-childcontainer{min-height:2155px;min-width:3865px}.fxs-desktop-organize .fxc-hotspot-customclick{z-index:1}")})
);define("MsPortalImpl/UI/UI.DesktopModeManager",["require","exports","f","o","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){function d(n,r,e){var l=n.desktop,v=new t(l,r,n,e),b=function(n){var t=u(n.target).closest(w);return s.Widget.getWidget(t,h.Widget)},d=r.element,y=r.getPanorama().getStartBoardArea();d.on(c.default.fxexitorganizemode,(function(){l.mode(0);var n=l.startBoard.widget.element.findByClassName("fxs-startboard-button-edit");n.length&&n.focus()}));y.on(c.default.fxenterorganizemode,(function(n,t){n.stopPropagation();var r=b(n);t=u.extend({},t);i.isNullOrUndefined(t.trigger)&&(t.trigger=r?0:1);v.startPartManagment(t);r&&(r.options.selected(
!0),v.updateTileSelection(r),r.showTileManagementContextMenu())}));y.on(c.default.click,p,(function(n){var i=b(n),t=i&&i.options;t&&!t.locked()&&(t.selected(!t.selected()),v.updateTileSelection(i))}));y.on(c.default.click,a,(function(n){if(l.mode()===1){var i=b(n),t=i&&i.options;!t||t.locked()||t.selected()||(t.selected(!0),v.updateTileSelection(i))}}));y.on(c.default.mouseenter,a,(function(n){var t,i,r;if(l.mode()!==1&&!f.isFullscreen()&&(t=b(n),i=t&&t.options,i&&!i.locked()&&!i.selected())){r=t.element;o.FlowLayoutDragDrop.Instance.enableDragDropOnSingleTarget(r);r.one(c.default.mouseleave,(function(){l.mode()!==1&&o.FlowLayoutDragDrop.Instance.disableDragDropTargets()}))}}));y.on(c.default.dragstart,k,(function(n){if(f.isFullscreen()){n.preventDefault();return}l.mode()!==1&&l.mode(1);var t=b(n),i=t&&t.options;i&&!i.selected()&&(i.selected(!0),v.updateTileSelection(t))}));y.on(c.default.fxpartcreated,(function(n,t){n.stopPropagation();var i=t.widget;i.options.selected(!0);v.updateTileSelection(i)})
);return v}var y=MsPortalImpl.Resources.Images,l=s.Widget.widgetRemoveEvent,p="."+h.overlayClassName,w="."+h.widgetClassName,a="."+h.actionBarContainerClassName,v="fxs-desktop-normal",b="fxs-partgallery-container",k=".ui-draggable",t;(function(){var t=y.getFlowLayout().gridShadow,i=".fxs-desktop-organize .fxs-flowlayout-childcontainer {"+("background: url("+t+");")+"}",n=document.createElement("style");n.setAttribute("type","text/css");n.appendChild(document.createTextNode(i));document.head.appendChild(n)})();n.organizeModeClassName="fxs-desktop-organize";n.createDesktopModeManager=d;t=(function(){function t(n,t,i,r){var u=this;this._wasContextPaneCollapsed=!1;this._dismissHandle={dismissFn:function(){u._desktop.mode(0)},logName:"desktopmodemanager"};this._desktop=n;this._portalWidget=t;this._services=i;this._lifetime=r;this._userSettingsManager=i.settings;this._contextPane=i.leftContextPane;this._partMgmtStarted=!1;this._selectedTile=null;this._handleModeChange(n,r)}return r.defineProperty(
t.prototype,"selectedTile",{get:function(){return this._selectedTile},enumerable:!0,configurable:!0}),t.prototype.updateTileSelection=function(n){var t=this;if(this._deselectCurrentTile(),n.options.selected()&&(this._selectedTile=n),this._selectedTile)this._selectedTile.element.on(l,this._tileRemoveHandler=function(n){n.target===t._selectedTile.element[0]&&t._deselectCurrentTile()})},t.prototype.startPartManagment=function(n){var t=this,r;return this._partMgmtStarted?Q():(this._partMgmtStarted=!0,this._desktop.mode(1),r=this._contextPane,Q.all([i.require("MsPortalImpl/UI/UI.PartGalleryManager"),r.tryOpen(this)]).spread((function(i){var u=t._partGalleryManager,f=t._partGallery;u||(u=t._partGalleryManager=i.createPartGalleryManager(t._lifetime.createChildLifetime(),t._services,f),u.load(5,n));f.setFocus();n.expandTileGallery&&r.collapsed(!1)})))},t.prototype.onAddingContent=function(n){var t=this;return i.require("MsPortalImpl/Widgets/Widgets.PartGallery").then((function(i){t._partGallery||
(t._partGallery=i.create(u("<div class='"+b+"'><\/div>")),n.addChild(t._partGallery.element))}))},t.prototype.onRemovingContent=function(){this._partMgmtStarted=!1},t.prototype._enterOrganizeMode=function(){var i=this._portalWidget,r=i.element,t;return(r.addClass(n.organizeModeClassName),r.removeClass(v),t=i.getTopBarWidget(),t&&t.options.isInOrganizeMode(!0),e.register(this._dismissHandle),o.FlowLayoutDragDrop.Instance.enableDragDropTargets(),this._wasContextPaneCollapsed=this._contextPane.collapsed(),!this._partMgmtStarted)?this.startPartManagment({}):Q()},t.prototype._exitOrganizeMode=function(){var r=this._portalWidget,u=r.element,t,i;o.FlowLayoutDragDrop.Instance.disableDragDropTargets();u.removeClass(n.organizeModeClassName);u.addClass(v);t=r.getTopBarWidget();t&&t.options.isInOrganizeMode(!1);i=this._contextPane;i.close(!0);i.collapsed(this._wasContextPaneCollapsed);this._deselectCurrentTile();this._userSettingsManager.flushSettings();e.unregister(this._dismissHandle)},t.prototype.
_handleModeChange=function(n,t){var i=this;n.mode.subscribe(t,(function(n){switch(n){case 1:i._services.getService("DialogManager").then((function(n){n.dismissOpenDialog()}));i._enterOrganizeMode();f.isFullscreen()&&f.exitFullscreen();break;case 0:default:i._exitOrganizeMode()}}))},t.prototype._deselectCurrentTile=function(){this._selectedTile&&(this._selectedTile.element.off(l,this._tileRemoveHandler),this._tileRemoveHandler=null,this._selectedTile.options.selected(!1),this._selectedTile=null)},t})();n.DesktopModeManagerImpl=t})(l||(l={})),l}));define("MsPortalImpl/UI/Compositions/UI.Composition.Services",["require","exports","f","i","MsPortalImpl/Base/Base.Router","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Permissions","MsPortalImpl/Base/Themes","MsPortalImpl/UI/Hubs/UI.BrowseManager","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.DesktopModeManager",
"MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Widgets/Widgets.WidgetBase","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";var b;return (function(t){function g(t,g,nt,tt,it,rt,ut){var st=r.Rpc.client,et=g.extensionManager,ot=e.createAssetTypeService(et),yt=f.createAssetManager(ot),ht=o.createPermissionsManager(et,ot);i.isFeatureEnabled("whatsnew")&&nt.whatsNewEnabledKey()&&w.WhatsNew.showWhatsNewModal.register(st,[k],(function(n){i.require("MsPortalImpl/Widgets/Widgets.WhatsNew").then((function(t){var i=n.items.map((function(n){var t=!n.published?"":new Date(n.published).toLocaleString();return n.description+="\r\n"+t,n}));new t.Widget($("<div />"),new p.ViewModel,i,it.element)}))}));var pt=h.createBrowseManager(et,ot,ht,tt),ct=s.createManager(t,d,nt["fxs-theme"],nt.highContrastKey),lt=l.create(it.getRightContextPane()),wt=l.create(it.getLeftContextPane()),bt=it.getToastVM(),ft={rpcClient:st,storageService:g.storageService,themeManager:ct,redirect:
rt,settings:g.settings,editScopeManager:g.editScopeManager,extensionManager:et,hubsMetadata:g.hubsMetadata,openWindow:g.openWindow,assetManager:yt,permissionsManager:ht,assetTypeService:ot,browseManager:pt,desktop:null,modeManager:null,contextPane:lt,leftContextPane:wt,getService:null,router:null,notificationManager:null},at=ft.desktop=a.createDesktopManager(it,ft),vt=c.createCommandManager(ft.desktop).startListeningForEvents(),kt=ft.getService=i.memoizeQ((function(t){switch(t){case"DialogManager":return ut();case"ResourceMapManager":return b("../Hubs/UI.ResourceMapManager",n).then((function(n){return n.createResourceMapManager(et,ot)}));case"FeedbackPane":return b("../../Widgets/Widgets.FeedbackPane",n).then((function(n){return{amdModule:n,widget:new n.FeedbackPane(lt,bt,function(){return at.getCurrentBladeInfo()})}}));case"ThemeManager":return Q(ct);case"PortalFormTarget":return vt.getFormTarget()}throw new Error("Invalid service type '{0}' specified.".format(t));}));return ft.notificationManager=
y.createNotificationManager(ft),ft.router=u.createRouter(ft),ft.modeManager=v.createDesktopModeManager(ft,it,t),t.registerForDispose([at,vt,ft.router,kt,]),ft}function nt(){return b("MsPortalImpl/UI/UI.DialogManager")}var k=r.Extension.getHubsWindowId(),b=i.require,d=$("body,head");t.initialize=g;t.getDialogManagerModule=nt})(b||(b={})),b}));define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager",["require","exports","f","o","a","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Storage","MsPortalImpl/UI/Compositions/UI.Composition.Services"],(function(n,t,i,r,u,f,e,o,s){"use strict";r.defineProperty(t,"__esModule",{value:!0});var p=i.Base,c=p.Diagnostics.createLog(n),h=f.Shell.Dialogs,l=0,v=1,y=0,a=h.loadOnlySafeExtensionsButtonText,w=(function(){function n(n,t,i,r,u,f,e,o,s,h,c,l){this._temporaryTestCodeComponents=[];this._trustedCodeComponents=n;this._settingsManager=t;this._storageService=i;this._getDialogManager=
r;this._dialogContainer=u;this._canModifyCodeComponents=f;this._acceptWithoutPrompt=e;this._storageServiceKey=o;this._hashQueryStringKey=s;this._createFunction=h;this._componentType=c;this._settingsKey=l}return n.prototype.getCodeComponentsMetadata=function(){var n=this,t;return Q().then((function(){var i=JSON.parse(JSON.stringify(n._trustedCodeComponents));return t=i.map((function(t){return n._createFunction(t)})),n.loadFromServer(t)})).then((function(i){return typeof i=="string"?i:(i.length>0&&n._merge(t,i),n._loadUntrustedCodeComponentsIfAllowed().then((function(i){if(i.length>0){var r=function(n){return n.logUsageWarning()};n._merge(t,i,r)}return t.filter((function(n){return n.isValid()}))})))}))},n.prototype.loadFromServer=function(){},n.prototype.listTestCodeComponents=function(){var t=this,n=this._temporaryTestCodeComponents.slice(0);return this._settingsManager.querySetting(l,this._settingsKey).then((function(i){return i=i&&i.map((function(n){return t._createFunction(n)})),u.isArray(i)&&(n=
n.concatUnique(i,(function(n,t){return n.isEqual(t)}))),n.filter((function(n){return n.isValid()}))})).then(null,(function(n){return c.error("Error listing code components",2,n),[]}))},n.prototype.registerTestCodeComponent=function(n,t){var r=this,u;return n.isValid()?t?(this._addOrUpdateCodeComponent(this._temporaryTestCodeComponents,n),Q.resolve(null)):this.listTestCodeComponents().then((function(t){return r._addOrUpdateCodeComponent(t,n),r._settingsManager.setSetting(l,r._settingsKey,t),r._settingsManager.flushSettings()})).catch((function(t){c.error("Error registering code component",4,{codeComponent:n,error:t})})):(u=new i.Errors.Error("Invalid codeComponent"),u.data=n,Q.reject(u))},n.prototype.unregisterTestCodeComponent=function(n){var t=this;return this._removeCodeComponent(this._temporaryTestCodeComponents,n),this.listTestCodeComponents().then((function(i){if(t._removeCodeComponent(i,n))return t._settingsManager.setSetting(l,t._settingsKey,i),t._settingsManager.flushSettings()})).catch((function(
n){c.error("Error unregistering code component.",6,{name:name,error:n})}))},n.prototype.unregisterAll=function(){this.clearTemporaryTestCodeComponents();var n=this._settingsManager;return n.deleteSettings({store:l,keys:[this._settingsKey]}),n.flushSettings().catch((function(n){c.error("Error registering all code components",5,n)}))},n.prototype.clearTemporaryTestCodeComponents=function(){var n=this._temporaryTestCodeComponents;n.splice(0,n.length)},n.prototype._loadUntrustedCodeComponentsIfAllowed=function(){var n=this,t=this._canModifyCodeComponents;return t?this.listTestCodeComponents().then((function(i){return i.length===0?(t&&c.verbose("No untrusted code components were found. Will load the portal in normal mode.",3),[]):n.prompt().then((function(t){return t?(i.forEach((function(t){n._componentType===y&&t.markAsTestExtension()})),i):[]}))})):Q([])},n.prototype.prompt=function(){var f=this,i=o.ComponentName.ExtensionManager,r=this._storageServiceKey,u=this._storageService,n,t;if(u.getValue(i,
r,v)||this._acceptWithoutPrompt)return Q(!0);switch(this._componentType){case y:n=h.untrustedExtensionsTitle;t=h.untrustedExtensionsDescriptionFmt.format(a);break;case 1:n=h.untrustedGalleryPackageTitle;t=h.untrustedGalleryPackageDescriptionFmt.format(a);break;case 2:n=h.untrustedPatchTitle;t=h.untrustedExtensionsDescriptionFmt.format(a);break;default:throw new Error("Unsupported componentType");}return s.getDialogManagerModule().then((function(e){var o=$("<div />"),s=new e.MessageBox(n,t,2);return f._dialogContainer.prepend(o),s.defaultButtonText=a,s.cancelButtonText=h.loadUnsafeExtensionsButtonText,f._getDialogManager().then((function(n){return n.showDialog(o,s,null,"sideload").then((function(t){var f=t===1;return n.dismissOpenDialog(),o.remove(),f?u.setValue(i,r,"true",v):u.clearValue(i,r,v),f}))}))}))},n.prototype._registerTestCodeComponentFromUri=function(n){return n.isValid()?this.registerTestCodeComponent(n,!0):null},n.prototype._removeCodeComponent=function(n,t){var i=-1;return(i=n.firstIndex(
(function(n){return n.isEqual(t)})),i>=0)?(n.splice(i,1),!0):!1},n.prototype._merge=function(n,t,i){var r=this;n!==null&&t!==null&&t.forEach((function(t){i&&i(t);r._addOrUpdateCodeComponent(n,t)}))},n.prototype._addOrUpdateCodeComponent=function(n,t){var i=n.first((function(n){return n.isEqual(t)}));i?i.updateWith(t):n.push(t)},n})();t.CodeComponentSideLoadManagerImpl=w}));define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(t){function v(n){return h.test(n)}var e=i.Base,u=e.Diagnostics.createLog(n),o=/^[a-zA-Z][\w]*$/,s=i.isFeatureEnabled,h,f,c,l,a;t.canModifyExtensions=s("canmodifyextensions");h=/^(https?:)?\/\/localhost(\:\d+)?(\/|$)/;f=function(n,t){return(n&&n.toLowerCase())===(t&&t.toLowerCase())};t.isLocalhostUri=v;t.canAddGalleryPackages=s("canaddgallerypackages");c=(function(){function n(){}return n.prototype.isValid=function(){if(typeof this.name!="string")return u.error("Invalid extension name",
1,this),!1;if(typeof this.uri!="string"||!this.uri)return u.error("Invalid extension uri",1,this),!1;if(!o.test(this.name))return u.error("Invalid extension name '{0}'. Expected pattern '{1}'".format(this.name,o),8),!1;return!0},n.prototype.isEqual=function(n){var t=n;return r.Extension.isEqualDescriptor(this,t)},n.prototype.updateWith=function(n){var t=n;this.name=t.name;this.uri=t.uri;this.obsoleteBundlesBitmask=t.obsoleteBundlesBitmask;this.features=t.features;this.trustedHost=t.trustedHost;this.startBoardParts=t.startBoardParts;this.isTestExtension=t.isTestExtension},n.prototype.markAsTestExtension=function(){this.isTestExtension=!0},n.prototype.logUsageWarning=function(){u.warning("Extension '{0}' is running untrusted code from '{1}'".format(this.name,this.uri),7,this)},n.prototype.normalizeCloudName=function(){r.Extension.multiCloudEnabled&&(this.cloudName=this.cloudName||e.Constants.DefaultCloudName);this.trustedHost=this.trustedHost||"*"},n.create=function(t){var r=i.extend(new
n,t);return r.normalizeCloudName(),r},n})();t.ExtensionMetadataExt=c;l=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n||{uri:""};return f(this.uri||"",t.uri)},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){u.warning("Untrusted gallery package '{0}' is running".format(this.uri),7,this)},n.create=function(t){var i=new n;return i.uri=t.uri,i},n})();t.GalleryPackageExt=l;a=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n;return f(this.uri,t&&t.uri)},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){u.warning("Untrusted patch '{0}' is running".format(this.uri),7,this)},n})();t.PatchExt=a})(u||(u={})),u}));define("MsPortalImpl/Services/Services.FileUploadInitialization",["require","exports","f","o"],(function(n,t,i,r){"use strict";function e(n){u||(u=!0,t.uploadSettingsManager=
n,Q(n.querySettings({store:12})).then((function(t){i.isEmpty(t)||f().then((function(t){return t.init(n)}))})))}r.defineProperty(t,"__esModule",{value:!0});var f=i.memoizeQ((function(){return i.require("MsPortalImpl/Services/Services.FileUploadSettings").then((function(n){return n.fileUploadResumableTrackerInstance()}))})),u=!1;t.init=e}));define("MsPortalImpl/Extension/ExtensionMetadataSource",["require","exports","f","i","o","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o,s){"use strict";function tt(n,t,i,r,u){var f=new l(n,t,i,r,u,p,v.isDevelopmentMode);return MsPortalImpl.Extension=f,f}var l;u.defineProperty(t,"__esModule",{value:!0});var a=i.Base,b=a.Diagnostics,h=e.ExtensionMetadataExt,k=window,d=b.createLog(n),v=k.fx.environment,y="testExtensions",g="loadUntrustedExtensions",nt=5e3,p=e.canModifyExtensions,
w="Reload the portal with the query parameter ?feature.canmodifyextensions=true to load the test extension.",c=h.create;t.initializeTestExtension=tt;l=(function(n){function t(t,i,r,u,f,e,s){return n.call(this,t,i,r,u,f,e,s,g,y,c,0,o.testExtensionsKey)||this}return __extends(t,n),t.prototype.registerTestExtension=function(n,t){var i=c(n);return this.registerTestCodeComponent(i,t).then((function(){console.log(w)}))},t.prototype.registerTestExtensionsFromUri=function(n,t){var c=this,a=new s.Uri(n),l=a.getHashQueryStringValue(y),f,o;return l?(f=JSON.parse(decodeURIComponent(l)),o=u.keys(f),!p&&o.length&&console.warn(w),Q.allSettled(o.map((function(n){var u=new h,l,o,s,a;return u.name=n,u.cloudName=t,l=r.Extension.getWindowId(u),o=i.find(c._trustedCodeComponents,(function(n){return r.Extension.getWindowId(n)===l})),o&&(u.obsoleteBundlesBitmask=o.obsoleteBundlesBitmask),s=u.uri=f[n],e.isLocalhostUri(s)?c._registerTestCodeComponentFromUri(u):(a="Invalid extension: '{0}', only allowed on 'localhost'.".
format(s),d.error(a,1),null)})))):Q(null)},t.prototype.unregisterTestExtension=function(n,t){var i=new h;return i.name=n,i.cloudName=t,i.normalizeCloudName(),this.unregisterTestCodeComponent(i)},t.prototype.listTestExtensions=function(){return this.listTestCodeComponents()},t.prototype.clearTemporaryTestExtensions=function(){this.clearTemporaryTestCodeComponents()},t.prototype.loadFromServer=function(n){var t=v.extensionsUri,i;return t?(i=a.Net2.postJSON({uri:t},n).timeout(nt),i.then((function(n){return n.map((function(n){return c(n)}))}),(function(n){var t=n&&n.jqXHR&&n.jqXHR.responseJSON&&n.jqXHR.responseJSON.reason;return t==="notSignedUp"?"/UE_NotSignedUp":"/UE_NoExtensions"}))):Q([])},t})(f.CodeComponentSideLoadManagerImpl);t.ExtensionMetadataSourceImpl=l}));define("MsPortalImpl/GalleryPackage/GalleryPackageLoader",["require","exports","f","o"],(function(n,t,i,r){"use strict";function h(n){return new u(n)}var u;r.defineProperty(t,"__esModule",{value:!0});var o=i.Base,f=o.Constants,e=f.ExtensionNames,
s=i.Services.Rpc;t.initialize=h;u=(function(){function n(n){this._extensionManager=n}return n.prototype.loadGalleryPackages=function(n){if(n&&n.length>0)return this._extensionManager.getExtensionByName(e.Marketplace,f.DefaultCloudName).then((function(){s.invokeCallback(e.Marketplace,"loadGalleryPackages",n)}))},n})();t.GalleryPackageLoaderImpl=u}));define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-keyboardshortcuts{padding:0 25px;width:355px}.fxs-keyboardshortcuts-category{margin-top:20px}.fxs-keyboardshortcuts-shortcut{display:-webkit-flex;display:flex}.fxs-keyboardshortcuts-key{-webkit-flex:0 0 auto;flex:0 0 auto;width:98px}")}));define("MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler",["require","exports","f","$","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper",
"MsPortalImpl/Base/Telemetry","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function c(n){var t=n.isJourneyVisible()&&n.getPanorama();return t&&t.getJourneyWidget()}function v(n){var t=c(n),r=t&&t.getFocusedBlade();return r?r:t&&i.last(t.getBlades())}function rt(n,t,i,r,u){return new y(n,t,i,r,u)}var l=i.Base.Diagnostics,p=l.Telemetry,w=window,a="#blade/HubsExtension/Resources",b=a+"/resourceType/",k="fxs-sidebar-collapse-button",d="fxs-topbar-home",s=f.KeyboardShortcuts,h=s.GoTo,g=l.createLog(n),nt=p.trace,tt=[49,50,51,52,53,54,55,56,57,48],it=[97,98,99,100,101,102,103,104,105,96],y;t.setup=rt;y=(function(){function n(n,t,i,r,u){this._disposables=[];this._keyShortcuts={};this._goToShortcuts={};this._errorLoggingFunc=u||function(n){g.error(n)};this._addKeyShortcuts(n);this._addGoToShortcuts(t.router,n);this._registerSpecialShortcut(s.showDiagnostics,i,65);this._registerSpecialShortcut(
s.showDebugHelper,r,68);this._registerShortcut(s.moveFavoritesUp,(function(){n.getSideBarWidget().reorderFavorites(38)}),38,5);this._registerShortcut(s.moveFavoritesDown,(function(){n.getSideBarWidget().reorderFavorites(40)}),40,5);this._attachEventHandlers()}return n.prototype.dispose=function(){this._removeEventHandlers()},n.prototype._attachEventHandlers=function(){var t=this,n;this._removeEventHandlers();n=!1;this._disposables.push(r(w.document).setEvents([u.default.keydown,function(i){var u,s=e.getModifierKeys(i),h,f;if(i.keyCode===71&&s===0){n=!0;return}(h=n?t._goToShortcuts[i.keyCode]:t._keyShortcuts[i.keyCode],f=h&&h[s],f)&&((u=r(document.activeElement),u.length>0&&s===0&&(u.is("input")||u.is("textarea")||["azc-editableControl","fxc-editor","fxc-console"].some((function(n){return u.closest("."+n).length>0}))))||(f.handler(),nt({source:o.Source.KeyboardShortcuts,action:o.Action.KeyboardShortcutExecuted,name:f.id}),i.preventDefault()))}],[u.default.keyup,function(t){var i=e.getModifierKeys(
t);t.keyCode===71&&i===0&&(n=!1)}]))},n.prototype._removeEventHandlers=function(){i.disposeDisposable(this._disposables);this._disposables=[]},n.prototype._registerShortcut=function(n,t,i,r){r===void 0&&(r=0);var u=this._keyShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate shortcut: "+f):this._keyShortcuts[i]=[];this._keyShortcuts[i][r]=e},n.prototype._addKeyShortcuts=function(n){this._registerGotoShortcut(s.toggleFocusSideAndTopBar,(function(){var n=r(document).findByClassName(d)[0];r(document.activeElement)[0]===n?r(document).findByClassName(k)[0].focus():n.focus()}),190);this._registerGotoShortcut(s.moveFocusToCommandBar,(function(){var t=v(n),i=t&&t.getContentWidget();i&&i.setFocusOnCommandBar()}),188);this._registerShortcut(s.bladeSearch,(function(){var t=v(n);t&&t.focusSearchBox()}),191,8);i.isFeatureEnabled("bladedocker")&&(this._registerGotoShortcut(s.GoBackOneBlade.desc,(function(){var t=c(n);t&&t.dockBladeLeftAlign(
!0)}),37),this._registerGotoShortcut(s.GoForwardOneBlade.desc,(function(){var t=c(n);t&&t.dockBladeLeftAlign(!1)}),39))},n.prototype._registerGotoShortcut=function(n,t,i){var r=0,u=this._goToShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r,!0),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate goto shortcut: "+f):this._goToShortcuts[i]=[];this._goToShortcuts[i][r]=e},n.prototype._registerSpecialShortcut=function(n,t,i){r.isFunction(t)&&this._registerShortcut(n,t,i,9)},n.prototype._addGoToShortcuts=function(n,t){var r=this,i;this._registerGotoShortcut(s.browse,(function(){t.getSideBarWidget().toggleFlyout()}),66);this._registerGotoShortcut(s.new,(function(){t.getSideBarWidget().openCreate()}),78);this._registerGotoShortcut(s.search,(function(){t.getSearchWidget().setFocus()}),191);[[h.allResources,a,65],[h.resourceGroups,b+"Microsoft.Resources%2Fsubscriptions%2FresourceGroups",82],].forEach((function(t){r._registerGotoShortcut(t[0],(function(){n.route(t[1])}),t[2])}));this.
_registerGotoShortcut(h.dashboard,(function(){t.handleStartButtonClick()}),68);i=function(n,i){var u=i+1;r._registerGotoShortcut(h.sideBarItem+u,(function(){t.options.sideBarViewModel.openFavorite(i)}),n)};tt.forEach(i);it.forEach(i)},n.prototype._generateIdForKeyboardShortcut=function(n,t,i){i===void 0&&(i=!1);var r=i?"G+":"";return t>15&&this._errorLoggingFunc("Not allowed modifier!"),t&8&&(r+="CTRL+"),t&1&&(r+="ALT+"),t&2&&(r+="WIN/CMD+"),r+e.mapKeyCodeToString((t&4)==4,n)},n.prototype.getShortcuts=function(){return{key:this._keyShortcuts,goTo:this._goToShortcuts}},n})()})(s||(s={})),s}));define("_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-part-buttonpart-assetname,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-wide .fxs-part-buttonpart-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-buttonpart{height:100%;width:100%;box-sizing:border-box}.fxs-part-buttonpart-inner{display:-webkit-flex;display:flex;position:relative;height:100%;box-sizing:border-box;text-align:center;-webkit-align-items:center;align-items:center;-webkit-flex-direction:column;flex-direction:column}.fxs-part-buttonpart-inner-pad{padding-top:28px}.fxs-part-buttonpart-iconcontainer{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.fxs-part-buttonpart-iconcontainer>img,.fxs-part-buttonpart-iconcontainer>svg{height:50px;width:50px}.fxs-part-buttonpart-textcontainer{width:100%;font-size:12px;line-height:18px}.fxs-part-buttonpart-assetname{margin:0;font-family:az_ea_font,\"Segoe UI\",wf_segoe-ui_semibold,\"Segoe UI Semibold\",\"Segoe WP Semibold\",\"Segoe WP\",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;line-height:10px;text-transform:uppercase}.fxs-part-buttonpart-title{margin:10px 0 5px;position:relative;overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-tilesize-mini .fxs-part-buttonpart-title,.fxs-tilesize-small .fxs-part-buttonpart-title{margin:0}.fxs-part-buttonpart-title::after,.fxs-part-buttonpart-title::before,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{position:absolute;background-color:inherit}.fxs-part-buttonpart-title::before{content:'\\02026';top:18px;right:0}.fxs-part-buttonpart-title::after{content:'';height:100%;width:100%}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg{height:30px;width:30px}.fxs-tilesize-small .fxs-part-buttonpart-inner,.fxs-tilesize-wide .fxs-part-buttonpart-inner{padding-top:0;text-align:left;-webkit-flex-direction:row;flex-direction:row}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>svg{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{-webkit-flex:0 1 auto;flex:0 1 auto;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:center;justify-content:center}.fxs-tilesize-mini{font-size:12px;line-height:normal}.fxs-tilesize-mini .fxs-part-buttonpart-inner{padding-top:5px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:32px;line-height:15px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:16px;right:0}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer{width:51px;padding-left:6px}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer{width:calc(100% - 51px)}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:18px;right:0}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{width:85px;padding-left:15px}.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{width:calc(100% - 85px)}.fxs-tilesize-wide .fxs-part-buttonpart-title{margin:0}.fxs-tilesize-wide .fxs-part-buttonpart-assetname{padding-top:2px}.fxs-tilesize-wide .fxs-part-buttonpart-desc{display:block;margin-top:10px;position:relative;overflow:hidden;text-overflow:ellipsis;max-height:90px}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after,.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{position:absolute;background-color:inherit}.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{content:'\\02026';top:72px;right:0}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after{content:'';height:100%;width:100%}.fxs-part-buttonpart-externallink{position:absolute;top:0;right:0;height:12px;width:12px}.fxs-part-buttonpart-externallink>img,.fxs-part-buttonpart-externallink>svg{height:12px;width:12px}.fxs-tilesize-mini .fxs-part-buttonpart-externallink{top:-5px;right:5px}.fxs-part-buttonpart,.fxs-part-buttonpart .fxs-part-buttonpart-desc,.fxs-part-buttonpart .fxs-part-buttonpart-inner,.fxs-part-buttonpart .fxs-part-buttonpart-textcontainer,.fxs-part-buttonpart .fxs-part-buttonpart-title{background-color:inherit}.fxs-part-buttonpart-adornment{position:absolute;top:0;left:33px;height:14px;width:14px}.fxs-tilesize-mini .fxs-part-buttonpart-adornment{position:absolute;top:0;left:17px;height:10px;width:10px}.fxs-tilesize-small .fxs-part-buttonpart-adornment{position:absolute;top:50% - 30px/2;left:0;height:10px;width:10px}.fxs-tilesize-wide .fxs-part-buttonpart-adornment{position:absolute;top:50% - 50px/2;left:0;height:14px;width:14px}html[lang^=ja] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=ko] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=zh] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title{font-size:11px;line-height:11px}")})
);define("MsPortalImpl/Parts/Parts.ButtonPart",["require","exports","f","ko","MsPortalImpl/Svg/Startup/Hyperlink.svg","MsPortalImpl/Parts/Parts","MsPortalImpl/Base/Base.SvgHelper","FxInternal/Composition/ViewModel","_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var t=i.getUniqueId(),s;n.template="<div class='fxs-part-buttonpart'><div class='fxs-part-buttonpart-inner'><div class='fxs-part-buttonpart-iconcontainer' data-bind='image: icon, css: { \"fxs-part-buttonpart-inner-pad\": _showTopPadding() }'><\/div><!-- ko if: $data.adornmentUri --><img alt='' class='fxs-part-buttonpart-adornment' data-bind='attr: { src: adornmentUri }' /><!-- /ko --><div class='fxs-part-buttonpart-textcontainer'><h3 class='fxs-part-buttonpart-title msportalfx-tooltip-overflow' "+('data-bind=\'text: _displayTitle, css: { "fxs-should-use-single-line": _assetNameVisible(), "fxs-can-use-multiline": !_assetNameVisible() }\' aria-describedby='+
t+"><\/h3>")+("<div data-bind='text: _assetName, visible: _assetName() && (_assetNameVisible())' class='fxs-part-buttonpart-assetname msportalfx-tooltip-overflow' id="+t+"><\/div>")+"<div data-bind='text: description, visible: ((_size() === MsPortalFx.Parts.PartSize.Wide) && description())' class='fxs-part-buttonpart-desc msportalfx-tooltip-overflow'><\/div><\/div><!-- ko if: _isExternalLink --><div class='fxs-part-buttonpart-externallink azc-fill-heavy' data-bind='attr: { \"aria-label\": _clickableLinkUri }'>"+e.getSvgReferenceOrFallBackToData(u,{customClass:"",isLogo:!0})+"<\/div><!-- /ko --><\/div><\/div>";s=(function(t){function u(){var i=t!==null&&t.apply(this,arguments)||this;return i.template=n.template,i}return __extends(u,t),u.prototype._getContentForBinding=function(n,u){var l=this,e=u.content,s=u.container,f=s.clickableLink,a=function(n){return n.target()==="_self"||n.uri&&i.startsWith(n.uri(),"#")&&n.target()==="auto"},v=r.observable(!!f&&!a(f)),y,h,c;return r.computed(n,(function(
){l.ariaLabel(e.title())})),y=f&&f.target,y&&y.subscribe(n,(function(){v(!a(f))})),h=f&&f.uri,h&&h.subscribe(n,(function(){v(!a(f))})),c=o.isV2(e)?function(){return l._options.size()}:function(){return e.size&&e.size()},i.extend2(t.prototype._getContentForBinding.call(this,n,u),{_displayTitle:r.computed(n,(function(){var n=c(),t=e.title();return n===0||n===1?e.shortTitle()||t:t})),_assetName:s.assetName,_isExternalLink:v,_clickableLinkUri:h,_assetNameVisible:r.computed(n,(function(){return!l.inContainerOfSameAsset()&&s.assetName()})),_showTopPadding:r.computed(n,(function(){return c()===2&&!s.partTitle()})),_size:r.computed(n,c)})},u})(f.PartImpl);n.ButtonPart=s})(s||(s={})),s}));define("_generated/Less/MsPortalImpl/Parts/Parts.Collection.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-part-collectionpart .azc-grid table td.azc-grid-cell:first-of-type,.fxs-part-collectionpart .azc-grid table thead tr th:first-child a{padding-left:15px}.fxs-part-collectionpart-more-data,.fxs-part-collectionpart-rollup-count{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.fxs-part-collectionpart .azc-grid table thead tr th{height:28px;line-height:28px;border-top-width:1px;border-top-style:solid}.fxs-part-collectionpart .azc-grid table thead tr th>a{line-height:normal}.fxs-part-collectionpart .azc-grid table tbody tr td{height:27px}.fxs-part-collectionpart .azc-grid table td:last-child,.fxs-part-collectionpart .azc-grid table td:last-of-type{padding-right:15px}.fxs-part-collectionpart .azc-grid table .azc-grid-resizableColumn-handle{height:28px}.fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:none}.fxs-part-collectionpart.fxs-part-collectionpart-rollup-forceshow .fxs-part-collectionpart-rollup-container{display:block}.fxs-part-collectionpart-more-data{font-size:12px;line-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:absolute;right:0}.fxs-part-collectionpart-more-data:hover{text-decoration:underline}.fxs-part-collectionpart-rollup-container{margin:-6px 0 6px}.fxs-part-collectionpart-rollup-count{font-size:30px;line-height:30px;letter-spacing:-.025em}.fxs-part-collectionpart-rollup-label{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em;margin-left:4px}.fxs-part-collectionpart-part-title{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;line-height:10px;text-transform:uppercase;margin:5px 0 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:none}.fxs-part-collectionpart-rollup-icon{width:21px;height:21px;margin-left:4px;display:inline-block}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:block;margin:0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label{display:none}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count{line-height:25px}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count{width:30px;height:30px;margin-left:0}.fxs-tilesize-mini .fxs-part-collectionpart{text-align:center;padding:5px 6px 0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-part-title{display:block}.fxs-tilesize-small .fxs-part-collectionpart{float:right;margin-top:-15px}html[lang^=ja] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=ko] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=zh] .fxs-part-collectionpart .fxs-part-collectionpart-part-title{font-size:11px;line-height:11px}')})
);define("MsPortalImpl/Parts/Parts.Collection",["require","exports","f","ko","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Parts/Parts","MsPortalImpl/Resources/ImplScriptResources","_generated/Less/MsPortalImpl/Parts/Parts.Collection.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var t=o.Parts,s='<div class="fxs-part-collectionpart" data-bind="css: {\'fxs-part-collectionpart-rollup-forceshow\': alwaysShowRollupCount()}"><div class="fxs-part-collectionpart-rollup-container"><span class="fxs-part-collectionpart-rollup-count" data-bind="text: rollupCount, visible: !noRollupCount()"><\/span><span class="fxs-part-collectionpart-rollup-label" data-bind="text: rollupCountLabel"><\/span><img class="fxs-part-collectionpart-rollup-icon" data-bind="attr: { src: rollupCountIconUri }, visible: rollupCountIconUri, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }" alt=""/><div class="fxs-part-collectionpart-rollup-icon" data-bind="image: rollupCountIcon, visible: rollupCountIcon, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }"><\/div><h4 class="fxs-part-collectionpart-part-title fxs-display-none" data-bind="text: _partTitle"><\/h4><\/div><!-- ko if: emptyGrid() && noRowsHtml() --><div class="fxs-part-collectionpart-norowshtml fxs-display-none" data-bind="pcControl: noRowsHtml"><\/div><!-- /ko --><!-- ko if: !emptyGrid() || !noRowsHtml() --><!-- ko if: !!gridMode() --><div data-bind="pcGrid: grid" class="msportalfx-removepartpaddingside"><\/div>'+
('<a href="#" class="fxs-part-collectionpart-more-data fxs-portal-text-primary" tabindex="0" data-bind="visible: hasMoreData">'+i.encodeHtml(t.more)+"<\/a>")+"<!-- /ko --><!-- /ko --><\/div>",h=(function(n){function t(t,i,r,f){var e=n.call(this,t,i,r,f)||this,o;e.template=s;o=e._container=u(t);o.on("click keydown","a.fxs-part-collectionpart-more-data",(function(n){n.preventDefault();n.stopPropagation();var t=u.Event(n.type);t.keyCode=n.keyCode;u(n.delegateTarget).trigger(t)}));return e}return __extends(t,n),t.prototype._getContentForBinding=function(n,t){var u=this._container.findByClassName("fxs-part-collectionpart-part-title"),e=this._container.findByClassName("fxs-part-collectionpart-norowshtml");return r.computed(n,(function(){var n=t.content.size();f.toggle(u,n!==0||!!t.container.partTitle());f.toggle(e,n!==0&&n!==1)})),i.extend2(t.content,{_partTitle:t.container.partTitle})},t})(e.PartImpl);n.CollectionPart=h})(s||(s={})),s}));define("_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css",
["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxpart-itemsummary{height:100%;background:#00f;display:block;color:#fff}.fxpart-itemsummary-name{font-size:19px;padding:20px;text-transform:uppercase}.fxpart-itemsummary-sourceControl{font-size:16px;padding:0 20px}")}));define("_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".msportalfx-pricingTier .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.msportalfx-pricingTier .msportalfx-pricingTier-normal-iconContainer,.msportalfx-pricingTier .msportalfx-pricingTier-wide-iconContainer{height:55px;border-bottom:1px solid #dcdfe2}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:10px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-specCode{float:left;margin-right:8px;max-width:100px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-promotedFeatures{line-height:12px;padding-top:4px}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon{width:30px;height:30px;margin-top:1.7em}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon.msportalfx-pricingTier-icon-small{margin-top:-.15em}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:10px}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:30px;height:30px;margin-right:15px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:18px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:20px;height:20px;margin-right:5px}.fxs-tilesize-small .msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:-12px}.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specCode,.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specTitle{text-align:center;float:initial}")})
);define("_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.msportalfx-specpicker-footer-value,.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode,.msportalfx-specpicker-table .msportalfx-specpicker-feature-name,.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.msportalfx-specpicker{width:175px;height:320px;position:relative;border-color:inherit}.msportalfx-specpicker:after,.msportalfx-specpicker:before{content:"";position:absolute;z-index:-1;top:10px;bottom:10px;left:0;right:0;border-radius:10px}.msportalfx-specpicker:after{right:10px;left:auto;transform:skew(8deg) rotate(3deg)}.msportalfx-specpicker .msportalfx-specpicker-table{table-layout:auto}.msportalfx-specpicker ul{list-style-type:none;padding:0}.msportalfx-specpicker .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.fxs-mode-dark .msportalfx-specpicker{box-shadow:0 1px 4px rgba(255,255,255,.3),0 0 40px rgba(255,255,255,.1) inset}.fxs-mode-dark .msportalfx-specpicker:after,.fxs-mode-dark .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(255,255,255,.8)}.fxs-mode-light .msportalfx-specpicker{box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset}.fxs-mode-light .msportalfx-specpicker:after,.fxs-mode-light .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(0,0,0,.8)}.msportalfx-specpicker-star{width:14px;height:14px;fill:#ffb900;stroke:#000;stroke-width:1px;float:right;margin-right:4px;margin-top:1px}.msportalfx-specpicker-header{color:#fff;font-size:14px;height:26px;line-height:26px}.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode{text-transform:uppercase;padding-left:11px}.msportalfx-specpicker-header .msportalfx-specpicker-header-title{padding-left:6px}.msportalfx-specpicker-header-text{fill:#ffb900;stroke:#000;stroke-width:1px;width:161px;position:absolute}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade1{background-color:#4668c5}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade2{background-color:rgba(70,104,197,.2)}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade3{background-color:rgba(70,104,197,.1)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade1{background-color:#8a2da5}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade2{background-color:rgba(138,45,165,.2)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade3{background-color:rgba(138,45,165,.1)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade1{background-color:#578000}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade2{background-color:rgba(87,128,0,.2)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade3{background-color:rgba(87,128,0,.1)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade1{background-color:#c40}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade2{background-color:rgba(204,68,0,.2)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade3{background-color:rgba(204,68,0,.1)}.msportalfx-specpicker-table{table-layout:auto;width:100%;border-collapse:collapse}.msportalfx-specpicker-table .msportalfx-specpicker-feature-name{font-size:12px;margin-left:6px}.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-size:17px}.msportalfx-specpicker-row td{white-space:nowrap;padding:0}.msportalfx-specpicker-row td .msportalfx-specpicker-cell{height:30px;line-height:30px}.msportalfx-specpicker-row td.msportalfx-specpicker-right{overflow:hidden;text-overflow:ellipsis;max-width:1px;width:100%}.msportalfx-specpicker-row.msportalfx-specpicker-promotedFeatures td{padding-bottom:1px}.msportalfx-specpicker-row.msportalfx-specpicker-borderBottom td{border-bottom:1px solid #e9e9f3}.msportalfx-specpicker-row .msportalfx-specpicker-left{text-align:center;min-width:39px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-value{font-size:12px;padding-top:6px;margin-left:6px;line-height:normal}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-name{font-size:10px;line-height:normal;margin-top:-3px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-mutipleline .msportalfx-specpicker-feature-value{padding-top:1px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{min-width:29px;text-align:center}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell img{width:22px;height:22px;margin-top:8px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell div{width:20px;height:20px;padding-top:5px;padding-left:0;display:inline-block}.msportalfx-specpicker-footer-container{position:absolute;bottom:0;left:0;right:0;height:46px;text-align:right}.msportalfx-specpicker-footer{margin-right:10px;margin-bottom:8px;background-color:inherit}.msportalfx-specpicker-footer-value{margin-top:6px;text-transform:uppercase;font-size:22px;line-height:22px;letter-spacing:-.025em}.msportalfx-specpicker-footer-details{font-size:10px;line-height:14px;text-transform:uppercase}.msportalfx-specpicker-footer-channelMessage,.msportalfx-specpicker-footer-statusMessage{margin-left:5px;margin-right:5px;font-size:11px;text-align:left}.msportalfx-specpicker-footer-statusMessage{margin-top:25px}.msportalfx-specpicker-footer-channelMessage{margin-top:10px;position:absolute;background-color:inherit;white-space:normal;overflow:hidden;text-overflow:ellipsis;max-height:32px}.msportalfx-specpicker-footer-channelMessage::after,.msportalfx-specpicker-footer-channelMessage::before{position:absolute;background-color:inherit}.msportalfx-specpicker-footer-channelMessage::before{content:\'\\02026\';top:16px;right:0}.msportalfx-specpicker-footer-channelMessage::after{content:\'\';height:100%;width:100%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker{background-color:rgba(189,189,189,.05)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-header{background-color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.2)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-right .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.1)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-container{background-color:#dedede}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-name,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-value,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-value{color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor{position:absolute;text-align:center;left:15px;right:15px;top:40%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container{display:inline-block;background-color:rgba(50,56,63,.8);margin-top:20px;padding:15px 10px;width:100%;box-sizing:border-box}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container .msportalfx-specpicker-disable-message{display:inline}.ext-hubs-specPickerGrid-container{height:100%;overflow:hidden;display:flex;flex-direction:column}.ext-hubs-specPicker-container{width:100%;min-height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-filtersContainer.ext-hubs-specPicker-filtersContainer{margin-top:0;padding-top:5px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer{height:25px;padding-top:5px;padding-right:15px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions{font-size:14px;float:right}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .msportalfx-specpicker-recommendationsIcon{width:14px;height:14px;display:inline-block}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-selected{cursor:default;background-color:inherit}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-clickable{color:#0058ad;fill:#0058ad}.ext-hubs-specPicker-container .ext-hubs-specPicker-content{height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-message{margin-top:0;border-left:6px solid #ffb900;padding:15px;white-space:pre-wrap}.ext-hubs-specPicker-container .ext-hubs-specPicker-listView{margin-left:19px}.ext-hubs-specPicker-container .fxc-hotspot{outline:0;padding:5px}.ext-hubs-specPicker-container .fxc-hotspot:focus{outline-style:dotted;outline-width:1px}')})
);define("MsPortalImpl/Parts/Parts.Intrinsics",["require","exports","f","o","MsPortalImpl/Parts/Parts","_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css","_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css"],(function(n,t,i,r,u){"use strict";r.defineProperty(t,"__esModule",{value:!0});var f=i.Parts.PartKind,c=0,s=1,o=2,e=3,l=10,a=4,v=5,y=6,b=7,p=8,k=9,h="<div data-bind='{0}: $root'><\/div>",w={defaultSize:p,supportedSizes:[p],viewStateProperties:["content.selection.selectedItems","content.selection.activatedItems"]};t.parts=[{kind:f.Asset,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Asset",(function(n,t,i,r,u){return new n.AssetPart(t,i,r,u)}),{defaultSize:s,supportedSizes:[c,s,o]})},{kind:f.Button,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.ButtonPart",(function(n,t,i,r,u){return new n.ButtonPart(t,i,r,u)}),{supportedSizes:[c,s,o,e]})},{kind:f.Chart,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Chart",
(function(n,t,i,r,u){return new n.Chart(t,i,r,u)}),{supportedSizes:[s,o,a,e,l,v,y,b,p,k]})},{kind:f.Collection,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Collection",(function(n,t,i,r,u){return new n.CollectionPart(t,i,r,u)}),{supportedSizes:[c,s,o,e,a,l,v,y,b,k,p]})},{kind:f.CollectionSummary,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.CollectionSummary",(function(n,t,i,r,u){return new n.Part(t,i,r,u)}),{supportedSizes:[c,s,o,e]})},{kind:f.DiffEditor,factory:u.createPartFactory(h.format("pcDiffEditor"))},{kind:f.Donut,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Donut",(function(n,t,i,r,u){return new n.Donut(t,i,r,u)}),{supportedSizes:[o,v,e,l,a,y,]})},{kind:f.Editor,factory:u.createPartFactory(h.format("pcEditor"))},{kind:f.Grid,factory:u.createPartFactory(h.format("pcGrid"),{viewStateProperties:["content.selectableData.selectedItems","content.selectableData.activatedItems","content.selectableData.itemsWithChildEdits"]})},{kind:f.InfoList,factory:u.createAmdPartFactory(
"MsPortalImpl/Parts/Parts.InfoList",(function(n,t,i,r,u){return new n.InfoListPart(t,i,r,u)}),w)},{kind:f.ItemSummary,factory:u.createPartFactory("<div class='fxpart-itemsummary'><div class='fxpart-itemsummary-name' data-bind='text: name'><\/div><\/div>")},{kind:f.LogStream,factory:u.createPartFactory(h.format("pcLogStream"))},{kind:f.Properties,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Properties",(function(n,t,i,r,u){return new n.PropertiesPart(t,i,r,u)}),w)},{kind:f.Provisioning,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Provisioning",(function(n,t,i,r,u){return new n.ProvisioningPart(t,i,r,u)}),{supportedSizes:[o,e]})},{kind:f.QuickStart,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuickStart",(function(n,t,i,r,u){return new n.QuickStartPart(t,i,r,u)}),{defaultSize:s,supportedSizes:[c,s,o,e]})},{kind:f.QuotaGauge,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuotaGauge",(function(n,t,i,r,u){return new n.QuotaGauge(t,i,r,u)}),{supportedSizes:
[o,l,e,a,y,v]})},{kind:f.ResourceSummary,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.ResourceSummary",(function(n,t,i,r,u){return new n.ResourceSummaryPart(t,i,r,u)}),w)},{kind:f.Settings,factory:u.createPartFactory(h.format("pcSettings"),{defaultSize:e,supportedSizes:[e]})},{kind:f.SingleSetting,factory:u.createPartFactory(h.format("pcSingleSetting"))},{kind:f.SingleValueGauge,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.SingleValueGauge",(function(n,t,i,r,u){return new n.SingleValueGauge(t,i,r,u)}),{supportedSizes:[o,l,e,a]})},{kind:f.Unavailable,factory:u.createPartFactory("<div><\/div>")}];t.parts.forEach((function(n){u.registerFactory(f[n.kind],n.factory)}))}));define("MsPortalImpl/Services/Services.AzureStorage",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function e(){u.register(r.Rpc.client,[r.Extension.getWindowId({name:"Microsoft_Azure_Scheduler",cloudName:t.Constants.DefaultCloudName})],o)}function o(n){var i={isBackgroundTask:
!1,uri:f};return t.Net2.postJSON(i,n).then((function(n){return n.data}))}var t=i.Base,u=r.InternalAzure.getSasUriForQueueEndPoint,f=t.Resources.getAppRelativeUri("api/Storage/getsasuriforqueue");n.registerSasEndPoint=e})(u||(u={})),u}));define("MsPortalImpl/Services/Services.BrowseCuration",["require","exports","f","i","o","a","MsPortalImpl/Resources/ImplScriptResources","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f,e,o){"use strict";function b(n){if(n&&!g.test(n)){y.warning("Invalid curation file name: <"+n+">, skipping this curation file.");return}return n}function nt(n,t,i){var r=f.isArray(t[0])?t:[t];return{base:h(n),associated:c.apply(c,r),infoTextOverride:i}}function h(n){var t,i;if(n&&!(n.length<2)&&n[0].length&&n[1].length)return t={extensionName:n[0],assetType:n[1]},n.length>2&&(i=n[2],i&&typeof i=="string"?t.kind=i:n[2]===!1&&(t.isHidden=!0)),t}function c(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.map((function(n){return h(n)})).filter((function(n){return!!n})
)}function tt(){o.Curation.getSharedCurationEndpoint.register(k.client,[r.Extension.getHubsWindowId()],(function(){return t.getSharedCuration()}))}var s;u.defineProperty(t,"__esModule",{value:!0});var l=i.Base,k=r.Rpc,a=i.Hubs.Notifications,d=window,v=d.fx.environment,y=l.Diagnostics.createLog(n),g=/^[a-z\_]+[a-z\d\-\_]*$/i,p=e.BrowseCuration,w=i.lowerCaseAllStrings;s=b(i.getFeatureValue("browsecuration"))||b(v.browseCuration)||"default";t.getMergedAssetType=nt;t.getAssetType=h;t.getAssetTypes=c;t.getBrowseCuration=i.memoizeQ((function(){return i.require("MsPortalImpl/Services/BrowseCuration/"+s).then((function(n){return n.getCuration()})).catch((function(n){var i="Failed to get the browse curation file <"+s+">",t=i;return n&&n.statusText?t+=": "+(n.status||"")+" ("+n.statusText+")":n&&n.message&&(t+=": "+n.message),y.warning(t),a.ClientNotification.publish({title:p.noCurationTitle,description:p.noCuration,status:a.NotificationStatus.Warning}),{}}))}));t.getSharedCuration=i.memoizeQ((function()
{var n=e.SearchTypeDisplayText,r=e.SearchTypeKeywords,u=e.SearchTypeSubText;return t.getBrowseCuration().then((function(t){var f=(t&&t.search||[]).map((function(t){var i=(t.id||"").toLowerCase(),f=i&&n[i];if(f)return{id:t.id,displayName:f,subText:u[i],keywords:(r[i]||"").split(","),icon:typeof t.icon=="string"?l.Images.ImageUri(t.icon):t.icon,link:(t.link||"").format({accountPortal:v.links.accountPortal})}})).filter(i.identity);return{searchCuration:f,resourceTypesExcludedFromBrowse:w(t&&t.resourceTypesExcludedFromBrowse),mergedAssetTypes:w(t&&t.mergedAssetTypes)}}))}));t.testReset=i.noop;t.initializeRpc=tt}));define("MsPortalImpl/Services/Services.Controller",["require","exports","f","o"],(function(n,t,i,r){"use strict";function f(n){var t=[n?n.flushSettings():Q(),u.Telemetry.flush(),u.Upload.flush()],i=t.every((function(n){return!n||Q.isPromise(n)?!Q.isPending(n):n.state()!=="pending"}));return i?Q():Q.all(t)}r.defineProperty(t,"__esModule",{value:!0});var u=i.Base.Diagnostics;t.flush=f}));define(
"MsPortalImpl/Services/Services.FavoritesSettings",["require","exports","i","o","ko","MsPortalImpl/Services/Services.SettingsProcessor"],(function(n,t,i,r,u,f){"use strict";function s(n){var i="InitializeFavoritesSettingsInternal";if(o&&!window.fx.environment.isTestMode)throw new Error(i+" has already been called.");o=!0;t.sidebarFavoritesProcessor.init(n,t.sidebarFavoritesSettings,10,i,!0);t.userDirectorySettingsProcessor.init(n,t.userDirectorySettings,7,i,!0)}var e,o;r.defineProperty(t,"__esModule",{value:!0});e=new i.TriggerableLifetimeManager;t.sidebarFavoritesProcessor=new f.SettingsProcessor(e);t.userDirectorySettingsProcessor=new f.SettingsProcessor(e);o=!1;t.sidebarFavoritesSettings={favorites:u.observable(""),version:u.observable(0)};t.userDirectorySettings={favoriteDirectoriesList:u.observableArray(),userDefaultDirectory:u.observable(),signInToLastVisitedDirectory:u.observable(!0)};t.initFavoritesSettings=s}));define("MsPortalImpl/Services/Services.FileUploadEndpointRegistration",
["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";function c(){s||(s=!0,e.uploadActionEndPoint.register(f.client,null,(function(n){return o().then((function(t){return t.invokeUploadAction(n.uploadKey,n.action,n.context)}))})),e.getUploadInfosEndPoint.registerObjectFactory(f.client,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){return o().then((function(t){return t.getUploadInfos(n.uploadKeys,n.category,n.resumable)}))}}))}u.defineProperty(t,"__esModule",{value:!0});var f=r.Rpc,e=r.FileUpload,h="MsPortalImpl/Services/Services.FileUploadManager",o=i.memoizeQ((function(){return i.require(h).then((function(n){return n.fileUploadManagerInstance()}))})),s=!1;t.registerFileUploadEndpoints=c}));define("MsPortalImpl/Services/Services.GalleryEndpoints",["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";u.defineProperty(t,"__esModule",{value:!0});var f=r.Extension,s=i.Base,h=s.Constants.ExtensionNames,c=window,e=c.fx.environment,o=e.features,l=(function(){function n(
n,t,i){var r=this;this._registeredEndpoints=[];this._extensionManager=t;this._extensionMetadataSource=i;f.getLocalGalleryPackagesEndpointsDefinition.register(n,null,(function(n,t){var i=f.getDescriptor(t.srcWindowId).name.toLowerCase();return i===h.Marketplace.toLowerCase()?r._ensureAllTestExtensionsAreLoaded().then((function(){return r._registeredEndpoints.slice(0)})):null}));f.registerLocalGalleryPackagesEndpointDefinition.register(n,null,(function(n){if(e.isDevelopmentMode||o&&o.canmodifyextensions){var t=r._registeredEndpoints;t.indexOf(n)<0&&t.push(n)}}))}return n.prototype._ensureAllTestExtensionsAreLoaded=function(){var n=this;return this._extensionMetadataSource.listTestExtensions().then((function(t){return Q.allSettled(t.map((function(t){return n._extensionManager.getExtensionByName(t.name,t.cloudName)})))}))},n})();t.GalleryEndpointsService=l}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(
t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-messagebox,.fxs-progressbox{font-size:14px;box-sizing:border-box;box-shadow:0 5px 15px 2px rgba(0,0,0,.3);border:1px solid}.fxs-messagebox h2,.fxs-progressbox h2{font-size:110%;padding:24px 27px 7px;margin:0;line-height:14px;border-bottom:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-messagebox .fxs-messagebox-text,.fxs-messagebox .fxs-modal-template,.fxs-messagebox .fxs-progressbox-text,.fxs-progressbox .fxs-messagebox-text,.fxs-progressbox .fxs-modal-template,.fxs-progressbox .fxs-progressbox-text{padding:0 27px;word-wrap:break-word}.fxs-messagebox .fxs-progressbox-progressbar,.fxs-progressbox .fxs-progressbox-progressbar{padding:7px 27px 24px}.fxs-messagebox .fxs-messagebox-buttons,.fxs-progressbox .fxs-messagebox-buttons{border-top-width:1px;border-top-style:solid}.fxs-messagebox .fxs-messagebox-buttons .fxs-button,.fxs-progressbox .fxs-messagebox-buttons .fxs-button{margin-right:5px}.fxs-messagebox .msportalfx-form,.fxs-progressbox .msportalfx-form{padding:0;margin:27px 0 0}.fxs-messagebox .msportalfx-form>div,.fxs-progressbox .msportalfx-form>div{padding:15px 27px}.azc-balloon-dialog .fxs-messagebox{box-shadow:unset;border:0}.fxs-messagebox-confirmation{padding:10px 27px 0;display:block}")})
);define("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","MsPortalImpl.Controls/Controls/SimpleButton"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function rt(n){var i=n.closest("."+v),t;i.length>0&&(t=h.Widget.getWidget(i,y),t.cancelBtn&&t.cancelBtn.onClick.call(this))}function d(n,t){var r=n.closest("."+v),i;for(r.length>0&&c.waitForBindings(r[0]).then((function(){var n=h.Widget.getWidget(r,y);n.options.confirmationRequired?n.element.find(".azc-checkBox").focus():n.element.find(".fxs-portal-button-primary").focus()})),i=t||document.activeElement;i&&typeof i.focus!="function";)i=f(i).closest("[tabindex]")[0];w=i}var g,y;r.defineProperty(t,"__esModule",
{value:!0});"use strict";var nt=i.Base.Diagnostics,tt=i.ViewModels.Controls.SimpleButton.ViewModel,a=nt.createLog(n),b=i.newGuid,l=e.Dialogs.ButtonText,k="fxs-portal-bg-txt-br",v="fxs-messagebox",p="fxs-messagebox-text",it='<h2 data-bind="text: data.title" class="fxs-messagebox-title" msportalfx-tooltip-overflow"><\/h2><!-- ko if: data.modal --><!-- ko ifnot: data.template -->'+('<div data-bind="sanitizedHtml: data.text" class="'+p+'"><\/div>')+'<!-- /ko --><!-- ko if: data.template --><div class="fxs-modal-template" data-bind="untrustedHtml: { html: data.template, data: data.templateViewModel, isolated: true }"><\/div><!-- /ko --><!-- /ko --><!-- ko ifnot: data.modal --><!-- ko ifnot: data.template -->'+('<div data-bind="text: data.text" class="'+p+'"><\/div>')+'<!-- /ko --><!-- ko if: data.template --><div class=\'msportalfx-padding\' data-bind="untrustedHtml: { html: data.template, data: data.templateViewModel, isolated: true }"><\/div><!-- /ko --><!-- /ko --><!-- ko if: data.confirmationRequired --><div data-bind="pcControl: func.checkboxVm" class="fxs-messagebox-confirmation"><\/div><!-- /ko --><div class="msportalfx-form fxs-messagebox-buttons fxs-portal-border"><div data-bind="foreach: func.buttonVms"><div data-bind="pcControl: $data.vm, attr: { \'data-result\': $data.result }"><\/div><\/div><\/div>',
w=document.activeElement;t.cancelMessageBox=rt;t.setFocusOnMessageBox=d;g=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.title=u.observable(),t.text=u.observable(),t.template=u.observable(),t.templateViewModel=u.observable(),t.modal=!1,t.buttons=1,t.confirmationRequired=!1,t}return __extends(t,n),r.defineProperty(t.prototype,"onButtonClick",{get:function(){return this._buttonClick},set:function(n){if(this._buttonClick)throw new Error("The onButtonClick callback has already been set.");this._buttonClick=n},enumerable:!0,configurable:!0}),t})(h.ViewModel);t.ViewModel=g;y=(function(n){function t(t,r){var e=n.call(this,t,r)||this,h,c,l;return e.buttonVms=u.observableArray([]),t.html(it).addClass(v).addClass(k),h=e.ltm,c=function(n){var t=e.element[0];return!e.options.modal&&!(t===n)&&!f.contains(t,n)?2:0},e._dismissHandle={dismissFn:function(){e.cancelBtn&&e.cancelBtn.onClick.call(e)},shouldDismissOnMouseDownFn:c,shouldDismissOnMouseWheelFn:c,restoreFocus:function(
){o.validatePreviousFocusedElement(e._dismissHandle,w)&&w.focus()},logName:"messagebox"},e.checkboxVm=new i.ViewModels.Forms.CheckBox.ViewModel(h,{label:u.observable(r.confirmationMessage),inlineLabel:!0}),e._getButtonHtml(r.buttons,h),e._bindDescendants(),e._setAria(),d(t,document.activeElement),l=new s.KeyboardNavigation(t,2),o.register(e._dismissHandle),h.registerForDispose((function(){l.dispose();o.unregister(e._dismissHandle)})),e.checkboxVm.value(!r.confirmationRequired),u.reactor(h,(function(){e.defaultBtn.disabled(!e.checkboxVm.value())})),e}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(v,k);n.prototype.dispose.call(this)},t.prototype.generateBtns=function(n,t){var u=this,r=this.buttonVms,f=function(n,t,i,r){return new tt(n,{text:t,primary:i,onClick:function(){if(typeof u.options.onButtonClick=="function")u.options.onButtonClick(r);u._dismissHandle.restoreFocus()}})};r().forEach((function(n){n.vm.dispose()}));r().length=0;r([]);this.defaultBtn=null;this.cancelBtn=
null;t.forEach((function(t,i){i===0&&t.kind!==1&&a.error("The first button should be the default button for this dialog.");u.defaultBtn&&t.kind===1&&a.error("Only one default button should be defined.");u.cancelBtn&&t.kind===2&&a.error("Only one cancel button should be defined.");switch(t.kind){case 1:r.push({vm:f(n,t.text,!0,t.result),result:t.result});u.defaultBtn=r().last().vm;break;case 2:r.push({vm:f(n,t.text,!1,t.result),result:t.result});u.cancelBtn=r().last().vm;break;case 3:default:r.push({vm:f(n,t.text,!1,t.result),result:t.result})}}));t.length===1&&(this.cancelBtn=this.defaultBtn);i.isNullOrUndefined(this.cancelBtn)&&a.error("Cancel button should be defined.")},t.prototype._getButtonHtml=function(n,t){var i=this.options;if(i.customBtns)this.generateBtns(t,i.customBtns);else{switch(n){case 0:this.generateBtns(t,[{kind:1,text:l.retry,result:5},{kind:2,text:l.abort,result:0},{kind:3,text:l.ignore,result:2}]);break;case 1:this.generateBtns(t,[{kind:1,text:l.ok,result:4}]);break;case
2:this.generateBtns(t,[{kind:1,text:l.ok,result:4},{kind:2,text:l.cancel,result:1}]);break;case 3:this.generateBtns(t,[{kind:1,text:l.retry,result:5},{kind:2,text:l.cancel,result:1}]);break;case 4:this.generateBtns(t,[{kind:1,text:l.yes,result:6},{kind:2,text:l.no,result:3}]);break;case 5:this.generateBtns(t,[{kind:1,text:l.yes,result:6},{kind:3,text:l.no,result:3},{kind:2,text:l.cancel,result:1}]);break;default:throw new Error("Could not locate message box button of type {0}.".format(n));}this.defaultBtn&&i.defaultButtonText&&this.defaultBtn.text(i.defaultButtonText);this.cancelBtn&&i.cancelButtonText&&this.cancelBtn.text(i.cancelButtonText)}return},t.prototype._setAria=function(){var n=this.element,t=b(),i=b();n.attr({role:"alertdialog","aria-labelledby":i,"aria-describedby":t});n.find("h2").attr("id",i);n.findByClassName(p).attr("id",t);this.ltm.registerForDispose((function(){n.removeAttr("role aria-labelledby aria-describedby")}))},t})(h.Widget);t.Widget=y}));define("MsPortalImpl/Services/Services.PortalTips",
["require","exports","f","o","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox"],(function(n,t,i,r,u,f,e){"use strict";function o(n,t,i,r){return t.then((function(){s(n,i);f.settings.whatsNewVersion(r)}))}function s(t,r){var o=t.createChildLifetime(),s=function(){o.isDisposed()||o.dispose()},h=u.PortalTips.DefaultView,f=new e.ViewModel;f.buttons=1;f.title(h.title);f.text(h.description.format(window.fx.environment.branding.browseLabel));f.onButtonClick=s;f.disabled(!1);Q.delay(500).then((function(){i.require("../../Viva.Controls/Controls/Viva.Balloon",n).then((function(n){var t=new n.ViewModel({ltm:o}),i;r.push(i=function(u){if(u.length&&r.indexOf(i)>=0){r.removeAll([i]);t.box((function(){return n.getBox($(u[0]))}));t.content('<div class="fxs-portal-tip-content"><\/div>');var h=$(".fxs-portal-tip:first");o.registerForDispose([new n.Widget(h,t,{isTrusted:!0}),new e.Widget(h.find(".fxs-portal-tip-content:first"),
f),]);t.visible(!0);t.visible.subscribe(o,(function(n){n||s()}))}})}))}))}r.defineProperty(t,"__esModule",{value:!0});t.setup=o}));define("MsPortalImpl/Services/Services.SecurityTokens",["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";function wt(n){t.authState=n}function bt(){t.authState&&ct.setItem(pt,JSON.stringify(t.authState))}function kt(n){return n.refreshToken?new a(new it,n):new rt(n)}function dt(n,t,i){return new v(et.client,n,t,i)}function gt(n){var t=n&&n.authHeader;return t?function(){return Q(t)}:function(){return Q.reject(c)}}var it,a,rt,v;u.defineProperty(t,"__esModule",{value:!0});var y=r,h=y.Extension,f=i.Base,p=f.Net2,ut=f.Constants,w=f.Constants.ExtensionNames.Hubs,b=f.Diagnostics,k=b.Telemetry,ft=f.Resources,et=r.Rpc,ot=f.Security,st=y.Security,ht=window,ct=MsPortalImpl.sessionStorage,d=b.createLog(n),lt=ft.getAppRelativeUri("/api/DelegationToken"),e=st.tokenErrors,o="",s=ut.Shell.toLowerCase(),at=e.accessDenied,g=e.unknown,nt=e.sessionEnded,c=e.credentialsExpired,
vt=e.networkError,yt=e.nullToken,l=Date.now,tt=h.getWindowId,pt=ht.fx.environment.bootstrapAuthorizationKey;t.updateAuthState=wt;t.writeAuthState=bt;t.createOAuthTokenProvier=kt;t.createSecurityTokensManager=dt;it=(function(){function n(){}return n.prototype.getToken=function(n,t,r,u){var e={extensionName:n,resourceName:r,tenant:t,portalAuthorization:u},o=k.start({source:"Services.SecurityTokens",action:"Get",name:n}),f;return Q(p.postJSON({uri:lt,dataType:"json",setAuthorizationHeader:!1,performRetry:!0},e)).catchError(i.Errors.AjaxError,(function(t){return f="Failed to get tokens for extension '{0}' resource '{1}'. {2} {3} {4}".format(n,r,t.jqXHR.status,t.textStatus,t.errorThrown),Q.reject(t)})).finally((function(){k.endTrace(o,!f,f||r)}))},n})();a=(function(){function n(n,t){var r=this._refreshToken=t.refreshToken,i;this._pendingAuthorization=Q.resolve(r);this._client=n;i=this._user=t.user;this._tenant=i&&i.tenantId}return n.prototype.getToken=function(n,t){var i=this;return this._pendingAuthorization.
then((function(r){var u=i._client.getToken(n,i._tenant,t||o,r).catch((function(n){var i=n.data||{},t=i.status,u;return u=t===401?c:t?g:vt,{portalAuthorization:r,value:{authHeader:null,expiresInMs:0,refreshToken:null,error:u,errorMessage:"code: {0}, statusText: {1}, message: {2}, stack: {3}".format(t,i.statusText,n.message,n.stack||"")}}}));return i._pendingAuthorization=u.then((function(n){return i._refreshToken=n.portalAuthorization||r})),u}))},n.prototype.getRefreshToken=function(){return this._refreshToken},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n})();t.OAuthTokenProviderImpl=a;rt=(function(){function n(n){this._token=n.oAuthToken;this._user=n.user}return n.prototype.getToken=function(){return Q.resolve({value:this._token,portalAuthorization:""})},n.prototype.getRefreshToken=function(){return""},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n})();v=(function(){function n(n,t,i,r){this._extensionTokenSettings={};this._sessionEnded=!1;this._hubsWindowId=
h.getHubsWindowId();this._tokenProvider=t;this._rpcClient=n;this._sessionEndedHandler=i;this._tokenFailedHandler=r}return n.prototype.initializeSecurityForShell=function(n){var t=n||{},i=t.oAuthToken,f=t.refreshToken,r=t.createdOn||l(),u=f?this._createShellTokenFunc(i,r):gt(i,r,this._sessionEndedHandler);return this._enableShellTokenAccess(),p.initialize(u),u},n.prototype.registerGetAuthorizationTokenEndpoint=function(n){var t=this;this._extensionTokenSettings=i.convertArrayToMap(n,(function(n){var t=n.cloudName;return tt({name:n.name.toLowerCase(),cloudName:t?t.toLowerCase():undefined},{forceCloudName:!0}).toLowerCase()}),(function(n){return n.tokenSettings}));this._enableShellTokenAccess();h.getAuthorizationTokenEndPoint.register(this._rpcClient,null,(function(n,i){var r,u=n.cloudName;return r=i.srcWindowId===t._hubsWindowId?tt({name:w,cloudName:u},{forceCloudName:!0}):i.srcWindowId,t._getSecurityToken(u,r,n.resourceName||o,n.isBackground)}))},n.prototype.getDiagnosticsData=function(){return this.
_tokenProvider.getDiagnosticsData()},n.prototype._getSecurityToken=function(n,t,i,r){var f=this,h=t.toLowerCase(),e=this._extensionTokenSettings[h],u=this._shellTokenCache;return i&&e&2?Q({error:at}):this._sessionEnded?Q({error:nt}):u&&!i&&e&1?u.getToken({cloudName:n,resourceName:""}).then((function(n){return{token:n}})):this._tokenProvider.getToken(t,i,r).then((function(e){var y=l(),h=e&&e.value||{},a=h?h.error:yt,k=h.errorMessage,p,v,tt,it,b;return!a&&h.authHeader?{token:{header:h.authHeader,expiresAt:y+h.expiresInMs}}:(p=a===c,(a===nt||p)&&(f._sessionEnded=!0,v=void 0,p||!u?v=y:(tt=t===s?i:o,v=u.getTokenExpiresAt(n,tt)),f._sessionEndedHandler(t,v||y)),r||(it=!i&&(t===s||t===w),f._tokenFailedHandler(t,it),b="Failed to get token for {0} & {1}. Error:{2}. Message:{3}".format(t,i,a,k),a===g?d.error(b):d.verbose(b)),{error:a,errorMessage:k})}))},n.prototype._createShellTokenFunc=function(n,i){var u=this,f={},r,e;return n&&(r=n.expiresInMs||1,f[o]={header:n.authHeader,expiresAt:r>0?i+r:-1}),e=
this._shellTokenCache=ot.createAuthTokenCache((function(n){return u._getSecurityToken(n.cloudName,s,n?n.resourceName:o,n.isBackground).then((function(i){var e=(i||{}).token,s;if(!!e&&n.resourceName===o){var r=t.authState||{},h=l(),f=r.oAuthToken||{};f.authHeader=e.header;f.expiresInMs=e.expiresAt-h;s=u._tokenProvider.getRefreshToken();s&&(f.refreshToken=s);r.createdOn=h;r.oAuthToken=f;t.authState=r}return i}))}),f),function(n){return e.getToken(n).then((function(n){return n&&n.header}))}},n.prototype._enableShellTokenAccess=function(){this._extensionTokenSettings[s]=0},n})();t.SecurityTokensManagerImpl=v}));define("MsPortalImpl/Services/Services.SharedSettings",["require","exports","i"],(function(n,t,i){"use strict";var r;return (function(n){function o(){u.getSharedSettingsEndPoint.register(f.client,null,(function(){return r()}))}function r(){return Q.fcall((function(){return{links:{accountPortal:t.accountPortal,classicPortal:t.classicPortal,createSupportRequest:t.createSupportRequest,helpAndSupport:
t.helpAndSupport,manageSupportRequests:t.manageSupportRequests,giveFeedback:t.giveFeedback,privacyAndTerms:t.privacyAndTerms,learnRelatedResources:t.learnRelatedResources,resourceGroupOverview:t.resourceGroupOverview}}}))}var u=i.Extension,f=i.Rpc,e=window,t=e.fx.environment.links;n.initializeRpc=o;n.getSharedSettings=r})(r||(r={})),r}));define("MsPortalImpl/Services/Services.ShellProvisioner",["require","exports","f","i","MsPortalImpl/Extension/Extension.Definition.Locator"],(function(n,t,i,r,u){"use strict";var f;return (function(t){function y(n){return h||(h=new o(n.desktop,n.rpcClient))}var c=u.Locator,f=r.Extension,l=f.CloudName,e=r.ViewModels.ParameterCollectionV3,a=i.Base,v=a.Diagnostics,s,h,o;t.promiseCleanupDelay=3e4;s=v.createLog(n);t.create=y;o=(function(){function n(n,t){this.provisioningPromisesLookup={};this._desktopManager=n;this._registerRpcCallbacks(t)}return n.prototype.processProvisioningRequest=function(n,r){var f=this,h=!0,e="Provisioning request is ",u,o,s;if(!n)throw new
Error(e+" undefined.");if(u=n.provisioningRefKey,!u)throw new Error(e+"missing the provisioningReferenceKey.");if(!n.provisioningPromise)throw new Error(e+"missing the provisioningPromise.");if(!i.isFeatureEnabled("removecreatepin")&&n.startboardInfo){if(this.provisioningPromisesLookup[u])throw new Error("Provisioning promise already exists with the same key.");this.provisioningPromisesLookup[u]={promise:n.provisioningPromise,wasAcquired:!1,data:undefined};o=function(n){f.provisioningPromisesLookup[u].data=n};n.provisioningPromise.progress(o).then(o).finally((function(){setTimeout((function(){f.provisioningPromisesLookup[u]&&!f.provisioningPromisesLookup[u].wasAcquired&&f._logWarning("Provisioning operation with ref key "+u+" wasn't aquired by the provisioning part. Deleted at "+new Date+".");delete f.provisioningPromisesLookup[u]}),t.promiseCleanupDelay)}));this._addProvisioningPart(n,r)}else n.provisioningPromise.catch((function(n){var t=(n||{}).error||n;f._logWarning("Provisioning promise rejected. "+
(t.message||JSON.stringify(t)))})),n.provisioningConfig&&!!n.provisioningConfig.dontDiscardJourney&&(h=!1);return h&&(s=this._desktopManager.getActiveJourney(),s&&this._desktopManager.forceDiscardJourney(s.id)),n.provisioningPromise},n.prototype._addProvisioningPart=function(n,t){this._desktopManager.addPartToStartBoard({originPartLocator:c.forExtension(n.startboardInfo.provisioningPart.extension,t).withPartType(n.startboardInfo.provisioningPart.name),model:l.addToModel(t,{initialData:{provisioningConfig:n.provisioningConfig,provisioningRefKey:n.provisioningRefKey,startboardPart:n.startboardInfo.startboardPart}}),initialSize:2})},n.prototype._registerRpcCallbacks=function(n){var t=this;e.initiateProvisioningRequestEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(i,r){var s,u=r.srcWindowId,o;return(s=u!==f.getHubsWindowId()?f.getDescriptor(u).cloudName:i.cloudName,o="Can't initiate the provisioning request. ",!i.provisionerId)?Q.reject(o+"provisionerId unspecified."):
i.provisioningRefKey?(e.getProvisioningRequestEndPoint.acquireObject(n,u,i).then((function(n){var i=n.getValue();t.processProvisioningRequest(i,s).finally((function(){n.dispose()}))}),(function(n){throw new Error(n);})),Q(i)):Q.reject(o+"provisioningRefKey unspecified.")}});e.getProvisioningOperationEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){if(!n)return Q.reject("Can't return provisioning operation. provisioningRefKey unspecified.");var i=t.provisioningPromisesLookup[n],r=i&&i.promise;return r&&(t.provisioningPromisesLookup[n].wasAcquired=!0),Q({provisioningPromise:r,data:i&&i.data})}})},n.prototype._logWarning=function(n){s.warning(n)},n})();t.ShellProvisionerImpl=o})(f||(f={})),f}));define("MsPortalImpl/Services/Services.TelemetrySharing",["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";function c(n){return o.registerExtensionUnloadCallback(n),o}u.defineProperty(t,"__esModule",{value:!0});var s=i.Base,e=s.Constants,f=r.Rpc,
h=(function(){function n(){var n=this;this._extensions={};f.client.registerRpcEndPoint(e.TelemetrySharing.RegisterExtension,{allowedOrigin:null,handler:function(){n._extensions[f.messageContext.srcWindowId]=!0}})}return n.prototype.registerExtensionUnloadCallback=function(n){var t=this;n.onUnload((function(n){var i=r.Extension.getWindowId(n);return t._extensions[i]&&delete t._extensions[i],!0}))},n.prototype.trace=function(n){var t=n.extension,i=n.data&&n.data.srcExtension,r=e.TelemetrySharing.TraceTelemetry;this._extensions[t]&&f.client.invokeRpc(r,t,n);t!==i&&this._extensions[i]&&f.client.invokeRpc(r,i,n)},n.prototype.flush=function(){return i.Helpers.Deferred().resolve().promise()},n})(),o=new h;t.getProcessor=c}));define("MsPortalImpl/Services/Services.Util",["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";function l(n,t){var i="./Services.UtilHandlers";f(e.pinParts,i,"pinPartsRpcHandler",n,{desktop:t});f(e.getHmacSha256,i,"hmacShaRpcHandler",n);f(h,i,"x509CertificateRpcHandler",
n);f(c,i,"getPublishingProfileRpcHandler",n,null,[s.DefaultCloudName+"/"+o.ClassicResources,"fx"])}function f(t,r,u,f,e,o){return f.registerRpcEndPoint(t,{allowedOrigin:o,handler:function(t,f,o){return i.require(n.normalize(r)).then((function(n){var i=n[u];return i(t,f,o,e)}))}})}u.defineProperty(t,"__esModule",{value:!0});var e=r.Constants.RpcMethods,o=i.Base.Constants.ExtensionNames,s=i.Base.Constants,h="MsPortalFx.Internal.Constants.RpcMethods.X509Certificate.getX509Certificates",c="MsPortalFx.Internal.Constants.RpcMethods.PublishingProfile.getPublishingProfile";t.registerEndpoints=l}));define("MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder",["require","exports","f","o","ko","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function d(n,t){var i=n.parent&&n.getPartsContainer(),f=function(
n){if(i&&i.getCompatibleSourceReferences){var t=i.getCompatibleSourceReferences(n);return t&&t[0]}},u,r;return t=t||[],u=n.overridesModel,r=[],t.forEach((function(n){var i=n.name,t;t=e.getModelValue(u,i).exists?null:f(n);r.push(s(n,t))})),r}function a(n){if(n.adapter){var i=v(n),t={},r=y(n,!1);return r.forEach((function(n){var r,f=n.compositionBindingDefinition,u=f&&f.source,e;u&&u.modelType===l&&(e=u.property,r=i[e]);r||(r={bindingSources:[],activeBindingSourceName:null});t[n.targetProperty]=r})),t}return v(n)}function g(n,t,i){function f(f,s){var y,b,l,v;t&&o.CompositionBinder.turnOnInputsSetSuppressionOn(t);o.CompositionBinder.turnOnInputsSetSuppressionOn(i);try{var k=f.inputs,p=f.settings,d=f.inputsMetadata,w=n.getSettingsModel(),c=n.partDefinition&&n.partDefinition.partState,g=c?(c.inputIdentityProperties||[]).concat((c.sharedProperties||[]).map((function(n){return n.property}))):[],it=r.keys(p);g.forEach((function(n){var r=u.unwrap(e.getModelValue(w,n).value),t=n.startsWith("content.")?
n.slice(8):n,i=u.toJS(e.getModelValue(p,t).value);h(i,r)||(e.setModelValue(w,n,i),y=!0);it.remove(t)}));l=a(n);r.keys(l).forEach((function(t){var i=l[t],r=d[t],u=k[t];tt(n,t,i,r.activeBindingSourceName,u)&&(b=!0)}));b&&(n.widgetState.valueHasMutated(),nt(n),n.save())}finally{return v=(y?2:1)|(s?0:4),Q.all([t&&Q(o.CompositionBinder.turnOnInputsSetSuppressionOff(t,v,!0))||Q(),Q(o.CompositionBinder.turnOnInputsSetSuppressionOff(i,v,!0))])}}n.getViewModel().internal.updateConfigFn(f)}function nt(n){var t=n.widget;t&&t.element.trigger(f.fxpartinputchanged,{part:n})}function s(n,t){var r=n,i=n,e=i.targetProperty||r.name,o=!!n.optional,u;return t||(u=i.source&&i.source.property||r.name,t=f.createOverridesOrContainerModelSourceReference(u)),{targetProperty:e,optional:o,source:t,isDynamicBinding:!0}}function v(n){var t=n.parent&&n.getPartsContainer(),i=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,o=function(n){var u,r;return i&&t&&t.getCompatibleSourceReferences&&(r=i.first(
(function(t){return t.name===n})),r&&(u=t.getCompatibleSourceReferences(r))),(u||[]).map((function(n){return{sourceReference:n,name:n.property,acceptsValueUpdates:!1}}))},r=n.overridesModel,s=function(n){if(!n||f.isDynamicBindingWithNonLocalSource(n))return!1;var t=n.source&&n.source.property;return r&&t&&e.getModelValue(r,t).exists},u={},h=y(n);return h.forEach((function(n){var r=n.targetProperty,f=o(r),t=n.compositionBindingDefinition,i=t&&t.source,e=!s(t)&&i&&(f||[]).first((function(n){var t=n.sourceReference;return t.modelType===i.modelType&&t.property===i.property}));u[r]={bindingSources:f,activeBindingSourceName:e&&e.name}})),u}function y(n,t){return t===void 0&&(t=!0),n.getNonDetailsContainerPropertyBindings(t).filter((function(n){var t=n.targetProperty;return!b.isBladeCallerInput(t)&&t!==p.EditScopeId}))}function tt(n,t,i,r,f){var y=r&&i.bindingSources.first((function(n){return n.name===r})),p,a,b,d,rt,ut,w,it;if(r&&!y){c.error("Source with name '{0}' for configurable Part input named '{1}' does not exist at the Dashboard/Blade-level.".
format(r,t));return}if(p=n.getInputPropertyBindings(),a=p.properties.first((function(n){return n.targetProperty===t})),y?(rt=i.activeBindingSourceName,y.name!==rt&&(b=!0)):(ut=u.unwrap(e.getModelValue(a.targetModel,a.targetProperty).value),h(u.toJS(f),ut)||(d=!0)),!(b||d))return!1;if(n.adapter){var ft=n.bindings.first((function(n){return n.targetProperty===t})),g=ft&&ft.source,et=g&&g.modelType===l&&g.property;if(et)w=et;else return c.error("For Adapted Part '{0}', input named '{1}' to the inner Part is not configurable.  Presently, only those inner Part inputs using the 'AdapterInput' binding are configurable.".format(n.toString(),t)),!1}else w=t;var nt=n.adapter?n.adapter.inputPropertyBindings:n.getInputPropertyBindings(),tt=nt.properties.first((function(n){return n.targetProperty===w})),ot=tt.compositionBindingDefinition,st=n.overridesModel,v;if(b){var ht=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,ct=ht.first((function(n){return n.name===w})),lt=y.sourceReference;
v=s(ct,lt)}return d&&(e.setModelValue(st,tt.sourceProperty,u.toJS(f)),v=s(ot)),v&&(nt.removeProperty(tt),it=n.adapter?n.adapter.bindings:n.bindings,k(it,ot),o.CompositionBinder.setupPropertyBindings(n,nt,[v],(function(t){return n.bindAgainstOverridesOrContainerModel(t)})),it.push(v),n.adapter&&(p.removeProperty(a),o.CompositionBinder.setupPropertyBindings(n,p,a&&[a.compositionBindingDefinition],(function(t){return n.bindAdaptedInput(t)})))),!0}var p=i.Base.Constants.BladeParameterNames,w=i.Base.Diagnostics,b=i.ViewModels.Internal,k=i.remove,h=i.deepEquals,c=w.createLog(n),l=9;t.inferInitialBindingsForInputDefinitions=d;t.getConfigurableInputsMetadata=a;t.listenForConfigurationChanges=g})(s||(s={})),s}));define("MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration",["require","exports","o","ko","MsPortalImpl/ViewModels/ViewModels.BladeCaller"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function e(n,t,u){var e=t.internal,f=r.observableArray([]);f.map(n,(function(n,t)
{r.ignoreDependencies((function(){o(n,t,e,u)}))}));r.computed(n,e.registeredSelectables,(function(n){n===void 0&&(n={});f.splice.apply(f,[0,f.peek().length].concat(i.keys(n)))})).extend({deferred:!0})}function o(n,i,e,o){var l=o.getBladeOpener(),h={invocationInputArguments:[{valuesFrom:[{referenceType:0,property:t+"."+i}]}]},c=r.unwrap(e.registeredSelectableOptions),s;c&&(s=c[i],s&&(s.parameterCollector&&u.addCallerBindings(f+"."+i+".parameterCollector.bladeCaller",h,0),h.openInContextPane=s.openInContextPane,h.persistentContextPane=s.persistentContextPane));l.registerInvocationProperty(h,null,n)}var t="internal.registeredSelectables",f="internal.registeredSelectableOptions";n.listenForRegistrationChanges=e})(f||(f={})),f}));define("MsPortalImpl/UI/Hubs/UI.FavoritesManager",["require","exports","f","i","o","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/UI/Hubs/UI.BrowseManager","MsPortalImpl/UI/Hubs/UI.NotificationManager"],
(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function dt(n,t,r,u){var e=f.computed(n,t,i.identity),o;e.extend(et);o=e.subscribe(n,r);u&&o.callback(e())}function ot(n,t){var r=(t||"").toLowerCase(),i=n.assetTypeManifest.resourceType;return(t&&i&&i.kinds||[]).first((function(n){return n.name.toLowerCase()===r}))}function p(n,t,i,r){i===w.BrowseResourceGroupBlade&&(i=w.ResourceGroups);var u=b.getWindowId({name:t,cloudName:n},{forceCloudName:!0});return vt.getAssetTypeOrResourceTypeIdByWindowId(u,i)+(r?"."+r.toLowerCase():"")}function st(n,t){return t&&(t.serviceDisplayName||t.pluralDisplayName||tt.assetPlusKindFormat.format(n.compositeDisplayName.service,t.name))||n.compositeDisplayName.service}function ht(n,t){return t&&t.icon||n.icon}function ct(n,t){return t&&t.keywords||n.assetTypeManifest.keywords}function gt(n,t){return d(n.cloudName,t.cloudName)&&n.extensionName===t.extension&&n.assetType===t.assetTypeManifest.name}function lt(n,t,i){var e,r,u=t.indexOf("."),f;return u>0&&(r=t,t=r.substring(
0,u),e=r.substring(u+1)),f=n.first((function(n){return n.id===t})),f&&g(f,e,i,[],r)}function ni(n,t,i){var o=[],r=[[],["Microsoft_AAD_IAM_AzureActiveDirectory","Microsoft_Azure_Monitoring_AzureMonitoring","Microsoft_Azure_Security_SecurityDashboard","Microsoft_Azure_Billing_Billing","Microsoft_Azure_Support_HelpAndSupport",],["Microsoft_Azure_Expert_AzureAdvisor",],["HubsExtension_Dashboard",],],u;if(i&&n.version()<r.length-1){var f=n.favorites,s=f().toLowerCase(),e=l(f()),h=function(n){r[n].forEach((function(t){var i=t.toLowerCase();s.indexOf(i)<0&&(n===3?e.unshift(t):e.push(t),o.push(t))}))};for(u=(n.version()||0)+1;u<r.length;u++)h(u);f(y(e))}t(o);n.version(r.length-1)}function g(n,t,i,r,u){var o=n.assetTypeManifest,e=ot(n,t),s=st(n,e),h=n.id.toLowerCase(),c=!!k(r,(function(n){return n.toLowerCase()===h}));return{id:u||n.id,image:ht(n,e),isFavorite:f.observable(!1),isHome:f.observable(!1),opensDashboard:o.name===w.Dashboard&&n.extension===a.ExtensionNames.Hubs,isFilteredOut:f.observable(!1),
isHidden:f.observable(c),label:f.observable(s),labelId:f.observable(s.replace(rt,"")),keywords:ct(n,e),matches:f.observable(),uri:i.assetTypeService.getAssetTypeDeepLink(n,t),opensExternal:o.browseType===3,cloudName:b.normalizeCloudName(n.cloudName),isPreview:n.isPreview,assetType:n,kind:t}}function ti(n){var t=[];return n.forEach((function(n){t=i.union(t,(n.associated||[]).map((function(n){return p(n.cloudName||v,n.extensionName,n.assetType,n.kind)})))})),t}function ii(n,t){return new at(n,t)}var et,at;u.defineProperty(t,"__esModule",{value:!0});var nt=i.Base,a=nt.Constants,w=a.AssetNames,b=r.Extension,vt=r.Assets,yt=i.Hubs.Notifications.NotificationStatus,pt=nt.Diagnostics,tt=e.Favorites,it=tt.Notification,ri=pt.createLog(n),v=a.DefaultCloudName,l=JSON.parse,y=JSON.stringify,wt="uncurated",rt=/\s+/g,k=i.find,ut=i.stableSort,d=b.isEqualCloudName,ft=h.compareAssetTypeForSort,bt=i.isFeatureEnabled("userdefineddefaultview"),kt={};r.getAssetTypeMappingData=function(){return kt};et={deferred:!0};
t.connectDebouncedObservable=dt;t.calculateHiddenAssetTypes=ti;t.createFavoritesManager=ii;at=(function(){function n(n,t){var i=this;this.categories=f.observableArray();this.categoriesLookup={};this.showCategories=f.observable(!1);this.possibleFavorites=f.observableArray();this.possibleFavoritesLookup={};this.favorites=f.observableArray();this.selectedCloud=f.observable();this._notificationsForItems=f.observable();this._extensionToDefaultCategoryMap={};this._missingFavoritesWithIndex={};this._hiddenAssetTypes=[];this._cloudNames=[];this._assetTypesPerCloudMap=r.getCloudMap();this._assetTypesForSelectedCloud=f.observable();this._favLoaded=!1;this._initialFavorites=[];this._categoriesInitialized=!1;this.remove=function(n){var t=i._savedFavorites().length&&l(i._savedFavorites())||[],r=t.indexOf(n);r!==-1&&(t.splice(r,1),i._savedFavorites(y(t)))};this.add=function(n){var t=l(i._savedFavorites())||[],r=t.indexOf(n);r===-1&&(t.push(n),i._savedFavorites(y(t)))};this.move=function(n){var t=l(i.
_savedFavorites())||[],r=i.favorites()[n],u=t.indexOf(r.id);t.splice(n,0,t.splice(u,1)[0]);i._savedFavorites(y(t))};this._services=t;this._savedFavorites=f.observable("");this._ltm=n.createChildLifetime()}return n.prototype.initializeFavorites=function(n,t){var r=this,s=this._savedFavorites=n.favorites,y=s&&s().length,c;if(this._cloudNames=o.getCloudNames(),y?(i.isFeatureEnabled("skipfavoritesupgrade")||ni(n,this._notificationsForItems,y),this._initialFavorites=l(s())):this._cloudNames.forEach((function(n){r._initialFavorites.push(p(n||v,a.ExtensionNames.Hubs,w.Dashboard,undefined))})),!bt)return this._registerDependency(),this.loadFavorites();var h=i.find(this._initialFavorites,(function(n){return t.some((function(t){t.name===a.ExtensionNames.Hubs&&(t={name:t.name,cloudName:r._cloudNames[0]});var u=b.getWindowId(t,{forceCloudName:!0});return i.startsWith(n,u+"_")}))})),u=Q.defer(),e=f.observable(!1),k=this._ltm.createChildLifetime();return u.promise.finally((function(){k.dispose()})),this.favorites.
subscribeAndRun(k,(function(){h&&(!r.favorites().length||r.favorites()[0].id!==h||e())||e(!0)})),this._registerDependency(),f.reactor(this._ltm,[this._assetTypesForSelectedCloud,e],(function(n,t){n&&n.length&&!r._favLoaded&&(r.loadFavorites().catch((function(n){return Q.isPending(u.promise)&&u.reject(n),Q.reject(n)})),t=e());Q.isPending(u.promise)&&r._favLoaded&&t&&u.resolve()})),c=3e4,u.promise.timeout(c,new Error("initializeFavorites timeout trying to find "+h+". Timeout: "+c))},n.prototype.initializeCategories=function(){var n=this,t=this._curationPromise||s.getBrowseCuration();return this._categoriesInitialized=!0,t.then((function(t){var h,u;n._discoveryPolicy=t.discoveryPolicy||0;var e=function(t,i){var r={id:t,showLabel:f.observable(!0),isFilteredOut:f.observable(!1),isHidden:f.pureComputed((function(){var t=n.selectedCloud();return!r.possibleFavorites().some((function(n){return!n.isHidden()&&!n.isFilteredOut()&&d(n.cloudName,t)}))})),label:o.provideCategoryName(t),count:f.observable(0),possibleFavorites:
f.observableArray(),sourceCategory:i};return r},s=t.categories||[],r=s.map((function(n){return e(n.id,n)}));r&&r.length&&(h=n._uncuratedCategory=e(wt),r.push(h));n.categories(r);n.possibleFavorites().forEach((function(t){var r=ot(t.assetType,t.kind),u=t.assetType,f=st(u,r);t.label(f);t.labelId(f.replace(rt,""));t.image=ht(u,r);t.keywords=ct(u,r);t.isHidden(t.isHidden()&&!!i.find(n._hiddenAssetTypes,(function(n){return n===t.id})))}));u={};s.forEach((function(t){(t.discoveryExtensions||[]).forEach((function(i){u[i]=k(r,(function(n){return n.id===t.id}))||n._uncuratedCategory}))}));n._extensionToDefaultCategoryMap=u;n._loadFlyoutMenu()}))},n.prototype.loadFavorites=function(){var n=this,t=this._savedFavorites&&this._savedFavorites().length&&l(this._savedFavorites())||[],i=[],f=this._services.assetTypeService.allManifestsLoaded(),r,u;return(this._favLoaded=!0,r=function(t,r){var u=lt(n._assetTypesForSelectedCloud(),t,n._services);u?(u.isHome(!r),u.isFavorite(!0),i.push(u)):n._missingFavoritesWithIndex[
t]=r},u=function(){var t=n._notificationsForItems()||[],r=t.slice(0);t.forEach((function(n){var t=k(i,(function(t){return n===t.id})),u,f;t&&(u=it.titleFmt.format(t.label()),f=t.assetType.assetTypeManifest||{},c.getNotificationManager().addClientNotification({title:u,description:it.Description[(f.name||"").toLowerCase()]||u,status:yt.Information,timestamp:new Date,cloudName:v,uri:t.uri}),r.remove(n))}));n._notificationsForItems(r);n.favorites(i)},t.length)?(t.forEach((function(n){n&&r(n,t.indexOf(n))})),u(),Q()):(this._curationPromise=s.getBrowseCuration()).then((function(t){var i=n._initialFavorites;t.favorites.forEach((function(n){var t=p(n.cloudName||v,n.extensionName,n.assetType,n.kind);i.push(t)}));n._initialFavorites.forEach((function(n){r(n,i.indexOf(n))}));n._savedFavorites(y(i));u()}))},n.prototype.dispose=function(){var n=this._ltm;n&&n.dispose();this._ltm=null},n.prototype._registerDependency=function(){var n=this,i=this._ltm,t,r;this._assetTypesForSelectedCloud(this._assetTypesPerCloudMap.
get(this.selectedCloud())||[]);this.selectedCloud.subscribe(i,(function(t){n._assetTypesForSelectedCloud(n._assetTypesPerCloudMap.get(t)||[]);n._assetTypesForSelectedCloud().length&&(n.possibleFavorites([]),n.possibleFavoritesLookup={},n.loadFavorites(),n._loadFlyoutMenu())}));t=this._services.browseManager;r=t.registerAssetTypesUpdateCallback((function(){n._createPerCloudAssetTypes();n._assetTypesForSelectedCloud(n._assetTypesPerCloudMap.get(n.selectedCloud())||[]);n._updateFavorites(n._assetTypesForSelectedCloud());n._categoriesInitialized&&n._loadFlyoutMenu()}));i.registerForDispose((function(){t.unregisterAssetTypesUpdateCallback(r)}))},n.prototype._createPerCloudAssetTypes=function(){var t=this,n=this._services.browseManager.getFilteredAssetTypes()||[];n.length&&this._cloudNames.forEach((function(i){var r=n.filter((function(n){return d(n.cloudName,i)}));t._assetTypesPerCloudMap.set(i,r)}))},n.prototype._updateFavorites=function(n){var t=this;i.forEachKey(this._missingFavoritesWithIndex,(function(
i,r){if(r!==-1){var u=lt(n,i,t._services);u&&(u.isHome(!r),u.isFavorite(!0),t.favorites.splice(r,0,u),t._missingFavoritesWithIndex[i]=-1)}}))},n.prototype._addBrowseMenuItem=function(n,t){var u=p(n.cloudName,n.extension,n.assetTypeManifest.name,t),i=g(n,t,this._services,this._hiddenAssetTypes,u),r;this.possibleFavoritesLookup[u]||(this.possibleFavorites().push(i),r=this.favorites().first((function(n){return n.id===i.id})),r&&(i.isFavorite=r.isFavorite,i.isHome=r.isHome),this.possibleFavoritesLookup[i.id]=i)},n.prototype._addBrowseMenuItemToCategory=function(n,t,i,r,u){var s=p(n.cloudName,n.extension,n.assetTypeManifest.name,i),e=g(n,i,this._services,this._hiddenAssetTypes,s),o,f;u.some((function(n){return n.id===s}))||(f=this.possibleFavoritesLookup[e.id],f&&(e.isFavorite=f.isFavorite,e.isHome=f.isHome,o=e.isHidden=f.isHidden,o(o()||r)),u.splice(t,0,e));r&&(f=this.possibleFavorites().filter((function(n){return n.id===e.id}))[0],f&&f.isHidden(r))},n.prototype._loadFlyoutMenu=function(){var n=this,
f=this.possibleFavoritesLookup,t,i,r,e,o;this._assetTypesForSelectedCloud().forEach((function(t){n._addBrowseMenuItem(t,undefined)}));t=this.categories();this.showCategories(!!t.length);i=u.keys(f).slice(0);t.forEach((function(t){var u=t.possibleFavorites;u();var f=t.sourceCategory,e=f&&f.items||[],r=[];e.length&&(e.forEach((function(t,u){var f=-1,e,o;n._assetTypesForSelectedCloud().some((function(n){var i,r,s;return t.cloudName=t.cloudName||v,gt(t,n)&&(i=n.assetTypeManifest.resourceType,r=(t.kind||"").toLowerCase(),r&&(s=(i&&i.kinds||[]).some((function(n){return n.name.toLowerCase()===r})),s&&(o=t.kind)),f=u,e=n),f>-1}));f>-1&&(o&&n._addBrowseMenuItem(e,o),i.remove(e.id),n._addBrowseMenuItemToCategory(e,f,o,!!t.isHidden,r))})),u(r),t.count(r.filter((function(n){return!n.isHidden()})).length))}));r=this._uncuratedCategory;e=[];r&&(o=ut(i.map((function(n){return f[n]})),(function(n,t){return ft(n.label(),t.label())})),o.forEach((function(t){var o=t.assetType,u=n._extensionToDefaultCategoryMap[o.extension],
s=u||r,h=!u&&n._discoveryPolicy===1,f,i;n.possibleFavorites().filter((function(n){return n.id===t.id}))[0].isHidden(h);f=s.possibleFavorites;i=[];i=u?f():e;n._addBrowseMenuItemToCategory(o,i.length,undefined,h,i);f(i);s.count(i.length)})));this.possibleFavorites(ut(this.possibleFavorites(),(function(n,t){return ft(n.label(),t.label())})))},n})()}));define("MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks",["require","exports","i","FxHubs/HubsSettingsSchema"],(function(n,t,i,r){"use strict";var u;return (function(n){function t(n,t,i){var r={store:i?0:6,keys:t};return n.querySettings(r).then((function(n){var i={};return t.forEach((function(t){i[t]=t in n?n[t]:undefined})),i}))}function u(n,t,i){n.setSettings({store:6,settings:t},i)}function f(n){var f=n.settings,e=n.rpcClient,o=[i.Extension.getHubsWindowId()];r.readHubsUserSettings.register(e,o,(function(n){return t(f,n.settingsKeys,n.useShellGeneralStore)}));r.writeHubsUserSettings.register(e,o,(function(n){return u(f,n.settings,n.priority),undefined}))}n.registerRpcCallbacks=
f})(u||(u={})),u}));define("MsPortalImpl/UI/Hubs/UI.NotificationsPane",["require","exports","f","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var t=i.Hubs.Notifications.NotificationStatus,e=u.NotificationMenu,o=[t.Information,t.Warning,t.Error,t.Success],s=[t.Information],h=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.hasNotifications=r.pureComputed((function(){return t.notifications&&(t.notifications()||[]).length})),t.lastPaneOpenedTime=r.observable(Date.now()),t.isPaneOpen=r.observable(!1),t.dismissOptions=[{name:e.informational,dismissableStates:s,isEnabled:r.pureComputed((function(){return t._checkNotificationsState(s)}))},{name:e.completed,dismissableStates:o,isEnabled:r.pureComputed((function(){return t._checkNotificationsState(o)}))},{name:e.all,dismissableStates:null,isEnabled:t.hasNotifications}],t}return __extends(t,n),t.prototype._checkNotificationsState=
function(n){return this.hasNotifications()&&this.notifications().some((function(t){return n.indexOf(t.status)>-1}))},t})(f.ViewModel);n.ViewModel=h})(e||(e={})),e}));define("MsPortalImpl/UI/Hubs/UI.ResourceMapManagerRpc",["require","exports","FxHubs/RpcEndPoints"],(function(n,t,i){"use strict";var r;return (function(n){function e(n,i){var e=r.getHubsWindowId(),f=function(n){return r.getDescriptor(n.srcWindowId).cloudName};r.mapAssetIdToResourceIdEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapAssetIdToResourceId(n,f(r))}))}));r.mapResourceIdToAssetIdEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapResourceIdToAssetId(n,f(r))}))}));u.mapResourceIdToAssetIdEndPoint.register(n,[e],(function(n){return i.getService(t).then((function(t){return t.mapResourceIdToAssetId(n.resourceId,n.cloudName)}))}));r.mapResourceIdToDynamicSelectionAndIconEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.
mapResourceIdToDynamicSelectionAndIcon(n.resourceId,f(r),{reason:"mapResourceIdToDynamicSelectionAndIcon",extension:r.srcWindowId})}))}));u.mapResourceIdToDynamicSelectionAndIconEndPoint.register(n,[e],(function(n,r){return i.getService(t).then((function(t){return t.mapResourceIdToDynamicSelectionAndIcon(n.resourceId,n.cloudName,{reason:"mapResourceIdToDynamicSelectionAndIcon",extension:r.srcWindowId})}))}));r.getResourceAssetInformationEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResourceAssetInformation(n,f(r),{reason:"getResourceAssetInformation",extension:r.srcWindowId})}))}));u.getResourceAssetInformationEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResourceAssetInformation(n.data,n.cloudName,{reason:"getResourceAssetInformationForHubs",extension:r.srcWindowId})}))}));r.getResourceEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResource(n.resourceId,n.skipCache,
f(r),{reason:n.invoker+":getResource",extension:r.srcWindowId})}))}));r.getResourceGroupEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResourceGroup(n.resourceGroupId,n.skipCache,f(r),{reason:n.invoker+":getResourceGroup",extension:r.srcWindowId})}))}));r.signalResourcesChangedEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return Q(t.signalResourcesChanged(n,f(r)))}))}));u.signalResourcesChangedEndPoint.register(n,null,(function(n){return i.getService(t).then((function(t){return Q(t.signalResourcesChanged(n.resourceIds,n.cloudName))}))}));u.mapAssetIdToResourceIdEndPoint.register(n,[e],(function(n){return i.getService(t).then((function(t){return t.mapAssetIdToResourceId(n.assetTriplet,n.cloudName)}))}));i.assetManager.onAssetDeleted((function(n,r,u){i.getService(t).then((function(t){t.processAssetDeletion(n,r,u)}))}))}var f=FxImpl,r=f.Extension,u=i.AssetTypes,t="ResourceMapManager";n.setupResourceMapManagerRpc=e})(r||(r={})),r}));
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration",["require","exports","f","i","o","MsPortalImpl/Extension/ViewModelManager"],(function(n,t,i,r,u,f){"use strict";function s(n){var s=e+"All.Part",t,u;f.registerWithState("Browse$BrowseAllBlade$ServicesListPartViewModel",s,(function(t,i){return o.composePartViewModel((function(r){return new t.ServicesListPartViewModel(r,i,n)}),{initialState:i,logArea:s})}));f.registerWithState("Browse$BrowseServiceBladeViewModel",e+"Service.Blade",(function(t,u){var f=new i.ViewModels.Internal.ContainerViewModel;return new r.ViewModels.CompositionViewModel(f,new t.BrowseServiceBladeViewModel(f,u,n),u)}));t=e+"Service.Part";f.registerWithState("Browse$BrowseServiceBlade$ServiceItemsListPartViewModel",t,(function(i,r){return o.composePartViewModel((function(t){return new i.ServiceItemsListPartViewModel(t,r,n)}),{logArea:t})}));u=e+"Service.PinnedPart";f.registerWithState("Browse$BrowseServiceTileViewModel",u,(function(t,i){return o.composePartViewModel(
(function(r){return new t.BrowseServiceTileViewModel(r,i,n)}),{createHubsInternalCloudNameProperty:!0,logArea:u})}))}u.defineProperty(t,"__esModule",{value:!0});var o=r.ViewModels.Part,e="./MsPortalImpl/UI/Hubs/ViewModels/UI.Browse";t.registerViewModels=s}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration",["require","exports","f","MsPortalImpl/Extension/ViewModelManager"],(function(n,t,i,r){"use strict";var u;return (function(n){function u(){r.register("Gallery$CsmCommand","./MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",(function(n){return new n.CsmCommand(t.DefaultCloudName)}))}var t=i.Base.Constants;n.registerViewModels=u})(u||(u={})),u}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration",["require","exports","f","i","MsPortalImpl/Extension/ViewModelManager"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function y(n){var i=u.registerWithState,h,r,c,y;i(l+"ViewModel",t+(f+"Blade"),(function(n,t){var i=new s,r=new n.SettingsBladeViewModel(
i,t);return new o(i,r,t)}));h=t+(f+"SettingsPart");i(l+"$SettingsPartViewModel",h,(function(t,i){return e((function(r){return new t.SettingsPartViewModel(r,i,n)}),{createHubsInternalCloudNameProperty:!0,logArea:h})}));i(a+"ViewModel",t+(f+"LanguageSelectionBlade"),(function(n,t){var i=new s,r=new n.LanguageSelectionBladeViewModel(i,t);return new o(i,r,t)}));r=t+(f+"LanguageGrid");i(a+"$LanguageGridViewModel",r,(function(n,t){return e((function(i){return new n.LanguageGridViewModel(i,t)}),{logArea:r})}));i(v+"ViewModel",t+(f+"LocaleSelectionBlade"),(function(n,t){var i=new s,r=new n.LocaleSelectionBladeViewModel(i,t);return new o(i,r,t)}));c=t+(f+"LocaleGrid");i(v+"$LocaleGridViewModel",c,(function(n,t){return e((function(i){return new n.LocaleGridViewModel(i,t)}),{logArea:r})}));y=t+(f+"DiagnosticsPart");i("Help$HelpAndSupportBlade$DiagnosticsPartViewModel",y,(function(t,i){return e((function(r){return new t.DiagnosticsPartViewModel(r,i,n)}),{logArea:r})}))}var c=r.ViewModels,o=c.CompositionViewModel,e=c.Part.
composePartViewModel,s=i.ViewModels.Internal.ContainerViewModel,t="./MsPortalImpl/UI/Hubs/ViewModels/",h="Settings$",l=h+"SettingsBlade",a=h+"LanguageSelectionBlade",v=h+"LocaleSelectionBlade",f="UI.Settings.";n.registerViewModels=y})(f||(f={})),f}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-formdialog{font-size:14px;border:1px solid;line-height:14px}.fxs-formdialog h2{font-size:110%}.fxs-formdialog .fxs-formdialog-description{margin-top:-10px}.fxs-formdialog .fxs-formdialog-form{margin:20px 0 0;padding:15px 25px;width:448px;max-width:calc(100% - 2 * 25px)}.fxs-formdialog .fxs-formdialog-buttons{margin-left:25px}.fxs-formdialog .fxs-formdialog-buttons>.fxc-simplebutton{margin-right:5px;margin-bottom:25px}.fxs-formdialog-header{border-bottom:1px solid;margin:0 25px;padding-bottom:10px}")}));define("MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog",
["require","exports","f","ko","$","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){var c=i.ViewModels.Controls.SimpleButton.ViewModel,w=i.ViewModels.Forms.Section,t=w.ViewModel,l=i.newGuid,a="fxs-formdialog",v="fxs-portal-bg-txt-br",y="fxs-popup",b="<div class='fxs-formdialog-header fxs-portal-border'><h2 data-bind='text: data.dialogOptions.title'><\/h2><div class='fxs-formdialog-description' data-bind='text: data.dialogOptions.description'><\/div><\/div><div class='fxs-formdialog-form msportalfx-form' data-bind='pcControl: func._formSection'><\/div><div class='fxs-formdialog-buttons'><div class='fxs-formdialog-okbutton' data-bind='pcControl: func._okButton'><\/div><div class='fxs-formdialog-cancelbutton' data-bind='pcControl: func._cancelButton'><\/div><\/div>",
k=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.okButtonText=r.observable(),t.cancelButtonText=r.observable(),t.onOkClick=u.noop,t.onCancelClick=u.noop,t}return __extends(t,n),t})(s.ViewModel),p;n.ViewModel=k;p=(function(n){function i(t,i){var r=n.call(this,t,i)||this;if(!i.dialogOptions)throw new Error("dialogOptions must be specified for rendering a form dialog.");t.addClass(a+" "+y+" "+v).html(b);var f=document.activeElement,u=r._dismissHandle={dismissFn:function(){r._cancelButton&&i.onCancelClick()},restoreFocus:function(){e.validatePreviousFocusedElement(u,f)&&f.focus()},logName:"formdialog"},s=new o.KeyboardNavigation(t,2);return e.register(u),r.ltm.registerForDispose((function(){s.dispose();e.unregister(u)})),r._initializeViewModels(),r._bindDescendants(),r._setAria(),r.setFocus(),r}return __extends(i,n),i.prototype.setFocus=function(){var n=this.element;h.waitForBindings(n[0]).finally((function(){var t=n.find("input:first");t.length===0&&(t=n.find(".fxs-formdialog-okbutton:first .fxs-button"));
setTimeout((function(){t.offsetParent()&&t.focus()}))}))},i.prototype.dispose=function(){this._cleanElement(a,y,v);n.prototype.dispose.call(this)},i.prototype._setAria=function(){var t="aria-labelledby",i="aria-describedby",n=this.element,r=l(),u=l();n.attr("role","alertdialog").attr(t,u).attr(i,r);n.find("h2").attr("id",u);n.findByClassName("fxs-formdialog-description").attr({id:r});this.ltm.registerForDispose((function(){n.removeAttr(["role",t,i].join(" "))}))},i.prototype._initializeViewModels=function(){var b=this,n=this.ltm,u=this.options,i=u.dialogOptions,l=3,e=0,o=new t(n,{style:r.observable(l),children:r.observableArray()}),s=new t(n,{style:r.observable(l),children:r.observableArray()}),a,v,y,p,h,w;i.row1column1&&(a=new t(n,{style:r.observable(e),children:r.observableArray([i.row1column1])}),o.children.push(a));i.row1column2&&(v=new t(n,{style:r.observable(e),children:r.observableArray([i.row1column2])}),o.children.push(v));i.row2column1&&(y=new t(n,{style:r.observable(e),children:r.
observableArray([i.row2column1])}),s.children.push(y));i.row2column2&&(p=new t(n,{style:r.observable(e),children:r.observableArray([i.row2column2])}),s.children.push(p));h=this._formSection=new t(n,{children:r.observableArray()});o.children().length&&h.children.push(o);s.children().length&&h.children.push(s);this._cancelButton=new c(n,{text:u.cancelButtonText,onClick:function(){u.onCancelClick()}});w=this._okButton=new c(n,{text:u.okButtonText,primary:!0,onClick:function(){f.ensureFormFieldValidation(b.element,!0).then((function(n){n&&u.onOkClick()}))}});r.computed(n,(function(){w.disabled(!h.valid())}))},i})(s.Widget);n.Widget=p})(c||(c={})),c}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-listpopup{display:inline-block;cursor:default;position:absolute;left:0;width:200px;max-height:300px;z-index:200;overflow-y:auto;box-sizing:border-box}.fxs-listpopup .fxs-listpopup-list{list-style-type:none;padding:0;max-height:300px}.fxs-listpopup .fxs-listpopup-item{font-size:12px;line-height:normal;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto;white-space:nowrap;text-overflow:ellipsis;position:relative;box-sizing:border-box;padding:0 10px;border:0;overflow:visible;text-align:left;height:35px;cursor:pointer}")})
);define("MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup",["require","exports","f","o","ko","$","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var b;r.defineProperty(t,"__esModule",{value:!0});var k=i.Base.Diagnostics,c=".fxs-commandBar-item",l="fxs-listpopup",d=k.createLog(n),a="fxs-portal-bg-txt-br",v="fxs-popup",y="fxs-listpopup-list",p="fxs-listpopup-item",w="."+p,g="<ul class='"+y+"' data-bind='foreach: func._items' role='menu'>"+("<li role='menuitem' class='"+p+" fxs-portal-hover' tabindex='-1'")+'data-bind=\'text: text, css: { "fxs-listpopup-item-selected fxs-portal-selected fxs-portal-activated fxs-br-primary": text === $root.data.dialogOptions.selectedItem() }, event: { click: onClick, keydown: onKeyDown}, attr: { title: text, "aria-setsize": $parent.func._items().length, "aria-posinset": $index() + 1, "aria-selected": text === $root.data.dialogOptions.selectedItem() }\'><\/li><\/ul>',
nt=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(h.ViewModel);t.ViewModel=nt;b=(function(n){function t(t,i){var r=n.call(this,t,i)||this;i.dialogOptions||d.error("dialogOptions must be specified for rendering a list popup.");var h=document.activeElement,p=function(n){return n===h||f.contains(h,n)?0:!(t[0]===n)&&!f.contains(t[0],n)?2:0},b=r._dismissHandle={dismissFn:function(){var n=i.onLostFocus;n&&n()},shouldDismissOnFocusOutFn:p,shouldDismissOnMouseDownFn:p,shouldDismissOnMouseWheelFn:p,restoreFocus:function(){e.validatePreviousFocusedElement(b,h)&&h.focus()},logName:"listpopup"};return r._items=u.computed(r.ltm,(function(){var n=function(n){typeof i.onItemSelected=="function"&&(i.dialogOptions.selectedItem(n),i.onItemSelected(),b.restoreFocus())};return i.dialogOptions.listItems().map((function(t){return{text:t,onClick:function(i,r){r.stopPropagation();n(t)},onKeyDown:function(i,r){if((r.keyCode===13||r.keyCode===32)&&o.getModifierKeys(
r)===0)r.stopPropagation(),n(t);else return!0}}}))})),t.addClass(l+" "+v+" "+a).html(g),r._keyboardNavigation=new s.KeyboardNavigation(t.find("."+y),12,w),t.closest(c).attr("aria-expanded","true"),r._bindDescendants(),Q.nextTick((function(){r.setFocus()})),e.register(b),r}return __extends(t,n),t.prototype.dispose=function(){e.unregister(this._dismissHandle);this._cleanElement(l,v,a);this._keyboardNavigation&&(this._keyboardNavigation.dispose(),this._keyboardNavigation=null);this.element.removeAttr("tabindex").closest(c).attr("aria-expanded","false");n.prototype.dispose.call(this)},t.prototype.setFocus=function(){this.element.find(w).first().focus()},t})(h.Widget);t.Widget=b}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-progressbox{color:#fff}")}));define("MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox",["require","exports","f","ko",
"MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var v=u.Dialogs.ProgressBar,e="fxs-progressbox",o="fxs-progressbox-text",y="<h2 data-bind='text: data.title' class='fxs-progressbox-title'><\/h2><div data-bind='text: data.text' class='"+o+"'><\/div><div data-bind='text: data.completionText' class='fxs-progressbox-progressbar'><\/div>",s="fxs-popup",h="fxs-portal-bg-txt-br",t=r.observable,c=r.isObservable,l=i.newGuid,p=(function(n){function i(i,u){var f=n.call(this)||this;return f.title=t(),f.text=t(),f.completionPercentage=t(-1),c(i)&&(f.text=i),c(u)&&(f.completionPercentage=u),f.completionText=r.pureComputed((function(){var n=f.completionPercentage();return n<0||n>100?"":v.percentComplete.format(n)})),f}return __extends(i,n),i})(f.ViewModel),a;n.ViewModel=p;a=(function(n)
{function t(t,i){var r=n.call(this,t,i)||this;return r.element.html(y).addClass(e).addClass(s).addClass(h),r._bindDescendants(),r._setAria(),r}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(e,s,h);n.prototype.dispose.call(this)},t.prototype._setAria=function(){var t="aria-labelledby",i="aria-describedby",n=this.element,r=l(),u=l();n.attr("role","alertdialog").attr(t,u).attr(i,r);n.find("h2").attr("id",u);n.findByClassName(o).attr("id",r);this.element.attr("tabindex",-1).focus();this.ltm.registerForDispose((function(){n.removeAttr("tabindex role "+t+" "+i)}))},t})(f.Widget);n.Widget=a})(e||(e={})),e}));define("MsPortalImpl/UI/UI.DialogManager",["require","exports","f","o","a","Viva.Controls/Util/Viva.Util","MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup","MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox","MsPortalImpl/Svg/Startup/Error.svg","MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/Base/Telemetry",
"MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";function k(n){return"The {0} used to render the dialog was not specified.".format(n)}function bt(n){return nt||(nt=new ht(n)),nt}function kt(){nt=null}function st(n,t){var r=i.getUniqueId();return n.replaceAll(t,r).replaceAll("msportalfx-svg-c01",t).replaceAll(r,"msportalfx-svg-c01")}function ct(n,t,r,u,f){var o,c;switch(r.type){case 1:o=new p.Widget(t,dt(f,r,u));break;case 2:o=new h.Widget(t,ni(null,r));break;case 4:c=ii(f,r);c.onLostFocus=function(){n.dismissOpenDialog()};o=new s.Widget(t,c);break;case 3:o=new e.Widget(t,ti(f,r));break;case i.ViewModels.Internal.Dlg2:r.positionHint=r.positionHint||3;o=new p.Widget(t,gt(f,r,u))}return o}function dt(n,t,i){var r=new p.ViewModel;return r.title(t.title),t.templateViewModel?
(r.template(t.text),r.templateViewModel(t.templateViewModel)):r.text(t.text),r.buttons=t.buttons,r.onButtonClick=function(t){n(t)},r.modal=i,r.defaultButtonText=t.defaultButtonText,r.cancelButtonText=t.cancelButtonText,r.confirmationRequired=t.confirmationRequired,r.confirmationMessage=t.confirmationMessage,r}function gt(n,t,r){var f=new p.ViewModel;return f.title(t.title),typeof t.content=="object"?(f.template(t.content.htmlTemplate),f.templateViewModel(t.content.viewModel)):typeof t.content=="string"&&f.text(t.content),u.isArray(t.buttons)?(f.customBtns=[],t.buttons.forEach((function(n){f.customBtns.push({kind:3,text:n.displayText,result:n.button})})),f.customBtns.length&&(f.customBtns[0].kind=1,f.customBtns.length>1&&(i.last(f.customBtns).kind=2))):f.buttons=t.buttons,f.onButtonClick=function(t){n(t)},f.modal=r,f}function ni(n,t){var i=new h.ViewModel(t.text,t.completionPercentage);return i.title(t.title),i}function ti(n,t){var i=new e.ViewModel;return i.dialogOptions=t,i.okButtonText(
b.Dialogs.okButtonText),i.cancelButtonText(b.Dialogs.cancelButtonText),i.onOkClick=function(){n(4)},i.onCancelClick=function(){n(1)},i}function ii(n,t){var i=new s.ViewModel;return i.dialogOptions=t,i.onItemSelected=function(){n(4)},i}function lt(n,t){var r=n.closest(".fxs-tile").data(v.CompositionInstanceDataName),u;return r&&v.isPartComposition(r)?u=r.locator:t!=="sideload"&&pt.error("Unable to determine the extension that opened the dialog. "+i.getCurrentCallStack(!0)),u}function at(n){var r=n.closest(".fxs-bladecontent"),t=y.Widget.getWidgets(r),i;return t&&t.length&&(i=t[0],n=g(i.getForm())),n}function vt(n){ft.trace({source:et,name:n&&n.toFriendlyString(),action:ot.DialogOpened,extension:n&&n.getExtensionLocator().name})}function d(n,t){ft.trace({source:et,name:n&&n.toFriendlyString(),action:ot.DialogClosed,extension:n&&n.getExtensionLocator().name,data:t+""})}var rt,ht;r.defineProperty(t,"__esModule",{value:!0});var tt=i.Base,ut=tt.Diagnostics,ft=ut.Telemetry,yt=i.ViewModels.Dialogs,
g=jQuery,it=g("body"),pt=ut.createLog(n),wt="<div class='fxs-portal-shield'><div class='fxs-portal-shield-icon fxs-portal-shield-icon-on-topbar'><\/div><div class='fxs-portal-shield-modaldialog'><div/><\/div><\/div>",et=a.Source.Shell,ot=a.Action,nt;rt=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(yt.MessageBox);t.MessageBox=rt;t.getOrCreate=bt;t.dispose=kt;ht=(function(){function n(n){this._portalIdleSvc=n}return r.defineProperty(n.prototype,"hasOpenDialog",{get:function(){return!!this._dismissOpenDialog},enumerable:!0,configurable:!0}),n.prototype.dismissOpenDialog=function(){this._dismissOpenDialog&&(this._dismissOpenDialog(),this._dismissOpenDialog=null)},n.prototype.showModalDialog=function(n){var s=this,t=g(wt),r,y,h,e,a,u,v,p,f;return it.append(t),r=t.findByClassName("fxs-portal-shield-icon"),y=t.findByClassName("fxs-portal-shield-modaldialog"),n.showErrorIcon?(h=w.getSvgReferenceOrFallBackToData(i.extend2(c,{data:st(c.data,"msportalfx-svg-c22")})),
e="fxs-portal-shield-icon-error"):(h=w.getSvgReferenceOrFallBackToData(i.extend2(l,{data:st(l.data,"msportalfx-svg-c10")})),e="fxs-portal-shield-icon-warning"),r.html(h),r.addClass(e),a=it.findByClassName("fxs-topbar-content").width(),u=it.findByClassName("fxs-topbar-notifications").position(),a&&u&&(v=a-(u.left+40),r.css({top:u.top,right:v}),y.css({top:u.top+40,right:v})),this._currentCancelToken&&(this._currentCancelToken.cancel(),this._currentCancelToken=null),p=t.find(".fxs-portal-shield-modaldialog > div"),f=new rt(n.title,n.description,n.buttons),f.defaultButtonText=n.defaultButtonText,f.cancelButtonText=n.cancelButtonText,f.templateViewModel=n.templateViewModel,o.unhide(t),this._portalIdleSvc.signalIdle(),this._showDialog(p,f,!0,null).then((function(i){var u=n.uiShield&&n.uiShield.hidePromise;return u?(s._currentCancelToken=new tt.Promises.CancelationToken,tt.Promises.wrapWithCancelablePromise(u,s._currentCancelToken).then((function(){o.hide(t)}))):o.hide(t),r.removeClass(e),i})).finally(
(function(){s._portalIdleSvc.signalBusy()}))},n.prototype.showDialog=function(n,t,i,r){return n?t?(this.dismissOpenDialog(),this._showDialog(n,t,!1,i,r)):Q.reject(k("options")):Q.reject(k("element"))},n.prototype.showDialogWithCallback=function(n,t,i,r){if(!n)throw new Error(k("element"));if(!t)throw new Error(k("options"));this.dismissOpenDialog();this._showDialogWithCallback(n,t,!1,i,r)},n.prototype.showShellDialog=function(n,t,r,u,e,o){if(!t)return Q.reject(k("formTarget"));if(!r)return Q.reject(k("sourceTarget"));if(!n)return Q.reject(k("options"));e=i.isUndefined(e)?!0:e;this.dismissOpenDialog();var s=this._showDialog(g(t.getForm()),n,e,u,o?"sideload":"").then((function(n){return t.hideForm(),n})),h=f.getBox(r);return t.showForm(h,n.positionHint),s},n.prototype._showDialog=function(n,t,i,r,u){var o=this,f=Q.defer(),s=function(n){f.resolve(n)},e;return r||i||(r=lt(n,u)),t.type!==4&&(n=at(n)),e=ct(this,n,t,i,s),vt(r),e?(this._dismissOpenDialog=function(){e.dispose();f.reject();d(r,"Dismissed")}
,f.promise.then((function(n){e.dispose();o._dismissOpenDialog=null;d(r,n)}))):(d(r,"InvalidDialogType"),f.reject("Invalid type specified in dialogOptions.")),f.promise},n.prototype._showDialogWithCallback=function(n,t,i,r,u){var o=this,f,e;u||i||(u=lt(n));t.type!==4&&(n=at(n));e=function(n){f&&f.dispose();o._dismissOpenDialog=null;d(u,n);r&&r(n)};f=ct(this,n,t,i,e);vt(u);f?this._dismissOpenDialog=function(){f.dispose();d(u,"Dismissed")}:d(u,"InvalidDialogType")},n})()}));define("MsPortalImpl/UI/UI.NpsHelper",["require","exports","f","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r){"use strict";var u;return (function(n){function u(u,s,h,c,l){return t||!o&&e&&!n.npsShownInSession?i.require("MsPortalImpl/Widgets/Widgets.Nps").then((function(t){f.Diagnostics.Telemetry.trace({source:r.Source.ToastTray,action:r.Action.NPSShown,data:i.extend({productId:h},c)});t.showSurvey(u,s,h,l);n.npsShownInSession=!0})):Q(null)}function c(n,i){var r=i(),f=Date.now()-h,e=r<f&&Math.random()<s;return t||e?u(n,null,
null,{surveyLastCompleted:r},(function(){i(Date.now())})):Q(null)}var f=i.Base,t=i.isFeatureEnabled("testnps"),e=i.isFeatureEnabled("nps"),o=i.isFeatureEnabled("ci"),s=(parseFloat(i.getFeatureValue("npspercent"))||1)/100,h=(parseInt(i.getFeatureValue("npsintervaldays"))||90)*864e5;n.npsShownInSession=!1;n.showNps=u;n.showPortalNps=c})(u||(u={})),u}));define("MsPortalImpl/UI/UI.SessionHandler",["require","exports","f","ko"],(function(n,t,i,r){"use strict";var u;return (function(t){function h(n,t,u){return t.addCallbacks({onIdle:function(t,i){var f=r.unwrap(n);f&&t.getTime()-i.getTime()>=f*6e4&&(c.warning("Signing out user at {0} after inactivity timeout of {1} minutes".format(t,f)),u())},onBusy:i.noop})}function a(n,t,r,e,c,a){var v,p,y;s?h(s,r,e):t.subscribeAndRun(n,(function(n){n&&!u?u=h(t,r,e):!n&&u&&r.removeCallbacks(u)}));v=i.memoizeQ((function(){return i.require("MsPortalImpl/UI/UI.SessionHandlerDeferred")}));i.isFeatureEnabled("sessionvalidity")&&(p=r.addCallbacks({onIdle:function(n){v().then(
(function(t){t.validateSessionLifetime(c,a,n.getTime(),"SessionValidityIdle").then((function(n){n?f():(o(),r.removeCallbacks(p))}))}))},onBusy:i.noop}),y=function(){return Q.delay(l).then((function(){v().then((function(n){n.validateSessionLifetime(c,a,Date.now(),"SessionValidityPoll").then((function(n){n?(f(),y()):o()}))}))}))},y());f()}var c=i.Base.Diagnostics.createLog(n),l=parseInt(i.getFeatureValue("sessionpollinterval"))||18e5,e="LastValidSessionTs",f=function(){MsPortalImpl.localStorage.setItem(e,Date.now().toString())},o=function(){MsPortalImpl.localStorage.removeItem(e)},s=parseInt(i.getFeatureValue("idletimeoutmins")),u;t.initialize=a})(u||(u={})),u}));define("MsPortalImpl/UI/UI.StatusHandler",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function y(n,t){return(n&t)===t}function o(n,t,i,r,u){rt.ClientNotification.publish({title:
n,description:t,status:r||k.Information,descriptionAsHtml:u,correlationIds:[i]})}function et(n,t,i,r){return new p(n,t,i,r)}var s=i.Base,w=s.Diagnostics,b=w.Telemetry,rt=i.Hubs.Notifications,k=i.Hubs.Notifications.NotificationStatus,h=f.Action,d=f.Source,g=window,c=w.createLog(n),ut=g.fx.environment.errorPageUri,l=s.Constants.Shell,nt=r.Shell,a=nt.Notifications,e=nt.Dialogs,v=a.SessionEnding,tt=a.TokenFailure,it=a.VersionChanged,ft=[12e5,6e5],p;t.create=et;p=(function(){function n(n,t,i,r){this._pageBlockingPrompt=!1;this._isDialogVisible=!1;this._unknownNetworkErrorCount=0;this._unknownNetworkErrorCanceled=!1;this._getDialogManager=n;this._initializationPromise=t;this._redirectFunc=i;this._showSplashScreenFunc=r}return n.prototype.onLastTokenRefresh=function(n,t){var i=Date.now();if(t<=i)this.onStatus({code:2},n);ft.forEach((function(n){var r=t-n;g.setTimeout((function(){var t=Math.floor(n/6e4),i=t>10?v.messageFmt.format(t):v.message;o(v.title,i,"lastTokenRefresh")}),r-i)}))},n.prototype.onStatus=
function(n,t){var nt=this,r=Q.resolve(null),f,y,p;if(!n||this._pageBlockingPrompt)return r;var a=t===l||t===s.Constants.ExtensionNames.Hubs,v=n.data||{},w=v.uri||"",g=function(n){var u=w,r;return i.isUriAbsolute(u)||(u="//"+t+i.ensurePrefix(u,"/")),r=document.createElement("a"),r.text=n,r.title=r.href=u,r.outerHTML};switch(n.code){case 0:break;case 1:a?r=this._showDialog(t,h.ShellVersionChanged,e.newVersionMessageTitle,e.newVersionMessageDescription,e.newVersionDefaultButtonText,null,3e4,2,5):(b.trace({source:d.Shell,action:h.ExtensionVersionChanged,data:t}),c.warning("Extension reporting incompatible server version. {0}:{1}".format(t,v.version)),o(it.title,it.messageFmt.format(t),"VersionChanged-{0}".format(t)));break;case 2:a&&n.data.isPrimaryToken?(u.updateAuthState(null),this._redirectFunc({uri:ut+"/UE_SessionExpired"+window.location.hash})):o(tt.title,tt.messageFmt.format(t),"AuthTokenError-{0}".format(t));break;case 7:r=this._showDialog(l,"SessionExpired",e.sessionExpired,e.sessionExpiredMessage,
e.refresh,null,0,1,2);break;case 4:if(c.verbose("Received a status code zero from extension {0} for URL '{1}'.".format(t,w)),!a)break;if(this._unknownNetworkErrorCount>3||this._isDialogVisible||this._unknownNetworkErrorCanceled)break;this._unknownNetworkErrorCount++;r=this._showDialog(l,h.UnknownNetworkError,e.connectionErrorMessageTitle,e.connectionErrorMessageDescription.format(g(e.connectionErrorMessagePlaceHolder)),null,e.connectionErrorCancelButtonText,0,2,0).then((function(n){nt._unknownNetworkErrorCanceled=n===1}));break;case 6:f=e.tooManyRequestsDescription.format(g(e.tooManyRequestsLink));y=v.retryAfter;y&&(f=f+" "+e.tooManyRequestsRetry.format(y));o(e.tooManyRequestsTitle,f,"TooManyRequests-{0}".format(t),k.Warning,!0);break;default:p="Received unknown extension event '{0}' for extension '{1}'.".format(n.code,t);r=Q.reject(p);c.error(p)}return r},n.prototype._showDialog=function(n,t,i,r,f,e,o,s,h){var a=this,v,k=this._redirectFunc,p=y(h,2),c,w,l;return this._pageBlockingPrompt=
y(h,1),t&&b.trace({source:d.Shell,action:t,data:n}),p&&u.updateAuthState(null),c=function(n){k({skipFlushBuffers:p,delayPromise:n&&o?Q.delay(o):null})},w=y(h,4)&&Q.isPending(this._initializationPromise),w?(v=Q.defer().promise,c(!1)):(l=Q.defer(),this._isDialogVisible=!0,v=this._getDialogManager().then((function(n){return n.showModalDialog({title:i,description:r,defaultButtonText:f,cancelButtonText:e,buttons:s,uiShield:{hidePromise:l.promise}})})).then((function(n){return a._pageBlockingPrompt?(a._showSplashScreenFunc(),l.resolve(),c(!0)):n===4?c(!1):l.resolve(null),n})).finally((function(){a._isDialogVisible=!1}))),v},n})();t.StatusHandlerImpl=p})(e||(e={})),e}));define("MsPortalImpl/UI/UI.ViewTimeTelemetry",["require","exports","f","i","o","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Telemetry","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o){"use strict";function ft(n,t){l=n.desktop;k=t&&t.increment||w;d=t&&t.tooSmall||b;s&&s.dispose();s=new r.TriggerableLifetimeManager;rt=
l.activeJourney.subscribe(s,(function(n){n?v():a(y)}));l.getDashboardManager().then((function(n){ut=n.currentDashboardId.subscribe(s,(function(n){v();p=n;a(y)}));p=n.currentDashboardId()}));var i,u,f;h.addEventListener(o.default.blur,u=function(){v()});h.addEventListener(o.default.focus,f=function(){a(y)});h.addEventListener(o.default.mousemove,i=function(){h.removeEventListener(o.default.mousemove,i);a()});s.registerForDispose((function(){h.removeEventListener(o.default.blur,u);h.removeEventListener(o.default.focus,f);h.removeEventListener(o.default.mousemove,i)}))}function et(){s&&(s.dispose(),s=null);v()}function a(n){c||l.activeJourney()||(n&&(nt=0,++g),tt=Date.now(),c=setTimeout((function(){it();c=null;a()}),k))}function v(){c!==null&&(clearTimeout(c),it());c=null}function it(){var n=Date.now()-tt;n>=d&&i.Base.Diagnostics.Telemetry.trace({source:e.Source.Shell,action:e.Action.DashboardViewTime,data:{target:"Dashboard",trackId:p,timespan:n,sequenceId:g,sequence:++nt,tileCount:l.startBoard.children.
filter((function(n){return!n.dontSetupWidget})).length,fullscreen:!!f.isFullscreen()}})}u.defineProperty(t,"__esModule",{value:!0});var h=window,y=!0,w=3e5,b=1e4,l,p="",rt,ut,k=w,d=b,g=0,nt=0,c=null,tt,s;t.start=ft;t.stop=et}));define("MsPortalImpl/Interactions/Interactions.ContextMenuTouch",["require","exports","o","$","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u){"use strict";function a(n){var i=n.originalEvent,t=i&&i.touches,r=t&&t.length===1,u=t&&t[0];return r?u:null}function p(){var n={width:0,height:0,top:f.targetY,left:f.targetX};e.css(n);r("body").append(e);e.animate({width:o,height:o,top:"-="+(o/2+5),left:"-="+o/2},75)}function w(n){if(n){var t={opacity:.2},i={opacity:1};e.animate(t,25).animate(i,25).animate(t,25).animate(i,25)}e.animate({width:0,height:0,top:"+="+o/2,left:"+="+o/2},75,(function(){e.detach()}))}function h(n,t){t.off(s);c.clearTimeout(l);w(n);f={startTime:0,target:null,targetX:0,targetY:0}}function b(n){h(!0,r(n.currentTarget))}function k(n){var i=a(n)||{
clientX:0,clientY:0},u=Math.abs(f.targetX-i.clientX),e=Math.abs(f.targetY-i.clientY);(u>t.MoveTolerancePixels||e>t.MoveTolerancePixels)&&h(!0,r(n.currentTarget))}function d(n){var e=r(n.currentTarget),o,i;f.startTime&&(o=Math.abs(Date.now()-f.startTime),o>=t.ReactionDelayMillis&&(e.off(u.default.contextmenu+s),i=r.Event(u.default.contextmenu),i.clientX=f.targetX,i.clientY=f.targetY,r(f.target).trigger(i)));h(!1,e)}function v(n){var i=a(n),e=r(n.currentTarget);if(!i){h(!0,e);return}if(!f||f.startTime===0){f={startTime:Date.now(),target:n.target,targetX:i.clientX,targetY:i.clientY};l=c.setTimeout((function(){p()}),t.ReactionDelayMillis);e.on(u.default.contextmenu+s,(function(){return!1})).on(u.default.touchmove+s,k).on(u.default.touchcancel+s,b).on(u.default.touchend+s,d)}}function g(n){n.on(u.default.touchstart,v)}function nt(n){n.off(u.default.touchstart,v);h(!0,n)}var c;i.defineProperty(t,"__esModule",{value:!0});c=window;t.ReactionDelayMillis=550;t.MoveTolerancePixels=10;t.HintClassIdentifier=
"fxs-contextMenuTouchHint";var y="<div class='"+t.HintClassIdentifier+"' style='position: fixed;z-index: 500border: 2px solid grey;box-sizing: border-box;background-color: rgba(255, 255, 255, 0.2);pointer-events: none;'><\/div>",e=r(y),o=110,s=".cmtevt",l,f={startTime:0,target:null,targetX:0,targetY:0};t.register=g;t.unregister=nt}));define("MsPortalImpl/Widgets/Widgets.ContextPane",["require","exports","f","o","ko","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Svg/Startup/Close.svg","MsPortalImpl/Svg/Startup/Hamburger.svg","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";var tt;r.defineProperty(t,"__esModule",{value:!0});var p=e.findByClassName,w=h.ContextPane,b="fxs-contextpane",y="fxs-contextpane-close",v="fxs-contextpane-expand",
k="fxs-progress-dots",d="fxs-contextpane-button-inner",g="fxs-contextpane-content",nt="fxs-portal-bg-txt-br",it=(function(n){function t(){var t=n.call(this,"fxs-contextpane-identifier")||this;return t.opened=u.observable(!1),t.loading=u.observable(!1),t}return __extends(t,n),t})(l.ViewModel);t.ViewModel=it;tt=(function(n){function t(t,r){var u=n.call(this,t,r)||this,e='<button type="button" class="'+v+' fxs-display-none"><div class="'+d+' fxs-portal-svg">'+f.getSvgReferenceOrFallBackToData(s)+"<\/div><\/button>"+('<button type="button" class="'+y+' fxs-display-none" title="'+i.encodeAttribute(w.close)+'"><div class="'+d+' fxs-portal-svg">'+f.getSvgReferenceOrFallBackToData(o)+"<\/div><\/button>")+('<div class="'+k+'">')+"<div><\/div><div><\/div><div><\/div><\/div>";return t.addClass(b).addClass(nt).attr("role","complementary").append(e),u._$closeButton=p(t,y),u._$expandButton=p(t,v),u._$progress=p(t,k),u._init(),u._attachEventHandlers(r),u}return __extends(t,n),t.prototype.dispose=function(
){this._cleanElement(b,nt);this.element.removeAttr("role");n.prototype.dispose.call(this)},t.prototype.hasContent=function(){return!!this._$content},t.prototype.addChild=function(n){var t,i;if(!n)throw new Error("Can't add null child.");this.hasContent()&&this.removeChild(null);t=this._$content=n.element?n.element:n;t.addClass(g).insertBefore(this._$progress);i=!t.hasClass("fxs-blade")&&!t.hasClass("fxs-partgallery-container");e.toggle(this._$closeButton,i);e.toggle(this._$expandButton,t.hasClass("fxs-partgallery-container"))},t.prototype.insertChild=function(n){this.addChild(n)},t.prototype.removeChild=function(n,t){var i=this._$content;return i?(t?i.detach():i.remove(),i.removeClass(g),this._$content=null,!0):!0},t.prototype.clear=function(n){return this.removeChild(null,n)},t.prototype.setFocus=function(){if(!i.isFeatureEnabled("skipautofocus")){var n=this._$content;n&&c.waitForBindings(this.element[0]).then((function(){n.findFirstTabbable().focus()}))}},t.prototype._init=function(){var
n=this.ltm,t=this.element,i=this.options;u.reactor(n,(function(){var n=i.opened();t.toggleClass("fxs-contextpane-visible",n)}));u.reactor(n,(function(){var n=i.loading();t.toggleClass("fxs-contextpane-loading",n)}))},t.prototype._attachEventHandlers=function(n){var t=this,i,r;this.element.findByClassName(y).on(a.default.click,i=function(){t.element.trigger(a.default.fxcontextpaneclosing)});this.element.findByClassName(v).on(a.default.click,r=function(){n.collapsed(!n.collapsed())});n.collapsed&&n.collapsed.subscribeAndRun(this.ltm,(function(n){t.element.findByClassName(v).attr({title:n?w.expand:w.collapse,"aria-expanded":!n})}));this.ltm.registerForDispose((function(){t.element.findByClassName(y).off(a.default.click,i);t.element.findByClassName(v).off(a.default.click,r)}))},t})(l.Widget);t.Widget=tt}));define("_generated/Templates/WidgetsPanorama",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-startboard-target" aria-labelledby="startboard-title"><\/div> <div class="fxs-journey-target"><\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.Panorama",["require","exports","f","o","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsPanorama","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var v;r.defineProperty(t,"__esModule",{value:!0});var y=window,c="fxs-panorama",l=i.encodeHtml(u.Portal.preview),a="Can't add null child.",p=(function(n){function t(t,i){var r=n.call(this,t)||this;return r.rotateThemeEvent=null,r.applyViewSettings(i),r}return __extends(t,n),t.prototype.getViewSettings=function(){return{}},t.prototype.applyViewSettings=function(){return},t})(s.ViewModel);t.ViewModel=p;v=(function(n){function t(t,i){var r=n.call(this,t,i)||this;return t.addClass(c).html(e()),t.findByClassName("fxs-panorama-previewbadge").attr("title",l).findByClassName(
"fxs-panorama-previewbadge-text").text(l),r.ltm.registerForDispose(t.setEvents([h.default.doubleclick,function(n){var t=$(n.target),i=t.hasClass(c),u=t.hasClass("fxs-startboard-layout"),f=t.hasClass("fxs-flowlayout-childcontainer"),e=t.hasClass("fxs-journey-layout"),o=t.hasClass("fxs-journey-placeholder");(i||u||f||e||o)&&(n.preventDefault(),n.stopPropagation(),y.getSelection().removeAllRanges(),r.trigger(h.default.fxrotatetheme))}])),r}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(c);n.prototype.dispose.call(this)},t.prototype.addChild=function(n){if(!n)throw new Error(a);this.getJourneyWidget().addChild(n)},t.prototype.insertChild=function(n,t){if(!n)throw new Error(a);this.getJourneyWidget().insertChild(n,t)},t.prototype.removeChild=function(n){var t=this.getJourneyWidget();return t&&t.removeChild(n)},t.prototype.getStartBoardArea=function(){return this.element.findByClassName("fxs-startboard-target")},t.prototype.getJourneyArea=function(){return this.element.
findByClassName("fxs-journey-target")},t.prototype.getStartBoardWidget=function(){return f.Widget.getWidget(this.getStartBoardArea(),o.Widget)},t.prototype.getJourneyWidget=function(){var n=f.Widget.getWidgets(this.getJourneyArea());if(n.length>1)throw new Error("The journey target has been initialized with more than one widget.");return n[0]},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t})(s.Widget);t.Widget=v}));define("_generated/Templates/WidgetsSearch",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-search" role="search" data-bind="css: { \'fxs-search-expanded\': data.isExpanded() }, attr: { \'aria-label\': searchLabel }"> <div class="fxs-box-wrapper" data-bind="css: { \'fxs-searching\': data.showSearching() }"> <div class="fxs-icon msportalfx-svg-flip-horizontal" data-bind="image: data.icons.search, attr: { title: searchLabel}"><\/div> <div class="fxs-searchbox fxs-topbar-input"><\/div> <div class="fxs-indicator"> <div><\/div><div><\/div><div><\/div> <\/div> <div role="presentation" aria-hidden="true" class="fxs-cross">&times;<\/div> <\/div> <a href="#" class="fxs-search-icon fxs-topbar-button fxs-trim-svg fxs-trim-hover" role="button" data-bind="attr: { title: searchLabel, \'aria-label\': searchLabel }" > <div class="msportalfx-svg-flip-horizontal" data-bind="image: data.icons.search"><\/div> <\/a> <div class=\'fxs-menu fxs-popup fxs-portal-bg-txt-br fxs-dropmenu-content\' data-bind=\'visible: data.showMenu()\' title=\'\'><\/div> <\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.Search",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","Viva.Controls/Controls/Forms/Viva.TextBox","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsSearch","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Svg/Startup/Search.svg","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var a,l,v,y;r.defineProperty(t,"__esModule",{value:!0});a=i.Base;t.searchClass="fxs-search";t.searchBoxClass="fxs-searchbox";l=f.Search;v=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.isExpanded=u.observable(!1),t.showMenu=u.observable(!1),t.showResults=u.observable(!1),t.showSearching=u.observable(!1),t.showExternalColumn=u.observable(!1),t.showAllSubscriptionsSearch=u.observable(!1),t.showChangeSubscriptions=u.observable(!1),t.icons={search:a.Images.CustomImageWithOptions(c,{isLogo:!0})},t.text=l,t.filter=u.observable(),t.searchInFilterText=
u.observable(),t.subscriptionSummary=u.observable(),t.mruItems=u.observableArray(),t.results=u.observableArray(),t}return __extends(t,n),t})(o.ViewModel);t.ViewModel=v;y=(function(n){function r(r,o){var c=n.call(this,r,o)||this;c._initialized=Q.defer();r.addClass(t.searchClass).html(s());window.fx.environment.chrome.hideSearchBox&&r.addClass("fxs-hidden-important");c._bindDescendants({text:o.text,searchLabel:f.KeyboardShortcuts.search});var p=c._textWidget=new e.Widget(r.findByClassName(t.searchBoxClass),{placeholder:i.isFeatureEnabled("globalsearch")?u.observable(l.globalPlaceholder):u.observable(l.placeholder),readonly:u.observable(!1)}),d=c._textField=$(p._getElementToFocus()),y,w,b,a=h.default.focusin,k=h.default.mousedown,v=r.findByClassName("fxs-search-icon");r.on(a,y=function(){r.off(a,y);o.showMenu(!0);var n=c._initOptions;(n&&n()||Q(!0)).then((function(){i.require("MsPortalImpl/Widgets/Widgets.SearchDefered").then((function(n){c._initialized.resolve();n.initialize(c,d)}))}))});v.on(
a,w=function(n){n.preventDefault();c.setFocus()});v.on(k,b=function(n){n.preventDefault();c.setFocus()});return c.ltm.registerForDispose((function(){p.dispose();r.off(a,y);v.off(a,w);v.off(k,b)})),c}return __extends(r,n),r.prototype.setFocus=function(){this.options.isExpanded(!0);this._textField.focus()},r.prototype.initOptions=function(n){this._initOptions=n},r.prototype.isDropdownInitialized=function(){return this._initialized.promise},r})(o.Widget);t.Widget=y}));define("MsPortalImpl/Widgets/Widgets.SideBar",["require","exports","f","i","o","ko","MsPortalImpl/Base/Base.Router","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Svg/Startup/AllServices.svg","MsPortalImpl/Svg/Startup/CaretUp.svg","MsPortalImpl/Svg/Startup/DoubleChevron.svg","MsPortalImpl/Svg/Startup/Ellipsis.svg",
"MsPortalImpl/Svg/Startup/Hamburger.svg","MsPortalImpl/Svg/Startup/Hyperlink.svg","MsPortalImpl/Svg/Startup/Plus.svg","MsPortalImpl/Svg/Startup/Star.svg","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt){"use strict";function ht(n,t,i){yt.Diagnostics.Telemetry.trace({source:c.Source.SideBar,name:t,action:n,data:i})}function hi(n,t,i,r){var u=r?it.expand:it.collapse;n.toggleClass("fxs-sidebar-is-collapsed",r);t.attr({title:u,"aria-expanded":!r});ut&&(t.hasClass(at)?t.removeClass(at):t.addClass(at))}function ci(n){var f=n.isCollapsed,e=f(),t=!e,r=n.saveCollapseState,u;i.isFeatureEnabled("sideBarAutoCollapsedInJourney")?(u=n.getStartboardVisible,u&&u()&&r&&r(t)):r&&r(t);f(t);ht(st.SideBarViewChanged,"",t?"collapsed":"expanded")}function ni(n,t,i){var f;if(t){var r=i.favorites,u=r.indexOf(n),e=r.indexOf(t);if(u||!t.opensExternal)return ht(st.SideBarFavoriteMoved,t.
id,{oldIndex:e,newIndex:u}),r.valueWillMutate(),f=r(),f.splice(u,0,f.splice(e,1)[0]),i.favoritesManager().move(u),r.valueHasMutated(),u}return-1}function li(n,t,i){var u=$(document.activeElement).parent(),e=i===40?u.next(kt)[0]:u.prev(kt)[0],o,r;e&&(o=f.dataFor(e),r=ni(o,n,t),r>=0&&Q.fcall((function(){var i=t.favorites()[r].uri,n=$("."+bt+" [href|='"+i+"']")[0];n&&n.focus()})))}var ti;u.defineProperty(t,"__esModule",{value:!0});var yt=i.Base,ii=i.ViewModels.Obsolete.Forms.DropDown.ViewModel,rt=yt.Images,ri=window,pt=ri.fx.environment,ft=a.default.click,ct=".fxs-sidebar-droppable",ui=r.Extension.getHubsWindowId()+"_Dashboard",fi=r.Extension.getHubsWindowId()+"_BrowseAllResources",et="fxs-sidebar-entered",ot=".fxs-sidebar-entered",wt="fxs-sidebar-flyout",lt=a.default.keydown,bt="fxs-sidebar-bar",kt="li.fxs-sidebar-item",at="fxs-sidebar-collapse-button-flip",it=o.SideBar,st=c.Action,ut=i.isFeatureEnabled("improvedsidebar"),vt=".fxs-sidebar-item-link",dt='<button class="fxs-sidebar-collapse-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="image: data.collapseIcon"><\/button><!-- ko if: data.cloudOptions().length > 1 --><div class="fxs-sidebar-cloudFilter" data-bind=\'formElement: func.cloudDropDown\'><\/div><!-- /ko --><button class="fxs-sidebar-create fxs-trim-hover fxs-trim-border" role="button" data-bind="attr: { title: data.createTooltip, \'aria-label\': data.createTooltip }, visible: !data.hideCreateButton()"><div class="fxs-sidebar-button-flex"><div class="fxs-sidebar-create-icon fxs-fill-success" data-bind="image: data.icons.plus"><\/div><div class="fxs-sidebar-create-label fxs-sidebar-show-if-expanded fxs-trim-text" aria-hidden="true" data-bind="text: data.createText"><\/div><\/div><span class="fxs-hide-accessible-label" data-bind="text: data.newResourceAriaLabel"><\/span><\/button>',
gt='<div class="fxs-sidebar-middle"><ul class="fxs-sidebar-favorites" data-bind="attr: { \'aria-label\': data.svcListText }"><!-- ko foreach: func._favorites --><li class="fxs-sidebar-item fxs-trim-hover fxs-sidebar-draggable fxs-sidebar-droppable fxs-trim-border" draggable="true" data-bind="attr: {\'aria-label\': label }"><a tabindex=\'-1\' href=\'\' class=\'fxs-sidebar-item-link fxs-trim-text\' data-bind="attr: { href: uri, title: label }"><div class="fxs-sidebar-icon fxs-trim-svg" data-bind="image: image"><\/div><div class="fxs-sidebar-label fxs-sidebar-show-if-expanded" aria-hidden="true" data-bind="text: label"><\/div><div class="fxs-sidebar-external fxs-sidebar-show-if-expanded" data-bind="visible: $data.opensExternal"><div class="fxs-trim-svg-secondary" data-bind="image: $root.data.icons.hyperlink"><\/div><\/div><div class="fxs-sidebar-handle fxs-trim-svg-secondary" data-bind="image: $root.data.icons.ellipsis"><\/div><span class="fxs-hide-accessible-label" data-bind="text: label"><\/span><\/a><\/li><!-- /ko --><\/ul><\/div>',
ei='<nav class="fxs-sidebar-bar fxs-trim fxs-trim-text" data-bind="attr: { \'aria-label\': data.svcNavLabel }"><div class="fxs-sidebar-top">'+dt+"<\/div>"+(""+gt)+'<div class="fxs-sidebar-bottom"><div class="fxs-sidebar-browse fxs-trim-hover fxs-menu-browse msportalfx-vertical-center" tabindex="0" role="button" aria-expanded="false" data-bind="attr: { title: data.browseTooltip, \'aria-label\': data.browseText }"><div class="fxs-sidebar-button-flex"><div class="fxs-sidebar-browse-label fxs-trim-text fxs-sidebar-show-if-expanded" data-bind="text: data.browseText"><\/div><div class="fxs-sidebar-browse-icon fxs-trim-svg" data-bind="image: data.icons.caretUp"><\/div><\/div><\/div><div class="fxs-sidebar-flyout fxs-popup fxs-portal-bg-txt-br fxs-sidebar-flyout-is-hidden" role="presentation"><\/div><\/div><\/nav>',oi='<nav class="fxs-sidebar-bar fxs-trim fxs-trim-text" data-bind="attr: { \'aria-label\': data.svcNavLabel }"><div class="fxs-sidebar-top">'+dt+'<div class="fxs-sidebar-browse fxs-trim-hover fxs-menu-browse msportalfx-vertical-center" tabindex="0" role="button" aria-expanded="false" data-bind="attr: { title: data.browseTooltip, \'aria-label\': data.browseText }"><div class="fxs-sidebar-button-flex"><div class="fxs-sidebar-browse-icon fxs-trim-svg" data-bind="image: data.icons.allServices"><\/div><div class="fxs-sidebar-browse-label fxs-trim-text fxs-sidebar-show-if-expanded" data-bind="text: data.browseText"><\/div><\/div><\/div><div class="fxs-sidebar-flyout fxs-popup fxs-portal-bg-txt-br fxs-sidebar-flyout-is-hidden" role="presentation"><\/div><\/div><div class="fxs-sidebar-favorites-section"><div class="fxs-sidebar-pre-divider fxs-trim-border"><\/div><div class="fxs-sidebar-star-icon" data-bind="image: data.icons.star"><\/div><span class="fxs-sidebar-myfavorites" data-bind="text: data.myFavoritesText, visible: !data.isCollapsed()"><\/span><div class="fxs-sidebar-post-divider fxs-trim-border"><\/div><\/div>'+
(""+gt)+"<\/nav>",si=(function(n){function t(){var t=n.call(this)||this;return t.browseText=ut?it.allServices:pt.branding.browseLabel,t.svcListText=it.svcList,t.svcNavLabel=it.svcNavLabel,t.closeText=it.close,t.myFavoritesText=it.myFavorites,t.browseTooltip=t.browseText,t.createText=ut?it.createResource:it.create,t.createTooltip=it.createTooltip,t.newResourceAriaLabel=it.newResourceAriaLabel,t.favorites=f.observableArray(),t.isCollapsed=f.observable(!0),t.onFavoritesChanged=f.observableArray([]),t.openFavorite=function(n,r,u){var f,e;if(typeof n=="number"){var o=t.favoritesManager(),s=o&&o.favorites||t.favorites,h=s();if(n||h.length)f=s()[n];else if(f=t.possibleFavorites().first((function(n){return n.id===ui})),f)t.favorites.push(f);else t.onDashboardFavoriteClick(c.Source.SideBar)}else f=n;if(f){if(f.opensExternal)return t.openExternal(f.uri),!0;if(!r&&!u){if(f.opensDashboard)t.onDashboardFavoriteClick(c.Source.SideBar);else e=f.uri,i.isFeatureEnabled("browsev2")&&f.id===fi&&(e="#blade/HubsExtension/BrowseV2Blade"),
t.launchBlade(e);return!0}}},t.possibleFavorites=f.observableArray(),t.previewText=it.preview,t.icons={hamburger:rt.CustomImageWithOptions(k,{isLogo:!0}),allServices:y,doubleChevron:rt.CustomImageWithOptions(w,{palette:5}),star:rt.CustomImageWithOptions(nt,{isLogo:!0,customClass:"msportalfx-svg-c11"}),plus:rt.CustomImageWithOptions(g,{isLogo:!0}),hyperlink:rt.CustomImageWithOptions(d,{isLogo:!0}),ellipsis:rt.CustomImageWithOptions(b,{isLogo:!0}),caretUp:rt.CustomImageWithOptions(p,{isLogo:!0})},t.collapseIcon=ut?t.icons.doubleChevron:t.icons.hamburger,t.cloudOptions=f.observableArray(),t.selectedCloud=f.observable(),t.favoritesManager=f.observable(),t.hideCreateButton=f.observable(!0),t.hideCreateButton(pt.chrome.hideCreateButton),t}return __extends(t,n),t.prototype.openExternal=function(n){window.open(n,"_blank")},t.prototype.attachFavoritesManager=function(n){this.favoritesManager(n)},t.prototype.initLifetime=function(n){var t=this;this.favoritesManager.subscribeAndRun(n,(function(i){
i&&(h.connectDebouncedObservable(n,t.selectedCloud,i.selectedCloud,!0),h.connectDebouncedObservable(n,i.favorites,t.favorites))}))},t})(l.ViewModel);t.ViewModel=si;ti=(function(n){function t(t,r){var u=n.call(this,t,r)||this,a,e,o,c,l;return t.attr("role","presentation").html(ut?""+oi:""+ei),i.isFeatureEnabled("userdefineddefaultview")&&t.addClass("fxs-sidebar-defaultviewenabled"),ut&&t.addClass("fxs-sidebar-improvedsidebar"),u._createButton=t.findByClassName("fxs-sidebar-create"),u._browseLink=t.findByClassName("fxs-sidebar-browse"),a=u._collapseButton=t.findByClassName("fxs-sidebar-collapse-button"),u._sideBar=t.findByClassName(bt),e=u.ltm,r.initLifetime(e),o=u._favorites=r.favorites.filter(e,(function(n){return n&&n.cloudName===r.selectedCloud()})).map(e,(function(n,t){return t.image=t.image&&i.Base.Images.CustomImageWithOptions(t.image,{isLogo:!0}),t})),o.extend({deferred:!0}),c=t.find(".fxs-sidebar-favorites"),o.subscribeAndRun(e,(function(){v.requestAnimationFrame((function(){var n=c.find(
vt+'[tabindex="0"]:eq(0)');n.length||c.find(vt+":eq(0)").attr("tabindex","0")}))})),e.registerForDispose(new tt.KeyboardNavigation(c,12,vt)),u.cloudDropDown=new ii(e,{label:f.observable(it.cloud),options:r.cloudOptions}),l=u.cloudDropDown.value,r.cloudOptions.subscribe(e,(function(n){n.length>0&&!l()&&l(n[0].value)})),l.subscribe(e,(function(n){r.selectedCloud(n);r.favoritesManager().selectedCloud(n)})),u._bindDescendants(),u._flyout=t.findByClassName(wt),u._attachEventHandlers(e,t,r),f.computed(e,r.onFavoritesChanged,(function(n){if(n.length){o();var i=s.findByClassName(t,"fxs-sidebar-favorites:first .fxs-sidebar-item");n.slice().forEach((function(n){n(i)}))}})),u._getSidebarFlyout=i.memoizeQ((function(){return i.require("MsPortalImpl/Widgets/Widgets.SideBarFlyout").then((function(n){var i=new n.ViewModel,t=new n.Widget(u.element.findByClassName(wt),i,u.options.favoritesManager());return u._initOptions&&u._initOptions().then((function(){t.options.openFeedbackPane=u.options.openFeedbackPane})),t.options.
launchBlade=u.options.launchBlade,t.options.openFavorite=u.options.openFavorite,h.connectDebouncedObservable(u.ltm,u.options.selectedCloud,t.options.selectedCloud,!0),t}))})),r.isCollapsed.subscribeAndRun(e,(function(n){hi(t,a,r,n)})),u}return __extends(t,n),t.prototype.dispose=function(){n.prototype.dispose.call(this);this._cleanElement()},t.prototype.initOptions=function(n){this._initOptions=n},t.prototype.toggleFlyout=function(){var n=this._flyout.hasClass("fxs-sidebar-flyout-is-hidden");i.tryImmediateResolve(this._getSidebarFlyout(),(function(t){t.toggle(n)}))},t.prototype.openCreate=function(){ht(st.SideBarNewMenuOpened);this.options.launchBlade(e.getGalleryDeepLink("hub","",this.cloudDropDown.value()))},t.prototype.reorderFavorites=function(n){var t=f.dataFor(document.activeElement);li(t,this.options,n)},t.prototype._attachEventHandlers=function(n,t,i){var u=this,s=this._flyout,h=this._sideBar,r=function(t,i,r,u){t.on(i,r,u);n&&n.registerForDispose((function(){t.off(i,r,u)}))},e,o;r(this.
_createButton,ft,null,(function(){u.openCreate()}));e=this._browseLink;o=function(n){s.addClass("fxs-sidebar-browse-shown");u.toggleFlyout();n.stopPropagation()};r(e,ft,null,o);r(e,lt,null,(function(n){var t=n.keyCode;if(t===13||t===32)return o(n),!1}));r(t,ft,".fxs-sidebar-item a",(function(n){var t=f.dataFor(n.target);ht(st.SideBarItemOpened,t.id,{isFavorite:t.isFavorite(),isHome:t.isHome()});u.options.openFavorite(t)&&n.preventDefault()}));r(this._collapseButton,ft,null,(function(){ci(i)}));f.reactor(n,i.favorites,(function(n){n.forEach((function(n,t){n.isHome(!t)}))}));r(h,lt,null,(function(n){var i=n.keyCode,t;n.type===lt&&i===32&&(t=$(n.target),t.trigger(a.default.click),t.hasClass("fxs-sidebar-filter-input")||n.preventDefault(),n.stopPropagation())}));r(t,a.default.dragstart,".fxs-sidebar-draggable",(function(n){var t=n.originalEvent.dataTransfer;t.setData("text","fxs-draganddrop");t.effectAllowed="move";u._dragItem=f.dataFor(n.target)}));r(t,a.default.dragover,null,(function(n){n.preventDefault(
)}));r(t,a.default.dragenter,null,(function(n){var t=$(n.target),i=t.closest(ct),r=t.closest(ot);r.length===0&&($(ot).removeClass(et),i.length&&i.addClass(et))}));r(t,a.default.dragleave,null,(function(n){var t=$(n.target).closest(ct).length===0?!0:!1;t&&$(ot).removeClass(et)}));r(t,a.default.drop,null,(function(n){var t=n.target,r=$(t).closest(ct),e=f.dataFor(t);n.preventDefault();$(ot).removeClass(et);r.length&&ni(e,u._dragItem,i)}))},t})(l.Widget);t.Widget=ti}));define("MsPortalImpl/Widgets/Widgets.ToastViewModel",["require","exports","a","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function e(n){var i=r.unwrap(n&&n.timeoutID);i&&t.clearTimeout(i)}var t=window,s=5e3,h=3e4,o;n.clearItemTimeout=e;o=(function(f){function o(n){n===void 0&&(n={});var t=f.call(this)||this;return t.displayCount=4,t.shouldShowToasts=r.observable(!0),t._items=r.observableArray(),t.eventHandlers=r.observableArray(
),t.closeTitle=u.NotificationMenu.dismissToast,t.displayCount=n.displayCount||t.displayCount,t.shouldShowToasts=n.shouldShowToasts||t.shouldShowToasts,t}return __extends(o,f),o.prototype.addToasts=function(n){var t=this,f=i.isArray(n)?n:[n];f.length&&f.forEach((function(n){var l=t._items(),a=n.icon,v=n.title,y=n.description,p=n.uri,w=n.time,f=n.ids||[],h=n.data||null,o=n.duration||0,b=n.htmlContent||"",k=n.clickable!==!1,d=n.descriptiveText||u.Toast.description.format(n.title),i,s;if(o!==3)if(f.length>0&&(i=l.first((function(n){var t=n.ids();return f.some((function(n){return t.indexOf(n)>-1}))}))),i)i.icon(a),i.title(v),i.description(y),i.uri(p),i.time(w),i.ids(f),i.data(h),i.clickable(k),i.htmlContent(b),i.descriptiveText(d),i.duration(o),i.formSection(n.formSection),e(i),t.startRemoveTimer(i);else{s={icon:r.observable(a),title:r.observable(v),description:r.observable(y),uri:r.observable(p),time:r.observable(w),ids:r.observableArray(f),data:r.observable(h),htmlContent:r.observable(b),timeoutID:
r.observable(null),clickable:r.observable(k),onDismissFn:n.onDismissFn,descriptiveText:r.observable(d),duration:r.observable(o),formSection:r.observable(n.formSection)};(l.length<t.displayCount||t._canDeque(o))&&t._items.unshift(s);var tt=(h||{}).inlineForm,g=n.formSection,nt=g&&g.children()||[],c=nt.length>1&&nt[1].children();c&&tt.buttons.forEach((function(n,i){if(!n.endpoint){var r=c[i].onClick;c[i].onClick=function(){r();t.removeToast(s)}}}));t.startRemoveTimer(s)}}))},o.prototype._canDeque=function(n){for(var t,r,u=this._items(),i=0;i<=n+0;i++)for(t=u.length-1;t>=0;t--)if(r=u[t],r.duration()===i)return this.removeToast(r),!0;return!1},o.prototype.removeToast=function(t){n.clearItemTimeout(t);this._items.remove(t)},o.prototype.removeAllToasts=function(){this._items().forEach((function(t){n.clearItemTimeout(t)}));this._items.removeAll()},o.prototype.startRemoveTimer=function(n){var f=this,u=r.unwrap(n.duration)||0,i;u!==2&&(i=s,u===1&&(i=h),n.timeoutID(t.setTimeout((function(){f._items.remove(
n)}),i)))},o})(f.ViewModel);n.ViewModel=o})(e||(e={})),e}));define("MsPortalImpl/Widgets/Widgets.Portal",["require","exports","f","ko","MsPortalImpl/Interactions/Interactions.ContextMenuTouch","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextPane","MsPortalImpl/Widgets/Widgets.Panorama","MsPortalImpl/Widgets/Widgets.Search","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/Widgets/Widgets.ToastViewModel","MsPortalImpl/Widgets/Widgets.TopBar","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.FocusHandler"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";var k;return (function(n){var it=i.Base.UriBuilder,rt=i.Base.Diagnostics.Telemetry,w=window,k=w.fx.environment.features.rapidtoasts,t="fxs-show-journey",d="fxs-show-startboard",g="fxs-blade-position-feature2",
ut="fxs-portal-peekmode",nt,tt;r.components.register("fxs-progress",{template:'<div class="fxs-progress-dots"><div><\/div><div><\/div><div><\/div><\/div>'});nt=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.topBarViewModel=new y.ViewModel,t.sideBarViewModel=new a.ViewModel,t}return __extends(t,n),t})(s.ViewModel);n.ViewModel=nt;tt=(function(n){function s(o,s){var nt=n.call(this,o,s)||this,it,st,ht,ct,lt,yt,at,vt,pt,wt,rt;nt.hasActiveJourney=!1;var et=nt.ltm,tt=s.sideBarViewModel,ot=s.topBarViewModel,ft=new y.Widget(o.findByClassName("fxs-topbar"),ot,o.findByClassName("fxs-portal-console"));return nt.getTopBarWidget=function(){return ft},it=new c.Widget(o.findByClassName("fxs-portal-content"),new c.ViewModel("fxs-panorama-instanceid")),nt.getPanorama=function(){return it},st=new h.ViewModel,st.collapsed=tt.isCollapsed,ht=new h.Widget(o.findByClassName("fxs-portal-contextpane-left"),st),nt.getLeftContextPane=function(){return ht},ct=new h.Widget(o.findByClassName(
"fxs-portal-contextpane-right"),new h.ViewModel),nt.getRightContextPane=function(){return ct},lt=new l.Widget(o.findByClassName("fxs-topbar-search"),new l.ViewModel),nt.getSearchWidget=function(){return lt},u.register(o),f.register(o),yt=r.computed(et,(function(){return e.settings.notificationToastEnabledKey()&&k!=="0"&&k!=="true"})),at=new v.ViewModel({shouldShowToasts:yt}),nt.getToastVM=function(){return at},i.require("MsPortalImpl/Widgets/Widgets.Toast").then((function(n){et.registerForDispose(new n.Widget(o.findByClassName("fxs-topbar-toast"),at))})),tt.getStartboardVisible=function(){return nt.isStartBoardVisible()},vt=new a.Widget(o.findByClassName("fxs-sidebar"),tt),nt.getSideBarWidget=function(){return vt},pt=function(){nt.isJourneyVisible()||(i.isFeatureEnabled("sideBarAutoCollapsedInJourney")||tt.isCollapsed(e.settings.sideBarCollapsedKey()),nt.element.removeClass(d).addClass(t),ot.dashboardVisible(!1),b.FocusHandler.Instance.journey(!0))},wt=function(n,i){var u,r;tt.isCollapsed(
e.settings.sideBarCollapsedKey());nt.element.removeClass(t).addClass(d);ot.dashboardVisible(!0);b.FocusHandler.Instance.journey(!1);u=i&&i.skipFocus;u||(r=nt.getPanorama().getStartBoardWidget(),r&&r.setFocus())},i.isFeatureEnabled("reservehozscroll")&&nt.element.addClass(g),rt=r.observable(!1),nt.ltm.registerForDispose([ft,it,ht,ct,lt,vt,function(){u.unregister(o);f.unregister(o)},nt.element.setEvents([p.default.fxloadingontopbar,function(n,t){ft.loadingHint(t.id,!t.cancel);var i=it.getJourneyWidget();i&&i.loadingHint(t.id,!t.cancel)}],[p.default.fxshowstartboard,wt],[p.default.fxshowjourney,pt],[p.default.fxdashboardactivity,function(){var n=it.getJourneyWidget(),t=n&&n.getBlades()[0];t&&t.close(!1)}],[p.default.fxpeekmode,function(n,t){rt(t&&t.enter!==undefined?!!t.enter:!rt())}]),$(w).setEvents([p.default.keyup,function(n){n.which===27&&rt(!1)}]),]),rt.subscribe(et,(function(n){nt.element.toggleClass(ut,n);var t=nt.getPanorama().getJourneyWidget();t&&t.peekMode(n);ft.options.peekMode(
n)})),nt}return __extends(s,n),s.prototype.dispose=function(){n.prototype.dispose.call(this);this._cleanElement(g)},s.prototype.isStartBoardVisible=function(){return!this.element.hasClass(t)},s.prototype.isJourneyVisible=function(){return this.element.hasClass(t)},s.prototype._hasJourneyWithContent=function(){var n=this.getPanorama(),t=n&&n.getJourneyWidget(),i=this.getRightContextPane();return t&&t.hasChildren()||i&&i.options.opened()},s.prototype.handleStartButtonClick=function(){var t=o.ActionModifier.PortalScrolled,i=new it(w.location.href),r=!i.fragment,n;this.isStartBoardVisible()||(this._hasJourneyWithContent()&&r&&!this.hasActiveJourney?(n=this.getPanorama().getJourneyWidget(),n&&n.close()):(this.element.trigger(p.default.fxhomebuttonclick),t=o.ActionModifier.StartBoardRestored));rt.trace({source:o.Source.Desktop,action:o.Action.HomeButtonClicked,actionModifier:t})},s})(s.Widget);n.Widget=tt})(k||(k={})),k}));define("MsPortalImpl/UI/UI.Initialize",["require","exports","f","i","o","a",
"ko","$","MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/ClaimsIdentity","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels","MsPortalImpl/Controls/ControlBindings.Async","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/ExtensionMetadataSource","Fx/Feedback","MsPortalImpl/GalleryPackage/GalleryPackageLoader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Languages","MsPortalImpl.Controls/Controls/ResourceFilterHelper","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.AzureStorage","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/Services/Services.Controller",
"MsPortalImpl/Services/Services.FileUploadEndpointRegistration","MsPortalImpl/Services/Services.FileUploadInitialization","MsPortalImpl/Services/Services.GalleryEndpoints","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/Services/Services.PortalIdentity","MsPortalImpl/Services/Services.PortalTips","MsPortalImpl/Services/Services.SharedSettings","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.ShellProvisioner","MsPortalImpl/Services/Services.TelemetrySharing","MsPortalImpl/Services/Services.Util","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Services","MsPortalImpl/UI/Hubs/UI.FavoritesManager",
"MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration","MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks","MsPortalImpl/UI/Hubs/UI.NotificationsPane","MsPortalImpl/UI/UI.NpsHelper","MsPortalImpl/UI/Hubs/UI.ResourceMapManagerRpc","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration","MsPortalImpl/UI/UI.SessionHandler","MsPortalImpl/UI/UI.StatusHandler","MsPortalImpl/UI/UI.ViewTimeTelemetry","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.KnockoutExtensions","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding",
"MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Parts/Parts.ButtonPart","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration","MsPortalImpl/UI/UI.DialogManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai,vi,yi,pi,wi,bi,ki,di,gi,nr){"use strict";function hu(n,t){t&&t.startsWith("#")&&n.route(t)}function df(n,t,i){return[n,t].forEach((function(n){var t=n.length;if(t!==1)throw new Error("Unexpected length '"+n.selector+"': "+t);})),new gu(n,t,i)}function er(n,t,i){br({source:n,action:t,data:i})}function cu(n,t){return Q().then(t).catch((function(n){ar.error(n)})).then((function(){return n.getCodeComponentsMetadata()}))}function gf(n){var f,e;if(n&&wr&&wr.getEntriesByType&&
wr.timing){var u=ur(),i=function(n,t,i){du(n,{duration:t,endTime:Math.round(i+wr.timing.navigationStart)})},o=wr.getEntriesByType("resource").filter((function(n){var t=n.initiatorType;return t==="link"||t==="script"})),r=o.reduce((function(n,t){return Math.min(t.startTime,n)}),Infinity),t=o.reduce((function(n,t){return Math.max(t.responseEnd,n)}),0),s=t-r,h=t;return r=Math.max(r,n),t=Math.min(t,u),f=t-r,e=u-f-n,i("TotalTimeToSplashScreen",n,n),i("TotalStartupResourceDownload",s,h),i("StartupResourceDownload",f,t),i("StartupScriptExecution",e,u),e}}function du(n,t){t=t||{};var r=t.duration||ur(),i=t.data||{};return i.cdn="CdnIndex"+gr.index,i.bundling="Bundling"+gr.bundling,br({timestamp:t.endTime,source:lr,action:n,actionModifier:yr.ActionModifier.Complete,duration:r,data:i}),r}function ne(n,t){var i=n.getValue(wu,pu,bu);return t!==i&&n.setValue(wu,pu,t,bu),i}function te(){ki.registerPrefix(y.PinVMPrefix,"./MsPortalImpl/Extension/PinBladeInferred",(function(n,t,i,r){return n.createViewModel(t,
i,r)}))}function ie(n,t,r,u,f){var e=new li.ViewModel,c=i.memoizeQ((function(){return tr("MsPortalImpl/Widgets/Widgets.NotificationsPane").then((function(n){return new n.Widget(o("<div/>"),e,t)}))})),s=i.memoizeQ((function(){return tr("MsPortalImpl/UI/Hubs/UI.NotificationHelper")})),h;t.notificationManager.notifications.subscribeArrayChanges(f,(function(n){s().then((function(t){return t.showToastAndUpdateCount(n,e,r)}))}),(function(n){s().then((function(t){return t.removeToastAndUpdateCount(n,e,r)}))}));f.registerForDispose(n.options.topBarViewModel.notificationButtonClick=function(){c().then((function(n){n.toggleNotificationsContextPane().then((function(){r.removeAllToasts();s().then((function(n){return n.updateUnreadCountOnButton(0)}))}))}))});h={events:nr.default.fxtoastclick,handler:function(n,t){u.handleNotificationClick(t,!0)}};r.eventHandlers.push(h)}function re(n,t,r,u,f){var e=i.memoizeQ((function(){return tr("MsPortalImpl/Widgets/Widgets.SettingsPane").then((function(n){return new n.Widget(o("<div/>"),
new n.ViewModel,t,r,f)}))}));u.registerForDispose(e);n.element.on(nr.default.fxsettingsbuttonclick,(function(){e().then((function(n){er(pr.TopBar,or.SettingsPaneOpen);n.toggleSettingsContextPane()}))}))}function ue(n,t){n.feedbackButtonClick=function(){t.getService("FeedbackPane").then((function(n){var t=n.widget;er(kr,or.FeedbackSmileyClicked,{isPaneOpen:t.isVisible()});t.toggle()}))}}function fe(n,t,r,u,f,e,s){var h=i.memoizeQ((function(){return tr("MsPortalImpl/Widgets/Widgets.DirectoryPane").then((function(n){return new n.Widget(o("<div><\/div>"),new n.ViewModel,{portalServices:t,subscriptionsPromise:r,userInfoPromise:u,tenantsPromise:f,redirectWithCdn:s})}))}));e.registerForDispose(n.options.topBarViewModel.directoryButtonClick=function(){h().then((function(n){n.toggleDirectoryContextPane()}))})}function ee(n,t,i,r,u){var f=function(n){return tr("MsPortalImpl/Widgets/Widgets.SharedOptionsInit").then((function(t){n(t)}))};n.initOptions((function(){return f((function(t){t.initSearchWidgetOptions(u,n,
i,r)}))}));t.initOptions((function(){return f((function(n){n.initSideBarWidgetOptions(u,t,i)}))}))}function oe(n,t,i,r,u,f,e,o,s){var l=n.getToastVM(),h=n.getTopBarWidget(),a=n.getSearchWidget(),c=n.getSideBarWidget(),v=h.options;re(h,t,i,f,s);ue(v,t);ee(a,c,t,c.options.selectedCloud,f);ie(n,t,l,e,f);rr("directorypane")&&fe(n,t,i,yt.getUserInfo(),yt.getTenants(),f,o)}var gu;u.defineProperty(t,"__esModule",{value:!0});var cr=r,nf=cr.Data,tf=cr.Extension,rf=cr.TriggerableLifetimeManager,vr=i.Base,tu=vr.Constants,uf=tu.Shell,iu=vr.Diagnostics,yr=iu.Telemetry,lu=r.NetDiagnostics,ff=vr.Resources,au=r.Rpc,ef=i.Hubs.Notifications,of=ef.NotificationStatus,sf=cr.Hubs.Notifications,hf=i.Services,cf=tu.DefaultCloudName,vu=vr.Net2,or=ui.Action,pr=ui.Source,lf=i.Helpers,sr=MsPortalImpl.Performance,ru=vr.UriBuilder,hr=window,wr=hr.performance,uu=hr.fx,ur=uu.getTimestamp,br=yr.trace,fu=au.client,lr=pr.Shell,ir=uu.environment,af=ir.chrome,eu=ir.links,kr=pr.TopBar,tr=i.require,vf=i.ensureSuffix,yf=i.pathJoin,
dr=vf(ff.getAppRelativeUri("/"),"/"),pf=hr.console,fr=hr.location,ar=iu.createLog(n),yu=dr+"SignOut",wf=dr+"signin/index",bf=ir.errorPageUri,kf=ir.isDevelopmentMode,pu="loadedPageVersion",wu=bt.ComponentName.Telemetry,bu=0,gr=ir.cdn,rr=i.isFeatureEnabled,ou=rr("ci"),su,nu,ku=function(){ar.warning.apply(ar,arguments)};vu.setAjaxLogFunc(ku);t.routeIfHash=hu;t.create=df;gu=(function(){function t(n,t,i){this._lifetime=new rf;this._disposed=!1;this._dependencies=i;this._element=n;this._$splashScreen=t;this._idleSvc=kt.createInstance()}return t.prototype.initialize=function(){var u=this,t=this._lifetime,y=this._$splashScreen,bt=i.memoizeQ((function(){return oi.getDialogManagerModule().then((function(n){return n.getOrCreate(u._idleSvc)}))}));t.registerForDispose(bt);var kt=function(n,t){return u._redirect({uri:n,skipFlushBuffers:t})},st=this._dependencies,f=st.settings,pt=st.extensionManager,li=st.storageService,ki=new ru(fr.href),vr=Q(uu.early.authBootstrapStatePromise);return vr.then((function(vr)
{var gu=function(n,t,r){var u=new ru(n+fr.search+(r||"")),f=gr.forceIndex,e=u.query;f&&e.setParameter(gr.indexParameter,f);t&&i.forEachKey(t,(function(n,t){return e.setParameter(n,t)}));kt(u.toString())},rf,pu,re;if(!vr){gu(dr,null,fr.hash);return}vr.createdOn||(vr.createdOn=Date.now());dt.updateAuthState(vr);ir.enableAnimations||o.enableAnimations(!1);pu=u._idleSvc;yr.initialize(lr);at.init(f);vt.initFavoritesSettings(f);gt.init(f);var ue=ni.queryStores(f,[8,4]),yf=ir.pageVersion,df=ne(li,yf),uu={defaultRoute:!1,splashScreen:sr.splashScreenLoadTime,initializeStart:ur(),cdnFailedIndex:st.cdnFailedIndex,loadedSameVersion:yf===df,previousVersion:df||""};tt.shutdown();tt.initialize(u._element);var fe=tt.read(d.Shell.Reader.portalLoading,1,"portal"),wr,ff=at.processor.initialized.then((function(w){function no(n,t){er(kr,t);hu(ii,n)}function ye(n){return l.getAvatarImage(pi.avatarUri,pi.defaultAvatarUri,li,n)}var be=ki.query.getParameter("l")!==undefined,re,ht,ni,gr,fe,ru,lt,se,wu,at,ii,ae,ku,
cr,nf,uf,ff,tt,ve,hf,gt,yf,pe,we;rt.initialize(t,li,w.rawLocale,ir.localeFromQuery,be)&&kt(null,!0);Q.fcall((function(){i.isObject(ir)&&pf.log("Version: "+ir.version+"\nSession: "+ir.sessionId)}));uu.initializeGeneralSettings=ur();var df=rt.currentLocaleContext,gf=df.selectedDisplayLanguage,ke=df.selectedFormatCulture;er(lr,or.PortalInitializeLanguage,{language:gf,formatCulture:ke||gf});yt.initialize(vr.user);var pi=yt.getSignedInUser(),yr=pi.tenantId,de=yt.getTenants(),ne=e.observable(!1);g.initialize();t.registerForDispose((function(){g.dispose()}));re=new di.ViewModel;ht=new di.Widget(u._element,re);t.registerForDispose((function(){it.hide(u._element);hr.setTimeout((function(){ht.dispose()}),100)}));wr=oi.initialize(t,st,w,ne,ht,kt,bt);v.initialize(wr);ni=wr.desktop;ut.initialize(wr.assetTypeService,t);gr=Q(yt.getSubscriptions());fe=gr.then((function(n){lf(n);ne((n&&n.subscriptions||[]).some((function(n){return n.requireRdfe})))}));u._notificationManager=wr.notificationManager;tf.extensionStatusEndPoint.
register(fu,null,(function(n,t){n&&ie(n,t.srcWindowId)}));ru=ht.options;lt=ru.topBarViewModel;rr("azureconsole")&&(lt.getConsoleViewModel=function(){return tr("MsPortalImpl/Widgets/Widgets.Console").then((function(n){return new n.ViewModel({src:ir.consoleUri,getAuthToken:rf})}))});lt.exitDevMode=function(){it.unhide(y);MsPortalImpl.Extension.unregisterAll().then((function(){kt(dr)}))};var wi=function(){tr("../Base/Base.ClientRawFileDownload",n).then((function(n){n.downloadFile({provideText:function(){return he().then((function(n){return JSON.stringify(n,null,2)}))}},"PortalDiagnostics.json","charset=utf-8;application/json")}))},bi=i.memoizeQ((function(){return tr("../Base/Base.DebugInfo",n).then((function(n){return n.initialize(t,wr)}))})),ge=af.hideShortcuts?null:nt.setup(ht,wr,wi,(function(){bi().then((function(n){return n.toggleStickys(su)}))})),ee=ht.element,vu=function(){return tr("MsPortalImpl/Widgets/Widgets.WelcomeSequence").then((function(n){return new n.Widget(o("<div />"),new gi.ViewModel,ee,f)})
)};t.registerForDispose(vu);se=i.memoizeQ((function(){return tr("MsPortalImpl/Widgets/Widgets.HelpPane").then((function(n){return new n.Widget(o("<div/>"),new n.ViewModel,wr,wi,ge,f,vu)}))}));t.registerForDispose(lt.helpButtonClick=function(){se().then((function(n){return n.toggle(pr.TopBar)}))});var he=function(){return Q.all([tr("MsPortalImpl/Base/Base.DiagnosticsPopup"),fe,ve]).spread((function(n){return n.getDiagnosticsData(wr,lf,vf,bu)}))},ce=yr==="72f988bf-86f1-41af-91ab-2d7cd011db47",le=i.getFeatureValue("showbugreportlink");return lt.canReportBug(le==="force"||le==="true"&&ce&&!i.isFeatureEnabled("ci")),lt.reportBug=function(){tr("./UI.Portal.Actions",n).then((function(n){n.reportBug(wr,he,ki)}))},wu=si.createFavoritesManager(t,wr),at=ru.sideBarViewModel,at.attachFavoritesManager(wu),ii=wr.router,at.onDashboardFavoriteClick=function(n){ii.navigateToDashboard(n)},ae=i.getIdGenerator("SideBarOpeningBlade"),at.launchBlade=function(n){var u=ii.route(n),r=ht.getPanorama(),t=r&&r.getJourneyWidget(
),i;t&&(i=ae(),t.loadingHint(i,!0),u.finally((function(){t.loadingHint(i,!1);t.trigger(nr.default.fxbladerepos,null,{noScroll:!0,noExitPeekMode:!0})})))},ku=!1,cr=cu(ef,(function(){return ef.registerTestExtensionsFromUri(fr.href)})).then((function(n){return typeof n=="string"?(nu=n,Q.reject()):n})),a.canModifyExtensions&&(cr=cr.then((function(n){return tr("MsPortalImpl/Extension/ExtensionPatch").then((function(n){var t=n.initializeTestPatch([],wr,y);return cu(t,(function(){return t.registerTestPatchesFromUri(fr.href).then((function(){return t.listTestPatches().then((function(n){n=n||[];p.patchUris=n.map((function(n){return n.uri}));ku=!!n.length}))}))}))})).then((function(){return n}))}))),uu.preGetExtensionMetadata=ur(),uf=cr.then((function(n){var t,i;return(uu.getExtensionMetadata=ur(),nf=vt.sidebarFavoritesProcessor.initialized.then((function(t){uu.favoritesManagerInitialized=ur();var i=t.favorites(),r=i&&JSON.parse(i);return er(pr.SideBar,"SideBarSettings",{collapsed:w.sideBarCollapsedKey(),favorites:r,
favoritesCount:r.length}),wu.initializeFavorites(t,n)})),t=[cf],r.Extension.multiCloudEnabled&&(t=n.map((function(n){return n.cloudName})).unique().filter((function(n){return n!==tu.HubsCloudName}))),ft.setCloudNames(t),at.cloudOptions(t.map((function(n){return{text:e.observable(n),value:n}}))),pt.initialize({extensions:n,useCachedManifests:!0}),bu.registerGetAuthorizationTokenEndpoint(n),yt.initializeRpc(n),wt.initializeRpc(),ot.initializeRpc(),et.registerSasEndPoint(),ri.registerEndpoints(au.client,wr.desktop),i=function(t){var i=n.some((function(n){return n.isTestExtension||n.isTestStamp}));return lt.inDevMode(i||t||ku),ni.initialize(n,ue,uu)},a.canAddGalleryPackages)?tr("MsPortalImpl/GalleryPackage/GalleryPackageMetadataSource").then((function(n){var t=n.initializeTestGalleryPackage([],wr,y);return cu(t,(function(){return t.registerTestGalleryPackagesFromUri(fr.href)}))})).then((function(n){var t=k.initialize(pt);return t.loadGalleryPackages(n),n&&n.length>0})).then((function(n){return uu.galleryPackagesSideload=
ur(),i(n)})):i(!1)})).then((function(){uu.desktopAndExtensionManagerInitialize=ur();var n=rr("nodirectory"),t=function(){return wr.router.goToDashboardOnInit("UiInitialize",n)};return ii.initialRoute((function(){return uu.defaultRoute=!0,rr("userdefineddefaultview")?nf.then((function(){if(!at.openFavorite(0))throw new Error("Couldn't open first favorite.");})).catch((function(n){var r=ar.warning;return r.call(ar,new i.Errors.Error({message:"favoritesManagerInitialized failed",innerErrors:n})),t()})):t()}),{skipFocus:n})})).then((function(){uu.setupInitialRoute=ur();it.hide(y);sr.pageLoaded();uu.locationHash=ki.fragment.split("?")[0];uu.hiddenTime=sr.getHiddenTime();var r={data:o.extend(uu,lu.traceDocumentNavigation())};pt.getHubsExtension().then((function(){su=du("TotalTimeToPortalReady",r);var i=1;!ou&&rr("userdefineddefaultview")&&w.whatsNewVersion()<i&&tr("../Services/Services.PortalTips",n).then((function(n){n.setup(t,nf,at.onFavoritesChanged,i)}))}));u._idleHandle=pu.addCallbacks({onIdle:function(
){var n=hr.navigator;n&&n.onLine!==!1&&(tt.avatarImage(ye(!0)),i.getFeatureValue("prefetch")!=="false"&&tr("MsPortalImpl/Services/Services.PortalPrefetch",null,!0).then((function(n){n.start(t,pu,li,su)})),ir.useCachedManifests&&pt.refreshManifests().catch((function(){})),rr("ldnstrace")&&tr("ldns",null,!0),tr("MsPortalImpl/Services/Services.BrowserTelemetry",null,!0));pu.removeCallbacks(u._idleHandle)},onBusy:i.noop})})).catch((function(n){nu=nu||"/LoadFailed?stack="+encodeURIComponent(n&&n.stack).substr(0,1e3);u._redirect({uri:bf+nu})})),vt.userDirectorySettingsProcessor.initialized.then((function(n){(!rr("directorypane")||n.signInToLastVisitedDirectory())&&n.userDefaultDirectory()!==yr&&n.userDefaultDirectory(yr)})),uf.then((function(){var n,t,i,r;!ou&&rr("guidedtour")?f.querySetting(7,"WelcomeSequence").then((function(n){n||vu().then((function(){er(ui.Action.PortalInitializeWelcome,ui.Source.Shell)}))})):rr("nodirectory")&&tt.dropMenu.isMenuOpen(!0);u._notificationManager.listenForClientNotifications(
);ct.init(f);!rr("internalonly")||a.canModifyExtensions||ce||(n=ir.trustedParentOrigin,t=n.replace(/^([^\/]+\/\/).+\.([^\.]+\.[^\.]+\.[^\.]+)$/,"$1$2"),n!==t&&(i=d.Portal,u._notificationManager.addClientNotification({status:of.Information,title:i.preview,description:i.unsupportedEnvironment.format(n),uri:t,timestamp:new Date,cloudName:null,uriAction:sf.ClientNotificationUriAction.OpenInCurrentTab})));h.isSafari&&h.webKitVersion<602&&(r=d.Portal,bt().then((function(n){return n.showModalDialog({title:r.unsupportedBrowser,description:r.unsupportedBrowserDesc.format(eu.unsupportedBrowser),buttons:1,showErrorIcon:!0})})))})).then((function(){var n=hr.navigator.serviceWorker;n&&n.getRegistrations&&n.getRegistrations().then((function(n){n.forEach((function(n){n.unregister()}))}))})),ft.setupAssetTypeServiceRpc(wr),vi.setupResourceMapManagerRpc(fu,wr),ti.create(wr),iu.ErrorReporter.initialize((function(){ar.debug(ni.getDiagnosticsData())})),s.initialize(ni,wr),ff=ht.getToastVM(),oe(ht,wr,gr,wi,bi,t,u._notificationManager,
gu,rf),b.Internal.showNpsEndpoint.register(wr.rpcClient,null,(function(n,t){ai.showNps(ff,n.productDisplayName,(t.srcWindowId||"")+"_"+n.productId)})),b.Internal.canShowNpsEndpoint.register(wr.rpcClient,null,(function(){return!ai.npsShownInSession})),ai.showPortalNps(ff,w.npsTimeMs),tt=lt.avatarMenu,tt.userIdentity(pi),tt.hideTenant(rr("hideavatartenant")),yt.getUserInfo().then((function(n){tt.userInfo(n)})),ve=de.then((function(n){var t=n.tenants;vf(t);tt.listOfTenants(t)})),tt.showDiagnostics=wi,tt.signedOut=function(){dt.updateAuthState(null);kt(yu)},tt.openAccountPortal=function(){var n=eu.accountPortal;no(n.startsWith("#")?n:n+"subscriptions",or.AvatarMenuOpenBilling)},tt.avatarImage(ye()),at.saveCollapseState=function(n){w.sideBarCollapsedKey(n)},tt.giveFeedback=function(){er(kr,or.AvatarMenuOpenFeedback);hu(ii,eu.giveFeedback)},tt.showMyAccessBlade=function(){er(kr,or.AvatarMenuOpenAccessDetails);ni.createJourneyForBlade({cloudName:null,extension:"HubsExtension",detailBlade:"MyAccessBlade",
detailBladeInputs:{resourceId:""},openInContextPane:!0,defaultMenuItemId:undefined},ni.generateLoadingJourneyGuid())},tt.switchedTenant=function(n,t){var i=c.getHashQueryStringSegment(fr.href);MsPortalImpl.localStorage.removeItem("LastValidSessionTs");gu(wf+"/@"+t.tenant.domainName,null,"#"+i)},!ou&&(kf||ir.clientOptimizations&&ir.clientOptimizations!=="true"||a.canModifyExtensions)&&bi().then((function(n){return n.startErrorDetection(t)})),t.registerForDispose(bi),hf="data-click-telemetry",gt=ee[0],gt.addEventListener(nr.default.mousedown,we=function(n){yf=n.target},!0),gt.addEventListener(nr.default.mouseup,pe=function(n){var i=yf,r,t;if(yf=null,n.target===i&&(r=o(i),t=r.closest("["+hf+"]",gt),t.length)){var e=t.attr(hf)+"",u=t.closest(".fxs-tile",gt).data(ei.CompositionInstanceDataName),f=u&&u.locator,s=f&&f.toFriendlyString()||lr;br({source:s,action:or.CustomClick,name:e})}},!0),t.registerForDispose((function(){gt.removeEventListener(nr.default.mousedown,we,!0);gt.removeEventListener(
nr.default.mouseup,pe,!0)})),wr.browseManager.initialize(),fi.registerViewModels(wr),hi.registerViewModels(),yi.registerViewModels({portalServices:wr,securityTokensManager:bu,subscriptions:lf,tenants:vf}),ci.registerRpcCallbacks(wr),te(),uf})),wu=wi.create(bt,ff,(function(n){u._redirect(n)}),(function(){it.unhide(y)})),ee=function(n,t){return wu.onLastTokenRefresh(n,t)},se=function(n,t){wu.onStatus({code:2,data:{isPrimaryToken:t}},n)},ie=function(n,t){wu.onStatus(n,t)},bu=dt.createSecurityTokensManager(dt.createOAuthTokenProvier(vr),ee,se),ef=w.initializeTestExtension(st.extensionsMetadata.map((function(n){return a.ExtensionMetadataExt.create(n)})),f,li,bt,y),lf=e.observable(),vf=e.observableArray();return new lt.GalleryEndpointsService(fu,pt,ef),nf.registerTelemetrySubmissionHandler(),lu.registerTelemetrySubmissionHandler(),cr.ProvisioningTelemetry.registerTelemetrySubmissionHandler(),vu.status.subscribe(t,(function(n){ie(n,uf)})),yr.addProcessor(ii.getProcessor(pt)),rr("consoletelemetry")&&(re=
hf.getConsoleTelemetryEventProcessor(),yr.addProcessor(re)),MsPortalEarly.initializedTelemetry(br),gf(sr.splashScreenLoadTime),ff.then((function(){bi.start(wr)})).then((function(){function i(n){ku("Injecting {0}blockable untrusted content : {1} from {2}".format(n.blockable?"":"un",n.tag,n.src));er(lr,"UntrustedSource",n)}function t(t){var r=t.src,s=t.tag,u=r!=="document.write",f,e,o;return u&&s==="SCRIPT"&&(f=document.createElement("a"),f.href=r,r=f.href,e=/(.*?)[#\?]|$/.exec(r)[1]||r,o=!!n.filter((function(n){return!!~e.indexOf(n||null)})).length,u=!r||o||!!i(t)&&!1),u}var n=sr.allowList=sr.allowList.concat(ir.cdnPrefixes);n.push(fr.host);n.push("about:blank");sr.sourceLogger=t;sr.sourceBacklog.forEach(t);fe();tt.read(d.Shell.Reader.portalReady,1,"portal");pi.initialize(u._lifetime,at.settings.idleTimeoutMins,u._idleSvc,(function(){return u._redirect({uri:yu})}),yt.getSignedInUser().tenantDomain,wu)})),t.registerForDispose(bi.stop),rf=bu.initializeSecurityForShell(vr),ht.registerFileUploadEndpoints(
),ct.uploadSettingsManager=f,ff}))},t.prototype.dispose=function(){var n,t,i;this._disposed=!0;n=this._idleSvc;n&&(n.dispose(),this._idleSvc=null);cr.resetGlobalState();t=this._lifetime;t&&(t.dispose(),this._lifetime=null);i=vt.userDirectorySettings;(!rr("directorypane")||i.signInToLastVisitedDirectory()||i.userDefaultDirectory().localeCompareIgnoreCase(yt.getSignedInUser().tenantId)===0)&&dt.writeAuthState()},t.prototype._redirect=function(n){var t=n.uri,r=lf.Deferred(),i;it.unhide(this._$splashScreen);br({source:lr,action:or.PortalRedirect,actionModifier:ui.ActionModifier.Redirect,data:t});i=function(){r.resolve()};n.skipFlushBuffers?i():(st.flush(this._dependencies.settings).finally(i),hr.setTimeout(i,5e3));Q.allSettled([n.delayPromise,r]).finally((function(){if(!t){var n=new ru(fr.href);n.path=yf("/",n.path,yt.getSignedInUser().tenantId,"/");t=n.toString()}fr.href=t}))},t})()}));define("_generated/Less/MsPortalImpl/Base/Base.Images.css",["require","exports","o","module"],(function(n,t,i,
r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".msportalfx-svg-c01{fill:#fff}.msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-c03{fill:#a0a1a2}.msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-c08{fill:#ba141a}.msportalfx-svg-c09{fill:#dd5900}.msportalfx-svg-c10{fill:#ff8c00}.msportalfx-svg-c11{fill:#fcd116}.msportalfx-svg-c12{fill:#fee087}.msportalfx-svg-c13{fill:#b8d432}.msportalfx-svg-c14{fill:#7fba00}.msportalfx-svg-c15{fill:#59b4d9}.msportalfx-svg-c16{fill:#3999c6}.msportalfx-svg-c17{fill:#804998}.msportalfx-svg-c18{fill:#ec008c}.msportalfx-svg-c19{fill:#0072c6}.msportalfx-svg-c20{fill:#68217a}.msportalfx-svg-c21{fill:#00188f}.msportalfx-svg-c22{fill:#e81123}.msportalfx-svg-c97{fill:#ffb900}.msportalfx-svg-c98{fill:#00a4ef}.msportalfx-svg-c99{fill:#f25022}.fxs-blade-header-icon .msportalfx-svg-c05,.fxs-sidebar-middle .msportalfx-svg-c05,.fxs-theme-dark .msportalfx-svg-c05,.msportalfx-inverted-theme .msportalfx-svg-c05{fill:#777}.fxs-blade-header-icon .msportalfx-svg-c07,.fxs-sidebar-middle .msportalfx-svg-c07,.fxs-theme-dark .msportalfx-svg-c07,.msportalfx-inverted-theme .msportalfx-svg-c07{fill:#f2f2f2}.msportalfx-svg-palette-white>*,.msportalfx-svg-palette-white>g>*{fill:#fff}.msportalfx-svg-palette-blue>*,.msportalfx-svg-palette-blue>g>*{fill:#3999c6}.msportalfx-svg-palette-black>*,.msportalfx-svg-palette-black>g>*{fill:#1e1e1e}.msportalfx-svg-palette-green>*,.msportalfx-svg-palette-green>g>*{fill:#7fba00}.msportalfx-svg-palette-gray>*,.msportalfx-svg-palette-gray>g>*{fill:#a0a1a2}.msportalfx-svg-palette-inherit>*,.msportalfx-svg-palette-inherit>g *{fill:inherit!important}.msportalfx-svg-badge{position:absolute;left:0;bottom:0;min-height:12px;min-width:12px}.ext-fxc-menu-icon>.msportalfx-svg-badge{left:8px;bottom:7px;min-height:8px;min-width:8px}.msportalfx-svg-disabled{filter:grayscale(100%)}@-moz-document url-prefix(){.msportalfx-svg-disabled{filter:none}}.msportalfx-svg-disabled .msportalfx-svg-c01{fill:#fff}.msportalfx-svg-disabled .msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-disabled .msportalfx-svg-c03{fill:#a1a1a1}.msportalfx-svg-disabled .msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-disabled .msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-disabled .msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-disabled .msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-disabled .msportalfx-svg-c08{fill:#676767}.msportalfx-svg-disabled .msportalfx-svg-c09{fill:#6f6f6f}.msportalfx-svg-disabled .msportalfx-svg-c10{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c11{fill:#898989}.msportalfx-svg-disabled .msportalfx-svg-c12{fill:#c3c3c3}.msportalfx-svg-disabled .msportalfx-svg-c13{fill:#838383}.msportalfx-svg-disabled .msportalfx-svg-c14{fill:#5d5d5d}.msportalfx-svg-disabled .msportalfx-svg-c15{fill:#999}.msportalfx-svg-disabled .msportalfx-svg-c16{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c17{fill:#717171}.msportalfx-svg-disabled .msportalfx-svg-c18{fill:#767676}.msportalfx-svg-disabled .msportalfx-svg-c19{fill:#636363}.msportalfx-svg-disabled .msportalfx-svg-c20{fill:#4e4e4e}.msportalfx-svg-disabled .msportalfx-svg-c21{fill:#484848}.msportalfx-svg-disabled .msportalfx-svg-c22{fill:#7d7d7d}.msportalfx-svg-disabled .msportalfx-svg-c97{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c98{fill:#787878}.msportalfx-svg-disabled .msportalfx-svg-c99{fill:#8a8a8a}.msportalfx-svg-loading-square{-webkit-animation:ProgressFlagAnimation 1.45s infinite ease-in-out;animation:ProgressFlagAnimation 1.45s infinite ease-in-out}.msportalfx-svg-loading-square:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.msportalfx-svg-loading-square:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.msportalfx-svg-loading-square:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}@-webkit-keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}@keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}.msportalfx-svg-flip-horizontal>svg,svg.msportalfx-svg-flip-horizontal{transform:scalex(-1)}.msportalfx-svg-flip-vertical>svg,svg.msportalfx-svg-flip-vertical{transform:scaley(-1)}.msportalfx-svg-rotate360{-webkit-animation:ImageRotation 1.45s infinite linear;animation:ImageRotation 1.45s infinite linear}@-webkit-keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}")})
);define("_generated/Less/MsPortalImpl/Themes/Themes.Universal.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,"a{color:#0078d7}.fxs-topbar{background-color:#1c1c1c;color:#fff}.fxs-topbar .fxs-bg-warning,.fxs-topbar.fxs-bg-warning{color:#000}.fxs-topbar .fxs-bg-warning svg,.fxs-topbar.fxs-bg-warning svg{fill:#000}.fxs-topbar-search .fxs-searchbox input{background-color:#444;color:#fff}.fxs-topbar-search .fxs-searchbox input::-webkit-input-placeholder{color:#bbb}.fxs-topbar-search .fxs-searchbox input:-ms-input-placeholder{color:#bbb}.fxs-topbar-search .fxs-searchbox input::-moz-placeholder{color:#bbb}.fxs-trim,.fxs-trim-text,.fxs-trim-text a,a.fxs-trim-text{color:#fff}.fxs-topbar-dashboard,.fxs-topbar-exit-customize{background-color:#8a2da5}.fxs-trim{background-color:#252525}.fxs-trim-btn{color:#fff;border-color:#fff}.fxs-trim-title{color:#bbb}.fxs-trim-selected{background-color:#444}.fxs-trim-hover:hover{background-color:#3d3d3d}.fxs-trim-border{border-color:#444}.fxs-trim-svg{fill:#fff}.fxs-trim-svg .fxs-portal-svg{fill:#fff!important}.fxs-trim-svg-secondary{fill:#bbb}.fxs-trim-text-primary a,a.fxs-trim-text-primary{color:#55b3ff}.fxs-sidebar-star.fxs-is-favorite svg{fill:#ffb900;stroke:#000;stroke-width:1px}.fxs-fill-white,.fxs-tile-actionbar-action{fill:#fff}.fxs-sidebar .azc-form-labelcontainer{color:#fff}.fxs-bg-white{background-color:#fff}.fxs-overlay{background:rgba(0,0,0,.7)}.fxs-highlight{color:#000;background-color:#fff100}.fxs-tile-actionbar{background-color:#9cd5f4}.fxs-tile-actionbar-action.fxs-tile-actionbar-action-pressed,.fxs-tile-actionbar-action:hover{background:#00bcf2}.fxs-tile-actionbar-action.fxs-tile-actionbar-command-unpinfromstartboard:hover{background:#ba141a}.fxs-portal .fxs-accent,.fxs-portal .fxs-popup{box-shadow:0 5px 15px 2px rgba(0,0,0,.3)}.fxs-portal .fxs-portal-main .azc-is-edited .azc-dockedballoon-validation.azc-control.azc-dockedballoon{border-color:#8a2da5}.fxs-blade-status-container,.fxs-blade-title-description{color:#000}.fxs-text-white{color:#fff}.fxs-br-primary{border-color:#00bcf2}.fxs-tile-selected .fxs-tile-overlay{background-color:transparent}.fxs-bg-overlay-dark{background:rgba(0,0,0,.7)}.fxs-bg-primary-10{background-color:rgba(0,188,242,.1)}.azc-is-edited.azc-has-focus{border-color:#7fba00}.azc-is-edited.azc-has-focus .azc-dockedballoon-validation{border-color:#00bcf2}.azc-is-edited .azc-dockedballoon-validation{border-color:#8a2da5}.azc-disabled:hover,.azc-row-disabled:hover{background-color:inherit}.azc-disabled,.azc-disabled:focus,.azc-disabled:hover,input.azc-disabled{cursor:default;outline:0}.fxs-part::after{border-color:#9cd5f4}.fxs-part.fxs-part-selected-command::after,.fxs-part.fxs-part-selected::after{border-color:#00bcf2}.fxs-portal .fxs-text-info,.fxs-portal .msportalfx-text-info{color:#0058ad}.fxs-portal .fxs-text-success,.fxs-portal .msportalfx-text-success{color:#7fba00}.fxs-portal .fxs-text-dirty,.fxs-portal .msportalfx-text-dirty{color:#8a2da5}.fxs-portal .fxs-text-warning,.fxs-portal .msportalfx-text-warning{color:#ff8c00}.fxs-fill-info,.msportalfx-fill-info{fill:#0058ad!important}.fxs-fill-complete,.fxs-fill-success,.msportalfx-fill-success{fill:#7fba00!important}.fxs-fill-dirty,.fxs-fill-upsell,.msportalfx-fill-dirty{fill:#8a2da5!important}.fxs-fill-warning,.msportalfx-fill-warning{fill:#ff8c00!important}.fxs-fill-error,.msportalfx-fill-error{fill:#e81123!important}.fxs-br-info,.msportalfx-br-info{border-color:#00bcf2!important}.fxs-br-success,.msportalfx-br-success{border-color:#7fba00!important}.fxs-br-dirty,.msportalfx-br-dirty{border-color:#8a2da5!important}.fxs-br-warning,.msportalfx-br-warning{border-color:#ff8c00!important}.fxs-br-error,.msportalfx-br-error{border-color:#e81123!important}.fxs-bg-info,.msportalfx-bg-info{background-color:#0058ad!important}.fxs-bg-success,.msportalfx-bg-success{background-color:#7fba00!important}.fxs-bg-dirty,.fxs-bg-upsell,.msportalfx-bg-dirty{background-color:#8a2da5!important}.fxs-bg-warning,.msportalfx-bg-warning{background-color:#ff8c00!important}.fxs-bg-error,.msportalfx-bg-error{background-color:#e81123!important}.fxs-blade-statusbg.fxs-bg-info{background-color:#d1e7f8!important}.fxs-blade-statusbg.fxs-bg-complete,.fxs-blade-statusbg.fxs-bg-success{background-color:#d1ebd1!important}.fxs-blade-statusbg.fxs-bg-dirty,.fxs-blade-statusbg.fxs-bg-upsell{background-color:#e4d5f0!important}.fxs-blade-statusbg.fxs-bg-warning{background-color:#fff0d1!important}.fxs-blade-statusbg.fxs-bg-error{background-color:#f9b1b7!important}")})
);define("MsPortalImpl/Init",["require","exports","f","o","MsPortalImpl/Base/Base.Router","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Services/Services.PortalIdentity","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.Initialize","MsPortalImpl/Services/Services.Storage","_generated/Less/MsPortalImpl/Base/Base.Images.css","_generated/Less/MsPortalImpl/Themes/Themes.Universal.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function tt(n){var t={fx:p.version};n||b.initializedExtensions.forEach((function(n){t[n.name]=n.extension.getVersion()}));ft.custom("Session",ot,st++,ht,t)}var nt;r.defineProperty(t,"__esModule",{value:!0});"use strict";var w=i.Base,ut=w.Diagnostics,k=w.UriBuilder,v=l.ComponentName,y=window,p=y.fx.environment,ft=ut.createLog(n),et=p.cdn,a=l.create(),d=new k(y.location.href),g=JSON.parse(a.getValue(v.Redirect,"BootParameters",0)||"{}");a.clearValue(v.Redirect,"BootParameters",
0);a.clearValue(v.Redirect,"BootParameters",1);a.clearValue(v.Redirect,"ReloadCount",1);y.fx.bootEnvironment=g.environment||{region:"unknown"};d.query=new w.QueryStringBuilder(g.userQuery);u.history_replaceState(null,y.document.title,d.toString());et.enabled||(nt=a.clearValue(v.Cdn,"FailedIndex",1));a.clearValue(v.Redirect,"IdpRedirectCount",1);var ot=1,st=0,ht=a.clearValue(v.Redirect,"Referrers",1)||"";tt(!0);y.setInterval(tt,36e5);var b=f.create(),it=s.createUserSettingsManager(a),rt=c.create($("#web-container"),$("body").find("> .fxs-splashscreen"),{storageService:a,settings:it,extensionManager:b,editScopeManager:o.createEditScopeManager(b),extensionsMetadata:p.extensionsMetadata,hubsMetadata:p.hubsMetadata,openWindow:function(n){var t=y.open();return Q(n).then((function(n){var u;if(n){var r=new k(n),f=r.path,o=i.ensureSuffix(f,"/");i.localeCompareIgnoreCase(o,i.ensureSuffix(location.protocol+"//"+location.host,"/"))||(u=r.fragment,u.startsWith("#@")||(r.fragment="#@"+e.getSignedInUserTenant(
)+(u[0]==="#"?"/"+u.slice(1):""),n=r.toString()))}t.location.href=n}))},cdnFailedIndex:nt});rt.initialize();$(y).on("unload",(function(){it.dispose();rt.dispose()}))}))