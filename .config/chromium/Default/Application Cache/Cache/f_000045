define("HubsExtension/MoveResource/MoveResourceCommon",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function c(n,t){var i=n.split("/")[0];return f[i]===r||f[i]===t}function l(n){var t=e.parseResourceDescriptor(n).provider;return!!(["Microsoft.ClassicCompute","Microsoft.ClassicStorage","Microsoft.ClassicNetwork"].filter((function(n){return n===t})).length>0)}function a(t,i,r){return n.resourceTypeCachePromise=t.getResourceTypeCache(r,i).then((function(t){n.resourceTypeCache=t})),n.resourceTypeCachePromise}function v(i,u){var f=i.toLowerCase(),v=t[f],y=n.excludedResourceTypes[f],e,l;if(c(f,u))return!0;if(y===u||y===r)return!1;if(v===u||v===r)return!0;var p=n.resourceTypeCache[f],w=p&&p.capabilities,a=w&&w.split(",");if(!a)return t[f]=4,!1;if(e=a.some((function(n){return n.trim().toLowerCase()===o})),l=a.some((function(n){return n.trim().toLowerCase()===s})),e&&l)return t[f]=r,!0;switch(u){case 1:if(e)return t[f]=h,!0;break;case 0:if(l)return t[f]=0,!0;break;case
3:if(e&&l)return t[f]=r,!0}return t[f]=4,!1}var e=i.ViewModels.Services.ResourceTypes,u="microsoft.resources/subscriptions/resourcegroups/",t,y;n.excludedResourceTypes={};var o="CrossResourceGroupResourceMove".toLowerCase(),s="CrossSubscriptionResourceMove".toLowerCase(),h=1,r=3,f={"microsoft.classiccompute":r,"microsoft.classicstorage":r,"microsoft.classicnetwork":0};n.resourceTypeCache={};t={};n.isClassicResource=l;n.initializeResourceTypeCache=a;n.supportsMoveType=v,(function(n){n.MoveResourcesAction=u+"moveresources/action";n.ValidateMoveResourceAction=u+"validatemoveresources/action";n.MoveResourcesToSubscriptionAction="microsoft.classiccompute/movesubscriptionresources/action";n.ValidateSubscriptionMoveAvailabilityAction="microsoft.classiccompute/validatesubscriptionmoveavailability/action"})(y=n.Actions||(n.Actions={}))})(r||(r={})),r}));define("HubsExtension/MoveResource/ViewModels/MoveResourceBladeVM",["require","exports","f","i","HubsExtension/MoveResource/MoveResourceStrings","HubsExtension/ResourceMap/ViewModels/ResourceProviderViewModel",
"HubsExtension/MoveResource/MoveResourceCommon"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){var l=i.Assets,a=i.Base,o=i.ViewModels,v=o.Blade,y=r.Extension.CloudName,t=o.Services.ResourceTypes,s=e.Actions,p=1,h=window.fx.environment,w=(function(n){function i(t){n.call(this);this._container=t;this.title(u.bladeTitle);this._resourceProvider=new f.ResourceProviderViewModel(this._container,null,null)}return __extends(i,n),i.prototype.onInputsSet=function(n){var c=this,k=y.readFromInputs(n),i=n.resourceId,d=n.moveType,f,o,a=[s.MoveResourcesAction,s.ValidateMoveResourceAction],g=function(t,i){return r.Security.hasPermission(t,i,r.Extension.CloudName.readFromInputs(n)).then((function(n){n||c._container.unauthorized()}))},v,w,b;return t.isResourceGroupId(n.resourceId)?(v=t.parseResourceGroupDescriptor(i),o=v.subscription,this.subtitle(v.resourceGroup),f=i,e.initializeResourceTypeCache(this._resourceProvider,o,k).then((function(){return g(f,a)}))):(w=t.parseResourceDescriptor(i),b=
t.buildResourceTypeFromResourceId(i),o=w.subscription,e.initializeResourceTypeCache(this._resourceProvider,o,k).then((function(){if(e.supportsMoveType(b,d))return c.subtitle(w.resource),e.isClassicResource(i)?(a=[e.Actions.MoveResourcesToSubscriptionAction],f=t.buildSubscriptionIdFromResourceId(i)):f=t.buildResourceGroupIdFromResourceId(i),g(f,a);var n=d===p?u.resourceGroupsLabel:u.subscriptionsLabel;return l.getResourceTypeAssetTypeInformation([b]).then((function(t){c._container.enableNotice({noticeTitle:u.comingSoonMsg,noticeImageType:1,noticeDescription:u.Move.notSupportedForType.format(t[0].compositeDisplayName.plural,n),noticeCallToActionText:u.moveDocLabel,noticeCallToActionUri:h.hubsLinks.moveResourcesDoc})}))})))},i})(v),c;n.MoveResourceBladeVM=w;c=(function(n){function t(){n.call(this);this.navigateUri(h.hubsLinks.moveResourcesDoc);this.icon(a.Images.Hyperlink())}return __extends(t,n),t})(o.UriCommand);n.LearnMoreCommandVM=c})(o||(o={})),o}));define("HubsExtension/MoveResource/ViewModels/MoveResourcePartVM",
["require","exports","f","i","a","ko","Fx/Assets/Assets","Fx/Controls/DropDown","HubsExtension/MoveResource/MoveResourceStrings","HubsExtension/ResourceMap/ResourceMapClientStrings","HubsExtension/ArmHelpers/ArmApisStartup","HubsExtension/ArmHelpers/Models/ArmResourceGroup","HubsExtension/Common/HubsObservables","HubsExtension/HubsCommon","HubsExtension/ResourceMap/ResourceMapCommon","HubsExtension/ResourceMap/ViewModels/ResourceProviderViewModel","HubsExtension/Store/DeploymentManagerV2","HubsExtension/MoveResource/MoveResourceCommon"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";var k;return (function(t){function lt(n){var t=k.parseResourceDescriptor(n);return t.types.length===1}function wt(n){var t=n&&n.provisioningState;return t&&t.toLowerCase()!==dt.ResourceManager.DeploymentStates.Succeeded}function fi(n,t){var r=n.filter((function(n){return lt(n.id())})),u=t.filter((function(n){return n.selected()&&lt(n.id())}));return i.union(r,u).map((function(n){return n.id()}))}function ei(
n,t){n.forEach((function(n){var r=n.type(),i=e.findAssetTypeInformation(r,t)||{};n.icon(i.icon||tt.ResourceDefault());n.type(i.compositeDisplayName&&i.compositeDisplayName.singular||r)}))}function g(n,t,i){var r=i?ut.StatusBadge.Error():ti,e="<a>{0}<\/a>".format(s.moveDocLabel);return new ft.LinkViewModel(n,{image:f.observable(r),text:f.observable(t+" "+e),clickableLink:f.observable(u.Part.createClickableLinkViewModel(f.observable(rt.hubsLinks.moveResourcesDoc)))})}var kt=i.Assets,dt=i.Azure,nt=i.Base,gt=r.Extension.CloudName,ut=nt.Images,tt=ut.Polychromatic,u=i.ViewModels,ni=u.ActionBars,ft=u.Controls.InfoBox,at=u.Controls.DockedBalloon,et=u.Controls.Lists.Grid,ot=et.Format,st=et.ViewModel,k=u.Services.ResourceTypes,vt=u.Forms,ht=s.Move,it=s.ClassicMove,yt=ht.NotSupported.insufficientPermissions,pt=h.EmptyResourceGroup.Form,ti=tt.Info(),ii=nt.Diagnostics.createLog(n),ct="<div style='margin-top: 5px'><div style='width: 30px; height: 30px; float: left; margin-right: 10px; margin-top: 5px' data-bind='image: settings.item.icon'><\/div><div><div data-bind='text: settings.item.name' class='msportalfx-text-regular msportalfx-text-ellipsis msportalfx-tooltip-overflow'><\/div><\/div><div><div class='msportalfx-text-regular msportalfx-text-muted-50 msportalfx-text-ellipsis msportalfx-tooltip-overflow' data-bind='text: settings.item.type'><\/div><\/div><\/div>",
bt;t.maxMovableResourceCount=250;var ri=1,ui=3,rt=window.fx.environment,d="MoveResource.";bt=(function(){function n(n,t,r){var e=this,h,o;this.infoBoxViewModel=f.observable(null);this.showResourcesToMoveHeader=f.observable(!0);this.resourcesToMoveHeaderText=f.observable(s.resourcesToMoveHeaderText);this.resourcesToMoveGrid=f.observable(null);this.showRelatedResourcesHeader=f.observable(!1);this.disabledResourcesHeaderText=ht.disabledResources;this.relatedResourcesHeaderText=f.observable(s.relatedResourcesHeaderText);this.infoBalloonViewModel=f.observable(null);this.relatedResourcesGrid=f.observable(null);this.disabledResourcesGrid=f.observable(null);this.moveToHeaderText=f.observable(s.moveToHeaderText);this.hideMoveToSection=f.observable(!1);this.actionBarOutput=f.observable();this.showResourceGroupDropDown=f.observable(!0);this.allowRGMove=f.observable(!0);this.allowSubMove=f.observable(!0);this.isClassicSubscriptionMove=f.observable(!1);this.createNewPickExistingLabel=f.observable(s.
createNewResourceGroup);this.hasOtherResourceGroups=f.observable(!0);this.validationErrorDetails=f.observable("");this.switchCreateAndPickResourceGroup=function(){e.showResourceGroupDropDown(!e.showResourceGroupDropDown());e.showResourceGroupDropDown()?e.createNewPickExistingLabel(s.createNewResourceGroup):e.createNewPickExistingLabel(s.pickExistingResourceGroup)};this._cloudNameInitialized=f.observable(!1);this._resourceGroupId="";this._isResourceGroupMove=!1;this._relatedResources=f.observableArray([]);this._requiredResources=f.observableArray([]);this._disabledResources=f.observableArray([]);this._resourceGroupsArray=f.observableArray([]);this._subscriptionsArray=f.observableArray([]);this._hasAccessToMultipleSubscriptions=!1;this._container=n;this._dataContext=r;h=t&&t.content||{};o=h.errorPaneSelectable||{};this.errorPaneSelectable=new u.Internal.Selectable({allowUnselect:!1,selectedValue:o.selectedValue,isSelected:o.isSelected,isActivated:o.isActivated});n.registerForDispose(this.
errorPaneSelectable);n.registerSelectable(n.createChildLifetime(),i.newGuid(),this.errorPaneSelectable,{openInContextPane:!0});this._populateMoveToSection(this._container);this.hideMoveToSection(!0);this._resourceProvider=new p.ResourceProviderViewModel(this._container,null,null)}return n.prototype.onInputsSet=function(n){var t=this,f,s,u;if(this._cloudName=gt.readFromInputs(n),this._cloudNameInitialized(!0),this._resourceGroupsArray([]),this._subscriptionsArray([]),this._relatedResources([]),this._requiredResources([]),this._disabledResources([]),this.showResourcesToMoveHeader(!1),this.infoBoxViewModel(null),this.actionBar.clearGroupValidationMessage(),i.isUndefined(n.moveType)||(this._moveType=n.moveType,f=n.moveType===ui,this.allowSubMove(f||n.moveType===0),this.allowRGMove(f||n.moveType===ri)),n.resourceId){var r=this._resourceId=n.resourceId,e="",o="";return k.isResourceGroupId(r)?(this._resourceGroupId=r,this._isResourceGroupMove=!0,e=nt.Constants.ResourceTypes.ResourceGroups,o=k.
buildSubscriptionIdFromResourceGroupId(this._resourceGroupId)):(e=k.buildResourceTypeFromResourceId(r),s=b.isClassicResource(r),u=k.parseResourceDescriptor(r),o=k.buildSubscriptionIdFromResourceDescriptor(u),this.isClassicSubscriptionMove(s&&this.allowSubMove()),this._topmostParentResourceId=k.buildTopmostParentResourceIdFromDescriptor(u),this._resourceGroupId=k.buildResourceGroupIdFromResourceDescriptor(u)),this._subscriptionId=k.parseSubscriptionDescriptor(o).subscription,a.getSubscriptionInfoPromise(this._subscriptionId,this._cloudName).then((function(n){t._subscription=n;var i=t.isClassicSubscriptionMove()?t._checkClassicSubMovePreConditions():t._checkMovePreConditions(e);return i.then((function(n){if(n)return t._arrangeResourcesToMoveSection()}))}))}return},n.prototype._checkMovePreConditions=function(){var n=this,t=this._cloudName,i=this._resourceGroupId;return this._subscription.state.toLowerCase()===v.subscriptionDisabledStatus?(this._setBladeToMoveNotAllowed(s.movingResourcesFromDisabledSubscriptionNotAllowed),
Q(!1)):r.Security.hasPermission(i,[b.Actions.MoveResourcesAction],t).then((function(t){return t?!0:(n._setBladeToMoveNotAllowed(yt),!1)}),(function(){return Q(!0)})).then((function(r){var u=c.makeResourceManagerTelemetry(d+"checkRGStatus");return y.ResourceGroupClient.getResourceGroup(i,t,u).then((function(t){return t&&wt(t)?(n._setBladeToMoveNotAllowed(s.sourceResourceGroupBusy),Q(!1)):Q(r)})).catch((function(t){if(t.status===404||t.status===0||t.status===403)return n._setBladeToMoveNotAllowed(s.resourceGroupPermissionsValidationMessage),!1;throw t;}))}))},n.prototype._checkClassicSubMovePreConditions=function(){var n=this,t=k.buildSubscriptionIdFromSubscriptionName(this._subscriptionId),i=this._cloudName;return r.Security.hasPermission(t,[b.Actions.ValidateSubscriptionMoveAvailabilityAction],i).then((function(t){return t?!0:(n._setBladeToMoveNotAllowed(yt),!1)})).then((function(r){return n._dataContext.validateSubscriptionMoveAvailability(t,"source",i).then((function(t){return t&&t.status.toLowerCase(
)==="unavailable"?(n._setBladeToMoveNotAllowed(it.sourceSubNotAvailable),n.validationErrorDetails((t.reasons||[]).join()),!1):r}))})).catch((function(){return!0}))},n.prototype._getResourcesForMove=function(){return this._isResourceGroupMove?this._getResourcesForResourceGroupMove(this._resourceId):this._getResourcesForResourceMove(this._topmostParentResourceId)},n.prototype._setBladeToMoveNotAllowed=function(n){this.showRelatedResourcesHeader(!1);this.hideMoveToSection(!0);this.infoBoxViewModel(g(this._container,n,!0))},n.prototype._arrangeResourcesToMoveSection=function(){var n=this,t=this.allowSubMove(),i=this._subscriptionId;return b.resourceTypeCachePromise.then((function(){return!t&&n.allowRGMove()?(n._populateResourceGroupsArray(i,n._resourceGroupsArray),n._getResourcesForMove()):t?n._populateSubscriptionsArray(n._subscriptionsArray).then((function(){if(!n._hasAccessToMultipleSubscriptions)return Q();if(n.isClassicSubscriptionMove()){n.allowRGMove(!1);var t=new u.CustomValidation(it.targetSubNotAvailable,
function(t){return Q(n._dataContext.validateSubscriptionMoveAvailability("/subscriptions/"+t.subscriptionId,"target",n._cloudName)).then((function(n){return Q.resolve({message:(n.reasons||[]).join(),valid:n.status&&n.status.toLowerCase()==="available"})}))});return n.subscriptionDropdown.validations.push(t),n._getResourcesForClassicSubscriptionMove(n._resourceId)}return n._getResourcesForMove()})):void 0}))},n.prototype._populateMoveToSection=function(n){var t=this,h,l,e;this.subscriptionDropdown=o.create(n,{label:f.observable(s.subscriptionLabel),items:this._subscriptionsArray,validations:f.observableArray([new u.RequiredValidation(s.subscriptionRequiredValidationMessage),new u.CustomValidation(s.subscriptionDisabledValidationMessage,function(n){var t=n&&n.state.toLowerCase()!==v.subscriptionDisabledStatus;return Q.resolve({message:s.subscriptionDisabledValidationMessage,valid:t})})])});this.resourceGroupDropdown=o.create(n,{label:f.observable(s.resourceGroupLabel),items:this._resourceGroupsArray,
validations:f.observableArray([new u.RequiredValidation,new u.CustomValidation(s.resourceGroupBusyValidationMessage,function(n){var t=!wt(n);return Q.resolve({message:s.resourceGroupBusyValidationMessage,valid:t})}),new u.CustomValidation(s.resourceGroupPermissionsValidationMessage,function(n){return n?Q(r.Security.hasPermission(n.id,["microsoft.resources/subscriptions/resourcegroups/write"],t._cloudName)).then((function(n){return{message:s.resourceGroupPermissionsValidationMessage,valid:n}}),(function(){return{message:s.resourceGroupPermissionsValidationMessage,valid:!0}})):i.ViewModels.getValidationResultPromise()})])});f.reactor(n,(function(){var i=t.subscriptionDropdown.value(),n;t._resourceGroupsArray([]);n=i&&i.subscriptionId;n&&t._cloudNameInitialized()&&(t.isClassicSubscriptionMove()||(f.ignoreDependencies((function(){t._populateResourceGroupsArray(n,t._resourceGroupsArray)})),t.resourceGroupDropdown.value(null)))}));h={label:f.observable(s.resourceGroupLabel),validations:f.observableArray(
[new u.RequiredValidation(pt.resourceGroupTextBoxEmptyValue),new u.CustomValidation(pt.resourceGroupTextBoxEmptyValue,function(n){var i=t.allowSubMove()?t.subscriptionDropdown.value():t._subscription;return n&&y.validateResourceGroupName(n,i,t._cloudName)})])};this.newResourceGroupTextBox=new vt.TextBox.ViewModel(n,h);l={inlineLabel:!0,label:f.observable(s.confirmResourceMove),infoBalloonContent:f.observable(s.confirmMoveInfoBalloonLabel),infoBalloonLinkContent:f.observable(new u.Controls.Balloon.Link(s.moveDocLabel,rt.hubsLinks.moveResourcesDoc)),defaultValue:f.observable(!1)};this.confirmationCheckBox=new vt.CheckBox.ViewModel(n,l);e=this.actionBar=new ni.GenericActionBar.ViewModel(this._container);e.infoBoxSelectable=this.errorPaneSelectable;e.enableErrorInfoBox(!0);e.actionButtonLabel(s.actionBarText);e.groupValidation={validate:function(){var r;if(t.hideMoveToSection())return t.actionBarOutput(!0),i.ViewModels.getValidationResultPromise();var h=t._resourceGroupId,n,u=fi(t._requiredResources(
),t._relatedResources()),f=function(){return t.isClassicSubscriptionMove()?(t._moveResourcesToSubscription(),i.ViewModels.getValidationResultPromise()):t._dataContext.validateMoveResources(h,n,u,t._cloudName).then((function(i){return t._moveResources(n,u),i}),(function(n){return{valid:!1,message:s.validationFailedMsg,blade:{extension:nt.Constants.ExtensionNames.Hubs,detailBlade:"ArmErrorsBlade",detailBladeInputs:{errors:n},openInContextPane:!0}}}))};if(t.showResourceGroupDropDown())return r=t.resourceGroupDropdown.value(),n=r&&r.id,f();var l=t.allowSubMove()?t.subscriptionDropdown.value().subscriptionId:t._subscriptionId,e=t.newResourceGroupTextBox.value(),o=c.makeResourceManagerTelemetry(d+"createRG");return y.ResourceGroupClient.getResourceGroup(t._resourceGroupId,t._cloudName,o).then((function(i){return w.createResourceGroup(l,e,i.location,t._cloudName,o).then((function(t){var i=t&&t.properties&&t.properties.provisioningState&&t.properties.provisioningState.toLowerCase();return i==="succeeded"?
(n=t.id,f()):Q({valid:!1,message:s.rgCreateFailureMsg.format(e)})}))})).catch((function(n){if(n.status===404||n.status===0||n.status===403)return Q({valid:!1,message:s.resourceGroupPermissionsValidationMessage});ii.error("Failed to create a new resource group".format(n.message))}))}};f.reactor(this._container,(function(){var r=t.subscriptionDropdown.valid(),n,i;n=t.showResourceGroupDropDown()?t.resourceGroupDropdown.valid():t.newResourceGroupTextBox.valid();i=t.confirmationCheckBox.value();f.ignoreDependencies((function(){e.valid(r&&n&&i)}))}))},n.prototype._populateResourceGroupsArray=function(n,t){var r=this,u=c.resourceGroupsInSubscriptionApi(n),i=[],e=this._resourceGroupId.toLowerCase(),o=c.makeResourceManagerTelemetry(d+"resourceGroupsArray");c.callWithContinuation([u],(function(n){var t=n.map(l.toResourceGroup).filter((function(n){return!!n}));i=i.concat(t)}),(function(n){throw n;}),this._cloudName,o).then((function(){i&&i.length>0&&(i.forEach((function(n){n.id.toLowerCase()!==e&&t.peek().push({
text:f.observable(n.name),value:n})})),t.valueHasMutated());t().length?(r.showResourceGroupDropDown(!0),r.hasOtherResourceGroups(!0)):(r.showResourceGroupDropDown(!1),r.hasOtherResourceGroups(!1))}))},n.prototype._populateSubscriptionsArray=function(n){var t=this;return Q(r.Azure.getAllSubscriptions(r.Rpc.client,this._cloudName)).then((function(i){var e,o,r;i&&i.length>0&&(e=t.allowRGMove(),o=t._subscriptionId.toLowerCase(),i.forEach((function(t){(e||t.subscriptionId.toLowerCase()!==o)&&n.peek().push({text:f.observable(t.uniqueDisplayName),value:t})})),n.valueHasMutated());n().length?t._hasAccessToMultipleSubscriptions=!0:(t.hideMoveToSection(!0),r=void 0,rt.hubsLinks.createNewSubscription?r=new ft.LinkViewModel(t._container,{image:f.observable(tt.ErrorIcon()),text:f.observable(s.noSubscriptionsInfoBoxMessage),clickableLink:f.observable(u.Part.createClickableLinkViewModel(f.observable(rt.hubsLinks.createNewSubscription)))}):(r=new ft.ViewModel(t._container,!1),r.image=f.observable(tt.ErrorIcon(
)),r.text=f.observable(s.noSubscriptionsInfoBoxMessage)),t.infoBoxViewModel(r))}))},n.prototype._moveResources=function(n,t){var i=this;return this._dataContext.moveResources(this._resourceGroupId,n,t,this._cloudName).then((function(){i.actionBarOutput(!0)}))},n.prototype._moveResourcesToSubscription=function(){var i=this,r=this._subscriptionId,n,t=[];return this._requiredResources().forEach((function(n){var i=n.id();lt(i)&&t.push(i)})),n=this.allowSubMove()?this.subscriptionDropdown.value().subscriptionId:this._subscriptionId,n=n,this._dataContext.moveResourcesToSubscription(r,n,t,this._cloudName).then((function(){i.actionBarOutput(!0)}))},n.prototype._getResourcesForResourceGroupMove=function(n){var t=this,i=c.makeResourceManagerTelemetry(d+"resourcesForGroupMove");return this._resourceProvider.getResourceGroupResults(n,this._cloudName,i).then((function(i){var r=i.result,u=r&&r.resourcesInResourceGroup||[];u.length?t._populateResources(n,u,[],[]):t.infoBoxViewModel(g(t._container,s.noResourcesMessage,
!1))}))},n.prototype._getResourcesForResourceMove=function(n){var t=this,i=c.makeResourceManagerTelemetry(d+"resourcesForMove");return this._resourceProvider.getResourceResults(n,this._cloudName,i).then((function(i){var r=i.result,u=r&&r.resourcesInResourceGroup||[],f=r&&r.resourcesLinkedFromResource||[],e=r&&r.resourcesLinkedToResource||[];u.length?t._populateResources(n,u,f,e):t.infoBoxViewModel(g(t._container,s.noResourcesMessage,!1))}))},n.prototype._getResourcesForClassicSubscriptionMove=function(n){var t=this,i=k.parseResourceDescriptor(n).subscription,r=c.makeResourceManagerTelemetry(d+"resourcesForSubMove");return y.ResourceClient.getClassicResourcesInSubscription(i,this._cloudName,r).then((function(i){i&&i.length?t._populateResources(n,i,[],[]):t.infoBoxViewModel(g(t._container,s.noResourcesMessage,!1))}))},n.prototype._populateResources=function(n,i,r){var u=this,a=this._container,e="",w=i.map((function(n){return n.type})),d=w.unique(),o=[],h=[],c=[],v=!1,y=n.toLowerCase(),nt=y+"/",
p,l;i.forEach((function(t){var i={id:f.observable(t.id),name:f.observable(t.name),icon:f.observable(ut.Loading.EllipsisSquare()),type:f.observable(t.type),selected:f.observable(!1)},s=b.isClassicResource(t.id),p=u.allowSubMove(),l=t.id.toLowerCase(),w=u._moveType,a;if(b.supportsMoveType(t.type,w))if(k.isResourceGroupId(n))s?(v=!0,i.selected(!1),c.push(i)):(i.selected(!0),o.push(i));else if(u.isClassicSubscriptionMove())e=ht.cannotMoveWithClassicRes,s&&(i.selected(!0),h.push(i));else{if(p&&s){e=it.cannotMoveWithNonClassicRes;return}l===y||l.startsWith(nt)?(i.selected(!0),h.push(i)):(r&&r.length>0&&(a=r.first((function(n){return k.compareResourceId(n,l)})),a&&i.selected(!0)),o.push(i))}else c.push(i)}));h.length?(this._requiredResources(h),this._initializeRequiredResourcesGrid(),this.showResourcesToMoveHeader(!0),this.hideMoveToSection(!1)):o.length&&this.hideMoveToSection(!1);o.length>0&&(this._relatedResources(o),this.hideMoveToSection(!1),this._isResourceGroupMove||this.showRelatedResourcesHeader(
!0),this.showResourcesToMoveHeader(!0),this._initializeRelatedResourcesGrid());c.length>0&&(this._disabledResources(c),this._initializeDisabledResourcesGrid());v&&!this.infoBoxViewModel()&&this.infoBoxViewModel(g(a,it.cannotMoveWithNonClassicRes,!1));(this._requiredResources().length>=2||e)&&!this.infoBoxViewModel()&&(p=e.length?e:s.requiredResourcesInfoBoxMessage,this.infoBoxViewModel(g(a,p,!1)));this._relatedResources().length>t.maxMovableResourceCount&&(l=new at.ViewModel(a),l.type=at.Type.Info,l.content(s.selectMaxResourcesInResourceGroup.format(t.maxMovableResourceCount)),this.infoBalloonViewModel(l));kt.getResourceTypeAssetTypeInformation(d).then((function(n){var t=u._requiredResources().concat(u._relatedResources()).concat(u._disabledResources());ei(t,n)}))},n.prototype._initializeRequiredResourcesGrid=function(){var t=[{name:f.observable(""),itemKey:"name",format:ot.HtmlBindings,formatOptions:{htmlBindingsTemplate:ct}}],n=new st(this._container,this._requiredResources);n.columns=
f.observableArray(t);n.showHeader=!1;this.resourcesToMoveGrid(n)},n.prototype._initializeRelatedResourcesGrid=function(){var t=[{name:f.observable(s.selectAll),itemKey:"name",format:ot.HtmlBindings,formatOptions:{htmlBindingsTemplate:ct}}],n=new st(this._container,this._relatedResources,et.Extensions.SelectableRow,{selectableRow:{selectionMode:2}});n.columns=f.observableArray(t);n.showHeader=!0;this.relatedResourcesGrid(n);this._relatedResources().forEach((function(t){if(t.selected()){var i=n.getRowMetadata(t);i.selected(!0)}}));this.relatedResourcesGrid().selectableData.selectedItems.subscribeArrayEdits(this._container,(function(n){n.forEach((function(n){var t=n.status,i=n.value;t==="added"?i.selected(!0):t==="deleted"&&i.selected(!1)}))}))},n.prototype._initializeDisabledResourcesGrid=function(){var t=[{name:f.observable(""),itemKey:"name",format:ot.HtmlBindings,formatOptions:{htmlBindingsTemplate:ct}}],n=new st(this._container,this._disabledResources);n.columns=f.observableArray(t);n.showHeader=
!1;this.disabledResourcesGrid(n)},n})();t.MoveResourcePartVM=bt})(k||(k={})),k}));define("HubsExtension/_generated/Blades/MoveResource.css",["require","exports"],(function(){"use strict";return".ext-hubs-moveresource-resourcesection{height:calc(100% - 215px)}.ext-hubs-moveresource-optionalheader{float:left;margin-right:5px;margin-top:5px;max-width:280px}.ext-hubs-moveresource-movetosection{position:absolute;bottom:0;height:220px;width:100%}.ext-relatedresourcegrid{float:left}.ext-hubs-moveresource-movetosection-confirmationCheckBox{margin-top:20px}.ext-hubs-moveresource-movetosection-header{margin-bottom:10px;padding-top:10px;border-top:1px #e9e9f3 solid}.ext-hubs-moveresource-movetosection-createrglink{position:absolute;right:25px}.ext-hubs-moveresource-errormsg{text-overflow:ellipsis;width:250px;word-wrap:break-word}"}));define("HubsExtension/_generated/Blades/MoveResourceBlade",["require","exports","HubsExtension/_generated/Blades/MoveResource.css","HubsExtension/MoveResource/ViewModels/MoveResourceBladeVM",
"HubsExtension/MoveResource/ViewModels/MoveResourcePartVM"],(function(n,t,i){"use strict";var r;return (function(n){n.blade={name:"MoveResourceBlade",inputs:["resourceId","moveType"],templateKeyInputs:["resourceId"],outputs:["actionBarOutput"],commandGroup:"MoveResourceBladeCommands",viewModelName:"MoveResource$MoveResourceBladeVM",lenses:[{name:"MoveResourceLens",partInstances:[{name:"MoveResourcePart",inline:{styleSheets:[{file:"Blades/MoveResource.css",content:i}],viewModel:"MoveResource$MoveResourcePartVM",partKind:0,inputs:["resourceId","moveType"],bindings:[{property:"resourceId",valuesFrom:[{referenceType:1,property:"resourceId"}]},{property:"moveType",valuesFrom:[{referenceType:1,property:"moveType"}]}],details:[],initialSize:9,supportedSizes:[9],htmlTemplateInline:{file:"MoveResourcePartTemplate.html",content:'<div class="msportalfx-overflowY ext-hubs-moveresource-resourcesection"> <!-- ko if: infoBoxViewModel() --> <div data-bind="pcControl: infoBoxViewModel()"><\/div> <!-- /ko --> <!-- ko if: validationErrorDetails() --> <div class="ext-hubs-moveresource-errormsg" data-bind="text: validationErrorDetails(), attr: { title: validationErrorDetails() }"><\/div> <!-- /ko --> <!-- ko if: showResourcesToMoveHeader() --> <div class="msportalfx-text-header-regular msportalfx-text-ellipsis msportalfx-tooltip-overflow" data-bind="text: resourcesToMoveHeaderText"><\/div> <!-- /ko --> <!-- ko if: resourcesToMoveGrid() --> <div class="msportalfx-grid-borderless" data-bind="pcControl: resourcesToMoveGrid()"><\/div> <!-- /ko --> <!-- ko if: showRelatedResourcesHeader() --> <div> <div class="msportalfx-text-regular msportalfx-text-muted-50 msportalfx-text-ellipsis msportalfx-tooltip-overflow ext-hubs-moveresource-optionalheader" data-bind="text: relatedResourcesHeaderText"><\/div> <!-- ko if: infoBalloonViewModel() --> <div data-bind="pcControl: infoBalloonViewModel()"><\/div> <!-- /ko --> <\/div> <!-- /ko --> <!-- ko if: relatedResourcesGrid() --> <div class="msportalfx-grid-borderless ext-relatedresourcegrid" data-bind="pcControl: relatedResourcesGrid()"><\/div> <!-- /ko --> <!-- ko if: disabledResourcesGrid() --> <div class="msportalfx-text-regular msportalfx-text-muted-50 msportalfx-text-ellipsis msportalfx-tooltip-overflow ext-hubs-moveresource-optionalheader" data-bind="text: disabledResourcesHeaderText"><\/div> <div class="msportalfx-grid-borderless ext-relatedresourcegrid" data-bind="pcControl: disabledResourcesGrid()"><\/div> <!-- /ko --> <\/div> <!-- ko if: !hideMoveToSection() --> <div class="msportalfx-form-custom ext-hubs-moveresource-movetosection"> ﻿<div class="msportalfx-text-header-regular msportalfx-text-ellipsis msportalfx-tooltip-overflow ext-hubs-moveresource-movetosection-header" data-bind="text: moveToHeaderText"><\/div> <!--ko if: allowSubMove() --> <div data-bind="pcControl: subscriptionDropdown"><\/div> <!-- /ko--> <!-- ko if: showResourceGroupDropDown() && !isClassicSubscriptionMove() --> ﻿<div data-bind="pcControl: resourceGroupDropdown"><\/div> <!-- /ko --> <!-- ko if: !showResourceGroupDropDown() && !isClassicSubscriptionMove() --> ﻿ <div data-bind="pcControl: newResourceGroupTextBox"><\/div> <!-- /ko --> <!-- ko if: hasOtherResourceGroups() && !isClassicSubscriptionMove() --> <a href="" class="ext-hubs-moveresource-movetosection-createrglink msportalfx-link-primary" data-bind=\'click: switchCreateAndPickResourceGroup, text: createNewPickExistingLabel\'><\/a> <!-- /ko --> <div data-bind="pcControl: confirmationCheckBox" class="ext-hubs-moveresource-movetosection-confirmationCheckBox msportalfx-form"><\/div> <\/div> <!-- /ko -->'}}}]}],
viewModelInputs:[{property:"resourceId",valuesFrom:[{referenceType:1,property:"resourceId"}]},{property:"moveType",valuesFrom:[{referenceType:1,property:"moveType"}]}],bindings:[{property:"actionBarOutput",valuesFrom:[{referenceType:0,property:"content.actionBarOutput",part:"MoveResourcePart"}]}],width:0,locked:!0,actionBar:{name:"",actionBarKind:6,source:{valuesFrom:[{referenceType:0,property:"content.actionBar",part:"MoveResourcePart"}]},bindings:[]},waitForInputsSet:!0,attributes:0}})(r||(r={})),r}))