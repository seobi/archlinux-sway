define("MsPortalImpl/Base/Telemetry",["require","exports","f","o"],(function(n,t,i){"use strict";var r;return (function(n){function t(n,t){i.extendArrayIntoMap(n,t)}var r,u,f;(function(n){t(n,["Asset","Blade","BrowseBlade","BrowseManager","BrowserRefresh","Dashboard","Desktop","DirectoryPane","DragDropCompositionManager","FeedbackPane","FormControl","Gallery","HelpBlade","HelpPane","KeyboardShortcuts","Lens","NotificationHub","PartGallery","Resource","ResourceSummary","Search","Shell","SideBar","StartBoardPart","SettingsBlade","SettingsPane","TileAction","ToastTray","TopBar",])})(r=n.Source||(n.Source={})),(function(n){t(n,["ActionBarClicked","AddPartByDragDrop","AvatarMenuOpenBilling","AvatarMenuOpenFeedback","AvatarMenuOpenAccessDetails","AvatarMenuOpen","AvatarMenuSignOut","AvatarMenuSwitchTenant","BladeClosed","BladeLoaded","BladeFullOpened","BladeOpened","BladeFullReady","BladeFullRevealed","BladeReady","BladeRevealed","BladeRebind","BladeLoadErrored","BladeCollapse","MenuCollapse","BreadCrumbClicked",
"BreadCrumbHomeClicked","BrowseAssetsCollected","BrowseCanceled","BrowseFeedback","BrowseSaved","BrowseStarted","BrowseItemActivated","BrowseRecentItemRemoved","BrowseItemDeactivated","BrowseTypeActivated","BrowseTypeDeactivated","ClonePartAcrossBlades","ClonePartInSameBlade","CommandExecuted","ConsoleClosed","ConsoleMaximized","ConsoleMinimized","OpenFileShare","ConsoleOpened","ConsoleRestored","CustomClick","CustomizeModeEntered","CustomizeModeExited","DashboardDiscard","DashboardEditCommandClicked","DashboardPublish","DashboardPublishNew","DashboardSaveACopy","DashboardView","DashboardViewTime","DashboardDelete","DashboardPinPart","DashboardNavigation","DeepLinkVisited","DialogClosed","DialogOpened","DirectoryPaneSwitchTenant","DockBlades","ExtensionSignedOut","ExtensionTooManyErrors","ExtensionVersionChanged","FeedbackSmileyClicked","FormFocused","FormBlurred","GenericFeedback","HashChanged","HelpBladeOpen","HelpMenuOpen","HelpMenuOpenLegal","HelpMenuOpenKeyboardShortcuts","HelpMenuOpenSupportRequest",
"HelpMenuOpenManageSupportRequest","HomeButtonClicked","NotificationMenuOpen","NotificationMenuNotificationClick","SearchFeedback","SearchSession","SearchExecuted","SearchAllResourcesExecuted","SearchAllRecentsExecuted","SearchResourceGroupsExecuted","SearchMarketplaceExecuted","SearchResultOpened","JourneyDeactivated","JourneyOpened","JourneyScroll","KeyboardShortcutExecuted","LinkClicked","NPSDismissed","NPSScoreClicked","NPSShown","NPSSubmitted","NPSOpenSurvey","OnInputsSetResolved","Opened","ShellVersionChanged","SideBarLoaded","SideBarBrowseMenuOpened","SideBarBrowseMenuViewInitialized","SideBarBrowseMenuViewChanged","SideBarFavorite","SideBarFavoriteMoved","SideBarItemOpened","SideBarNewMenuOpened","SideBarUnFavorite","SideBarViewChanged","PartClick","PartGalleryLearnRelatedResources","PartGalleryOpenRelatedResources","PartGalleryStart","PartGalleryItemsLoaded","PartLoaded","PartLoadedNoExtensionDerived","PartPosition","PartReady","PartRevealed","PartErrored","PartMigrated","PortalInitializeLanguage",
"PortalInitializeWelcome","PortalRedirect","RelexDisconnected","RelexOnReloadSet","ResourceSummaryCopyProperty","ResourceSummaryAction","RestoreJourney","ResultOpened","NotificationClicked","RecommendationClicked","RecommendationSurfaced","RecommendationAdded","Redirect","RedirectFallback","RotateTheme","SelectedTheme","SelectedHighContrastMode","SeeAll","SettingsBladeOpen","SettingsBladeSwitchLanguage","SettingsBladeSwitchRegionalFormat","SettingsBladeSwitchTheme","SettingsBladeToggleNotificationToasts","SettingsBladeToggleRelex","SettingsBladeToggleCommandLabels","SettingsBladeRestoreDefaults","SettingsPaneOpen","SettingsPaneSwitchLanguage","SettingsPaneSwitchRegionalFormat","SettingsPaneSwitchTheme","SettingsPaneSwitchIdleTimeout","SettingsPaneToggleNotificationToasts","SettingsPaneToggleRelex","SettingsPaneToggleDblClickTheme","SettingsPaneToggleCommandLabels","SettingsPaneRestoreDefaults","StackLayoutMoveNext","StackLayoutMovePrevious","StartBoardPartLoaded","StartButtonClicked","StartFileDownload",
"TileActionClicked","ToastClicked","UnhandledExtensionError","UnknownNetworkError","HelpPaneOpen","HelpPaneFeedback","HelpPaneRequestContent","HelpMenuOpenWelcomeSequence","WhatsNewBladeOpen",])})(u=n.Action||(n.Action={})),(function(n){t(n,["Default","Failed","Redirect","Succeeded","FailedToGetBlade","FailedPreCheck","FailedToLoadExtension","FailedInvalidUIDefinition","Search","StartBoardRestored","JourneyRestored","PortalScrolled",])})(f=n.ActionModifier||(n.ActionModifier={}))})(r||(r={})),r}));define("MsPortalImpl/Base/Base.EventTypes",["require","exports","f","o"],(function(n,t,i,r){"use strict";r.defineProperty(t,"__esModule",{value:!0});var u=undefined,f={doubleclick:"dblclick",mousewheel:"wheel",fxrightclick:"rightclick",animationstart:u,blur:u,change:u,click:u,contextmenu:u,dragover:u,dragstart:u,dragend:u,dragenter:u,dragleave:u,drop:u,focus:u,hashchange:u,input:u,keydown:u,keypress:u,keyup:u,mousedown:u,mouseenter:u,mouseleave:u,mousemove:u,mouseout:u,mouseover:u,mouseup:u,popstate:
u,resize:u,scroll:u,selectstart:u,transitionend:u,focusin:u,focusout:u,remove:u,fxactionbarclick:u,fxactionbarvalidationtargetupdated:u,fxactionbarvalidationtargetmutated:u,fxautosettings:u,fxbladerepos:u,fxbladestatusbarclicked:u,fxbreadcrumbclick:u,fxbreadcrumbupdate:u,fxcontextmenu:u,fxcontextmenurequest:u,fxcontextpaneclosing:u,fxcopybuttonclick:u,fxcreatepart:u,fxdashboardactivity:u,fxensurebladevisible:u,fxenterorganizemode:u,fxerrorpartclicked:u,fxexitorganizemode:u,fxhomebuttonclick:u,fxloadingontopbar:u,fxopeninnewtab:u,fxpaneresize:u,fxpartcreated:u,fxpartgallerypivotinitialized:u,fxpeekmode:u,fxportalcontrolloadfailed:u,fxreadyforfocus:u,fxrearrange:u,fxregistermenu:u,fxrotatetheme:u,fxsettingsbuttonclick:u,fxshowstartboard:u,fxshowjourney:u,fxsizechange:u,fxsizechanged:u,fxsummarycollapsed:u,fxtoastclick:u,fxunpin:u,touchcancel:u,touchend:u,touchmove:u,touchstart:u,pointerdown:u};i.forEachKey(f,(function(n,t){f[n]=t||n}));t.default=f}));define("MsPortalImpl/Base/JQueryHelper",
["require","exports","i"],(function(){"use strict";var n;return (function(n){function e(n,t){return n.find("."+t)}function u(n){return n.addClass(r)}function t(n){return n.removeClass(r)}function o(n,i){var r=i?t:u;return r(n)}function i(n){return!!n.offsetParent}function s(n){return n.toArray().some(i)}function h(){return f}function c(n){return n.filter((function(n,t){return i(t)}))}function l(n,i){return t(n),n.show(i)}var r="fxs-display-none",f=":not(.fxs-display-none)";n.findByClassName=e;n.hide=u;n.unhide=t;n.toggle=o;n.isElementVisible=i;n.isVisible=s;n.getUnhideSelector=h;n.filterVisible=c;n.forceShow=l})(n||(n={})),n}));define("MsPortalImpl/Base/Base.BrowserDetection",["require","exports"],(function(){"use strict";var n;return (function(n){function s(){var n=/AppleWebKit\/([\d.]+)/.exec(t);if(n)return parseFloat(n[1])}var t=window.navigator.userAgent,e=/Firefox\//i.test(t),r=/Chrome[ /]/i.test(t),i=/Edge\//i.test(t),u=/MSIE /i.test(t),f=/Trident\//i.test(t),o=/Safari/i.test(t);n.isFirefox=
e;n.isChrome=r&&!i;n.isEdge=i;n.isIe=u||f||i;n.isIe11=!u&&f&&!i;n.isSafari=o&&!r&&!i;n.webKitVersion=s()||0})(n||(n={})),n}));define("MsPortalImpl/Base/Base.CssSelectorParser",["require","exports"],(function(){"use strict";var n;return (function(n){function f(n){return n=n.replace("::after",":after").replace("::before",":before"),r=function(n,t){return t},l(n||"",!1)}function e(n){var t=n.map((function(n){return n.value}));return t.join("")}var a;n.parseCssSelector=f;n.subselectorToString=e;var i=jQuery.find,u=i.selectors,o=i.selectors.match,r;
/*!
         * -----------------------------------------------------------------------------
         * The portion of this file from here until "End of jQuery code snippet" is code
         * derived from the jQuery JavaScript Library v2.0.3 - http://jquery.com/
         * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
         * Released under the MIT license - http://jquery.org/license
         * Date: 2013-07-03T13:30Z
         */
var t="[\\x20\\t\\r\\n\\f]",s=new RegExp("^"+t+"+|((?:^|[^\\\\])(?:\\\\.)*)"+t+"+$","g"),h=new RegExp("^"+t+"*,"+t+"*"),c=new RegExp("^"+t+"*([>+~]|"+t+")"+t+"*"),l=function(n,t){var l,e,v,a,f,y,p,w=r[n+" "];if(w)return t?0:w.slice(0);for(f=n,y=[],p=u.preFilter;f;){(!l||(e=h.exec(f)))&&(e&&(f=f.slice(e[0].length)||f),y.push(v=[]));l=!1;(e=c.exec(f))&&(l=e.shift(),v.push({value:l,type:e[0].replace(s," ")}),f=f.slice(l.length));for(a in u.filter)(e=o[a].exec(f))&&(!p[a]||(e=p[a](e)))&&(l=e.shift(),v.push({value:l,type:a,matches:e}),f=f.slice(l.length));if(!l)break}return t?f.length:f?i.error(n):r(n,y).slice(0)};
/*!
         * End of jQuery code snippet
         * -----------------------------------------------------------------------------
         */
a=undefined})(n||(n={})),n}));define("MsPortalImpl/Base/Base.ImplUtils",["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";function rt(n,t){t=t||{};var i=t.requireHttps||!1,r=i?nt:g;return r.test(n)}function ut(n){var t="data-extensionname",i="["+t+"]["+t+"!='']";return $(n).closest(i).attr(t)||"fx"}function ft(n,t,i,r,u){var f=new o(null,n,t);f.log(i,r,u)}function s(n){n===void 0&&(n="");var t={},i=n.indexOf("?"),r=i>-1?n.substr(i+1):n,u=r.split("&");return u.forEach((function(n){if(n&&!n.match(/^\=+$/)){var i=n.split("="),r=i.shift(),u=i.length>0?i.join("="):"";t[r]=u}})),t}function h(n){var i="",t="";return tt(n,(function(n,r){i+="{0}{1}={2}".format(t,n,r);t||(t="&")})),i}function f(n){var t=n.toString().match(/^([^\:\/]+)\:\/\//);return t?t[1]+":":""}function e(n){var t;if(n=n.toString(),t=f(n),!t)return"";var i=n.substr(t.length+2),u=i.indexOf("/"),r=u>0?i.substr(0,u):i;return!r||r.indexOf("@")>0?"":r.replace(/\:.*/,"")}function y(n){var t=p(n),r=e(t),u=c(t),i=f(t),o=(i?
i.length+2:0)+r.length+(u?u.length+1:0);return!r||!i?"":t.substr(o)}function c(n){var i=f(n),r=e(n),u,t;return!i||!r?"":(u=i.length+2+r.length,t=n.toString().substring(u).match(/^\:([0-9]+)/),!t)?"":t[1]}function p(n){var t=n.toString().replace(/\#.*/g,"").replace(/\?.*/,"");return!e(t)||!f(t)?"":t}function w(n){return(n=n.toString().replace(/\#.*/g,""),!n.match(/\?/))?"":n.replace(/.*\?/,"?")}function b(n){return(n=n.toString(),!n.match(/\#/))?"":n.replace(/[^\#]*\#/,"#").replace(/\?.*/,"")}function k(n){var t=n.indexOf("#"),i=t===-1?-1:n.substr(t).indexOf("?");return t===-1?"":i===-1?"":n.substr(t+i)}var o,v;u.defineProperty(t,"__esModule",{value:!0});var d=r.Rpc,l="^([Hh][Tt][Tt][Pp][Ss]",a="://(?::)?@?(([dw.-]+)(?::(d+))?)?)([/\\w.()-]*)?(?:([?][^#]*)?(#.*)?).*$",g=new RegExp(l+"?"+a),nt=new RegExp(l+a),tt=i.forEachKey,it=i.isEmpty;t.validateAbsoluteHttpUri=rt;o=(function(){function n(n,t,i,r){this._contextData={};this.value=n;this._area=t.normalize();this._contextData=r;var u;this.
_extensionName=function(){return u||(typeof i=="string"?u=i:i&&(u=ut(i)),u=u||"fx"),u}}return n.prototype.log=function(n,t,r){var e=this._extensionName(),f;typeof t=="string"&&(f=i.extend2(this._contextData,r),u.keys(f)&&(t+=" "+JSON.stringify(f).replace(/\"([^(\")"]+)\":/g,"$1:")));d.internalClient.log(e,{level:n,code:0,area:this._area,message:i.getLogFriendlyMessage(t)})},n})();t.ProvenanceContainer=o;t.logToExtension=ft;v=(function(){function n(n){n===void 0&&(n="");this._hashQs={};this._qs={};n=n.toString();this._protocol=f(n);this._host=e(n);this._port=c(n);this._pathname=y(n);this._hash=b(n);this._qsPart=w(n);this._qs=s(this._qsPart);this._hashQsPart=k(n);this._hashQs=s(this._hashQsPart)}return n.prototype.getQueryStringValue=function(n){return this._qs[n]||""},n.prototype.setHashQueryStringValue=function(n,t){return this._hashQs[n]=t,this},n.prototype.deleteHashQueryStringValue=function(n){return delete this._hashQs[n],this},n.prototype.clearHashQueryStringIfEmpty=function(){return it(
this._hashQs)&&(this._hashQsPart=""),this},n.prototype.getHashQueryStringValue=function(n){return this._hashQs[n]||""},n.prototype.setHash=function(n){return this._hash=n,this},n.prototype.isHashEmpty=function(){return this.hash===""||this.hash==="#"},n.prototype.toString=function(){return this.href},u.defineProperty(n.prototype,"href",{get:function(){return this.path+this.queryString+this.hash+this.hashQueryString},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"path",{get:function(){return(this.protocol?this.protocol+"//":"")+this.host+(this.port?":"+this.port:"")+this.pathname},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"pathname",{get:function(){return this._pathname},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"port",{get:function(){return this._port},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"protocol",{get:function(
){return this._protocol},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"queryString",{get:function(){var n=h(this._qs);return n||this._qsPart?"?"+n:""},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"hash",{get:function(){return this._hash||this.hashQueryString?"#"+(this._hash||"").replace(/^\#/,""):""},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"hashQueryString",{get:function(){var n=h(this._hashQs);return this._hashQsPart||n?"?"+n:""},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"hashWithHashQueryString",{get:function(){return this.hash+this.hashQueryString},enumerable:!0,configurable:!0}),n.prototype.getHashParts=function(){if(!this._cachedHashParts||this._partsBasedHash!==this.hash){this._partsBasedHash=this.hash;var n=this.hash.match(/^\#([^\/]*)?(\/[^\/]*)?(\/.*)?|$/),t=n[1]||"",i=(n[2]||"").slice(1),r=n[3]||"";this._cachedHashParts=t[0]==="@"?{tenant:t.slice(1),category:i,rest:r.slice(1)}:{tenant:"",category:t,rest:i+
r}}return this._cachedHashParts},n})();t.Uri=v;t.queryStringToMap=s;t.mapToQueryString=h;t.getProtocol=f;t.getHost=e;t.getPathnameSegment=y;t.getPort=c;t.getPathSegment=p;t.getQueryStringSegment=w;t.getHashSegment=b;t.getHashQueryStringSegment=k}));define("MsPortalImpl/Base/Base.Sanitization",["require","exports","f","o","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u){"use strict";function e(n){return n===""||u.validateAbsoluteHttpUri(n)||c.test(n)}function y(n){return e(n)||o.test(n)}function p(n){return n===""||o.test(n)}function w(n){return n===""||l.test(n)}function b(n){var t=e(n);return t||a.error("Disallowed URI: "+n),t}function k(){return s}var f,s;r.defineProperty(t,"__esModule",{value:!0});var h=i.Base.Diagnostics,c=/^(vstfs:|ftp:|ftps:|sftp:|)\/\/|mailto:/,o=/^#/,l=/^(data:image)\//,a=h.createLog(n),v=(function(){function n(n,t){this.sanitizedMarkup=n;this.errors=t}return n})();t.SanitizerResult=v;f=(function(){function n(n,t,i,r,u,f){this.provenanceContext=n;this.reason=
t;this.tag=i;this.attr=r;this.binding=u;this.val=f}return n.prototype.logError=function(){var n='Sanitization error found: "'+this.reason+".";this.provenanceContext.log(2,n,{Tag:this.tag,Attribute:this.attr,Binding:this.binding,Value:this.val})},n})();f.Reasons={InvalidAttribute:"Invalid attribute",InvalidCSSClassName:"Invalid CSS class name",InvalidCSSProperty:"Invalid CSS property",InvalidTag:"Invalid tag",UnknownBindingName:"Unknown or prohibited binding",InvalidBindingValue:"Invalid binding value"};t.SanitizerError=f;t.validateUriOrBlank=e;t.validateLinkUri=y;t.validateLocalUriOnly=p;t.validateDataImage=w;t.sanitizeUri=b;s=["alt","border","colspan","rowspan","span","disabled","height","width","lang","spellcheck","title","cx","cy","d","rx","ry","x","y","x1","x2","y1","y2","fill","fill-rule","opacity","points","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-width","transform","vector-effect","aria-atomic","aria-autocomplete","aria-busy","aria-checked",
"aria-colcount","aria-colindex","aria-colspan","aria-current","aria-disabled","aria-expanded","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","role",];t.getWhitelistedAttr=k}));define("MsPortalImpl/Services/Services.SettingsProcessor",["require","exports","f","o","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u){"use strict";var f;return (function(n){var f=i.Base.Diagnostics.Telemetry,e=(function(){function n(n){this._deferred=Q.defer();this.initialized=this._deferred.promise;this.flush=Q;this._lifetimeManager=n.createChildLifetime()}return n.prototype.init=function(n,i,e,o,s){var l=this,a=f.startTrace({source:u.Source.Shell,action:
o}),h={},c=r.keys(i),v=this._lifetimeManager;c.forEach((function(r){h[r]=t.Default;i[r].subscribe(v,(function(i){h[r]!==t.ServerInProgress&&(h[r]=t.FromUser,n.setSetting(e,r,i),s&&n.flushSettings())}))}));this.flush=function(){return n.flushSettings()};n.queryStore(e).then((function(n){n=n||{};c.forEach((function(r){var u=n[r];u!==undefined&&h[r]===t.Default&&(h[r]=t.ServerInProgress,i[r](u),h[r]=t.ServerComplete)}));f.completeTrace(a);l._deferred.resolve(i)}))},n})(),t;n.SettingsProcessor=e,(function(n){n[n.Default=0]="Default";n[n.ServerInProgress=1]="ServerInProgress";n[n.ServerComplete=2]="ServerComplete";n[n.FromUser=3]="FromUser"})(t||(t={}))})(f||(f={})),f}));define("MsPortalImpl/Services/Services.GeneralSettings",["require","exports","i","ko","MsPortalImpl/Services/Services.SettingsProcessor"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function h(r){if(f&&!o.isTestMode)throw new Error(t+" has already been called.");f=!0;i.Rpc.client.registerObjectFactory(i.Constants.RpcMethods.
getSettings,{allowedOrigin:null,allowRemoteChanges:!1,handler:function(){return Q.resolve(n.settings)}});n.processor.init(r,n.settings,e,t)}var e=0,t="InitializeGeneralSettingsInternal",o=window.fx.environment,f=!1,s=new i.TriggerableLifetimeManager;n.processor=new u.SettingsProcessor(s);n.settings={rawLocale:r.observable(""),"fxs-theme":r.observable(),npsTimeMs:r.observable(0),sideBarCollapsedKey:r.observable(!1),notificationToastEnabledKey:r.observable(!0),whatsNewEnabledKey:r.observable(!0),sideBarBrowseDisplayModeKey:r.observable(0),whatsNewVersion:r.observable(0),userConsentForNpsContact:r.observable(!1),highContrastKey:r.observable(0),idleTimeoutMins:r.observable(0),dblClickThemeEnabledKey:r.observable(!0)};n.init=h})(f||(f={})),f}));define("_generated/Less/MsPortalImpl/Themes/Themes.Blue.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-theme-blue{background-color:#215b7d}.fxs-theme-blue .fxs-startboard-button,.fxs-theme-blue .fxs-startboard-header,.fxs-theme-blue .fxs-startboard-message-container{color:#fff}.fxs-theme-blue .fxs-startboard-button-icon{fill:#fff}")})
);define("_generated/Less/MsPortalImpl/Themes/Themes.LightMode.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-mode-light .azc-formControl,.fxs-mode-light .fxs-portal-border,.fxs-mode-light .msportalfx-docking-footer{border-color:#bbb}.fxs-mode-light .fxs-blade-locked,.fxs-mode-light .fxs-portal-background{background-color:#fff}.fxs-mode-light .fxs-bladecontent-unlocked,.fxs-mode-light .fxs-portal-background-secondary{background-color:#eee}.fxs-mode-light .fxs-bladestyle-create,.fxs-mode-light .fxs-bladestyle-help{background-color:#fff}.fxs-mode-light .fxs-portal-background-primary{background-color:#0058ad}.fxs-mode-light .fxs-portal-text{color:#252525}.fxs-mode-light .fxs-portal-text-primary{color:#0058ad}.fxs-mode-light .fxs-portal-title{color:#444}.fxs-mode-light .fxs-portal-bg-txt-br{color:#252525;border-color:#bbb;background-color:#fff}.fxs-mode-light .fxs-portal-focus:focus{background-color:#f5fcfe}.fxs-mode-light .fxs-portal-selected{background-color:#e5f8fd}.fxs-mode-light .fxs-portal-activated{background-color:rgba(0,137,250,.15)}.fxs-mode-light .fxs-portal-hover:hover{background-color:rgba(0,137,250,.08)}.fxs-mode-light .fxs-portal-hover:active{background-color:rgba(0,137,250,.15)}.fxs-mode-light .fxs-portal-svg{fill:#252525}.fxs-mode-light .fxs-portal-svg-secondary{fill:#444}.fxs-mode-light .fxs-tile-overlay{background-color:rgba(255,255,255,.6)}.fxs-mode-light .fxc-infoBox-image-container{background-color:#bbb}.fxs-mode-light .azc-node-fill{fill:#94caff}.fxs-mode-light .azc-node-fill-focused,.fxs-mode-light .azc-node-fill-hovered{fill:#47a5ff}.fxs-mode-light .azc-node-bg{background-color:#94caff}.fxs-mode-light .azc-node-bg-focused,.fxs-mode-light .azc-node-bg-hovered{background-color:#47a5ff}.fxs-mode-light .azc-chart{fill:#fff;stroke:#ccc}.fxs-mode-light .azc-chart text{fill:#515151}.fxs-mode-light .azc-chart text.azc-chart-axis-slider-text{fill:#252525}.fxs-mode-light .azc-external-hovered:not(.azc-row-disabled){background-color:#e6eef7}.fxs-mode-light .azc-header{background-color:#bbb;color:#252525}.fxs-mode-light .azc-formControl{background-color:#fff}.fxs-mode-light .azc-input{color:#252525}.fxs-mode-light .azc-formControl.azc-br-focused,.fxs-mode-light .azc-formControl.azc-br-focused.fxs-br-dirty,.fxs-mode-light .azc-formControl:focus{border-color:#0058ad}.fxs-mode-light .azc-bg-default{background-color:#fff}.fxs-mode-light .azc-bg-light{background-color:#e6e6e6}.fxs-mode-light .azc-bg-muted{background-color:#b3b3b3}.fxs-mode-light .azc-bg-muted-80-10{background-color:#333}.fxs-mode-light .azc-bg-console{background-color:#191919}.fxs-mode-light .azc-bg-hover{background-color:#99bcde}.fxs-mode-light .azc-bg-disabled{background-color:#e6e6e6}.fxs-mode-light .azc-bg-inverted{background-color:#4d4d4d}.fxs-mode-light .azc-bg-hover-muted:hover{background-color:grey}.fxs-mode-light .azc-br-muted{border-color:#ccc}.fxs-mode-light .azc-br-muted-80-10{border-color:#333}.fxs-mode-light .azc-br-active{border-color:#252525}.fxs-mode-light .azc-br-strong{border-color:grey}.fxs-mode-light .azc-br-focused,.fxs-mode-light .azc-br-focused.azc-br-edited,.fxs-mode-light .azc-br-focused.fxs-br-dirty,.fxs-mode-light .azc-br-focused.fxs-br-error,.fxs-mode-light .azc-br-hovered,.fxs-mode-light .azc-br-selected{border-color:#0058ad}.fxs-mode-light .azc-br-top-hovered{border-top-color:#0058ad}.fxs-mode-light .azc-br-bottom-hovered{border-bottom-color:#0058ad}.fxs-mode-light .azc-br-inverted{border-color:#4d4d4d}.fxs-mode-light .azc-stroke-muted{stroke:grey}.fxs-mode-light .azc-stroke-heavy{stroke:#666}.fxs-mode-light .azc-stroke-default{stroke:#fff}.fxs-mode-light .azc-stroke-selected{stroke:#0058ad}.fxs-mode-light .azc-fill-default,.fxs-mode-light svg.azc-fill-default{fill:#fff}.fxs-mode-light .azc-fill-heavy,.fxs-mode-light .azc-fill-hovered-heavy:hover{fill:#666}.fxs-mode-light .azc-fill-text{fill:#252525}.fxs-mode-light .azc-fill-hover{fill:#d9e6f3}.fxs-mode-light .azc-fill-selected{fill:#b3cde6}.fxs-mode-light .azc-fill-primary svg{fill:#0058ad}.fxs-mode-light .azc-scrollbar-default,.fxs-mode-light .azc-scrollbar-default:hover{-ms-scrollbar-track-color:#e6e6e6;-ms-scrollbar-face-color:#b3b3b3}.fxs-mode-light .azc-scrollbar-default::-webkit-scrollbar,.fxs-mode-light .azc-scrollbar-default:hover::-webkit-scrollbar{background:0 0}.fxs-mode-light .azc-scrollbar-default::-webkit-scrollbar-track-piece,.fxs-mode-light .azc-scrollbar-default:hover::-webkit-scrollbar-track-piece{background:0 0}.fxs-mode-light .azc-scrollbar-default::-webkit-scrollbar-thumb,.fxs-mode-light .azc-scrollbar-default:hover::-webkit-scrollbar-thumb{background:#b3b3b3}.fxs-mode-light .azc-text-muted{color:#757575}.fxs-mode-light .azc-text-console{color:#e6e6e6}.fxs-mode-light .azc-text-primary,.fxs-mode-light a.azc-text-primary{color:#0058ad}.fxs-mode-light .azc-text-disabled,.fxs-mode-light a.azc-text-disabled{color:#929292}.fxs-mode-light .azc-text-inverted{color:#fff}.fxs-mode-light .azc-fill-disabled svg{fill:#929292!important}.fxs-mode-light .fxc-grid2.fxs-grid-selection tbody td.fxc-grid-activatable{color:#0058ad}.fxs-mode-light .fxc-grid2.fxs-grid-selection.fxc-pseudoHover tbody tr.fxc-grid-row:not([aria-disabled=true]):not(.fxs-portal-selected):not(.fxs-portal-activated){background-color:rgba(0,137,250,.08)}.fxs-mode-light .fxc-grid2.fxs-grid-selection.fxc-pseudoHover tbody tr.fxc-grid-row:not([aria-disabled=true])~tr.fxc-grid-row:not([aria-disabled=true]):not(.fxs-portal-selected):not(.fxs-portal-activated):not(:hover),.fxs-mode-light .fxs-blade-has-activation .fxc-grid2.fxs-grid-selection tr:not(.fxs-portal-activated){background-color:transparent}.fxs-mode-light .fxs-blade-has-activation .fxc-grid2.fxs-grid-selection .fxs-portal-activated{background-color:rgba(0,137,250,.15)}.fxs-mode-light .msportalfx-bg-muted-5{background-color:#f2f2f2}.fxs-mode-light .msportalfx-bg-muted{background-color:#e6e6e6}.fxs-mode-light .msportalfx-bg-default{background-color:#fff}.fxs-mode-light .msportalfx-text-default{color:#252525}.fxs-mode-light .msportalfx-text-white{color:#fff}.fxs-mode-light .msportalfx-text-muted-50{color:#444}.fxs-mode-light .msportalfx-fill{fill:#252525}.fxs-mode-light .msportalfx-bgcolor-paletteLightGray{background-color:#e6e6e6}.fxs-mode-light .msportalfx-highlight{color:#000;background-color:#fff100}.fxs-mode-light .msportalfx-brdr-color:hover,.fxs-mode-light .msportalfx-brdr-selected{border-color:#00bcf2}.fxs-mode-light .msportalfx-border{border-color:#bbb}.fxs-mode-light .msportalfx-text-primary{color:#0058ad}.fxs-mode-light .msportalfx-link-primary{color:#0058ad!important;fill:#0058ad}.fxs-mode-light .fxs-graph-fill{fill:#fff!important}.fxs-mode-light .azc-dockedballoon-validation{border-color:rgba(127,127,127,.7)}.fxs-mode-light .azc-has-focus .azc-dockedballoon-validation{border-color:#0058ad}.fxs-mode-light .fxs-bladestyle-create .msportalfx-form .fxs-br-dirty{border-color:#bbb}.fxs-mode-light .fxs-bladestyle-create .msportalfx-form .fxs-br-dirty.azc-br-focused{border-color:#0058ad}.fxs-mode-light .fxs-bladestyle-create .msportalfx-form .azc-is-edited .azc-dockedballoon-validation{border-color:#bbb}.fxs-mode-light .azc-validation-messages,.fxs-mode-light .fxs-text-error,.fxs-mode-light .msportalfx-text-error{color:#b40e1b}.fxs-mode-light .fxs-portal-selected.azc-bg-disabled{background-color:#acd6e2}.fxs-mode-light .fxs-button-default{background-color:#fff;border-color:#0078d7;color:#0078d7;fill:#0078d7}.fxs-mode-light .fxs-button-default .fxs-button-icon .fxs-portal-svg{fill:#0078d7}.fxs-mode-light .fxs-button-default:hover{color:#0089fa;fill:#0089fa;border-color:#0089fa;background-color:rgba(127,127,127,.1)}.fxs-mode-light .fxs-button-default:hover .fxs-button-icon .fxs-portal-svg{fill:#0089fa}.fxs-mode-light .fxs-button-default:active{color:#0062b3;fill:#0062b3;border-color:#0062b3;background-color:rgba(127,127,127,.1)}.fxs-mode-light .fxs-button-default:active .fxs-button-icon .fxs-portal-svg{fill:#0062b3}.fxs-mode-light .fxs-portal-button-primary{background-color:#0078d7;border-color:#0078d7;color:#fff;fill:#fff}.fxs-mode-light .fxs-portal-button-primary .fxs-button-icon .fxs-portal-svg{fill:#fff}.fxs-mode-light .fxs-portal-button-primary:hover{background-color:#0089fa;border-color:#0089fa}.fxs-mode-light .fxs-portal-button-primary:active{background-color:#0062b3;border-color:#0062b3}.fxs-mode-light .fxs-button-disabled,.fxs-mode-light .fxs-button-disabled:active,.fxs-mode-light .fxs-button-disabled:focus,.fxs-mode-light .fxs-button-disabled:hover{cursor:default;background-color:rgba(127,127,127,.1);border-color:transparent;outline:0;color:rgba(127,127,127,.7);fill:rgba(127,127,127,.7)}.fxs-mode-light .fxs-button-disabled .fxs-button-icon .fxs-portal-svg{fill:rgba(127,127,127,.7)}.fxs-mode-light .fxs-button-disabled:active .fxs-button-icon .fxs-portal-svg,.fxs-mode-light .fxs-button-disabled:focus .fxs-button-icon .fxs-portal-svg,.fxs-mode-light .fxs-button-disabled:hover .fxs-button-icon .fxs-portal-svg{fill:rgba(127,127,127,.7)}.fxs-mode-light .fxs-portal-button-primary.fxs-portal-optionPicker-dirty{background-color:#68217a;border-color:#68217a}.fxs-mode-light .fxs-button-default.fxs-portal-optionPicker-dirty{border-color:#68217a;color:#68217a}.fxs-mode-light .fxs-button-default.fxs-portal-optionPicker-disabled{background-color:#fff;border-color:rgba(127,127,127,.7);color:rgba(127,127,127,.7)}.fxs-mode-light .fxs-portal-button-primary.fxs-portal-optionPicker-disabled{border-color:rgba(127,127,127,.7);color:rgba(127,127,127,.7)}.fxs-mode-light .azc-radio-circle{border-color:#7f7f7f;background-color:#fff}.fxs-mode-light .azc-noRadio .azc-radio-circle:active,.fxs-mode-light .azc-noRadio .azc-radio-circle:hover{border-color:#161616}.fxs-mode-light input[type=radio]:checked~.azc-radio-circle:after{background-color:#0078d7}.fxs-mode-light .azc-radio .fxs-portal-optionPicker-disabled{color:rgba(127,127,127,.7)}.fxs-mode-light .azc-radio .fxs-portal-optionPicker-disabled .azc-radio-circle{border-color:rgba(127,127,127,.7)}.fxs-mode-light .azc-radio .fxs-portal-optionPicker-disabled input[type=radio]:checked~.azc-radio-circle:after{background-color:rgba(127,127,127,.7)}.fxs-mode-light .azc-checkBox{border-color:#7f7f7f;background-color:#fff}.fxs-mode-light .azc-checkBox:active,.fxs-mode-light .azc-checkBox:hover{border-color:#161616}.fxs-mode-light .azc-checkBox.azc-control-disabled,.fxs-mode-light .azc-input{border-color:rgba(127,127,127,.7)}.fxs-mode-light .azc-checkBox.azc-control-disabled .azc-checkBox-svg{fill:rgba(127,127,127,.7)}.fxs-mode-light .azc-checkBox.azc-control-disabled .azc-disabled{background-color:#fff}.fxs-mode-light .azc-checkBox .azc-checkBox-svg{fill:#0078d7}.fxs-mode-light .azc-text-label,.fxs-mode-light .azc-text-sublabel{color:#595959}.fxs-mode-light .msportalfx-form-formelement-disabled .azc-text-label,.fxs-mode-light .msportalfx-form-formelement-disabled .azc-text-sublabel{color:rgba(127,127,127,.7)}.fxs-mode-light .azc-disabled,.fxs-mode-light .azc-disabled:focus,.fxs-mode-light .azc-disabled:hover,.fxs-mode-light input.azc-disabled{color:rgba(127,127,127,.7);background-color:rgba(127,127,127,.1);border-color:rgba(127,127,127,.7);fill:rgba(127,127,127,.1)}.fxs-mode-light .azc-control ::-webkit-input-placeholder{color:rgba(127,127,127,.7)}.fxs-mode-light .azc-control ::-moz-placeholder{color:rgba(127,127,127,.7)}.fxs-mode-light .azc-control :-ms-input-placeholder{color:rgba(127,127,127,.7)}.fxs-mode-light .fxs-copyfield .fxc-copyablelabel-copyimage{fill:#252525}.fxs-mode-light .fxc-tabs-container.fxc-tabs-block>.fxc-tabs-itemslist li.azc-br-active{border-bottom-color:#fff!important}.fxs-mode-light .fxs-bladestyle-create .msportalfx-form .azc-optionPicker li.fxs-bg-dirty{background-color:rgba(0,137,250,.15)!important}.fxs-mode-light .fxs-journey-docker{fill:#252525;background-color:#fff;box-shadow:0 0 10px #252525}")})
);define("_generated/Less/MsPortalImpl/Themes/Themes.Reset.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,':link img,:visited img,a img,fieldset,img,legend{border:0}body,fieldset,legend{margin:0;padding:0}.fxs-display-none{display:none!important}.fxs-hide-accessible-label{overflow:hidden;position:fixed;top:-1000px;left:-1000px;width:0;height:0}a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{font-size:100%;font-weight:inherit}code,p,pre{font-size:12px}body,button,input,p,select,textarea{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_normal,"Segoe WP",Tahoma,Arial,sans-serif;font-weight:400}body,html{height:100%}[type=button],[type=reset],[type=submit],button{font-size:12px;background:0 0;color:inherit}img{overflow:hidden;max-height:100%;max-width:100%}[contentEditable=true]:not([tabindex="-1"]):focus,[tabindex="0"]:focus,a[href]:not([tabindex="-1"]):focus,area[href]:not([tabindex="-1"]):focus,button:not([disabled]):not([tabindex="-1"]):focus,iframe:not([tabindex="-1"]):focus,input:not([disabled]):not([tabindex="-1"]):focus,select:not([disabled]):not([tabindex="-1"]):focus,textarea:not([disabled]):not([tabindex="-1"]):focus{outline-offset:-1px}tbody tr[tabindex]:not([tabindex=\'-1\']):focus{box-shadow:none}a{text-decoration:none}p{line-height:18px}b,strong{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700}code,pre{font-family:Consolas,"Courier New",monospace}textarea{overflow:auto}hr{border-width:1px 0 0;border-top-style:solid}[data-bind*=fxClick],[data-bind*=fxclick],[role=link],[role=button]{cursor:pointer}@-moz-document url-prefix(http){::-moz-placeholder{opacity:1}::-moz-focus-inner{border:0;padding:0}button:focus,input[type=button]:focus{outline-width:1px;outline-style:dashed}}@supports (outline-offset:-1px){:focus{outline:#00bcf2 dashed 1px}}')})
);define("MsPortalImpl/Base/Themes",["require","exports","f","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Telemetry","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Services/Services.GeneralSettings","_generated/Less/MsPortalImpl/Themes/Themes.Reset.css","_generated/Less/MsPortalImpl/Themes/Themes.Blue.css","_generated/Less/MsPortalImpl/Themes/Themes.LightMode.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function ht(n,t,i,r){return new k(n,t,i,r)}function h(n,t,i,r,u){return{colorCode:n,imageUri:d.getContentUri(it+t),name:i,title:r,mode:u}}function c(n,t,i){nt({source:n,action:t,data:i})}var d=i.Base.Resources,g=i.Base.Diagnostics.Telemetry,nt=g.trace,k;t.extLightClass="ext-mode-light";t.extDarkClass="ext-mode-dark";t.extHcActiveClass="ext-mode-highcontrast";t.extHcLightClass="ext-highcontrast-light";t.extHcDarkClass="ext-highcontrast-dark";var l=window,tt="fxs-theme-",a="fxs-mode-light "+t.extLightClass,v="fxs-mode-dark "+t.extDarkClass,
y="fxs-mode-highcontrast "+t.extHcActiveClass,p="fxs-highcontrast-dark "+t.extHcDarkClass,w="fxs-highcontrast-light "+t.extHcLightClass,s=u.Themes.Names,it="Content/Images/MsPortalImpl/Themes/",b="_generated/Less/MsPortalImpl/Themes/Themes.{0}.css",rt="(-ms-high-contrast: active)",ut="(-ms-high-contrast: black-on-white)",ft="(-ms-high-contrast: white-on-black)",et=window.fx.environment,ot={name:"HighContrastMode",mode:1},st={name:"HighContrastMode",mode:0};t.createManager=ht;k=(function(){function t(n,t,i,u){var b=this,et=this._themes=[h("#0078d7","Theme_Azure.png","azure",s.azure,0),h("#215b7d","Theme_Blue.png","blue",s.blue,0),h("#f1f1f8","Theme_Light.png","light",s.light,0),h("#333","Theme_Dark.png","dark",s.dark,1),],k=et.map((function(n){return n.name})).indexOf((i()||this.getDefaultTheme()).name),nt,d,ht,ct,it,g;~k||(k=1);this.currentTheme=i;i(et[k]);this.highContrastMode=u;this._themeIndex=k;r.explicitComputed(n,[i,u],(function(){var r=i(),n=u(),f,e;r=r||b._themes[b._themeIndex=0];f=
b._injectStyles(r);e=n===2?b._injectStyles(ot):n===1?b._injectStyles(st):Q({});Q.all([e,f]).then((function(){var i=r.mode?v:a;n!==0&&(i=n===2?v:a);t.removeClass(nt).addClass(nt=tt+r.name+" "+i).toggleClass(y,n!==0).toggleClass(p,n===2).toggleClass(w,n===1)}))}));c(f.Source.Shell,f.Action.SelectedTheme,i().name);u()!==0&&c(f.Source.Shell,f.Action.SelectedHighContrastMode,u());u.subscribe(n,(function(){c(f.Source.Shell,f.Action.SelectedHighContrastMode,u())}));t.on(e.default.fxrotatetheme,(function(){var n,t;o.settings.dblClickThemeEnabledKey()&&(n=i().name,b.rotateTheme(),t=i().name,c(f.Source.Shell,f.Action.RotateTheme,{fromTheme:n,toTheme:t}))}));it=[d=l.matchMedia(rt),ht=l.matchMedia(ut),ct=l.matchMedia(ft),];g=function(){ht.matches?u(1):ct.matches||d.matches?u(2):u(0)};d.media!=="not all"&&(it.forEach((function(n){return n.addListener(g)})),d.matches&&g());n.registerForDispose((function(){t.off(e.default.fxrotatetheme).removeClass(nt+" "+y+" "+p+" "+w);it.forEach((function(n){return n.removeListener(
g)}))}))}return t.prototype.getThemes=function(){return this._themes},t.prototype.rotateTheme=function(){var n=this._themes,t=this._themeIndex=((this._themeIndex||0)+1)%n.length;this.currentTheme(n[t])},t.prototype.getDefaultTheme=function(){var t=et.chrome.defaultTheme,n;return t&&(n=this._themes.filter((function(n){return n.name===t})),n&&n.length>0)?n[0]:this._themes[1]},t.prototype._injectStyles=function(t){var r=t.name,u=t.mode,f=r.charAt(0).toUpperCase()+r.slice(1),e=u?"DarkMode":"LightMode",o=[b.format(f),b.format(e),];return Q.all(o.map((function(t){return i.require(t,n)})))},t})()})(s||(s={})),s}));define("MsPortalImpl/Base/Base.CssSanitizer",["require","exports","f","o","a","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.CssSelectorParser","MsPortalImpl/Base/Themes","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function p(n){return n==="cssFloat"?"float":(n||"").replace(/([A-Z])/g,"-$1").toLowerCase(
)}function tt(n){var t=n.toLowerCase().match(nt).reduce((function(n,t,i){return i>0?(t=t.charAt(0).toUpperCase()+t.slice(1),n+t):n+t}));return t==="float"&&(t="cssFloat"),t}function w(n){return"css-scope-"+n.replace(g,"")}function it(t){var u="."+w(t.name),i=[],r;return t.styleSheets=(t.styleSheets||[]).map((function(n){return b(n,u,i)})),i.length&&(r=new h.ProvenanceContainer(null,n,t.name),i.forEach((function(n){var i="Sanitization error found in style sheet in extension: {0}\n{1} - {2}\nCSS rule: {3}".format(t.name,f.SanitizerError.Reasons.InvalidCSSProperty,n.errorMessage,n.rule.cssText);r.log(2,i,{})}))),i.length===0}function rt(n,t,i){t.insertRule(".ignored1 { {0} }".format(n),0);t.insertRule(".ignored2 {}",1);var r=t.cssRules[0],u=t.cssRules[1];return r.type===CSSRule.STYLE_RULE?(d(r.style,u,i),u.style.cssText):(i.push("Not a style rule: "+n),null)}function b(n,t,r){var u=document.implementation.createHTMLDocument(""),e=u.createElement("style");u.body.appendChild(e);var s=st(n,u),h=s.
filter((function(n){return n.type===CSSRule.STYLE_RULE})),c=h.map((function(n){var i=ut(n,e.sheet,t,r);return i?i.cssText:null})),f=c.join("\n");return[o.extLightClass,o.extDarkClass,o.extHcActiveClass,o.extHcLightClass,o.extHcDarkClass].forEach((function(n){var r=["{0} {1}","{1} {0}"].map((function(i){return i.format(t,"."+n)}));f=i.replaceAll(f,r[0],r[1])})),f}function k(n,t,i){i.push.apply(i,n.map((function(n){return{rule:t,errorMessage:n}})))}function ut(n,t,i,r){var e=[],o=ft(n.selectorText,i,e),u,f;return k(e,n,r),o?(t.insertRule(o+" {}",0),u=t.cssRules[0],f=[],d(n.style,u,f),k(f,n,r),u):null}function d(n,i,r){for(var o,c,l=ct(n),h=0,v=l.length;h<v;h++){var f=l[h],e=n.getPropertyValue(f),y=n.getPropertyPriority(f);if(e!=="initial"){var p=ot(y,r),a=null,s=null;t.stylePolicy.hasOwnProperty(f)?(a=f,o=t.stylePolicy[f],o===1?s=e:o instanceof u?(c=o.indexOf(e),c>=0&&(s=o[c])):typeof o=="function"&&o(e)&&(s=e),s?i.style.setProperty(f,e,p):r.push("Disallowed style value. Property name: {0}, value: {1}".
format(a,e))):r.push("Disallowed style property. Property name: "+f)}}}function ft(n,t,i){var r,u=[];try{r=e.parseCssSelector(n)}catch(f){return i.push("Malformed selector: "+n+"\nException: "+f.toString()),null}return r.forEach((function(n){et(n,i)&&u.push(t+" "+e.subselectorToString(n))})),u.join(", ")}function et(n,t){var i=[".ext-",".fxt-"],r=n.some((function(n){switch(n.type){case"CLASS":if(n.value){for(var r=0;r<i.length;r++)if(n.value.indexOf(i[r])===0)return!1;return t.push("Selectors can only refer to extension-specific class names (those starting with '"+i.join("', '")+"')"),!0}break;case"ID":return t.push("Selectors cannot refer to elements by ID"),!0}return!1}));return!r}function ot(n,t){return n?(t.push("Disallowed CSS priority value: "+n),""):n}function st(n,t){var i=t.createElement("style");t.body.appendChild(i);i.type="text/css";i.textContent=n;var r=i.sheet,f=r&&r.cssRules;return f?u.prototype.slice.call(f,0):[]}function ht(n){return n==="none"||n==="uppercase"||n==="lowercase"}
function l(n,t){t.forEach((function(t){n[t]=1}))}function ct(n){for(var i,u=[],r=0;r<n.length;r++)if(i=n[r],!a[i]){if(c[i]&&!(i in t.stylePolicy))return lt(n);u.push(i)}return u}function lt(n){for(var i,r=[],t=y.length-1;t>=0;t--)i=y[t],n[i]&&r.push(p(i));return r}var v,c,a;r.defineProperty(t,"__esModule",{value:!0});v=["align-content","align-items","align-self","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-left","border-left-color","border-left-style","border-left-width","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing",
"border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-shadow","box-sizing","clear","clip-path","color","content","counter-increment","counter-reset","cursor","display","fill","fill-rule","fill-opacity","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","font-size","font-stretch","font-style","font-variant","font-weight","height","justify-content","left","line-height","list-style-position","list-style-type","margin","margin-left","margin-top","margin-right","margin-bottom","max-height","max-width","min-height","min-width","opacity","order","outline","outline-color","outline-style","outline-width","overflow","overflow-x","overflow-y","padding","padding-top","padding-left","padding-right","padding-bottom","pointer-events","right","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit",
"stroke-opacity","stroke-width","table-layout","text-align","text-decoration","text-transform","text-overflow","top","transform","transform-origin","transition","transition-delay","transition-duration","transition-property","transition-timing-function","vertical-align","visibility","white-space","width","word-break","word-wrap",];t.stylePolicy={};v.forEach((function(n){t.stylePolicy[n]=1}));t.stylePolicy.position=["relative","absolute","static","inherit"];t.stylePolicy["text-transform"]=ht;var g=/\W/g,nt=/[a-z|A-Z]+/g,y=r.keys(t.stylePolicy).map(tt);t.domStylePropertyToCssProperty=p;t.getScopeName=w;t.sanitizeDefinition=it;t.sanitizeStyleDeclarationString=rt;t.sanitizeStyleSheetText=b;c={};l(c,["background-position-x","background-position-y",]);s.isChrome||s.isSafari?l(c,["background-repeat-x","background-repeat-y","font-variant-alternate","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","text-decoration-color","text-decoration-line","text-decoration-style",
"-webkit-border-horizontal-spacing","-webkit-border-vertical-spacing",]):s.isFirefox&&l(c,["-moz-border-top-colors","-moz-border-right-colors","-moz-border-bottom-colors","-moz-border-left-colors","font-variant-caps","font-variant-ligatures","font-variant-numeric","font-variant-position","overflow-wrap","text-decoration-color","text-decoration-line","text-decoration-style",]);a={};s.isIe&&l(a,["enable-background","list-style-image"])}));define("MsPortalImpl/Base/Base.KnockoutBindingSanitizer",["require","exports","ko","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function nt(n){return g[n]||n}function y(n,r,f,e,o){var h=[],a=i.expressionRewriting.parseObjectLiteral(r),s=!0;return a.forEach((function(i){var a=(i.key||"").trim(),v=nt(a),r=d[v],y,w,b,k;r||v.substring(0,l.length)!==l||(r=t);r?(y=(i.value||"").trim(),w=r(y,e),w!==null?h.push(p(v)+": "+w):(s=!1,b=new u.
SanitizerError(n,c.InvalidBindingValue,f,null,a,y),o.push(b))):(s=!1,k=new u.SanitizerError(n,c.UnknownBindingName,f,null,a,null),o.push(k))})),s?h.join(", "):null}function it(n,t,i,r){var f=/^\s*ko\s([\s\S]*)/.exec(t),u;return f?(u=y(n,f[1],"comment",i,r),u===null?" ko ":" ko "+u+" "):/^\s *\/ko/.test(t)?" /ko ":null}function p(n){return n&&!v.exec(n)&&(tt.exec(n)||(n="'"+n.replace("'","\\'")+"'")),n}function t(n){var r=o(n),t,i;if(r!==null)return r;for(t=0;t<a.length;t++)if(i=n.split(a[t]),i.length===2&&o(i[0].trim())&&o(i[1].trim()))return n;return null}function rt(n,i,u){var h=r.domStylePropertyToCssProperty(n),f=u.style[h],e=v.exec(i),s=e?i.slice(1,-1):null,o=!1;return f===1?o=!!e||t(i)===i:f instanceof Array?o=!!e&&f.indexOf(s)>=0:typeof f=="function"&&(o=!!e&&f(s)),o}function o(n){return/^\!?([\$_a-z0-9\.'\-"\[\]]|\(\))+$/i.test(n)||/^\{\s*\}$/.test(n)?n:null}function s(n){return w(n,(function(n,i){return!!t(i)}))}function w(n,t){return function(r,u){var o=i.expressionRewriting.parseObjectLiteral(
r),f=[],e=!0;return o.forEach((function(i){var r=(i.key||"").trim(),o=(i.value||"").trim();n(r,u)&&t(r,o,u)?f.push(p(r)+": "+o):e=!1})),e?"{ "+f.join(", ")+" }":null}}function b(n){return s((function(t){return n.indexOf(t)>=0}))}function k(n){return/^"[^"]*"$/.test(n)||/^'[^']*'$/.test(n)?n:null}function ut(n){return function(t){var i=!!n.first((function(n){return t==='"'+n+'"'||t==="'"+n+"'"}));return i?t:null}}function h(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(n,i){for(var u,r=0;r<t.length;r++)if(u=t[r](n,i),u!==null)return u;return null}}var c=u.SanitizerError.Reasons,e=h(t,s((function(){return!0}))),d={checked:t,click:t,clickBubble:t,commands:h(t,s((function(){return!0}))),disable:t,enable:t,event:b([f.default.click,"keypress","afterkeypress"]),foreach:h(t,b(["data","as"])),formElement:e,fxclick:t,fxParameterCollector:t,htmlTemplate:e,"if":t,ifnot:t,image:t,options:t,optionsText:k,optionsValue:k,sanitizedAttr:e,sanitizedCss:e,sanitizedHtml:t,selectedOptions:
t,style:w((function(n,t){return t.style.hasOwnProperty(r.domStylePropertyToCssProperty(n))}),rt),submit:t,text:t,uniqueName:t,visible:t,value:t,valueUpdate:ut(["afterkeyup"]),"with":t},g={attr:"sanitizedAttr",css:"sanitizedCss",html:"sanitizedHtml"},l="pc",a=["===","==","!==","!=","<=","<",">=",">","&&","||","-","+","*","/"],v=/^("([^"\\]|\\.)*"|'([^'\\]|\\.)*')$/,tt=/^[a-z_$][a-z0-9_$]*$/i;n.sanitizeBindingAttribute=y;n.sanitizeBindingComment=it})(e||(e={})),e}));define("MsPortalImpl/Base/Base.KnockoutTemplateSanitizer",["require","exports","f","o","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutBindingSanitizer","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization"],(function(n,t,i,r,u,f,e,o){"use strict";function it(){a={}}function w(n,t,i,r){var u=i&&i.htmlTemplateInline;u&&v(n,t,u,r,(function(){u.content=null}))}function rt(n,t,i){(t.lenses||[]).forEach((function(r){(r.partInstances||[]).forEach((function(r){w(n,t.name+"/"+r.name,r.inline,i)}))}))}function ut(
n,t){var r=n.name,o=n.htmlTemplates||{},f=n.hash,u=a[r],e;f&&u&&u.version===f||(u=a[r]={version:f,templateMap:{}});e=u.templateMap;i.forEachKey(o,(function(n,i){var u=e[n],f;u?i.content=u:(f=v(r,n,i,t,(function(){delete o[n]})),f&&(e[n]=i.content))}));(n.partsCatalog||[]).forEach((function(n){var i=n.htmlTemplateInline;i&&v(r,""+n.name,i,t,(function(){i.content=null}))}))}function v(t,i,r,u,f){var s=new g(r.content,n,t,{File:r.file,TemplateKey:i}),e=b(s),o=!e.errors.length,h=o||u===0;return h?r.content=e.sanitizedMarkup:f(),o}function b(n,t){function et(t,i,r,u,f,e){if(!b&&t===s.validateKOBindingString)return null;if(t===1)return i;if(typeof t=="object")return i in t?i:null;if(t instanceof Function){var o=t(i,r,u,f,c,e,n);return typeof o=="boolean"?o===!0?i:null:typeof o=="string"?o:null}return null}function it(t,i,u){var f,s;if(typeof u=="object")for(f in u)if(s=u[f],t.hasAttribute(f)&&!i.hasAttribute(f)){var c=t.getAttribute(f),e=[],o=et(s,c,t.nodeName.toUpperCase(),f,i,e);o!==null&&i.setAttribute(
f,o);e.length>0?e.forEach((function(n){r.push(n)})):o===null&&r.push(new h(n,h.Reasons.InvalidAttribute,t.nodeName.toUpperCase(),f,null,c))}}function rt(t,i){var s=t.nodeName.toUpperCase(),o,y,p,d,l,a,et,v,k;t.nodeType===Node.ELEMENT_NODE&&(nt||(nt=t!==u.body))&&(g[s]?(o=document.createElement(s),it(t,o,g[s]),it(t,o,ft),y=t.getAttribute("style"),y&&(p=[],d=e.sanitizeStyleDeclarationString(y,tt,p),p.forEach((function(t){r.push(new h(n,h.Reasons.InvalidCSSProperty,s,"style",null,t))})),o.setAttribute("style",d)),i.appendChild(o),i=o):r.push(new h(n,h.Reasons.InvalidTag,s,null,null,null)));for(var w=0,ut=t.childNodes,ot=ut.length;w<ot;w++){l=ut[w];switch(l.nodeType){case Node.TEXT_NODE:i.appendChild(document.createTextNode(l.textContent));break;case Node.ELEMENT_NODE:rt(l,i);break;case Node.COMMENT_NODE:a=c.comments;et=!b&&a===f.sanitizeBindingComment;!et&&a&&a instanceof Function&&(v=[],k=a(n,l.textContent,c,v),k!==null&&i.appendChild(document.createComment(k)),v.length>0&&v.forEach((function(
n){r.push(n)})))}}return i}var a,tt,v;t=i.extend({allowKnockoutBindings:!0},t);var b=t.allowKnockoutBindings,u=document.implementation.createHTMLDocument(""),ut=document.createDocumentFragment(),y=document.createElement("div"),d=c.elements,g=d.tags,ft=d.global,r=[],nt=!1,w=n.value;return ut.appendChild(y),p.forEach((function(n){w=k(w,n,l+n)})),u.body.innerHTML=w||"",a=u.createElement("style"),a.setAttribute("type","text/css"),u.head.appendChild(a),tt=a.sheet,rt(u.body,y),r.forEach((function(n){n.logError()})),v=y.innerHTML,p.forEach((function(n){v=k(v,l+n,n)})),new o.SanitizerResult(v,r)}function k(n,t,i){if(!n)return n;var r=new RegExp("(\\s+)"+t+"(\\s*\\=)","g");return n.replace(r,"$1"+i+"$2")}function d(n,t){var i={};return i[l+n]=t,i}var c;r.defineProperty(t,"__esModule",{value:!0});var g=u.ProvenanceContainer,h=o.SanitizerError,nt=/^(msportalfx|ext-|lang-|fxt-)[_\-a-zA-Z0-9]+$/,y=i.getUniqueId,tt=y(),s={validateLinkUri:o.validateLinkUri,validateUriOrBlank:o.validateUriOrBlank,validateLocalUriOnly:
o.validateLocalUriOnly,validateClassNames:function(n,i,r,u,f,e,o){for(var a=/[_\-a-z0-9]+/ig,c,l=[],s;c=a.exec(n);)s=c[0],t.isAllowedCssClassName(s)?l.push(s):e.push(new h(o,h.Reasons.InvalidCSSClassName,i,null,null,s));return l.join(" ")||null},validateKOBindingString:function(n,t,i,r,u,e,o){return f.sanitizeBindingAttribute(o,n,t,u,e)},mapName:function(n,t,i,r){return r.setAttribute(i,"TemplateSanitizer"+tt+"_"+n),!1}},p=["src"],l="data-sanitizer-"+y().toLowerCase()+"-",a={};t.reset=it;t.sanitizeInlineTemplate=w;t.sanitizeBladeDefinition=rt;t.sanitizeDefinition=ut;t.isAllowedCssClassName=function(n){return typeof n=="string"&&nt.test(n)};c=(function(){function i(t){return t.length?n(t):1}function n(n){var t={};return n.forEach((function(n){var u,r;if(typeof n=="string")t[n]=1;else for(u in n)r=n[u],t[u]=r instanceof Function?r:i(r)})),t}var r=["ABBR","ADDRESS","B","BLOCKQUOTE","BR","CAPTION","CITE","CODE","COL","COLGROUP","DD","DEL","DFN","DIV","DL","DT","EM","FIELDSET","H1","H2","H3","H4",
"H5","H6","HR","I","INS","LABEL","LEGEND","OL","P","PRE","Q","S","SMALL","SPAN","STRONG","SUB","SUP","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","U","UL",{A:["target",{href:s.validateLinkUri},]},{BUTTON:["value"]},{IMG:[d("src",s.validateUriOrBlank)]},{INPUT:[{type:["text","password","radio","checkbox","submit"]},"checked","maxlength","value"]},{LI:["value"]},{OPTION:["label","selected","value"]},{SELECT:["multiple","size"]},{TEXTAREA:["rows","cols"]},{TIME:["datetime"]},{SVG:["viewBox","focusable",{"xmlns:xlink":s.validateUriOrBlank},{"xmlns:svg":s.validateUriOrBlank},{xmlns:s.validateUriOrBlank}]},{CIRCLE:["r"]},"DEFS","DESC",{ELLIPSE:["id"]},{G:["id"]},{LINE:["id"]},"METADATA",{PATH:["id"]},{POLYGON:["id"]},{POLYLINE:["id"]},{RECT:["id"]},{STOP:["offset"]},{TEXT:["id","font-size"]},"TITLE",{USE:["id",{"xlink:href":s.validateLocalUriOnly}]},{VIDEO:["controls","poster"]},{SOURCE:[d("src",s.validateUriOrBlank),"type"]},],u=(t=[{"data-bind":s.validateKOBindingString},{"class":s.validateClassNames},
{name:s.mapName},"data-click-telemetry",{"data-activatable":["true","false"]},"data-activate-info",]).concat.apply(t,o.getWhitelistedAttr()),t;return{style:e.stylePolicy,elements:{tags:n(r),global:n(u)},comments:f.sanitizeBindingComment}})();t.sanitizeHTML=b}));define("MsPortalImpl/Extension/AddCloudName",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function it(n,t){e.multiCloudEnabled&&(n.name===r?et(n):ct(n,t))}function rt(n,t){e.multiCloudEnabled&&(n.name===r?ot(t):lt(n,t))}function ut(n,t){e.multiCloudEnabled&&(n.name===r?st(t):b(n,t))}function ft(n,t){e.multiCloudEnabled&&n.name===r&&t.type===4&&f(t.bindings,u)}function et(n){a(n.startBoardParts,tt);var t=n.commandGroups||[];t.forEach((function(n){y(n.commands)}));y(n.commandsCatalog)}function ot(n){n.effectiveInputs||(n.viewModelInputs=f(n.viewModelInputs,u));n.inputs=h(n.inputs);n.templateKeyInputs=h(n.templateKeyInputs);p(n.commandGroupReference,u);var t=n.lenses||[];t.forEach((function(n){a(n.partInstances,
u)}));n.actionBar&&(n.actionBar.bindings=f(n.actionBar.bindings,u))}function a(n,t){n&&n.forEach((function(n){n.inline?v(n.inline,t):n.reference.bindings=f(n.reference.bindings,t)}))}function st(n){v(n,u)}function v(n,t){n.inputs=h(n.inputs);n.bindings=f(n.bindings,t);w(n.details||[],0);p(n.commandGroupReference,t)}function y(n){(n||[]).forEach((function(n){n.bindings=f(n.bindings,u);n.commandKind===2&&w([n.details],4)}))}function p(n,t){n&&(n.commands||[]).forEach((function(n){n.bindings=f(n.bindings,t)}))}function f(n,t){var i=n||[];return i.push(t),i}function h(n){var i=n||[];return i.some((function(n){return n===t}))||i.push(t),i}function w(n,i){var u={property:t,valuesFrom:[{referenceType:i,property:"internal."+g.internalCloudNamePropertyName}]};n.forEach((function(n){if(n.blade&&(!n.bladeExtension||n.bladeExtension===r)){var t=n.additionalInputArguments=n.additionalInputArguments||[];t.push(u)}}))}function ht(n){return{property:t,valuesFrom:[{constantValue:n,referenceType:5,property:t}]}}function ct(
n,t){t.referencesToHubsCommands={};(n.commandGroups||[]).forEach((function(n){(n.commands||[]).forEach((function(n){n.reference&&n.reference.extension===r&&(t.referencesToHubsCommands[n.name]=!0,n.bindings=o(n.bindings,t.cloudName))}))}));k(t,n.startBoardParts);(n.partsCatalog||[]).forEach((function(n){b(t,n)}))}function b(n,t){var i=t.reference;i?i.extension===r&&(i.bindings=o(i.bindings,n.cloudName)):c(n,t.commandGroupReference)}function lt(n,t){c(n,t.commandGroupReference);var i=t.lenses||[];i.forEach((function(t){k(n,t.partInstances)}))}function k(n,t){(t||[]).forEach((function(t){var i=t.reference;i?i.extension===r&&(i.bindings=o(i.bindings,n.cloudName)):c(n,t.inline.commandGroupReference)}))}function c(n,t){(t&&t.commands||[]).forEach((function(t){n.referencesToHubsCommands[t.name]&&(t.bindings=o(t.bindings,n.cloudName))}))}function o(n,t){var i=n||[];return i.push(ht(t)),i}var s=FxImpl,d=s.Constants.CloudName,e=s.Extension,g=s.ViewModels,l=i.Base.Constants,nt=l.ExtensionNames.Hubs,at=i.Extension,
t=d.inputBindingKey,r=nt,tt={property:t,valuesFrom:[{constantValue:l.DefaultCloudName,referenceType:5,property:t}]},u={property:t,valuesFrom:[{referenceType:1,property:t}]};n.addCloudName=it;n.processBlade=rt;n.processPart=ut;n.processRedirect=ft})(r||(r={})),r}));define("MsPortalImpl/ViewModels/ViewModels.BladeCaller",["require","exports","f"],(function(){"use strict";var n;return (function(n){function r(t,r,u){var e=r.additionalInputArguments=r.additionalInputArguments||[],f;r.outputArguments=r.outputArguments||[];f=t+i;e.push({property:n.bindingName_bladeCallId,valuesFrom:[{referenceType:u,property:f+n.bindingName_bladeCallId}]});e.push({property:n.bindingName_bladeCallerParams,valuesFrom:[{referenceType:u,property:f+n.bindingName_bladeCallerParams}]});r.outputArguments.push({property:n.bindingName_bladeCallerResult,valuesFrom:[{referenceType:1,property:n.bindingName_bladeCallerResult}]})}function u(t){t.inputs=t.inputs||[];t.inputs.push(n.bindingName_bladeCallId,n.bindingName_bladeCallerParams)}
function f(t,r,u,f){var o=r.inputs=r.inputs||[],e;if(r.outputs=r.outputs||[],r.bindings=r.bindings||[],f.inline)e=f.inline.bindings=f.inline.bindings||[];else if(f.reference)e=f.reference.bindings=f.reference.bindings||[];else throw new Error("Part is neither inline nor a reference, so cannot add blade callable bindings");o.push(n.bindingName_bladeCallId);e.push({property:n.bindingName_bladeCallId,valuesFrom:[{referenceType:1,property:n.bindingName_bladeCallId}]});o.push(n.bindingName_bladeCallerParams);e.push({property:n.bindingName_bladeCallerParams,valuesFrom:[{referenceType:1,property:n.bindingName_bladeCallerParams}]});r.outputs.push(n.bindingName_bladeCallerResult);r.bindings.push({property:n.bindingName_bladeCallerResult,valuesFrom:[{referenceType:0,property:t+i+n.bindingName_bladeCallerResult,part:u}]})}var t="internal_",i=".";n.bindingName_bladeCallId=t+"bladeCallId";n.bindingName_bladeCallerParams=t+"bladeCallerParams";n.bindingName_bladeCallerResult=t+"bladeCallerResult";n.addCallerBindings=
r;n.addCallablePartInputs=u;n.addCallableBindings=f})(n||(n={})),n}));define("MsPortalImpl/Extension/DefinitionPreprocessor",["require","exports","f","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Extension/AddCloudName","MsPortalImpl/ViewModels/ViewModels.BladeCaller"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function ft(n,t,i){r.sanitizeDefinition(n,s);var f=n;return u.addCloudName(n,t),f.partTypeMap=f.partTypeMap||{},f.bladeMap=f.bladeMap||{},(f.partsCatalog||[]).forEach((function(n){return k(f,t,n,i||{})})),(f.blades||[]).forEach((function(n){return d(f,t,n,i||{})})),ct(n),(t.redirects||[]).forEach((function(n){return u.processRedirect(t,n)})),f}function w(n,t){n&&n.extension&&(n.extension=t[n.extension]||n.extension)}function b(n,t){n&&n.length&&n.forEach((function(n){n.bladeExtension&&(n.bladeExtension=t[n.bladeExtension]||n.bladeExtension)}))}function et(n,t,i){if(!n.requireConfig)throw new Error("requireConfig is not provided. Extension's requireConfig must be set to fetch the custom control from the extension");
return i.requireConfig=n.requireConfig,i}function k(n,t,f,o){return f.processed?f:(i.isFeatureEnabled("extensionredirect")&&(o=o||{},w(f.reference,o),b(f.details,o)),n.partTypeMap[f.name.toLowerCase()]=f,f.assetTypeDefinition=(t.assetTypes||[]).first((function(n){return n.partName===f.name})),e(f.details,0),f.parameterProvider&&g(f),u.processPart(t,f),yt(n,f),r.sanitizeInlineTemplate(n.name,f.name,f,s),f.processed=!0,f)}function d(n,t,f,e){if(e=e||{},f.processed)return f;f.templateBlade&&vt(f);f.menuBlade&&st(n,f);f.frameBlade&&ht(n,f);i.isFeatureEnabled("extensionredirect")&&(f.lenses||[]).forEach((function(n){(n.partInstances||[]).forEach((function(n){w(n.reference,e);b(n.inline&&n.inline.details,e)}))}));n.bladeMap[f.name.toLowerCase()]=f;f.assetTypeDefinition=(t.assetTypes||[]).first((function(n){return n.bladeName===f.name}));lt(f);u.processBlade(t,f);f.effectiveInputs||(f.effectiveInputs=f.viewModelInputs||[]);var o=ot(f);return n.partTypeMap[o.name.toLowerCase()]=o,r.sanitizeBladeDefinition(
n.name,f,s),f.processed=!0,f}function ot(t){var r=n.PinPrefix+t.name,i;return t.pinnedPart||(t.pinnedPart=r),i={name:r,viewModel:n.PinVMPrefix+t.name,partKind:o.Button,inputs:t.inputs,initialSize:2,details:[{blade:t.name,isMultiple:!1,invocationInputArguments:[{valuesFrom:[{property:"container.selectable.value",referenceType:0}]}],additionalInputArguments:[]}],bindings:[],viewStateProperties:["container.selectable.isSelected"],commandGroup:t.commandGroup,commandGroupReference:t.commandGroupReference,assetIdInputProperty:t.assetIdInputProperty,assetType:t.assetType},(t.inputs||[]).forEach((function(n){i.bindings.push({property:a+n,valuesFrom:[{property:n,referenceType:1}]})})),(t.optionalInputs||[]).forEach((function(n){n!==nt.ReferrerInfo&&i.bindings.push({property:a+n,optional:!0,valuesFrom:[{property:n,referenceType:1}]})})),t.viewModelInputs&&t.viewModelInputs.forEach((function(n){n.property===t.assetIdInputProperty&&i.bindings.push(n)})),i}function t(n,t,i,r){t&&t.forEach((function(t){var
u=!r&&i&&i.indexOf(t)>-1;n.inputs.push(t);n.bindings.push({property:t,optional:r,isIdentityInput:u,valuesFrom:[{referenceType:1,property:t}]})}))}function h(n,t,i,r,u,f,e,s,h,c,l){return{name:n,inline:{bindings:[],details:[],inputs:[],partKind:c||o.Custom,viewModel:t.viewModelName,htmlTemplate:i,htmlTemplateInline:r,assetType:t.assetType,assetIdInputProperty:t.assetIdInputProperty,initialSize:u,viewStateProperties:[],shareVmWithParentBlade:!0,partState:f,styleSheets:s,permissions:h,isV2:l},parameterProvider:e}}function st(n,r){var f=r.name,o=r.menuBlade.isV2,u=h(f,r,undefined,{content:"<div data-bind='pcControl: "+(o?"viewModel._msPortalFxMenu":"menu")+"' class='ext-menublade-part'><\/div>",file:f+i.getUniqueId()},9,undefined,!1,[],undefined),e;t(u.inline,r.inputs,r.templateKeyInputs);t(u.inline,r.optionalInputs,[],!0);e={name:f,partInstances:[u]};r.lenses.splice(0,0,e);r.effectiveInputs=u.inline.bindings;i.isNullOrUndefined(r.pinnable)&&(r.pinnable=!0)}function ht(n,i){var u=i.name,r=h(
u,i,undefined,undefined,9,i.frameBlade.partState,!1,[],i.permissions,o.Frame),f;t(r.inline,i.inputs,i.templateKeyInputs);t(r.inline,i.optionalInputs,[],!0);i.toolbar={source:{valuesFrom:[{referenceType:0,part:u,property:"content.commandBar"}]}};f={name:u,partInstances:[r]};i.lenses.splice(0,0,f);i.effectiveInputs=r.inline.bindings}function ct(n){n.startBoardParts&&n.startBoardParts.forEach((function(n){n.inline&&e(n.inline.details,0)}));n.commandsCatalog&&n.commandsCatalog.forEach((function(n){e([n.details],4)}));n.commandGroups&&n.commandGroups.forEach((function(n){n.commands&&n.commands.forEach((function(n){e([n.details],4)}))}))}function lt(n){n.lenses&&n.lenses.forEach((function(t){t.partInstances&&t.partInstances.forEach((function(t){t.inline&&(t.parameterProvider&&g(t.inline),e(t.inline.details,0));at(n,t.name,t)}))}))}function e(n,t){n&&n.filter((function(n){return n&&!!n.parameterCollector})).forEach((function(n){f.addCallerBindings(n.parameterCollector+".bladeCaller",n,t)}))}function g(n){n.editScopeType=
n.editScopeType||"PDLEditScope";n.inputs=n.inputs||[];n.inputs.push(c);f.addCallablePartInputs(n)}function at(n,t,i){if(i.parameterProvider&&(n.attributes|=1,f.addCallableBindings(l+".bladeCallable",n,t,i),n.actionBar)){n.actionBar.bindings=n.actionBar.bindings||[];var r=n.actionBar.bindings.some((function(n){return n.property==="input"}));r||n.actionBar.bindings.push({property:"input",valuesFrom:[{referenceType:0,part:t,property:l+".defaultActionBarInput"}]});n.templateBlade||(i.inline||i.reference).bindings.push({property:c,valuesFrom:[{referenceType:2,property:"content.output"}]})}}function vt(n){var i=n.templateBlade,r=h(n.name,n,i.htmlTemplate,i.htmlTemplateInline,i.partSize?i.partSize:8,i.partState,i.parameterProvider,i.styleSheets,n.permissions,null,i.isV2),u,f;n.lenses=n.lenses||[];n.lenses.push({name:"TemplateBladeVirtualLens",partInstances:[r]});n.locked=!0;u=r.inline;t(u,n.inputs,n.templateKeyInputs);t(u,n.optionalInputs,[],!0);f=n.effectiveInputs=u.bindings;n.outputs&&n.outputs.
forEach((function(t){n.bindings=n.bindings||[];n.bindings.push({property:t,valuesFrom:[{referenceType:0,property:"content."+t,part:r.name}]})}));n.editScopeType&&f.push({property:"editScopeId",valuesFrom:[{referenceType:1,property:"editScopeId"}]});n.actionBar&&(n.actionBar.source={valuesFrom:[{referenceType:0,part:r.name,property:"content.actionBar"}]});n.toolbar&&(n.toolbar.source={valuesFrom:[{referenceType:0,part:r.name,property:"content.commandBar"}]});u.details=i.details}function yt(n,t){var i=t.reference,u,r,f;i&&(u=i.partTypeName===ut&&(i.extension===v||!i.extension&&n.name===v),u&&(r=i.bindings,f=r.first((function(n){return n.property===y})),f||(r.push({property:y,valuesFrom:[{referenceType:9,property:p}],optional:!0}),t.inputDefinitions.push({name:p,type:it.TimeRangeValueType,optional:!0}))))}var nt=i.Base.Constants.BladeParameterNames,pt=i.Extension,tt=i.Parts,o=tt.PartKind,it=i.Composition.Configuration,rt=window,c="internal_parameterProviderActionBarOutput",l="content.parameterProvider",
s=rt.fx.environment.isDevelopmentMode?1:0;n.PinPrefix="InferredBladePinPart";n.PinVMPrefix="Shell."+n.PinPrefix;var a="inferredBladePinPartInputs.",v="Microsoft_Azure_Insights",ut="MetricsSummaryPart",y="timeRange",p="_msPortalFxTimeRange";n.preprocessDefinition=ft;n.processControl=et;n.processPart=k;n.processBlade=d})(e||(e={})),e}));define("MsPortalImpl/Extension/Extension.Definition.Locator",["require","exports","f","i","o","ko","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/DefinitionPreprocessor"],(function(n,t,i,r,u,f,e,o){"use strict";function y(n,t){for(var u=[],i=n,r;i;)u.unshift(i.getCacheKeyPart()),i=i.parent;return r=u.join("-"),t?r:r.toLowerCase()}function ot(n,t){for(var r=[],i=n;i;)r.unshift(i.getCacheFriendlyKeyPart(t)),i=i.parent;return r.join(t)}function g(n,t){return n.definition.partTypeMap[t.toLowerCase()]}function b(n,t){var i="<InvalidJsonString>";try{i=JSON.stringify(t)}catch(r){}return ft.error("{0} JSON: {1}".format(n,i)),v.forExtension("##ErrorDeserializingLocator##-{0}".
format(i),w.EmptyCloudName)}function st(n){return n&&(l=n),l}function k(n,t,i,r,u){return"["+n+"]"+t+"-"+i+"-"+r+"-"+u}function ht(n,t){c[k(t.type,t.fromExtension||n,t.fromPart,t.fromBlade,t.fromLens)]=i.extend({toExtension:n},t)}function ct(){l={};c={}}function lt(n,t,i,r){var u=ut.buildResourceTypeFromResourceId(t);return tt(n,u,i,r)}function tt(n,t,i,r){var f=t.toLowerCase(),u=n.getExtensions().some((function(n){var u=n.getManifest("assetTypes"),t=u&&a.isEqualCloudName(n.cloudName,r)&&u.assetTypes.first((function(n){return n.resourceType&&n.resourceType.resourceTypeName&&n.resourceType.resourceTypeName.toLowerCase()===f&&n.browseType!==3}));return t&&(i.extensionName=n.name,i.cloudName=n.cloudName,i.value=t),!!t}));return u||(i.error="Unable to locate extension for resource type '{0}'.".format(t),i.value=null),u}var l,c,s,v,p,nt,it;u.defineProperty(t,"__esModule",{value:!0});var a=r.Extension,w=i.Base.Constants,rt=i.Base.Diagnostics,at=i.Extension,ut=i.ViewModels.Services.ResourceTypes,
h={extensionNotFound:"Unable to locate extension '{0}'.",bladeNotFound:"Unable to locate blade '{0}' in extension definition.",actionBarNotFound:"Unable to locate action bar '{0}' in extension definition.",partInstanceNotFound:"Unable to locate part instance '{0}' in extension definition.",partTypeNotFound:"Unable to locate part type '{0}' in extension definition.",commandTypeNotFound:"Unable to locate command type '{0}' in extension definition.",lensNotFound:"Unable to locate lens '{0}' in extension definition.",assetTypeNotFound:"Unable to locate asset type '{0}' in extension definition.",commandGroupNotFound:"Unable to locate command group '{0}' in extension definition.",commandNotFound:"Unable to locate command '{0}' in extension definition.",hubNotFound:"Unable to locate hub '{0}' in extension definition."},ft=rt.createLog(n),et="{0} Search path:'{1}'.",d=o.PinPrefix;l={};c={};t.redirects=st;t.addPartRedirect=ht;t.clearRedirects=ct,(function(n){n[n.Extension=0]="Extension";n[n.Blade=
1]="Blade";n[n.Lens=2]="Lens";n[n.AssetType=3]="AssetType";n[n.CommandGroup=4]="CommandGroup";n[n.PartInstance=5]="PartInstance";n[n.PartType=6]="PartType";n[n.StartboardPartInstance=7]="StartboardPartInstance";n[n.BladeActionBar=8]="BladeActionBar";n[n.Command=9]="Command";n[n.ExtensionManifest=10]="ExtensionManifest";n[n.Hub=11]="Hub";n[n.CustomLens=12]="CustomLens";n[n.CommandType=13]="CommandType";n[n.BladeRedirect=14]="BladeRedirect";n[n.PartInstanceRedirect=15]="PartInstanceRedirect";n[n.PartTypeRedirect=16]="PartTypeRedirect"})(s=t.LocatorType||(t.LocatorType={}));v=(function(){function n(n,t,i,r,u,f,e){this.type=n;this.name=t;this.parent=u;this.enumerate=i;this.getValue=f;this.getValueAsync=e;this.errorMessageFormat=r}return n.forExtensionManifest=function(n,t){return new p(s.ExtensionManifest,n,t,function(n){return n.getExtensions()||[]},h.extensionNotFound)},n.forExtension=function(n,t){return new p(s.Extension,n,t,function(n){return n.initializedExtensions},h.extensionNotFound)}
,n.fromJSON=function(t){var i;if(!t||typeof t!="object")return b("Locator object is invalid.",t);var r=t.parent?n.fromJSON(t.parent):null,u=s[t.type],f="with{0}".format(u);if(!r&&t.type!==s.Extension&&t.type!==s.ExtensionManifest)return b("Locator with name '{0}' has no parent.".format(t.name),t);switch(t.type){case s.Extension:return i=l[t.name]||t.name,n.forExtension(i,t.cloudName);case s.ExtensionManifest:return i=l[t.name]||t.name,n.forExtensionManifest(i,t.cloudName)}return f in r?r[f](t.name):b("Unknown locator type: {0}.".format(u),t)},n.prototype.getCacheKeyPart=function(){return"["+this.type+"]"+this.name},n.prototype.getCacheFriendlyKeyPart=function(n){return n===void 0&&(n="/"),""+s[this.type]+n+this.name},n.prototype.withBlade=function(t){return new n(s.Blade,t,undefined,h.bladeNotFound,this,function(n,t){return n.definition.bladeMap[t.toLowerCase()]},function(n){return n.getBladeDefinition(t)})},n.prototype.withPartInstance=function(t){return new n(s.PartInstance,t,function(
n){return n.partInstances},h.partInstanceNotFound,this)},n.forPartInstanceRedirect=function(t,r,u,f){var e=k(5,t,r,u,f);return new n(s.PartInstanceRedirect,e,undefined,h.assetTypeNotFound,undefined,function(){return c[e]&&i.extend({name:e},c[e])})},n.forPartTypeRedirect=function(t,r){var u=k(4,t,r);return new n(s.PartTypeRedirect,u,undefined,h.assetTypeNotFound,undefined,function(){return c[u]&&i.extend({name:u},c[u])})},n.prototype.withBladeActionBar=function(t){return new n(s.BladeActionBar,t,function(n){return n.actionBar?[n.actionBar]:[]},h.actionBarNotFound,this)},n.prototype.withStartboardPartInstance=function(t){return new n(s.StartboardPartInstance,t,function(n){return n.definition.startBoardParts},h.partInstanceNotFound,this)},n.prototype.withPartType=function(t){return new n(s.PartType,t,undefined,h.partTypeNotFound,this,g,function(n){if(i.startsWith(t,d)){var r=t.substr(d.length);return n.getBladeDefinition(r).then((function(){return g(n,t)}))}return n.getPartDefinition(t)})},
n.prototype.withCommandType=function(t){return new n(s.CommandType,t,function(n){return n.definition.commandsCatalog},h.commandTypeNotFound,this)},n.prototype.withLens=function(t){return new n(s.Lens,t,function(n){return n.lenses},h.lensNotFound,this)},n.prototype.withCustomLens=function(t){return new n(s.CustomLens,t,function(){return[{name:t,partInstances:[]}]},"N/A",this)},n.prototype.withAssetType=function(t){return new n(s.AssetType,t,function(n){return n.getManifest("assetTypes").assetTypes},h.assetTypeNotFound,this)},n.prototype.withBladeRedirect=function(t){return new n(s.BladeRedirect,t,null,h.assetTypeNotFound,this,function(n){return n.getBladeRedirect(t)})},n.prototype.withCommandGroup=function(t){return new n(s.CommandGroup,t,function(n){return n.definition.commandGroups},h.commandGroupNotFound,this)},n.prototype.withCommand=function(t){return new n(s.Command,t,function(n){return n.commands},h.commandNotFound,this)},n.prototype.getExtensionLocator=function(){for(var t=this;
t.parent;)t=t.parent;return t.type===s.ExtensionManifest?n.forExtension(t.name,t.cloudName):t},n.prototype.toString=function(){return y(this,!0)},n.prototype.toFriendlyString=function(n){return n===void 0&&(n="/"),ot(this,n)},n.prototype.equals=function(n){if(this.name&&n&&n.name&&this.name===n.name&&this.type===n.type){if(this.parent)return this.parent.equals(n.parent);if(!n.parent)return!0}return!1},n.prototype.toJSON=function(){return{name:this.name,type:this.type,parent:this.parent&&this.parent.toJSON()}},n.prototype.readFromIdentifiable=function(n){this.name=n.name},n})();t.Locator=v;p=(function(n){function t(t,i,r,u,f){var e=n.call(this,t,i,u,f)||this;return e.getValueAsync=function(n){return n.getExtensionByName(i,r)},e.cloudName=r,e}return __extends(t,n),t.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this);return t.cloudName=this.cloudName,t},t.prototype.getCacheKeyPart=function(){var n=a.getWindowId(this);return"[{0}]{1}".format(this.type,n)},t.prototype.getCacheFriendlyKeyPart=
function(n){n===void 0&&(n="/");var t=a.getWindowId(this);return"{0}{1}{2}".format(s[this.type],n,t)},t.prototype.equals=function(n){return this.name&&n&&a.isEqualDescriptor(this,n)&&this.type===n.type},t.prototype.readFromIdentifiable=function(n){this.name=n.name;this.cloudName=n.cloudName},t})(v);t.ExtensionLocator=p;nt=(function(){function t(n,t){this._extensionManager=n;this._cache=t||{}}return t.populateCache=function(n,t,i){return n[y(t)]=i,n},t.prototype.locateAsync=function(n){var o=this,r=i.Helpers.Deferred(),t={},f,e,u;return this.tryLocate(n,t)?r.resolve(t.value):(f=void 0,u=n.parent,u?(f=Q(this.locateAsync(u)),e=u.errorMessageFormat.format(u.name)):f=Q(this._extensionManager),f.then((function(i){if(e=n.errorMessageFormat.format(n.name),o.tryLocate(n,t))return t.value;if(n.getValueAsync)return n.getValueAsync(i).catch((function(n){return Q.reject(n.message)}));throw t.error;})).then((function(){o.tryLocate(n,t)?r.resolve(t.value):r.reject(t.error)})).catch((function(n){typeof n=="string"?
r.reject(n):r.reject(e)}))),r.promise()},t.prototype.locate=function(t,i){var r={},u=null,f;return this.tryLocate(t,r)?u=r.value:(f=i||t.getExtensionLocator().name,e.logToExtension(n,f,2,r.error,{})),u},t.prototype.tryLocate=function(n,t){var r=y(n),u,i={},e=!1,f,o;return this._cache.hasOwnProperty(r)||(n.parent?this.tryLocate(n.parent,i):i.value=this._extensionManager,i.value&&(n.getValue?(f=n.getValue(i.value,n.name),f!==undefined&&(this._cache[r]=f)):(o=n.enumerate(i.value),this._fillCacheFromArray(o,n)))),u=this._cache[r],u?(t.value=u,e=!0):(t.error=et.format(n.errorMessageFormat.format(n.name),n.toString()),i.error&&(t.error=i.error+"\n"+t.error)),e},t.prototype._fillCacheFromArray=function(n,t){var r=this,i=f.toJS(t);n&&n.forEach((function(n){i.readFromIdentifiable(n);var t=y(i);r._cache[t]=n}))},t})();t.DefinitionFinderImpl=nt;t.tryLocateAssetDefinitionFromResourceId=lt;t.tryLocateAssetDefinitionFromResourceType=tt;it=w.BladeNames.Hubs.ResourceMenuBlade;t.hubsLocator=v.forExtension(
w.ExtensionNames.Hubs,a.getHubsCloudName());t.resourceMenu=t.hubsLocator.withBlade(it)}));define("MsPortalImpl.Controls/Fields/Base/FormValidation",["require","exports","f","i","ko","$","MsPortalImpl/Base/JQueryHelper"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function v(n,t){t===void 0&&(t=!0);var r=c(n),u=r.map((function(n){return n.field})),f=r.map((function(n){return n.viewmodel})).filter(i.identity);return(t&&this.gridEnableValidation(f),u.length===0)?Q(!0):l(u)}function y(n){n.forEach((function(n){var t=n&&n.rowMetadata;t&&t.editState&&t.editState()&&n.performValidation&&!n.performValidation()&&n.performValidation(!0)}))}function p(n,i,e,h){var c=r(n),a;if(c.attr(f,"true"),c.data(t,h),c.data(o,i),c.data(s,e),a=c.closest(".fxs-part-content"),a.length){var p=a.parent(),v=u.dataFor(p[0]),y=v&&v.context,l=y&&y.validateElements;l&&l.push(n);h.ltm.registerForDispose((function(){l&&l.remove(n);c.data(t,null);c.data(o,null);c.data(s,null)}))}}function h(n,i){return n.filter((function(
n){var u=r(n);return n&&n.hasAttribute(f)&&u.closest(".fxs-suppresschildvalidation").length<1&&u.data(t)&&(!i||i(n))&&e.isElementVisible(n)})).map((function(n){var i=r(n);return{viewmodel:i.data(o),widgetviewmodel:i.data(s),field:i.data(t)}}))}function c(n,i){var u=function(n){var u=r(n).data(t);return u&&(!i||i(n))};return n.length?h(n.find("["+f+"]").toArray(),u):[]}function l(n){var t=[];return n.filter((function(n){return n.triggerValidation})).map((function(n){t.push(n.triggerValidation())})),Q.all(t).then((function(n){return n.every(a)}))}var r=jQuery,a=i.identity;n.ensureFormFieldValidation=v;n.gridEnableValidation=y;var f="data-validatable",t="field",o="viewmodel",s="widgetviewmodel";n.markFormFieldElement=p;n.gatherFormFieldsFromElements=h;n.gatherFormFields=c;n.performFieldValidation=l})(o||(o={})),o}));define("MsPortalImpl/Base/Base.ItemCache",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function u(n){return function(t){return n(t.item)}}function c(n)
{var t=r();return t-n}function f(n){return{age:r(),item:n}}function e(n,t){var i;return n&&(t&&(n.age=r()),i=n.item),i}function b(n,i){var r=(y++).toString();return t.set(r,i),n.registerForDispose((function(){t.delete(r)})),r}function k(n){return t.get(n)}var s=window,h=i.remove,p=i.find,w=i.findIndex,r=Date.now,o=(function(){function n(n,t){n===void 0&&(n=12e4);var i=this;this._map=t;this._maxAge=n;this._timer=s.setTimeout((function(){return i._reduceCache()}),1e3)}return n.prototype.dispose=function(){this.flush()},n.prototype.hasEntry=function(n){return n in this._map},n.prototype.getEntry=function(n){return e(this._map[n],!0)},n.prototype.peekEntry=function(n){return e(this._map[n])},n.prototype.removeEntry=function(n){n in this._map&&this._delete(n)},n.prototype._removeEach=function(n){for(var t in this._map)n.call(this,t)&&this._delete(t)},n.prototype.removeEach=function(n){this._removeEach(n)},n.prototype.flush=function(){this._removeEach()},n.prototype._delete=function(n){delete this.
_map[n]},n.prototype._isExpired=function(n){return c(this._map[n].age)>this._maxAge},n.prototype._reduceCache=function(){this._removeEach(this._isExpired)},n})(),l,a,v,t,y;n.BaseItemCache=o;l=(function(n){function t(t){t===void 0&&(t=12e4);var i=this,r={};return i=n.call(this,t,r)||this,i._cache=r,i}return __extends(t,n),t.prototype.addEntry=function(n,t){this._cache[n]=f(t)},t})(o);n.ItemCache=l;a=(function(n){function t(t){t===void 0&&(t=12e4);var i=this,r={};return i=n.call(this,t,r)||this,i._cache=r,i}return __extends(t,n),t.prototype.addEntry=function(n,t,i){this.removeEntry(n);var r=f(t);r.mgr=i;this._cache[n]=r},t.prototype._delete=function(t){this._cache[t].mgr.dispose();n.prototype._delete.call(this,t)},t})(o);n.LifetimeItemCache=a;v=(function(){function n(n){n===void 0&&(n=12e4);var t=this;this._cache=[];this._maxAge=n;this._timer=s.setTimeout((function(){return t._reduceCache()}),1e3)}return n.prototype.dispose=function(){this.clear()},n.prototype.first=function(n,t){var i=p(this._cache,
u(n));return e(i,!t)},n.prototype.peekFirst=function(n){return this.first(n,!0)},n.prototype.pushEntry=function(n){this._cache.push(f(n))},n.prototype.removeEntry=function(n){this.removeFirst((function(t){return i.deepEquals(t,n)}))},n.prototype.removeFirst=function(n){var t=w(this._cache,u(n));t>=0&&this._cache.splice(t,1)},n.prototype.removeEach=function(n){h(this._cache,u(n))},n.prototype.clear=function(){this._cache=[]},n.prototype._isEntryExpired=function(n){return c(n.age)>this._maxAge},n.prototype._reduceCache=function(){var n=this;h(this._cache,(function(t){return n._isEntryExpired(t)}))},n})();n.ItemArrayCache=v;t=new i.Map;y=1;n.rotAdd=b;n.rotFind=k})(r||(r={})),r}));define("MsPortalImpl/Base/Base.Pipeline",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function u(){function u(t){n.push(t)}function f(t,r,u,f){function e(n,e,o,s){return u(e,o,s)?i.require(t,f).then((function(t){return r(n,t,e,o,s)})):undefined}n.push(e)}function e(t,i,r,u){return n.map(
(function(n){return n(t,i,r,u)}))}var n=[],r={registerFactory:u,registerAsyncFactory:f,getHandlers:e,createPipeline:undefined};return r.createPipeline=function(n,i,u){return t(n,r,i,u)},r}function t(n,t,i,r){function u(u){function c(t){t=t.filter((function(n){return!!n}));var i=f(t);return e(i,u,n,h).finally((function(){h.dispose()}))}var h=n.createChildLifetime(),s=t.getHandlers(h,i,r,u),o;return(s.forEach((function(n,t){Q.isPromise(n)&&(o||(o=[]),o[t]=n.then((function(n){s[t]=n})))})),o)?Q.all(o.filter((function(n){return!!n}))).then((function(){return c(s)})):c(s)}return{startTask:u}}function f(n){for(var i=[],r=Math.max.apply(Math,n.map((function(n){return n.length}))),u=function(t){n.forEach((function(n){n[t]&&i.push({e:t,f:n[t]})}))},t=0;t<r;t++)u(t);return i}function e(n,t,i,u){function a(i){var r;try{r=n[f].f(l,t)}catch(u){return Q.reject(u)}return o?undefined:r&&f<n.length?r.then(i):r}function h(){var t=undefined;for(f++;f<n.length&&!o;f++)if(t=a(h),t)break;return t}var f=-1,e,o=!1,c=r++,s=function(
){o=!0},l={indicateTaskComplete:s,taskId:c,lifetime:u};return i.registerForDispose(s),e=h(),e||(e=Q.resolve(undefined)),e}var r=1;n.createDescriptor=u;n.createPipelineInstance=t})(r||(r={})),r}));define("MsPortalImpl/Base/Base.Selectable2",["require","exports","f","i","o","a","ko","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.Pipeline"],(function(n,t,i,r,u,f,e,o,s){"use strict";function d(n){var t=new r.TriggerableLifetimeManager;return n.setLifetimeReference(1,t),{selectable:n,dispose:function(){t.dispose()}}}function g(n){return y(n)}function y(n){var i="Selectable",t=l.disposableData(n,i),r;return t||(r=new v(n),t=d(r),l.disposableData(n,i,t)),t.selectable}function nt(n,t){if(t){var i=n.options||{},r=n.metadata||{},u=r.outputParameters||[];return i.onClosed||u.length?!1:!p(n)}return!0}function tt(n,t){var i=n.bladeReference,u=n.flags,s=n.operationId,f=i.parameters,e=i.metadata||{},o=n.reason===3,h=nt(i,o),r=0;return h||(r|=2),o&&(r|=4),u&2&&(r|=8),u&4&&(r|=128),{cloudName:
i.cloudName,detailBlade:i.bladeName,extension:i.extensionName,detailBladeInputs:f?f:{},openInContextPane:!!(u&1)||e.isContextBlade,persistentContextPane:e.persistentContextPane,flags:r,operationId:s,onClosed:t}}function it(n){return n.parents("["+h+"]")}function rt(n,t,i){var r=o.rotAdd(n,t);i.attr(h,r);n.registerForDispose((function(){i.removeAttr(h)}))}function ut(n,t){t=t.attr(h)?t:it(t);var i=t.attr(h);return o.rotFind(i)}function p(n){var t=w(n);return t&&t.type===20560}var v,h;u.defineProperty(t,"__esModule",{value:!0});var l=i.Base.ProxiedObservables,w=r.shellInterface,a=window,b=500,k=1,c=s.createDescriptor();c.registerAsyncFactory("./Base.Selectable2.Pipeline",(function(n,t,i,r){return t.openBladeHandler(i,r)}),(function(){return!0}),n);c.registerAsyncFactory("../UI/Compositions/UI.Composition.BladeOpener.Selectable2",(function(n,t,i,r){return t.parameterCollectorHandler(i,r)}),(function(n,t){return t.openBladeRequest?p(t.openBladeRequest.bladeReference):!0}),n);v=(function(n){function t(
t){function ut(n){if(n){if(n.operationId in y){delete y[n.operationId];return}if((n.reason===3||n.reason===4)&&(rt=!0,s(!0),rt=!1),n.reason===4){g(n.operationId,!!(n.flags&2),n.initialWidth);return}(n.reason===2||n.reason===3)&&(l.openBladeRequest=n,it.startTask({}))}}var u=n.call(this)||this,d,g,nt;u.id=k++;u.callbacks=e.observableArray();var o=e.observable(),v=r.shellInterface(t),s=e.observable(!1),l={selectable:u,selectedValue:o,openBladeRequest:undefined,extensionVm:v},it=c.createPipeline(u,{},l),y={},h,p,w=0,rt=!1;return u.setLifetimeReference=function(n,t){n===(w&n)&&(w|=n,t.registerForDispose({dispose:function(){w^=n;w||u.dispose()}}))},u.value=e.computed(u,{read:function(){var n=s()?o():undefined;return n!==undefined?(p&&p!==h&&(p=h),h=d.peek()):h&&(p=h,h=undefined),n},write:function(n){n===undefined&&(s(!1),o(undefined))}}),u.getBladeSelection=function(n){var f,t=n.bladeReference,i=n.operationId,r=t&&t.options&&t.options.onClosed;return r&&i&&(u.callbacks.push({id:i,fn:r}),f=function(
n,t){Q(r(n,t)).finally((function(){u.callbacks.remove((function(n){return n.id===i}))}))}),tt(n,f)},d=v.request,g=function(n,t,r){var f=u.createChildLifetime(),h=a.setTimeout((function(){var u=16;u|=t?8:0;o({operationId:n||i.getUniqueId(),flags:u,initialWidth:r})}),b),e=function(){f.dispose()};o.subscribe(f,e);s.subscribe(f,e);f.registerForDispose((function(){a.clearTimeout(h)}))},u.isSelected=e.computed(u,{read:function(){return s()},write:function(n){if(s()!==n)if(s(n),n===!0){var t=i.getUniqueId();g(t);l.openBladeRequest=undefined;it.startTask({operationId:t})}else o(undefined)}}),u.onClick=function(){u.isSelected(!0)},u.invokeClickCallback=function(n,t,i,r,u,f,e){t.invokeClickHandler(n,i,r,v,u,f,e)},u.fetchRequest=function(n){return Q(v.fetchRequest(n)).then((function(n){return n&&n.operationId in y&&(delete y[n.operationId],n=null),l.openBladeRequest=n,n}))},u.getOutputProperties=function(){var n=l.openBladeRequest.bladeReference.metadata,t=n&&n.outputParameters;return f.isArray(t)?t:[]},u.
getOutputsChangedHandler=function(){var n=l.openBladeRequest.bladeReference;return function(t){r.invokeCallback(n,"onOutputsChanged",[t])}},nt=function(n){return n?{item:n.selectedItem,metadata:n.controlMetadata}:undefined},u.activationState=e.computed(u,(function(){u.value();var n=nt(p),t=nt(h);return{previous:n,current:t}})),u.notifyBladeOpenCompleted=function(n,t){v.result({operationId:n,success:t})},u.cancel=function(n){var t=o();t&&t.operationId===n&&(t.flags&16&&(y[n]=!0),s(!1),o(undefined),u.notifyBladeOpenCompleted(n,!1))},d.subscribeAndRun(u,ut),u}return __extends(t,n),t.prototype.isClickable=function(){return!0},t})(r.TriggerableLifetimeManager);t.createListSelectable=g;t.getOrCreate=y;h="data-fxselectable";t.setSelectableContext=rt;t.findExtensionViewModel=ut}));define("MsPortalImpl/Base/Base.Selectable2.ClickContext",["require","exports","f","i","ko"],(function(n,t,i,r,u){"use strict";var f;return (function(t){function f(){return i.require("../UI/Compositions/UI.Composition.Selectable2Registrar",
n)}function e(n,t,i){var r=u.observable();return{onClick:function(u){if(r())r().onClick(u);else f().then((function(f){r()||r(f.getListSelectableWithClickHandler(n,t,i));r().onClick(u)}))},activationState:u.pureComputed((function(){return r()?r().activationState():{previous:undefined,current:undefined}}))}}function o(n,t,i){function l(){o&&(o=!1,e().onClick());s&&(s=!1,e().isSelected(!0))}function h(){f().then((function(r){if(!e()){var u=r.getSelectableWithClickHandler(n,t,i);u.registerForDispose(c);e(u)}l()}))}function p(){e()?e().onClick():(o=!0,h())}var c=new r.TriggerableLifetimeManager,e=u.observable(),o,s,a=u.computed(c,{read:function(){return e()?e().isSelected():(h(),!1)},write:function(n){e()&&e().isSelected(n);n&&(s=!0,h())}}),v=u.pureComputed((function(){return e()?e().isClickable():!1})),y=u.pureComputed((function(){return e()?e().value():undefined}));return{isSelected:a,isClickable:v,value:y,onClick:p}}t.getListSelectableWithClickHandler=e;t.getSelectableWithClickHandler=o})(f||(f={})
),f}));define("MsPortalImpl/Base/Base.Timers",["require","exports","f","o"],(function(n,t,i,r){"use strict";function l(n){u={handleMap:{},counter:1,handle:null};!n&&f.requestAnimationFrame&&f.cancelAnimationFrame?(e=f.requestAnimationFrame,o=f.cancelAnimationFrame):(e=function(n){var t=(new Date).getTime(),i=Math.max(0,16-(t-c)),r=f.setTimeout((function(){n(t+i)}),i);return c=t+i,r},o=function(n){f.clearTimeout(n)})}function s(n){return e(n)}function a(n){o(n)}function p(n){var t=u.counter++;return u.handleMap[h+t]=n,v(!1),t}function w(n){delete u.handleMap[h+n]}function b(n){var t;y(u.handleMap,(function(i,r){t=!0;r.call(f,n)}));t?v(!0):k()}function v(n){(n||!u.handle)&&(u.handle=s(b))}function k(){var n=u.handle;n&&(a(n),u.handle=null)}function d(n){var t=null;return function(){t||(t=s((function(){t=null;n()})))}}r.defineProperty(t,"__esModule",{value:!0});var f=window,h="",e,o,u,c=0,y=i.forEachKey;t.setupTimers=l;t.requestAnimationFrame=s;t.cancelAnimationFrame=a;t.requestAnimationFrameInterval=
p;t.cancelAnimationFrameInterval=w;l(!1);t.throttleByAnimationFrame=d}));define("MsPortalImpl/Interactions/Interactions.FocusHandler",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.Timers"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){function a(n){var t=document.createEvent("CustomEvent");t.initCustomEvent(o.default.fxreadyforfocus,!1,!1,null);n.dispatchEvent(t)}function c(n,t){var u=e(n),r,f,o;if(!e.contains(u[0],document.activeElement)){if(r=u.findFirstTabbable((function(n){return n.isInScrollView(t)})),!r.length&&u.hasClass("fxs-blade-content")){var s=u.closest(".fxs-blade"),c=s.hasClass("fxs-menublade"),h=c?[]:[s.find(".fxs-blade-header [tabindex]")];h.push(u.closest("[tabindex]"));f=i.find(h,(function(n){return!!n.attr("tabindex")}));f&&(r=f)}if(r.length)return r.hasClass("fxs-part")&&(o=r.findFirstTabbable(),o.length===1&&(r=o)),r.focus()}}function v(n,t){s.requestAnimationFrame((function(){c(n,t)}))}var t,h=i.
isFeatureEnabled("skipautofocus"),l;n.setFocusOnContainer=v;l=(function(){function n(){var n=this;if(this._containerTargets=[],this._mapToContainer=new i.Map,this._mapTofocusableTargets=i.memoize((function(){return[]})),this._mapSkipAutoFocus=new i.Map,this._debounceFocus=i.debounce((function(n){s.requestAnimationFrame((function(){if(n&&n.parentElement){var i=f.dataFor(n),t=i&&i.func;t&&t.setFocus?t.setFocus():c(n,"fxs-blade-content")}}))}),250),this._debounceMenuBladeCleanup=i.debounce((function(){n._containerTargets.length===0&&(n._menuBladeToSetFocus=undefined)}),1e3),this.journey=f.observable(!0),t)throw new Error("FocusHandler operates as a singleton.");this._ltm=new r.TriggerableLifetimeManager;t=this;this._ltm.registerForDispose(e("body").setEvents(["focusin",this._cancelAutofocus=function(t){h||n._mapTofocusableTargets.map().forEach((function(i,r){var u=!!t||r!==n._menuBladeToSetFocus;n._mapSkipAutoFocus.set(r,u)}))}]))}return n.prototype.dispose=function(){this._ltm&&(this._ltm.dispose(),
this._ltm=null);t=null},u.defineProperty(n,"Instance",{get:function(){return t||(t=new n)},enumerable:!0,configurable:!0}),n.prototype.waitForJourney=function(){var t=this,n;return this.journey()?Q():(this._journeyPromise||(n=this._ltm.createChildLifetime(),this._journeyPromise=this.journey.fxAwait(n).finally((function(){n.dispose();t._journeyPromise=null}))),this._journeyPromise)},n.prototype.registerContainerForFocus=function(n){if(n){if(!this._menuBladeToSetFocus){var r=e(n),t=r.closest(".fxs-blade"),u=t.length&&t.hasClass("fxs-menublade"),f=u&&r.closest(".fxs-blade-content-container-details",t[0]).length>0;u&&!f&&(this._menuBladeToSetFocus=n)}this._cancelAutofocus();i.pushUnique(this._containerTargets,[n])}},n.prototype.registerTargetForFocus=function(n){var t,r;n&&(t=e(n).closest(".fxs-blade-content")[0],t&&this._containerTargets.indexOf(t)>=0&&(this._mapToContainer.set(n,t),r=this._mapTofocusableTargets(t),i.pushUnique(r,[n])))},n.prototype.notifyTargetReadyForFocus=function(n){var
r=this,o;try{var t=this._mapToContainer.get(n),u=this._mapTofocusableTargets(t),f=u.indexOf(n);f>-1&&(u.splice(f,1),this._mapToContainer.delete(n),u.length===0&&(i.remove(this._containerTargets,t),o=t,this.waitForJourney().finally((function(){var i,n;h||r._mapSkipAutoFocus.get(t)||(i=t,r._menuBladeToSetFocus&&r._menuBladeToSetFocus!==t&&(n=e(r._menuBladeToSetFocus).closest(".fxs-blade-content-container"),n[0]&&e.contains(n[0],t)&&(i=n.children(".fxs-blade-content-container-default").children(".fxs-blade-content-wrapper")[0])),r._debounceFocus(i));r._mapSkipAutoFocus.delete(t);r._mapTofocusableTargets.delete(t);a(o)})),this._menuBladeToSetFocus&&this._containerTargets.length===0&&this._debounceMenuBladeCleanup()))}catch(s){}},n})();n.FocusHandler=l})(h||(h={})),h}));define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding",["require","exports","f","i","o","a","ko","$"],(function(n,t,i,r,u,f,e,o){"use strict";function ot(n,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[
i];return et(ut,this,[n,t].concat(r.map(e.toJS)))}function h(n,t,i){for(var f=t?t.split("."):[],u={exists:n&&f.length>0,value:undefined},r=n,o=0,s=i?e.utils.peekObservable:e.unwrap;u.exists&&o<f.length;)r=s(r),r&&r.hasOwnProperty(f[o])?r=r[f[o]]:u.exists=!1,o++;return u.exists&&(u.value=r),u}function v(n,t,r){for(var h=function(i){if(!i||typeof i!="object")throw new Error(g("A property in model hierarchy is not an object. Path: '{0}'.".format(t),n));return i},o=t.split("."),f=h(n),u,s=0;s<o.length-1;s++)u=o[s],i.isNullOrUndefined(f[u])&&(f[u]={}),f=h(e.unwrap(f[u]));u=o.last();f[u]&&e.isObservable(f[u])?f[u](r):f[u]=r}function y(n){var t;try{t=e.toJSON(n)}catch(i){return i.message}return t}function g(n,t){var i=y(t);return i?"{0}\nModel: '{1}'".format(n,i):n}function ht(n,t,i,r){var o=p(r,k),u={};return f.isArray(t)&&t.forEach((function(t){var r=t.source,s=t&&r&&r.scope===d.CurrentContainer&&r.modelType===i,f=s&&h(n,r.property);f&&f.exists&&(w(o,t.targetProperty,f.value),v(u,t.targetProperty,
e.toJS(f.value)))})),u}function p(n,t){if(t){var s=n.toLowerCase(),r=function(n){return i.isPlainObject(n)&&!i.isEmptyObject(n)?u.keys(n).every((function(n){return s.indexOf(n.toLowerCase())>=0})):!1},f=r(t.debug),h=r(t.log),e=r(t.verbose),o;return(h||f||e)&&(o={debugId:n,breakOnInputsSet:f,verbose:e}),o}}function w(n,t,r){n&&n.verbose&&!i.canSendThroughPostMessage(r)&&b.verbose("Inputs should be simple data objects without functions/observables: {0} | {1} | {2}".format(n.debugId,t,e.toJSON(r)))}var d,st,s,a,c,nt;u.defineProperty(t,"__esModule",{value:!0});var tt=r.TriggerableLifetimeManager,it=i.Base,b=it.Diagnostics.createLog(n),rt=window,l=rt.fx.environment,k=l.trace.inputsset,ut=f.prototype.splice,ft=r.quickApplyArrayEdits,et=i.applyCall;(function(n){n[n.CurrentContainer=0]="CurrentContainer";n[n.MasterContainer=1]="MasterContainer";n[n.DetailsContainer=2]="DetailsContainer"})(d=t.ReferenceScope||(t.ReferenceScope={})),(function(n){n[n.OneToOne=0]="OneToOne";n[n.OneToMany=1]="OneToMany";
n[n.ManyToOne=2]="ManyToOne"})(st=t.ReferenceCardinality||(t.ReferenceCardinality={}));s=(function(){function n(n,t){this.kind=n;this.propertyName=t}return n.forObject=function(t,i,r){var u=new n(0,t);return u.propertyValue=i,u.propertyOldValue=r,u},n.forArray=function(t,i){var r=new n(1,t);return r.propertyArrayEdits=i||[],r},n.forNewArray=function(t,i){var r=new n(1,t);return r.propertyValue=i,r},n})();t.ObservableChangeArgs=s;a=(function(){function n(n,t,i,r,u){this.cancel=!1;this.propertyChanges=[];this.sourceModelId=n;this.sourceModel=t;this.sourceProperty=i;this.targetModel=r;this.targetProperty=u}return n})();t.PropertyTransformerArgs=a;c=(function(){function n(n,t,r,u,f,e){this.transformers=[];this.compositionBindingDefinition=null;this._callbacks=o.Callbacks();this._errCallbacks=o.Callbacks();this._tgtHasValue=!1;this.sourceProperty=n;this.targetProperty=t;this.targetModel=r;this._tgtModelName=u;this.transformers=f;this._awaitBound=i.Helpers.Deferred();this._tgtPropExists=e;this._traceOptions=
p(u,k)}return n.prototype.sourceModelName=function(){return this._srcModelName},u.defineProperty(n.prototype,"sourceModel",{get:function(){return this._srcModel},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"isBound",{get:function(){return!!this._srcModel},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"awaitBound",{get:function(){return this._awaitBound.promise()},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"targetHasValue",{get:function(){return this._tgtHasValue},enumerable:!0,configurable:!0}),n.prototype.addValueChangedHandler=function(n){n&&this._callbacks.add(n)},n.prototype.removeValueChangedHandler=function(n){this._callbacks.remove(n)},n.prototype.addErrorHandler=function(n){n&&this._errCallbacks.add(n)},n.prototype.bind=function(n,t,i,r,u){var o=this,l,a,h,c;if(i===void 0&&(i=!0),this.isBound){this._err("Property binding is already bound.");return}return this.addValueChangedHandler(r),this.addErrorHandler(u),this._validateBinding(
n,t)?(this._srcModelName=n,this._srcModel=t,l=this._getSrcValue(),a=e.utils.peekObservable(l),i&&a!==undefined&&this._changeTgtModel(s.forObject(this.targetProperty,a)),e.isObservable(l)?(h=l,this._bindingLifetime=new tt,h.subscribe(this._bindingLifetime,(function(n){var t,r,i;f.isArray(n)?(r=n,t=n.slice(0)):t=n;(h.splice||h.map)&&(i="arrayChange");c&&c.dispose();c=o._bindingLifetime.createChildLifetime();h.subscribe(c,(function(n){var u,l;c.dispose();c=undefined;i==="arrayChange"&&(u=n,n=h());f.isArray(t)&&f.isArray(n)?r===n?(u=u||e.utils.compareArrays(t,n,{sparse:!0}),l=s.forArray(o.targetProperty),l.propertyArrayEdits=e.utils.adjustArrayEdits(u),o._changeTgtModel(l)):o._changeTgtModel(s.forNewArray(o.targetProperty,n)):o._changeTgtModel(s.forObject(o.targetProperty,h(),t))}),null,i)}),null,"beforeChange")):i||this._err("Error when binding. The value is not an observable and importInitialValue is false."),this._awaitBound.resolve()):this._awaitBound.reject(),this},n.prototype.unbind=function(
){this._bindingLifetime&&(this._bindingLifetime.dispose(),this._bindingLifetime=null);this._srcModel=null;this._srcModelName=null;this._callbacks.empty();this._errCallbacks.empty()},n.prototype.toString=function(){return"\n\nDetails:\nSource model id: '{0}'.\nSource property: '{1}'.\nTarget model id: '{2}'.\nTarget property: '{3}'.\nSource model: '{4}'.\nTarget model: '{5}'.".format(this._srcModelName||"<UNBOUND>",this.sourceProperty,this._tgtModelName,this.targetProperty||"<DYNAMIC>",this._srcModel?y(this._srcModel):"<UNBOUND>",y(this.targetModel))},n.prototype._changeTgtModel=function(n){var i=this,r=new a(this._srcModelName,this._srcModel,this.sourceProperty,this.targetModel,this.targetProperty),t,u;n&&r.propertyChanges.push(n);this._processTransformers(r)&&((r.propertyChanges||[]).forEach((function(n){var r,o,s;n.propertyName&&(r=i._traceOptions,n.kind===0?(i._tgtHasValue=n.propertyValue!==undefined,w(r,n.propertyName,n.propertyValue),v(i.targetModel,n.propertyName,e.toJS(n.propertyValue))):
(t=h(i.targetModel,n.propertyName).value,u=e.unwrap(t),o=n.propertyArrayEdits,f.isArray(u)?o?(r&&r.verbose&&o.forEach((function(t){t.status==="added"&&w(r,n.propertyName,t.value)})),e.isObservable(t)&&t.valueWillMutate(),i._tgtHasValue=!0,ft(u,o,{inplaceFixup:!1,spliceFunc:ot}),e.isObservable(t)&&t.valueHasMutated()):n.propertyValue&&(i._tgtHasValue=!0,s=n.propertyValue,t.splice?t.splice.apply(t,[0,u.length].concat(s)):t(s)):i._err("[Property Binding] Array change detected on source property, but target property is not an array.")))})),this._callbacks.fire(r.propertyChanges))},n.prototype._processTransformers=function(n){return this.transformers.some((function(t){return t(n),n.cancel})),!n.cancel},n.prototype._getSrcValue=function(){return h(this._srcModel,this.sourceProperty).value},n.prototype._validateBinding=function(n,t){var i,r=this.compositionBindingDefinition,u=!(r&&r.optional);return this._validateModel(n,t,this.sourceProperty,u,(function(n){i=n}))?this.sourceProperty?this._validateModel(
this._tgtModelName,this.targetModel,this.targetProperty,this._tgtPropExists,(function(n){i=n}))||(i="[Property Binding] Invalid target model - {0}".format(i)):i="[Property Binding] Invalid source model - Source property must be defined.":i="[Property Binding] Invalid source model - {0}".format(i),i&&this._err(i),!i},n.prototype._validateModel=function(n,t,i,r,u){var f;return n?t?i&&r&&!h(t,i).exists&&(f="Model is missing property '{0}'.".format(i)):f="Model is undefined.":f="Model is missing an identifier.",f&&u&&u(g(f+"\nModel id: '{0}'.".format(n||"N/A"),t)),!f},n.prototype._err=function(n){this.isBound&&(n+=""+this);var t=l.trace;(l.isDevelopmentMode||t&&t.diagnostics)&&b.error(n);this._errCallbacks.fire(n)},n})();t.PropertyBinding=c;t.getModelValue=h;t.setModelValue=v;nt=(function(){function n(n,t,i){var r=this;this._properties=[];this._propertyChangedCallbacks=o.Callbacks();this._aggregatePropertyChangedHandler=function(n){r._propertyChangedCallbacks.fire(n)};this._targetModel=t;this.
_targetModelName=n;this._validateTargetPropertiesExist=i!==!1}return u.defineProperty(n.prototype,"properties",{get:function(){return this._properties.slice(0)},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"targetModelName",{get:function(){return this._targetModelName},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"targetModel",{get:function(){return this._targetModel},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"awaitAllBound",{get:function(){var n=this._properties.map((function(n){return n.awaitBound}));return o.when.apply(o,n)},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"allBound",{get:function(){return this.properties.every((function(n){return n.isBound}))},enumerable:!0,configurable:!0}),n.prototype.addPropertyChangedHandler=function(n){this._propertyChangedCallbacks.add(n)},n.prototype.addProperty=function(n){for(var i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return i=new c(n,n,this._targetModel,this._targetModelName,
r,this._validateTargetPropertiesExist),i.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(i),i},n.prototype.mapProperty=function(n,t){for(var r,u=[],i=2;i<arguments.length;i++)u[i-2]=arguments[i];return r=new c(n,t,this._targetModel,this._targetModelName,u,this._validateTargetPropertiesExist),r.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(r),r},n.prototype.removeProperty=function(n){var t=this._properties.indexOf(n);t>=0&&(this._properties[t].unbind(),this._properties[t].removeValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.splice(t,1))},n.prototype.getProperty=function(n){return this._properties.first((function(t){return t.targetProperty===n}))},n.prototype.unbind=function(){this._properties.forEach((function(n){n.unbind()}));this._propertyChangedCallbacks.empty()},n.prototype.toString=function(){for(var t="",i=this.properties,r=this.properties.length,n=0;n<r;++n)t+="properties[{0}]: {1}".
format(n,i[n].toString());return t},n})();t.PropertyBindings=nt;t.mapSourceModelToTargetModel=ht;t.extractTraceOptions=p}));define("MsPortalImpl/UI/UI.DesktopManager",["require","exports","o"],(function(n,t,i){"use strict";i.defineProperty(t,"__esModule",{value:!0});var r=window;t.DesktopManagerEvents={activeJourneyChanged:"activejourneychanged",journeyActivating:"journeyActivating",journeyDeactivated:"journeyDeactivated",journeyDiscarded:"journeyDiscarded",journeyCreating:"journeyCreating",journeyCreated:"journeyCreated",bladeOpening:"bladeOpening",bladeRebound:"bladeRebound",bladeClosed:"bladeClosed",settingsLoaded:"settingsLoaded"};t.isTraceEnabled=!!r.fx.environment.trace.desktop}));define("MsPortalImpl.Controls/Controls/Base/WidgetBinding",["require","exports","f","o","ko"],(function(n,t,i,r,u){"use strict";function c(n,t){var i;return f(n)||(i=u.unwrap(n)),f(i)?t:i}function l(n,t){var r=s([n.$disabled,t.$disabled]),i=v([n.$tabIndex,t.$tabIndex],[t.$disabled]),f=u.pureComputed((function(
){return i()===null?null:-1}));return{$disabled:r,$tabIndex:i,$focusIndex:f}}function e(n){return u.contextFor($(n)[0])}function o(n){var t=$("<div/>")[0],i;return u.applyBindings(n,t),i=u.contextFor(t),u.cleanNode(t),i}function y(n,t){return o(n).extend({$disabled:t.$disabled,$tabIndex:t.$tabIndex,$focusIndex:t.$focusIndex})}function a(n,t,i,r){var u=r||e(n);return u=u?u.createChildContext(t):o(t),u.extend(i)}function p(n){var t=e(n);return t||(t=o(null)),f(t.$disabled)&&(t=t.extend({$disabled:u.pureComputed(i.wrap(!1))})),f(t.$tabIndex)&&(t=t.extend({$tabIndex:u.pureComputed(i.wrap(0))})),f(t.$focusIndex)&&(t=t.extend({$focusIndex:u.pureComputed(i.wrap(-1))})),t}function s(n){return u.pureComputed((function(){for(var r,t=!1,i=0;i<n.length;i++)r=c(n[i],!1),t=t||r;return t}))}function v(n,t){var i=s(t);return u.pureComputed((function(){for(var r,f=i(),t=0,u=0;u<n.length;u++)r=c(n[u],0),t===null||r===null?t=null:f||t<0||r<0?r<0?t=r:t<0||(t=-1):t=r;return t}))}var f,h;r.defineProperty(t,"__esModule",
{value:!0});f=i.isUndefined;t.getContext=e;t.createIsolatedContext=y;t.createChildContext=a;t.contextFor=p;t.chainDisabledProperties=s;t.chainTabindexProperties=v;u.bindingHandlers.context={init:function(){return{controlsDescendantBindings:!0}},update:function(n,t,i,r,f){var e=u.unwrap(t()),o=u.ignoreDependencies((function(){var t=l(f,e);return a(n,r,t,f)}));u.applyBindingsToDescendants(o,n)}};u.virtualElements.allowedBindings.context=!0;h=u.bindingHandlers.template;u.bindingHandlers.template={init:function(n,t,i,r,u){return h.init(n,t,i,r,u)},update:function(n,t,i,r,f){var a=t(),e=u.unwrap(a),o,s,c;return e=typeof e=="string"?{name:a}:u.utils.extend({},e),o=e.context,o&&(f=u.ignoreDependencies((function(){typeof o=="function"&&(o=o(e.data||r));var n=l(f,o);return f.extend(n)})),delete e.context),s=f.$ctl,c=s&&s.templateEngine,c&&e.name&&!e.templateEngine&&(e.templateEngine=c),t=function(){return e},h.update(n,t,i,r,f)}}}));define("MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding",
["require","exports","ko","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl.Controls/Controls/Base/WidgetBinding"],(function(n,t,i,r,u,f){"use strict";var e;return (function(){function o(){return{controlsDescendantBindings:!0}}function s(r,e,o,s,c,l,a){var y=t(e()),p=y,w,b,k;y!==null&&typeof y=="object"&&(p=t(y.html),b=y.data,w=t(b),k=t(y.isolated));i.ignoreDependencies((function(){if(p&&!l){var t=new v(p,n,r,{BindingName:a}),e=u.sanitizeHTML(t,{});p=e.sanitizedMarkup}k?c=f.createIsolatedContext(w||s,c):b&&(c=c.createChildContext(w));h.cleanDescendantNodes(r);h.setHtml(r,p);i.applyBindingsToDescendants(c,r)}))}var v=r.ProvenanceContainer,t=i.unwrap,h=i.utils,e=i.bindingHandlers,c="htmlTemplate",l="untrustedHtml",a="trustedHtml";e[c]={init:o,update:function(n,t,i,r,u){s(n,t,i,r,u,!1,c)}};e[l]={init:o,update:function(n,t,i,r,u){var f=u.$ctl,e=f&&f.isTrusted;return s(n,t,i,r,u,e,l)}};e[a]={init:o,update:function(n,t,i,r,u){return s(n,t,i,r,u,!0,
a)}}})(e||(e={})),e}));define("Viva.Controls/Controls/Base/Viva.KnockoutExtensions",["require","exports","f","ko","MsPortalImpl.Controls/Controls/Base/WidgetBinding"],(function(n,t,i,r,u){"use strict";var f;return (function(){function f(t){return function(i,u,f,e,s){var c=r.unwrap(u()),l,y,a,v,h;if(c&&(l=c.text,y=c.visible,a=c.disabled,v=c.handler),!c||!l||!y||!a||!v||!c.execute)throw new Error("Command");h=n.text[t];h&&h(i,(function(){return l}),f,e,s);h=n.value[t];h&&h(i,(function(){return l}),f,e,s);h=n.visible[t];h&&h(i,(function(){return y}),f,e,s);h=n.disable[t];h&&h(i,(function(){var u=a()||r.unwrap(s.$disabled||!1),n=v(),f=n?n.canExecute():!1,t=u||!f;return i&&o(i).toggleClass("azc-command-disabled",t),t}),f,e,s);h=n.click[t];h&&h(i,(function(){return function(){var n=v();n&&!a()&&n.canExecute()&&c.execute()}}),f,e,s)}}function e(n){var t=u.createIsolatedContext(n.$data,n);return t.createChildContext=function(t){return u.createIsolatedContext(t,n)},t}var o=jQuery,n=r.bindingHandlers,t;n.azcCommand=
{init:f("init"),update:f("update")};n.stopBindings={init:function(n,t){var i=r.unwrap(t());return{controlsDescendantBindings:i}}};n.privateTemplate={init:function(t,i,r,u,f){return n.template.init(t,i,r,u,e(f))},update:function(t,i,r,u,f){return n.template.update(t,i,r,u,e(f))}};t={};n.vivaControl={registerCallback:function(n){var r=i.getUniqueId();return t[r]=n,r},unregisterGuid:function(n){delete t[n]},init:function(u,f,e,o,s){var h=r.unwrap(f()),c=t[h];return r.utils.domNodeDisposal.addDisposeCallback(u,(function(){var t=c().ltm;n.vivaControl.unregisterGuid(h);i.disposeDisposable.apply(i,t)})),n.privateTemplate.init(u,c,e,o,s)},update:function(i,u,f,e,o){var s=r.unwrap(u()),h=t[s];return n.privateTemplate.update(i,h,f,e,o)}}})(f||(f={})),f}));define("Viva.Controls/Util/Viva.Util.Private",["require","exports","o"],(function(n,t,i){"use strict";var r;return (function(n){var t=null,r,u=window,f=(function(){function n(n){this._prefixCode=";;;";this._dataTransfer=n}return i.defineProperty(n.prototype,
"dropEffect",{get:function(){return this._dataTransfer.dropEffect},set:function(n){if(n!=="none"&&n!=="copy"&&n!=="link"&&n!=="move")throw new Error("Drop effect must be either none, copy, link, or move.");this._dataTransfer.dropEffect=n},enumerable:!0,configurable:!0}),i.defineProperty(n.prototype,"effectAllowed",{get:function(){return this._dataTransfer.effectAllowed},set:function(n){if(n!=="none"&&n!=="copy"&&n!=="copyLink"&&n!=="copyMove"&&n!=="link"&&n!=="linkMove"&&n!=="move"&&n!=="all"&&n!=="uninitialized")throw new Error("Effect allowed must be either none, copy, copyLink, copyMove, link, linkMove, move, all, or uninitialized.");this._dataTransfer.effectAllowed=n},enumerable:!0,configurable:!0}),i.defineProperty(n.prototype,"types",{get:function(){var n=this._dataTransfer.types,u,f,e,o;if(t===null&&this.getData(""),t)return f=this._getLegacyData(),o=i.keys(f).some((function(n){return f[n]!==""})),i.keys(o?f:r);if(n&&!n.forEach)for(e=n,n=[],u=0;u<e.length;u++)n.push(e[u]);return n}
,enumerable:!0,configurable:!0}),i.defineProperty(n.prototype,"files",{get:function(){return this._dataTransfer.files},enumerable:!0,configurable:!0}),n.isLegacyDataTransfer=function(){if(t===null){var n=u.DataTransfer||u.Clipboard;return!n.prototype.setDragImage}return t},n.prototype.setDragImage=function(n,t,i){this._dataTransfer.setDragImage&&this._dataTransfer.setDragImage(n,t,i)},n.prototype.addElement=function(n){this._dataTransfer.addElement&&this._dataTransfer.addElement(n)},n.prototype.getData=function(n){if(this._checkFormat(n),t)return this._getLegacyDataTransfer(n);try{return t=!1,this._dataTransfer.getData(n)}catch(i){return t=!0,this.getData(n)}},n.prototype.setData=function(n,i){if(this._checkFormat(n),t)this._setLegacyDataTransfer(n,i);else try{t=!1;this._dataTransfer.setData(n,i)}catch(r){t=!0;this.setData(n,i)}},n.prototype.clearData=function(n){if(this._checkFormat(n),t)this._clearLegacyDataTransfer(n);else try{t=!1;this._dataTransfer.clearData(n)}catch(i){t=!0;this.
clearData(n)}},n.prototype._checkFormat=function(n){if(n&&n.toLowerCase()!==n)throw new Error("Format must be in lowercase.");},n.prototype._getLegacyData=function(){var n=this._dataTransfer.getData("Text");return n&&n.substr(0,this._prefixCode.length)===this._prefixCode?JSON.parse(n.substr(this._prefixCode.length)):{Text:n}},n.prototype._stringifyLegacyData=function(n){return this._prefixCode+JSON.stringify(n)},n.prototype._getLegacyDataTransfer=function(n){return this._getLegacyData()[n]||""},n.prototype._setLegacyDataTransfer=function(n,t){var i=this._getLegacyData();i[n]=t;r=i;this._dataTransfer.setData("Text",this._stringifyLegacyData(i))},n.prototype._clearLegacyDataTransfer=function(n){if(r={},n){var t=this._getLegacyData();delete t[n];r=t}this._dataTransfer.setData("Text",this._stringifyLegacyData(r))},n})();n.DataTransfer2=f;document.addEventListener("dragend",(function(){r={}}),!1)})(r||(r={})),r}));define("Viva.Controls/Util/Viva.Util",["require","exports","f","o","ko","$","Viva.Controls/Util/Viva.Util.Private"],
(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function l(n,t){var f=n.tagName,i,r,u;switch(f){case"TABLE":i="tr";break;case"TR":i="td";break;case"UL":i="li";break;default:i="span"}t&&(u=n.getAttribute("aria-live"),n.setAttribute("aria-live","assertive"));r=document.createElement(i);n.appendChild(r);n.removeChild(r);t&&(u?n.setAttribute("aria-live",u):n.removeAttribute("aria-live"))}function a(n,t){var i=n.parents().filter((function(){var n=f(this),t=n.css("overflow-x"),i=n.css("overflow-y");return(t!=="hidden"||i!=="hidden")&&(t!=="visible"||i!=="visible")}));return t&&(i=i.add(window)),i}function v(n){if(n){var r=f(n),i=void 0;if(r.attr(t.dataControlAttribute))return n;if(i=r.closest("["+t.dataControlAttribute+"='true']"),i.length>0)return i[0]}return null}function h(n){var r=f(n),i;return r.attr(t.dataCanFocusAttribute)&&(i=n[t.dataCanFocusAttribute],i)?i():!1}function o(n,t,i){var f=0,r,e,u;do{if(r=null,u=n.find(t+":eq("+f+")"),u.length>0&&(r=u[0],e=i(r),e&&h(r)))return!0;
f++}while(!c(r));return!1}function y(n,t){t===void 0&&(t=!0);var i=r.keys(n);return t?i.sort((function(n,t){return n<t?1:-1})):i}function p(n,t){var i,f,r,u;if(t.length<=n.length){for(i=-1,f=function(r){var u=t[r];return i=n.firstIndex((function(n){return n===u}),i+1),i<0?{value:!1}:void 0},r=0;r<t.length;r++)if(u=f(r),typeof u=="object")return u.value;return!0}return!1}function w(n,i){var f="["+t.dataFocusFirstAttribute+"='true']",e=":not("+f+")",u="["+t.dataCanFocusAttribute+"='true']",s=function(n){return n},r=!1;return i&&(r=o(n,u+f,i),r||(r=o(n,u+e,i))),r||(r=o(n,u+f,s),r||(r=o(n,u+e,s))),r}function b(n,t){var i=t||n.type;return f.Event(n,{type:i,target:n.target,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,currentTarget:n.currentTarget,isImmediatePropagationStopped:n.isImmediatePropagationStopped,isPropagationStopped:n.isPropagationStopped,preventDefault:n.preventDefault,stopImmediatePropagation:n.stopImmediatePropagation,stopPropagation:n.stopPropagation})}function k(n,t,i){for(var s=i?i.length:
0,r,e,f,o=0;o<s;o++)r=i[o],e=t[r]||u.observable(),f=n[r],e(u.isObservable(f)?f.peek():f),t[r]||(t[r]=e)}function d(n,t){var i=n.indexOf(t)<0;return i&&n.push(t),!i}function g(n){var t=n.getAttribute("class");return t?new s(t):new s}function nt(n,t){n.setAttribute("class",t._fields.join(" "))}function tt(t){var i=f(t);return i.length?i[0].getBoundingClientRect():n.defaultBox}var c=i.isNullOrUndefined,f=jQuery,t,s;(function(n){n.dataCanFocusAttribute="data-canfocus";n.dataFocusFirstAttribute="data-focus-first";n.dataEditableAttribute="data-editable";n.dataControlAttribute="data-control";n.dataActivatableAttribute="data-activatable";n.dataActivateInfoAttribute="data-activate-info"})(t=n.Constants||(n.Constants={}));n.forceScreenRead=l;n.getScrollableParents=a;n.findContainingControl=v;n.executeSetFocusOn=h;n.getObjectBasicShape=y;n.shapeContains=p;n.setFocusToFirstFocusableChild=w;n.cloneEvent=b;n.fillObserableFields=k;n.existsOrRegisterId=d;s=(function(){function n(n){n===void 0&&(n=null);
this._fields=n?n.split(" "):[]}return n.prototype.add=function(n){this._fields.indexOf(n)<0&&this._fields.push(n)},n.prototype.remove=function(n){while(this._fields.indexOf(n)>=0)this._fields.splice(this._fields.indexOf(n),1)},n.prototype.contains=function(n){return this._fields.indexOf(n)>=0},r.defineProperty(n.prototype,"length",{get:function(){return this._fields.length},enumerable:!0,configurable:!0}),n.prototype.toggle=function(n){return this._fields.indexOf(n)>=0?(this.remove(n),!1):(this.add(n),!0)},n.prototype.item=function(n){return this._fields[n]},n.prototype.toString=function(){return this._fields.toString()},n})();n.DOMTokenListShim=s;n.getClassList=g;n.setClassList=nt;n.DataTransfer=e.DataTransfer2;n.defaultBox={top:0,left:0,width:0,height:0};n.getBox=tt})(o||(o={})),o}));define("_generated/Less/MsPortalImpl.Controls/Controls/Base.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxc-base-fill-container-width{width:100%}.fxc-base-fill-container-height{height:100%}.fxc-base-loading{position:relative;height:100%}.fxc-base-loading .fxc-base-loadingImage{position:absolute;top:calc(50% - 30px / 2);left:calc(50% - 30px / 2)}")})
);define("MsPortalImpl.Controls/Controls/Base/Base",["require","exports","f","i","a","ko","Viva.Controls/Util/Viva.Util","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","_generated/Less/MsPortalImpl.Controls/Controls/Base.css","Viva.Controls/Controls/Base/Viva.KnockoutExtensions","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){function v(n,t){var i=c(n,t);return i?i[0]||null:null}function c(n,i){var r=n.data(t.widgetTypesDataKey)||[];return i?r.filter((function(n){return n instanceof i})):r}var a=i.Base,y=a.Diagnostics,u,h,l;t.widgetTypesDataKey="fxWidgetTypes";u="remove.fxWidget";h="fxs-display-none";t.getWidget=v;t.getWidgets=c;l=(function(){function c(u,f,e){var v,y,l,a,c;if(e===void 0&&(e={}),v=this,this._destroyIds=[],this._currentCssClass="",!u||!u.length)throw new Error("You must specify an element to associate a control to it. Your element is either null or an empty collection.");
this.element=u;y=this.ltm=new r.TriggerableLifetimeManager;this.vmBasicOption={ltm:y};this.bindingContext=e.bindingContext;u.data(t.widgetTypesDataKey)||u.data(t.widgetTypesDataKey,[]);u.data(t.widgetTypesDataKey).push(this);l=f.controlType;l!==0&&l!==94&&(a=f.visible,a&&a.subscribeAndRun(this.ltm,(function(n){i.isNullOrUndefined(n)||u.toggleClass(h,!n)})));c=f&&f.cssClass;c&&(c.subscribeAndRun(this.ltm,(function(t){t&&(s.isAllowedCssClassName(t)?(u.addClass(t),v._currentCssClass=t):o.logToExtension(n,u,2,"Invalid control css class name: "+t,{}))})),c.subscribe(this.ltm,(function(n){n&&u.removeClass(n)}),null,"beforeChange"));this._registerDispose()}return c.prototype.isDisposed=function(){return this._destroyIds.length>0},c.prototype.dispose=function(){if(!this._checkExistsOrRegisterDestroyId(null)){this.ltm&&this.ltm.dispose();this.element.removeClass(h+" "+this._currentCssClass);var n=this.element.data(t.widgetTypesDataKey);n&&(n.splice(n.indexOf(this),1),n.length||this.element.removeData(
t.widgetTypesDataKey));this._disposeCallback&&(this._unregisterDispose(),this._disposeCallback=null)}},c.prototype._checkExistsOrRegisterDestroyId=function(n){return e.existsOrRegisterId(this._destroyIds,n)},c.prototype._cleanDescendants=function(){f.utils.cleanDescendantNodes(this.element)},c.prototype._cleanElement=function(){for(var i,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i=this.element;this._cleanDescendants();t.length&&i.removeClass(t.join(" "));i.empty()},c.prototype._registerDispose=function(){var n=this,t=this.element;if(this.bindingContext)f.utils.domNodeDisposal.addDisposeCallback(t[0],this._disposeCallback=function(){n.dispose()});else t.on(u,this._disposeCallback=function(i){i.target!==t[0]||n._destroyTriggered||(n._destroyTriggered=!0,n.dispose())})},c.prototype._unregisterDispose=function(){var n=this.element,t=this._disposeCallback;this.bindingContext?f.utils.domNodeDisposal.removeDisposeCallback(n[0],t):n.off(u,t)},c})();t.Widget=l})(h||(h={})),h}));define("MsPortalImpl/Base/Base.LruMap",
["require","exports","f","o"],(function(n,t,i,r){"use strict";r.defineProperty(t,"__esModule",{value:!0});var u=(function(){function n(n){this._map={};this._capacity=n||0;this.clear()}return n.prototype._getItem=function(n,t){var i=this._map[n];if(i)i.lastAccessed=++this._lastAccessed;else if(t)throw new Error("Unable to find item with key: '"+n+"'.");return i},r.defineProperty(n.prototype,"count",{get:function(){return r.keys(this._map).length},enumerable:!0,configurable:!0}),n.prototype.contains=function(n){return!!this._getItem(n)},n.prototype.trim=function(n){var t,r;if(n===void 0&&(n=this._capacity),n<0)throw new Error("Capacity cannot be negative.");else if(n>0&&n<this.count)for(t=[],i.forEachKey(this._map,(function(n,i){return t.push(i)})),t.sort((function(n,t){return t.lastAccessed-n.lastAccessed})),r=n;r<t.length;r++)delete this._map[t[r].key]},n.prototype.getOrAdd=function(n,t){var r=this._getItem(n,!t),i;return r?i=r.data:(i=t(n),this.addOrUpdate(n,i)),i},n.prototype.addOrUpdate=function(
n,t,i){var r=this._getItem(n);return r?r.data=t:(this._map[n]={key:n,data:t,lastAccessed:++this._lastAccessed},i||this.trim()),!r},n.prototype.remove=function(n){delete this._map[n]},n.prototype.clear=function(){this._map={};this._lastAccessed=0},n})();t.LruMap=u}));define("MsPortalImpl/Base/Base.SvgHelper",["require","exports","f","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.LruMap","MsPortalImpl/Base/Base.Sanitization"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function c(i,r){var u,f;return r.customClass&&(u=h(new s(r.customClass,n)).sanitizedMarkup,(u.startsWith("ext-")||u.startsWith("msportalfx")||u.startsWith("fxt-"))&&u.indexOf(" ")===-1&&(i=i.replace(t.SvgPlaceholderClass,t.SvgPlaceholderClass+" "+u))),r.description&&(i=i.replace("<\/title>","<\/title><desc>"+h(new s(r.description,n)).sanitizedMarkup+"<\/desc>")),r.title?(f=!r.title?"":h(new s(r.title,n)).
sanitizedMarkup,i=i.replace("<title><\/title>",'<title id="titleID">'+f+"<\/title>")):i=i.replaceAll("<title><\/title>",""),r._badgeWidth||(i=i.replaceAll(t.SvgPlaceholderClass,"").replaceAll(' class="" '," ")),i}function b(i,f,e){var b,a,nt,tt,k,d,g;if(f=f||i.options||{},b=i&&i.type,a=i&&i.data,b!==0&&a){if(b===2&&o.sanitizeUri(a))return nt=!f.title?"":h(new s(f.title,n)).sanitizedMarkup,'<img alt="'+nt+'" aria-hidden="'+!f.title+'" src="'+v(a)+'"/>';if(b===1&&(a=y.getOrAdd(a,(function(){return h(new s(a,n,e)).sanitizedMarkup})),!a))return new u.ProvenanceContainer(i,n,e).log(2,"Svg has failed to load, imageData: "+i,{}),""}else return"";return(tt=t.SvgsPalettes[f.palette],f.palette&&(a=a.replace(t.SvgPlaceholderClass,t.SvgPlaceholderClass+" "+tt)),f.isLogo||(a=a.replace(/fill=\"[^\"]*\"|fill=\'[^\']*\'/ig,""),a.indexOf(t.SvgsPalettes[99])===-1&&(a=a.replace(t.SvgPlaceholderClass,t.SvgPlaceholderClass+" fxs-portal-svg"))),r.isIe||f.customClass||/msportalfx-svg-c0(5|7)|-animated(\s|'|")|(\s|'|")ext-/.
test(a))?c(a,f):(k=l.get(a),k||(d=w(),l.set(a,k='<svg class="'+t.SvgPlaceholderClass+'" height="100%" width="100%"><title><\/title><use xlink:href="#'+d+'"><\/use><\/svg>'),g=$("<svg><defs>"+a.replace("<svg","<symbol").replace("<\/svg>","<\/symbol>")+"<\/defs><\/svg>"),g.find("symbol").attr("id",d).removeClass(t.SvgPlaceholderClass),p.appendChild(g[0])),c(k,f))}var a=i.Base,k=a.Diagnostics,s=u.ProvenanceContainer,v=i.encodeAttribute,h=f.sanitizeHTML,y=new e.LruMap(100);t.SvgPlaceholderClass="msportalfx-svg-placeholder";t.SvgBadgeClass="msportalfx-svg-badge";t.SvgsPalettes={};t.SvgsPalettes[0]="";t.SvgsPalettes[2]="msportalfx-svg-palette-black";t.SvgsPalettes[3]="msportalfx-svg-palette-blue";t.SvgsPalettes[1]="msportalfx-svg-palette-white";t.SvgsPalettes[4]="msportalfx-svg-palette-green";t.SvgsPalettes[5]="msportalfx-svg-palette-gray";t.SvgsPalettes[99]="msportalfx-svg-palette-inherit";t.SvgsPalettes[100]="msportalfx-svg-disabled";var p=document.head.appendChild($("<div id='FxSymbolContainer'><\/div>")[
0]),w=i.getIdGenerator("FxSymbol"),l=new i.Map;t.getSvgReferenceOrFallBackToData=b})(s||(s={})),s}));define("MsPortalImpl/Svg/Startup/Warning.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 9 9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8.267 8H.733c-.6 0-.916-.623-.62-1.129L2.014 3.53 3.896.384c.302-.507.903-.514 1.197-.008L7.001 3.65l1.882 3.229C9.183 7.383 8.881 8 8.267 8z' class='msportalfx-svg-c10'/><circle cx='4.5' cy='6.178' r='.615' class='msportalfx-svg-c01'/><path d='M4.623 2.428H3.98l.164 2.85h.774l.165-2.85z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));define("MsPortalImpl/Widgets/Widgets.Common",["require","exports","f","i","ko","$","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/Base/Base.SvgHelper",
"MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var a;return (function(t){function tt(){if(!k){var n=f("<div style='width:50px;height:50px;overflow:auto'><div><\/div><\/div>").appendTo("body"),t=n.children();k=t.innerWidth()-t.height(99).innerWidth();n.remove()}return k}function it(n,t,i){var e,o,s;t===void 0&&(t=0);i===void 0&&(i=!1);var r=n.getBoundingClientRect(),u=document.documentElement,f=!0;return i||(e=v.innerWidth||u.clientWidth,f=r.left>=0&&r.right<=e),o=v.innerHeight||u.clientHeight,s=r.top+t>=0&&r.bottom+t<=o,{elementRect:r,fullyVisible:s&&f}}function rt(n,t){var i,r;if(!n||!t){y.error("Cannot register a template with an undefined "+(n?"content":"name")+".");return}if(!/^[a-z][a-z0-9]*$/ig.test(n)){y.error("Name '"+n+"' is invalid. Name must start with a letter and can only contain letters and numbers.");return}if(i=f("body"),i.find("#"+n).length){y.error("A template with name '"+n+"' was already registered.");return}r=f("<script id="+n+" type='text/html'/>").
text(t);i.append(r)}function d(n){function r(t){var i=t.element;return n===i||f.contains(n,i)}var i=b.first(r),t;return i?i.promise:(t=w.get(n)||a.first((function(t){return f.contains(n,t.element)})),t)?t.promise.then((function(){return d(n)})):Q()}function ut(n){if(n){if(!f.contains(v.document.documentElement,n))return Q.reject(new i.Errors.CanceledError("container is not in documentElement"))}else return r.QReject("container is "+n);return d(n)}function ft(n){n&&f.contains(v.document.documentElement,n)&&a.filter((function(t){var i=t.element;return n===i||f.contains(n,i)})).forEach((function(n){i.remove(a,n);n&&n.dispose()}))}function et(n,t,i,r,u){var s=f(r),h=e.getWidget(s),c,o;return h!==null&&h.dispose(),u&&(c=new i.Widget(s,u,{bindingContext:t,services:n}),o=c,o.awaitContentRevealed)?o.awaitContentRevealed():void 0}function ot(t,u,e){var c,a,s,h;p.isInstanceOfErrorType(t,p.CanceledError)||(t&&(c=r.Diagnostics.getLogFriendlyMessage(t),a=t.stack),s=e?"Failed to load the control module '"+e+
"'.":"",c&&(s+="\r\n Error: "+c),h=f(u),h.closest("[class^='ext-']").length||h.closest("[class*=' ext-']").length?o.logToExtension(n,u,2,s,{}):y.error(s,1),h.html(nt),Q.nextTick((function(){h.trigger(l.default.fxportalcontrolloadfailed,new i.Errors.Error({message:s,stack:a,innerErrors:t}))})))}function st(n,t,r){return t=t||{controlsDescendantBindings:!0},{init:function(){return t},update:function(t,f,e,o,s){var h=u.unwrap(f());u.ignoreDependencies((function(){var e,o=i.tryImmediateResolve(i.require(n),(function(n){if(!e)return et(r,s,n,t,h)}),(function(r){if(!e&&!i.Errors.isInstanceOfErrorType(r,p.CanceledError))return ot(r,t,n),Q.reject(r)})),c,l,f;Q.isFulfilled(o)||(c=function(){i.remove(a,f,-1);w.delete(t);e&&i.remove(b,f,-1)},l=function(){e=!0;c()},u.utils.domNodeDisposal.addDisposeCallback(t,l),f={element:t,promise:o,dispose:l},Q.isPending(o)&&(a.push(f),w.set(t,f)),f.promise=o.catch((function(n){return b.push(f),Q.reject(n)})).finally(c))}))}}}var g=i.Base.Diagnostics,p=i.Errors,v=window,
nt="<span class='fxs-portal-controlloadfailed'>"+c.getSvgReferenceOrFallBackToData(h)+i.encodeHtml(s.PartError.title)+"<\/span>",y=g.createLog(n),a=[],w=new i.Map,b=[],k;t.getBrowserScrollbarWidth=tt;t.isElementFullyInViewport=it;t.registerKoTemplate=rt;t.waitForBindings=ut;t.cancelBindings=ft;t.getAsyncBindingHandler=st})(a||(a={})),a}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-avatarmenu-tenant,.fxs-avatarmenu-tenant-uri,.fxs-avatarmenu-username{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-avatarmenu{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.fxs-avatarmenu-header{position:relative;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;padding-left:20px;height:40px}.fxs-avatarmenu-username{font-size:14px;line-height:normal;max-width:146px}.fxs-avatarmenu-dropdown-title,.fxs-avatarmenu-tenant{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;text-transform:uppercase}.fxs-avatarmenu-tenant{line-height:normal;opacity:.9;max-width:146px}.fxs-avatarmenu-tenant-container{text-align:right;-webkit-flex:1 1 auto;flex:1 1 auto}.fxs-avatarmenu-tenant-image{height:35px;width:35px;border:0;border-radius:35px;margin-left:11px;margin-right:5px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-avatarmenu-tenant-name{-webkit-flex:0 0 100%;flex:0 0 100%}.fxs-avatarmenu-dropdown{width:220px}.fxs-avatarmenu-dropdown-title{padding:5px 20px 0}.fxs-avatarmenu-tenant-uri{font-size:12px;margin-top:5px}.fxs-avatarmenu-list-tenant a{display:block}.fxs-avatarmenu-list-system a{display:-webkit-flex;display:flex}.fxs-avatarmenu-scrollviewer{max-height:505px;overflow:auto}html[lang^=ja] .fxs-avatarmenu .fxs-avatarmenu-dropdown .fxs-avatarmenu-dropdown-title,html[lang^=ja] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^=ko] .fxs-avatarmenu .fxs-avatarmenu-dropdown .fxs-avatarmenu-dropdown-title,html[lang^=ko] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^=zh] .fxs-avatarmenu .fxs-avatarmenu-dropdown .fxs-avatarmenu-dropdown-title,html[lang^=zh] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant{font-size:11px}')})
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-contextMenu{display:none;position:fixed;width:225px;padding:10px 0;box-sizing:border-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:300;max-height:100vh;overflow-x:hidden;overflow-y:auto;border-style:solid;border-width:1px}.fxs-contextMenu:focus{outline:0}.fxs-contextMenu.fxs-contextMenu-active{display:block}.fxs-contextMenu-item{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:30px;padding:5px 25px;box-sizing:border-box;font-size:13px;line-height:normal;cursor:default}.fxs-contextMenu-text{-webkit-flex:1 1 auto;flex:1 1 auto;height:20px}.fxs-contextMenu-icon{-webkit-flex:0 0 auto;flex:0 0 auto;-webkit-align-content:flex-end;align-content:flex-end;height:21px;width:21px;display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;align-items:center}.fxs-contextMenu-icon>svg{height:16px;width:16px}.fxs-contextMenu-itemList{list-style-type:none;margin:0;padding:0}.fxs-contextMenu-extensioncommand .fxs-contextMenu-icon{display:none}.fxs-contextMenu-extensioncommand.fxs-contextMenu-itemDisabled{display:block}.fxs-contextMenu-itemDisabled{opacity:.5;cursor:text}.fxs-contextMenu-itemDisabled.fxs-contextMenu-item:hover{background-color:transparent}.fxs-contextMenu-form{padding:8px 20px;display:none}.fxs-contextMenu-form.fxs-contextMenu-active{display:block}.fxs-dialogballoon.azc-balloon{opacity:1;width:auto;max-width:550px}.fxs-dialogballoon.azc-balloon .azc-balloon-content{padding:0}.fxs-dialogballoon.azc-balloon.azc-balloon-box-bottom .azc-balloon-pointer{border-bottom-color:#464f59}.fxs-dialogballoon.azc-balloon.azc-balloon-box-top .azc-balloon-pointer{border-top-color:#3c454f}.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-hero,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herotall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herowide,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-large,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-mini,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-normal,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-small,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-tall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-wide{height:20px;width:20px}.msportalfx-contextmenu-grid rect{display:none}.msportalfx-contextmenu-grid-hero .msportalfx-grid-rect-hero,.msportalfx-contextmenu-grid-herotall .msportalfx-grid-rect-herotall,.msportalfx-contextmenu-grid-herowide .msportalfx-grid-rect-herowide,.msportalfx-contextmenu-grid-large .msportalfx-grid-rect-large,.msportalfx-contextmenu-grid-mini .msportalfx-grid-rect-mini,.msportalfx-contextmenu-grid-normal .msportalfx-grid-rect-normal,.msportalfx-contextmenu-grid-small .msportalfx-grid-rect-small,.msportalfx-contextmenu-grid-tall .msportalfx-grid-rect-tall,.msportalfx-contextmenu-grid-wide .msportalfx-grid-rect-wide{display:block}")})
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-contextpane{display:none;height:100%;position:relative;z-index:200}.fxs-contextpane .fxs-contextpane-content{box-sizing:border-box;height:100%;overflow:auto}.fxs-contextpane .fxs-progress-dots{display:none}.fxs-contextpane.fxs-contextpane-loading .fxs-progress-dots,.fxs-contextpane.fxs-contextpane-visible{display:block}.fxs-contextpane-close,.fxs-contextpane-expand{cursor:pointer;border:0;background-color:transparent;margin:0;transition:background .2s ease-out;height:30px;width:30px;position:absolute;top:0}.fxs-contextpane-close svg,.fxs-contextpane-expand svg{display:block;height:16px;width:16px}.fxs-contextpane-close{right:0}.fxs-contextpane-close:hover{background:#ba141a;color:#fff}.fxs-contextpane-expand{left:0;padding:8px 7px 9px 20px;width:100%}.fxs-contextpane-expand svg{height:18px;width:18px}.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left{width:60px;max-width:60px}.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-loading-status,.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-partscontainer,.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-topcontainer>*{display:none}.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-topcontainer{overflow:visible}.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-topcontainer .fxs-partgallery-title{display:block;white-space:nowrap;-webkit-transform:rotate(90deg) translateY(5px);transform:rotate(90deg) translateY(5px);-webkit-transform-origin:0;transform-origin:0}.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-contextpane-expand,.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-contextpane-expand .fxs-contextpane-button-inner{height:100%;display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap}.fxs-sidebar+.fxs-portal-contextpane-left{width:225px;max-width:225px;border-right:1px solid}.fxs-portal-contextpane-right{position:absolute;right:0;box-shadow:0 5px 15px 2px rgba(0,0,0,.3);max-width:calc(100% - 225px)}.fxs-sidebar-is-collapsed~.fxs-portal-contextpane-right{max-width:calc(100% - 60px)}")})
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxc-base .fxs-tile-progress{background-color:inherit}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent{height:100%;width:100%;left:auto;top:auto}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent>div{margin:0;left:0;vertical-align:baseline}")}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-dropmenu{position:relative;-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box;z-index:200}.fxs-dropmenu-button{border:none;padding:0;margin:0;background:0 0;cursor:pointer;display:-webkit-flex;display:flex;position:relative;height:100%;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center}.fx-dropmenu-dropdown .fxs-dropmenu-list-system a{display:-webkit-flex;display:flex}.fx-dropmenu-dropdown .fxs-journeysmenu-journey-nodata{height:130px;width:100%}.fx-dropmenu-dropdown .fxs-journeysmenu-journey-nodata .fxs-journeysmenu-journey-nodata-content{font-size:12px;line-height:18px;margin:0 40px;padding-top:50px;text-align:center}.fxs-dropmenu-content{position:absolute}.fxs-dropmenu-content.fxs-dropmenu-defaultWidth{width:220px}.fxs-dropmenu-content.fxs-dropmenu-extendWidth{width:355px}.fxs-dropmenu-content ol,.fxs-dropmenu-content ul{list-style:none;padding:0;margin:0}.fxs-dropmenu-content li{white-space:nowrap}.fxs-dropmenu-content li a{-webkit-align-items:center;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:10px 20px}.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton{display:-webkit-flex;display:flex;-webkit-flex:0 0 auto;flex:0 0 auto;background:0 0;cursor:pointer;border:0;margin-right:5px;-webkit-align-items:center;align-items:center}.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton img,.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton svg{opacity:.2;height:15px;width:15px}.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton:hover img,.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton:hover svg{opacity:1}.fxs-dropmenu-content .fxs-dropmenu-list-content{-webkit-flex:1 1 auto;flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-dropmenu-content .fxs-journeysmenu-journey{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;margin-right:auto}.fxs-dropmenu-content .fxs-journeysmenu-journey-content{-webkit-flex:0 0 auto;flex:0 0 auto;padding:0 10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-dropmenu-content .fxs-dropmenu-image{-webkit-flex:0 0 auto;flex:0 0 auto;height:16px;width:16px}.fxs-dropmenu-content .fxs-dropmenu-image img,.fxs-dropmenu-content .fxs-dropmenu-image svg{height:13px;width:13px}.fxs-dropmenu-content .fxs-dropmenu-line-separator{border-top-width:1px;border-top-style:solid}.fxs-journeysmenu-content{min-width:450px}.fxs-dropmenu-left{right:0}.fxs-dropmenu-right{left:0}.fxs-dropmenu-hidden{display:none}.fxs-dropmenu-invisible{visibility:hidden}.fxs-journeysmenu-list{display:-webkit-flex;display:flex}.fxs-journeysmenu-journey-wrapper{display:-webkit-flex;display:flex;-webkit-flex:1 1 auto;flex:1 1 auto}")})
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-flowlayout{position:relative}.fxs-flowlayout>.fxs-flowlayout-childcontainer{position:relative;transition:height .25s linear,width .25s linear 0s}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-element{position:absolute}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-drop-placeholder{position:absolute;background:rgba(0,0,0,.2)}.fxs-flowlayout-childcontainer>.fxs-tile{transition:height 125ms linear 125ms,width 125ms linear 0s,top 175ms ease-out,left 175ms ease-out,right 175ms ease-out}.fxs-flowlayout-resolutionguide{position:absolute;top:0;left:0;box-sizing:border-box;color:#fff;border-color:#fff;opacity:.7;border-width:1px;border-right-style:dashed;border-bottom-style:dashed;pointer-events:none;font-size:13px;line-height:normal}.fxs-flowlayout-resolutionguide::after{position:absolute;right:8px;bottom:5px}.fxs-flowlayout-resolutionguide-1024x768{height:768px;width:1024px}.fxs-flowlayout-resolutionguide-1024x768::after{content:"1024 x 768"}.fxs-flowlayout-resolutionguide-1366x768{height:768px;width:1366px}.fxs-flowlayout-resolutionguide-1366x768::after{content:"1366 x 768"}.fxs-flowlayout-resolutionguide-1440x900{height:900px;width:1440px}.fxs-flowlayout-resolutionguide-1440x900::after{content:"1440 x 900"}.fxs-flowlayout-resolutionguide-1920x1080{height:1080px;width:1920px}.fxs-flowlayout-resolutionguide-1920x1080::after{content:"1920 x 1080"}.fxs-flowlayout-resolutionguide-3840x2160{height:2160px;width:3840px}.fxs-flowlayout-resolutionguide-3840x2160::after{content:"3840 x 2160"}.fxs-drag-surface{position:fixed;margin:0;padding:0;top:0;left:0;right:0;bottom:0;overflow:hidden;background-color:transparent;pointer-events:none;z-index:199}.fxs-drag-disableTouchAction{-ms-touch-action:none;touch-action:none}.fxs-flowlayout-resizehandle{display:inline-block;padding:0 4px 4px 0;bottom:0;right:0}.fxs-flowlayout-resizehandle>div{height:12px;width:12px;border:2px solid rgba(125,125,125,.5);border-left-width:0;border-top-width:0}.fxs-flowlayout-livepreview,.fxs-flowlayout-resizehandle{position:absolute;cursor:se-resize;z-index:1}.fxs-flowlayout-livepreview{min-width:85px;min-height:85px;max-width:2245px;max-height:2245px;overflow:hidden}')})
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-panorama{position:relative;-ms-scroll-chaining:none}.fxs-panorama .fxs-journey-target,.fxs-panorama .fxs-startboard-target{position:absolute;top:0;left:0;height:100%;width:100%;z-index:0}.fxs-panorama>div[data-popup=true].azc-control{z-index:150}body.fxs-panning-cursor{cursor:ew-resize!important;cursor:-webkit-grabbing!important;cursor:-moz-grabbing!important;cursor:grabbing!important}.fxs-show-journey .fxs-startboard-target,.fxs-show-startboard .fxs-journey-target{display:none}.fxs-panorama-scrollbounce-onleft .fxs-startboard-layout,.fxs-panorama-scrollbounce-onleft>.fxs-journey-target{-webkit-transform:translateX(20px);transform:translateX(20px)}.fxs-panorama-scrollbounce-onright .fxs-startboard-layout,.fxs-panorama-scrollbounce-onright>.fxs-journey-target{-webkit-transform:translateX(-20px);transform:translateX(-20px)}.fxs-panorama-scrollbounce-reset .fxs-startboard-layout,.fxs-panorama-scrollbounce-reset>.fxs-journey-target{-webkit-transform:translateX(0);transform:translateX(0)}.fxs-panorama-scrollbounce-onleft .fxs-startboard-layout,.fxs-panorama-scrollbounce-onleft>.fxs-journey-target,.fxs-panorama-scrollbounce-onright .fxs-startboard-layout,.fxs-panorama-scrollbounce-onright>.fxs-journey-target,.fxs-panorama-scrollbounce-reset .fxs-startboard-layout,.fxs-panorama-scrollbounce-reset>.fxs-journey-target{transition:transform .333s ease!important}")})
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,"@-webkit-keyframes fxs-indicator-animatedEllipses{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}@keyframes fxs-indicator-animatedEllipses{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}.fxs-topbar-search{height:40px}.fxs-topbar-search .fxs-box-wrapper{margin-top:6px;margin-right:6px}.fxs-topbar-search .fxs-menu{margin-right:6px;top:34px}.fxs-search-text{white-space:normal;overflow:hidden;text-overflow:ellipsis}.fxs-search{position:relative}.fxs-search.fxs-search-expanded{padding:0 0 0 10px;position:relative}.fxs-search.fxs-search-expanded .fxs-box-wrapper{display:inline-block}.fxs-search.fxs-search-expanded .fxs-search-icon{display:none}.fxs-search .fxs-box-wrapper{position:relative;padding:0;display:none}.fxs-search .fxs-box-wrapper.fxs-searching .fxs-indicator{display:inline-block}.fxs-search .fxs-box-wrapper.fxs-searching .fxs-searchbox .azc-input{padding:0 60px 0 32px}.fxs-search div.fxs-icon{position:absolute;padding:5px 7px}.fxs-search div.fxs-icon svg{height:18px;width:18px;-webkit-flex:0 0 auto;flex:0 0 auto;fill:#fff}.fxs-search .fxs-cross{height:28px;width:20px;position:absolute;font-size:20px;top:-2px;right:0;cursor:pointer;color:#fff}.fxs-search .fxs-searchbox{height:28px;width:400px}.fxs-search .fxs-searchbox .azc-input{border:0;font-size:14px;padding:0 20px 0 32px;height:28px}.fxs-search .fxs-searchbox .azc-input::-ms-clear{display:none}.fxs-search .fxs-indicator{height:28px;width:40px;position:absolute;display:none;top:0;padding-top:4px;right:20px}.fxs-search .fxs-indicator>div{display:inline-block;height:6px;width:6px;-webkit-animation:fxs-indicator-animatedEllipses 1.5s infinite;animation:fxs-indicator-animatedEllipses 1.5s infinite;background:#aab3bd;margin:0 2.5px}.fxs-search .fxs-indicator>div:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.fxs-search .fxs-indicator>div:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.fxs-search .fxs-indicator>div:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}@media all and (min-width:1000px){.fxs-search{padding:0 0 0 10px;position:relative}.fxs-search .fxs-box-wrapper{display:inline-block}.fxs-search .fxs-search-icon{display:none}}")})
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-sidebar,.fxs-sidebar-bar{height:100%;box-sizing:border-box}.fxs-sidebar{z-index:201;position:relative;font-size:13px;border-right-width:1px;border-right-style:solid}.fxs-sidebar ul{padding:0;margin:0;list-style:none}.fxs-sidebar ul.fxs-sidebar-favorites{padding-bottom:20px}.fxs-sidebar button{font-family:inherit;margin:0;cursor:pointer;font-size:inherit}.fxs-sidebar-bar{width:225px;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column}.fxs-sidebar-bottom,.fxs-sidebar-top{-webkit-flex:0 0 auto;flex:0 0 auto;overflow:hidden}.fxs-sidebar-middle{min-height:0;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}@-moz-document url-prefix(){.fxs-sidebar-is-collapsed .fxs-sidebar-middle{width:80px}}@supports (-webkit-appearance:none) and (not (-ms-ime-align:auto)) and (not (-moz-appearance:none)){.fxs-sidebar-is-collapsed .fxs-sidebar-middle{width:80px}}.fxs-sidebar-bar{overflow:hidden}.fxs-sidebar-is-collapsed .fxs-sidebar-middle{-ms-overflow-style:none;-webkit-mask-image:linear-gradient(transparent,#000 12px,#000 calc(100% - 30px),transparent);mask-image:linear-gradient(transparent,#000 12px,#000 calc(100% - 30px),transparent)}.fxs-sidebar-is-collapsed .fxs-sidebar-improvedflyout.fxs-sidebar-flyout{max-width:calc(100vw - 85px);position:absolute;top:0;bottom:0;left:100%}.fxs-sidebar-button-flex{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-sidebar-favorites-section{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;padding:2px 0;margin:20px 0 10px;min-height:17px}.fxs-sidebar-create{height:37px;padding:0 20px;width:100%;box-sizing:border-box;border-right:none;border-left:none;border-top-width:1px;border-top-style:solid;border-bottom-width:1px;border-bottom-style:solid}.fxs-sidebar-improvedsidebar .fxs-sidebar-create{height:37px;padding:0 20px;width:100%;border:none}.fxs-sidebar-post-divider,.fxs-sidebar-pre-divider{border-bottom-width:1px;border-bottom-style:solid;height:0;margin:0 5px}.fxs-sidebar-myfavorites{text-transform:uppercase;color:#aab3bd;font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;word-break:keep-all}.fxs-sidebar-pre-divider{width:15px}.fxs-sidebar-post-divider{width:150px}.fxs-sidebar-flyout-is-hidden{display:none}.fxs-sidebar-create-label{margin-left:10px}.fxs-sidebar-create-icon{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:18px}.fxs-sidebar-create-icon svg{height:18px;width:18px}.fxs-sidebar-browse{padding:0 20px;height:40px;border:none}.fxs-sidebar-favorites .fxs-sidebar-icon{padding-left:20px}.fxs-sidebar-item{display:-webkit-flex;display:flex;-webkit-flex:1 1 auto;flex:1 1 auto;-webkit-align-items:center;align-items:center;min-height:40px}.fxs-sidebar-item:hover .fxs-sidebar-handle svg{display:block}.fxs-sidebar-defaultviewenabled .fxs-sidebar-favorites .fxs-sidebar-item:first-child{border-bottom-width:1px;border-bottom-style:solid;height:37px}.fxs-sidebar-item .fxs-sidebar-home{display:none}.fxs-sidebar-defaultviewenabled .fxs-sidebar-item .fxs-sidebar-home{display:flex}.fxs-sidebar-item-link{display:-webkit-flex;display:flex;-webkit-flex:1 1 auto;flex:1 1 auto;-webkit-align-items:center;align-items:center;width:100%;height:40px;-webkit-user-drag:none}.fxs-sidebar-icon{-webkit-flex:0 0 18px;flex:0 0 18px;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:18px}.fxs-sidebar-icon img,.fxs-sidebar-icon svg{height:18px;width:18px}.fxs-sidebar-flyout .fxs-sidebar-label,.fxs-sidebar-label{-webkit-flex:1 1 auto;flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-left:10px}.fxs-sidebar-item-icon{-webkit-flex:0 0 auto;flex:0 0 auto;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;height:100%;width:30px;cursor:pointer}.fxs-sidebar-item-icon svg{height:14px;width:14px}.fxs-sidebar-collapse-button{display:-webkit-flex;display:flex;height:44px;width:100%;-webkit-align-items:center;align-items:center;padding-left:20px;border:none}.fxs-sidebar-collapse-button svg{height:18px;width:18px}.fxs-sidebar-collapse-button-flip svg{-webkit-transform:rotate(90deg)!important;transform:rotate(90deg)!important}.fxs-sidebar-improvedsidebar .fxs-sidebar-collapse-button{display:-webkit-flex;display:flex;height:18px;width:100%;border:none;padding-left:0}.fxs-sidebar-improvedsidebar .fxs-sidebar-collapse-button svg{height:8px;width:8px;-webkit-transform:rotate(-90deg);transform:rotate(-90deg);margin-left:auto}.fxs-sidebar-browse-label{padding-right:5px;margin-left:10px}.fxs-sidebar-improvedsidebar .fxs-sidebar-browse-icon{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;padding-top:3px}.fxs-sidebar-improvedsidebar .fxs-sidebar-browse-icon svg{height:18px;width:18px;-webkit-transform:none;transform:none}.fxs-sidebar-browse-icon{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;padding-top:3px}.fxs-sidebar-browse-icon svg{height:15px;width:15px;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fxs-sidebar-star-icon{padding-right:10px}.fxs-sidebar-star-icon svg{height:12px;width:12px}.fxs-sidebar-show-if-expanded{display:block}.fxs-sidebar-show-if-collapsed{display:none}.fxs-sidebar-content{height:65px;padding:0 20px 5px}.fxs-sidebar-external{-webkit-flex:0 0 12px;flex:0 0 12px;margin:0 10px;padding-top:4px;width:12px}.fxs-sidebar-external svg{height:12px;width:12px}.fxs-sidebar-handle{-webkit-flex:0 0 20px;flex:0 0 20px;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;align-items:center;margin-left:auto;cursor:move}.fxs-sidebar-handle svg{display:none;height:16px;width:16px;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fxs-sidebar-is-collapsed .fxs-sidebar-bar{width:60px}.fxs-sidebar-is-collapsed .fxs-sidebar-show-if-collapsed{display:block}.fxs-sidebar-is-collapsed .fxs-sidebar-show-if-expanded{display:none}.fxs-sidebar-is-collapsed .fxs-sidebar-post-divider,.fxs-sidebar-is-collapsed .fxs-sidebar-pre-divider{width:15px}.fxs-sidebar-is-collapsed .fxs-sidebar-star-icon{padding-right:0}.fxs-sidebar-cloudFilter{padding-left:20px;padding-right:10px;padding-bottom:10px;font-size:14px;line-height:24px}.fxs-sidebar-cloudFilter .azc-dropdown-wrapper{background-color:inherit}')})
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-stacklayout{display:-webkit-flex;display:flex}.fxs-stacklayout.fxs-stacklayout-vertical{-webkit-flex-direction:column;flex-direction:column}.fxs-stacklayout.fxs-stacklayout-horizontal{-webkit-flex-direction:row;flex-direction:row;height:100%}.fxs-stacklayout-child{-webkit-flex:0 0 auto;flex:0 0 auto}")}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-startboard{display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap;overflow:hidden}.fxs-startboard .fxs-startboard-message-container,.fxs-startboard.fxs-startboard-notfound>.fxs-startboard-layout{display:none}.fxs-startboard.fxs-startboard-notfound .fxs-startboard-message-container{display:block}.fxs-startboard-header{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto;width:100%;height:45px;padding:0 25px 0 40px;box-sizing:border-box}.fxs-startboard-header .fxs-startboard-title-next{display:block}.fxs-startboard-header .fxs-startboard-button-text{font-size:12px}.fxs-startboard-header .fxs-startboard-button-icon{height:12px;width:12px;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;-webkit-flex:0 0 12px;flex:0 0 12px}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon{height:16px;width:16px;margin:4px 8px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon>svg{-webkit-flex:0 0 16px;flex:0 0 16px}.fxs-startboard-header .fxs-startboard-title{max-width:300px}.fxs-startboard-header .fxs-startboard-title-edit{padding:0 5px 2px;margin:0 -6px -2px;border-width:1px;border-style:solid;color:inherit;background-color:transparent;width:300px;transition:border .12s}.fxs-startboard-header .fxs-startboard-title-edit:active,.fxs-startboard-header .fxs-startboard-title-edit:hover{border-color:inherit}.fxs-startboard-header .fxs-startboard-button{position:relative}.fxs-startboard-header .fxs-startboard-button,.fxs-startboard-header .fxs-startboard-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left}.fxs-startboard-header .fxs-startboard-button,.fxs-startboard-header .fxs-startboard-dropdown{font-size:13px;line-height:20px}.fxs-startboard-header .fxs-startboard-title,.fxs-startboard-header .fxs-startboard-title-edit{font-size:24px;line-height:normal}.fxs-startboard-header .fxs-startboard-actions,.fxs-startboard-header .fxs-startboard-migration{height:40px;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-startboard-header .fxs-startboard-fileUpload-overlay{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;display:block;cursor:pointer}.fxs-startboard-header .fxs-startboard-item-focused{outline:#00bcf2 dashed 1px}.fxs-startboard-header ::-webkit-file-upload-button{cursor:pointer}.fxs-startboard-layout{padding:25px 40px;overflow:auto;-webkit-flex:1 1 auto;flex:1 1 auto}.fxs-startboard-layout .fxs-flowlayout-childcontainer{padding-bottom:25px;padding-right:25px}.fxs-startboard-dropdown{-webkit-flex:0 1 auto;flex:0 1 auto;min-width:32px;max-width:560px}.fxs-startboard-button{-webkit-flex:0 0 auto;flex:0 0 auto;border:0;margin:0 5px;padding:4px 5px;height:20px;background-color:transparent;box-sizing:content-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;min-width:0}.fxs-startboard-button:not([aria-disabled]):hover{cursor:pointer}.fxs-startboard-button .fxs-startboard-button-text{margin-left:5px}.fxs-startboard-button .fxs-startboard-button-icon{height:16px;width:16px}.fxs-startboard-button:hover,.fxs-startboard-dropdown:hover{background:rgba(255,255,255,.15)}.fxs-startboard-button-browse{padding:0!important}.fxs-startboard-dropdown>.fxs-dropmenu,.fxs-startboard-dropdown>.fxs-dropmenu .fxs-dropmenu-button{width:100%}.fxs-startboard-dropdown .fxs-dropmenu-content{overflow-x:hidden;overflow-y:auto;min-width:400px;max-width:560px;min-height:35px;max-height:480px}.fxs-startboard-item-container{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;min-width:0}.fxs-startboard-dropdown .fxs-dropmenu-list-system .fxs-startboard-dropdown-item{padding:7px 25px 8px}.fxs-startboard-dropdown-item+.fxs-startboard-dropdown-item::before{content:"";position:absolute;top:0;width:calc(100% - 50px);border-top-width:1px;border-top-style:solid;border-color:rgba(125,125,125,.5)}.fxs-startboard-item-title{-webkit-flex:1 1 auto;flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-startboard-item-icon{-webkit-flex:0 0 auto;flex:0 0 auto;height:14px;width:14px;padding-right:5px}.fxs-startboard-dropdown-item{position:relative;height:35px;box-sizing:border-box;cursor:pointer}.fxs-startboard-dropdown-item.fxs-startboard-dropdown-browseall{height:auto;cursor:default}.fxs-startboard-dropdown-subscriptions{white-space:normal}.fxs-startboard-actions,.fxs-startboard-dropdown,.fxs-startboard-header:not(.fxs-startboard-header-normal) .fxs-startboard-title-edit,.fxs-startboard-migration{display:none}.fxs-startboard-header-normal .fxs-startboard-actions,.fxs-startboard-header-normal .fxs-startboard-dropdown{display:-webkit-flex;display:flex}.fxs-startboard-header-migration .fxs-startboard-actions,.fxs-startboard-header-migration .fxs-startboard-dropdown,.fxs-startboard-header-normal .fxs-startboard-migration,.fxs-startboard-header-normal .fxs-startboard-title-next{display:none}.fxs-startboard-header-migration .fxs-startboard-migration{display:-webkit-flex;display:flex}.fxs-startboard-header-migration .fxs-startboard-title-next{display:block}.fxs-startboard-message-container{padding:55px 40px}.fxs-startboard-message-title{font-size:32px;margin-bottom:20px}.fxs-startboard-message-body{font-size:17px}.fxs-startboard-notfound .fxs-startboard-button{display:none}.fxs-startboard-notfound .fxs-startboard-button-delete,.fxs-startboard-notfound .fxs-startboard-button-new{display:-webkit-flex;display:flex}.fxs-topbar-dashboard-changed .fxs-startboard-header-item{display:none}.fxs-topbar-dashboard-changed .fxs-startboard-title-next{display:block}.fxs-startboard-loadanimation{display:none;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;position:absolute;height:100%;width:100%}.fxs-startboard-loading .fxs-startboard-loadanimation{display:-webkit-flex;display:flex}.fxs-startboard-loading .fxs-startboard-layout,.fxs-startboard-loading .fxs-startboard-message-container{visibility:hidden}.fxs-startboard-loading .fxs-startboard-header-item{display:none}.fxs-startboard-loading .fxs-startboard-title-next{display:block}.fxs-startboard-loading .fxs-startboard-layout .fxs-tile .fxs-part-content{display:none}@media all and (max-width:1300px){.fxs-startboard-button-text{display:none}}.fxs-portal-fullscreen .fxs-sidebar,.fxs-portal-fullscreen .fxs-topbar{display:none!important}.fxs-portal-fullscreen .fxs-portal-main{height:100%}.fxs-portal-fullscreen .fxs-startboard-button{display:none}.fxs-portal-fullscreen .fxs-startboard-button-fullscreen{display:-webkit-flex;display:flex}.fxs-portal-fullscreen .fxs-tile::after{content:"";display:block;position:absolute;top:0;bottom:0;left:0;right:0}.fxs-portal-fullscreen .fxs-tile-actionbar{display:none}')})
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-tile-progress-transparent{height:12px;position:absolute;top:0;z-index:195;overflow:hidden}.fxs-tile-progress-transparent>div{margin-left:6px}.fxs-tile-progress-transparent>div::after{height:4px;width:4px;background:#000}.fxs-tile{height:175px;width:175px;position:relative;box-shadow:none}.fxs-tile .fxs-tile-actionbar{z-index:196}.fxs-tile .fxs-tile-container{width:100%;height:100%}.fxs-tile.fxs-tilesize-mini{height:85px;width:85px}.fxs-tile.fxs-tilesize-small{height:85px;width:175px}.fxs-tile.fxs-tilesize-tall{height:355px;width:175px}.fxs-tile.fxs-tilesize-wide{height:175px;width:355px}.fxs-tile.fxs-tilesize-normal{height:175px;width:175px}.fxs-tile.fxs-tilesize-large{height:355px;width:355px}.fxs-tile.fxs-tilesize-herotall{height:535px;width:355px}.fxs-tile.fxs-tilesize-herowide{height:355px;width:535px}.fxs-tile.fxs-tilesize-hero{height:535px;width:535px}.fxs-tile.fxs-tilesize-herowidefitheight{height:auto;width:535px}.fxs-tile.fxs-tilesize-fullwidthfitheight{height:auto;width:100%}.fxs-tile.fxs-tilesize-fullwidthfitheight .fxs-part,.fxs-tile.fxs-tilesize-fullwidthfitheight .fxs-part-content{height:auto}.fxs-tile.fxs-tilesize-fullwidthfitheight,.fxs-tile.fxs-tilesize-herowidefitheight{margin-bottom:5px}.fxs-tile.fxs-tilesize-fullwidthfitheight:last-child,.fxs-tile.fxs-tilesize-herowidefitheight:last-child{margin-bottom:0}.fxs-tile.fxs-tilesize-fittocontainer{height:100%;width:100%}.fxs-tile.fxs-tilesize-fittocontainer>.fxs-part{overflow:auto}.fxs-tile div.fxs-tile-overlay{display:none;position:absolute;width:100%;top:0;bottom:0;cursor:pointer}.fxs-blade-content-container .fxs-bladecontent-unlocked .fxs-tile{box-shadow:0 2px 2px rgba(0,0,0,.25)}.fxs-blade-content-container .fxs-bladestyle-context .fxs-tile,.fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile,.fxs-blade-content-container .fxs-bladestyle-create .fxs-tile,.fxs-blade-content-container .fxs-bladestyle-help .fxs-tile{box-shadow:none}")})
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-tile-actionbar-actionlist{display:-webkit-flex;display:flex;-webkit-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-justify-content:flex-end;justify-content:flex-end}.fxs-tile-actionbar-actionlist:empty{display:none}.fxs-tile-actionbar-action{-webkit-flex:0 0 auto;flex:0 0 auto;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;box-sizing:border-box;height:25px;width:25px;padding:6px;background-color:transparent;cursor:pointer;border:0;transition:background .1s ease-out}.fxs-tile-actionbar-action>svg{height:13px;width:13px}.fxs-tile .fxs-tile-actionbar{position:absolute;top:-25px;width:100%;opacity:0;transition:opacity .1s;cursor:default}.fxs-tile.ui-draggable .fxs-tile-actionbar{cursor:move}.fxs-tile.fxs-tile-selected .fxs-tile-actionbar,.fxs-tile.fxs-tile-selectedfromhover .fxs-tile-actionbar{opacity:1}")})
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-toast-description,.fxs-toast-time,.fxs-toast-title{overflow:hidden;text-overflow:ellipsis}.fxs-nps .fxs-nps-commentstitle,.fxs-nps .fxs-nps-link-survey,.fxs-nps .fxs-nps-submit,.fxs-toast-title.fxs-toast-link:hover{text-decoration:underline}.fxs-toast{position:fixed;top:55px;right:20px;width:355px;list-style-type:none;margin:0}.fxs-toast-header,.fxs-toast-item{display:-webkit-flex;margin-bottom:5px}.fxs-toast-content,.fxs-toast-wrapper{-webkit-flex:1 1 auto;flex:1 1 auto;padding:10px}.fxs-toast-item{display:flex;position:relative}.fxs-toast-header{display:flex;-webkit-align-items:center;align-items:center;padding-top:5px}.fxs-toast-icon svg{height:14px;width:14px}.fxs-toast-title{-webkit-flex:1 1 auto;flex:1 1 auto;margin-left:10px;max-width:254px;white-space:nowrap}.fxs-toast-time{white-space:nowrap;max-width:60px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-toast-close{position:absolute;top:0;right:0;background:0 0;border:none;padding:5px;cursor:pointer}.fxs-toast-close svg{height:12px;width:12px}.fxs-toast-description{font-size:12px;line-height:18px;width:335px}.fxs-toast-progressbar{margin-top:10px;max-height:5px}.fxs-nps .fxs-nps-title{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;margin-bottom:7px}.fxs-nps .fxs-nps-score{display:-webkit-flex;display:flex}.fxs-nps .fxs-nps-score span{-webkit-flex:1 1 auto;flex:1 1 auto;border:1px solid #c5cbd1;text-align:center;height:23px;line-height:23px;font-size:11px;margin-right:6px;display:inline-block;cursor:pointer}.fxs-nps .fxs-nps-score span.fxs-nps-score-selected,.fxs-nps .fxs-nps-score span:hover{background:#00bcf2;border-color:#00bcf2}.fxs-nps .fxs-nps-score span:last-child{margin-right:0}.fxs-nps .fxs-nps-help{color:#758393;display:flex;margin-bottom:10px;font-size:12px;width:335px}.fxs-nps .fxs-nps-help span:last-child{margin-left:auto}.fxs-nps .fxs-nps-survey{font-size:12px}.fxs-nps .fxs-nps-comments{margin-top:6px;margin-bottom:18px;width:319px;border:1px solid #c5cbd1;height:100px;padding:7px}.fxs-nps .fxs-nps-checkbox{margin:10px 5px 0 10px;padding:0;vertical-align:bottom;width:14px;height:14px}.fxs-nps .fxs-nps-button-holder{border-top:1px solid #dcdfe2;margin-left:-10px}.fxs-nps .fxs-nps-submit{margin:15px 10px 5px;background-color:#00bcf2;border-color:#00bcf2;color:#fff}')})
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-topbar-devmode .fxs-trim-hover:hover,.fxs-topbar-exitdevmode.fxs-trim-hover:hover,.fxs-topbar-reportbug.fxs-trim-hover:hover{background-color:#fff0d1!important}.fxs-topbar{height:40px;position:relative;z-index:250;-webkit-flex:0 0 auto;flex:0 0 auto;font-size:13px}.fxs-topbar .fxs-topbar-journey-icon{border:none}.fxs-topbar .fxs-topbar-journey-icon svg{height:16px;width:16px;margin-top:4px}.fxs-topbar-content{width:100%;height:100%;position:absolute;top:0;display:-webkit-flex;display:flex;-webkit-align-content:center;align-content:center;-webkit-align-items:center;align-items:center}.fxs-topbar-internal{height:40px;min-width:85px;max-width:225px;box-sizing:border-box;padding:0 12px;line-height:40px;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-topbar-exitdevmode,.fxs-topbar-reportbug{display:-webkit-flex;display:flex;height:40px;width:auto;-webkit-flex:0 0 auto;flex:0 0 auto;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;padding:0 2px}.fxs-topbar-home{-webkit-flex:0 0 auto;flex:0 0 auto;font-size:20px;padding:0 7px;margin-left:13px;height:100%;line-height:40px}.fxs-topbar-button{display:-webkit-flex;display:flex;height:40px;width:40px;-webkit-flex:0 0 auto;flex:0 0 auto;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;border-right:1px solid rgba(128,128,128,.4)}.fxs-topbar-button svg{height:20px;width:20px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-desktop-organize .fxs-topbar-exit-customize{visibility:visible;top:0}.fxs-topbar-dashboard-message,.fxs-topbar-exit-customize-message{font-size:14px}.fxs-topbar-dashboard .fxs-button,.fxs-topbar-exit-customize-button{-webkit-flex:0 0 auto;flex:0 0 auto;margin-left:10px}.fxs-topbar-dashboard-view{display:none}.fxs-show-journey .fxs-topbar-dashboard-view{display:block}.fxs-show-journey .fxs-topbar-dashboard-discard,.fxs-show-journey .fxs-topbar-dashboard-save{display:none}.fxs-topbar-notifications{position:relative}.fxs-topbar-dashboard,.fxs-topbar-exit-customize{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;-webkit-flex:1 1 auto;flex:1 1 auto;position:absolute;top:-40px;z-index:250;visibility:hidden;width:100%;height:100%;transition:top .3s ease .1ms}.fxs-topbar-dashboard-changed .fxs-topbar-dashboard{top:0;visibility:visible}.fxs-topbar-console,.fxs-topbar-dashboard-changed .fxs-topbar-exit-customize{display:none}.fxs-topbar-placeholder{-webkit-flex:1 1 auto;flex:1 1 auto}")})
);define("MsPortalImpl/Widgets/Widgets.WidgetBase",["require","exports","i","o","a","ko","$","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],
(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var u=(function(){function n(){this.disabled=f.observable(!1)}return n})(),t;n.ViewModel=u;t=(function(){function n(t,r){var u=this,f;if(!t||t.length===0)throw new Error("You must specify an element to associate a widget to it. Your element is either null or an empty collection.");this.options=r;f=this._ltm=new i.TriggerableLifetimeManager;this.element=e(t[0]);f.registerForDispose(t.setEvents([n.widgetRemoveEvent,function(n){n.target!==t[0]||u._disposeTriggered||(u._disposeTriggered=!0,u.dispose())}]));t.data(n._widgetTypesDataKey)||t.data(n._widgetTypesDataKey,[]);t.data(n._widgetTypesDataKey).push(this)}return n.prototype.setFocus=function(){},n.prototype.dispose=function(){this._ltm&&(this._ltm.dispose(),this._ltm=null);var i=this.element,t=i.data(n._widgetTypesDataKey);t&&(t.splice(t.indexOf(this),1),t.length===0&&i.removeData(n._widgetTypesDataKey))},r.defineProperty(n.prototype,"ltm",{get:function(){return this._ltm},enumerable:
!0,configurable:!0}),n.getWidget=function(t,i){var r=n.getWidgets(t,i);return r?r[0]||null:null},n.getWidgets=function(t,i){var r=t.data(n._widgetTypesDataKey)||[];return i?r.filter((function(n){return n instanceof i})):r},n.prototype.trigger=function(n,t,i){var u=this.options[n],r=this.element;return i=i||{},t=t||e.Event(n),t.type=n,t.target=r[0],r.trigger(t,i),!(e.isFunction(u)&&u.apply(r[0],[t].concat(i))===!1||t.isDefaultPrevented())},n.prototype.getTelemetrySource=function(){return null},n.prototype._bindDescendants=function(n){var t={data:this.options,func:this},i=n?e.extend(null,t,n):t;f.applyBindingsToDescendants(i,this.element[0])},n.prototype._cleanDescendants=function(){f.utils.cleanDescendantNodes(this.element)},n.prototype._cleanElement=function(){for(var i,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._cleanDescendants();i=this.element;t.length>0&&i.removeClass(t.join(" "));i.empty()},n.prototype._isRtl=function(){return e("html:first").attr("dir")==="rtl"},n})();t.
widgetRemoveEvent=o.default.remove+".fxWidget";t._widgetTypesDataKey="fxWidgetTypes";n.Widget=t})(s||(s={})),s}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-portal .fxs-tile .fxs-part-error-devmode{background-color:#b00000!important;color:#fff}.fxs-part-error{background-color:#f4f5f6}.fxs-part .fxs-part-content.fxs-errorpart-clickable{cursor:pointer}.fxs-part-error-content{display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap;height:100%;box-sizing:border-box}.fxs-part-error-content .fxs-part-error-title{font-size:14px;line-height:normal;margin:0}.fxs-part-error-content .fxs-part-error-reason{font-size:12px;line-height:normal}.fxs-part .fxs-part-content.fxs-errorpart~.fxs-part-nodatamessage{display:none!important}.fxs-part-error-icon{-webkit-flex:0 0 auto;flex:0 0 auto;margin:auto;display:block;height:50px;width:50px}.fxs-part-error-subtitle{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;line-height:normal;text-transform:uppercase}.fxs-tilesize-fullwidthfitheight .fxs-part .fxs-part-content.fxs-errorpart,.fxs-tilesize-herowidefitheight .fxs-part .fxs-part-content.fxs-errorpart{position:relative}.fxs-tilesize-fullwidthfitheight .fxs-part-error-content,.fxs-tilesize-herowidefitheight .fxs-part-error-content{position:static}.fxs-tilesize-mini .fxs-part-error-icon,.fxs-tilesize-small .fxs-part-error-icon{display:none}.fxs-tilesize-mini .fxs-part-error-text{order:1}.fxs-tilesize-mini .fxs-part-error-reason,.fxs-tilesize-mini .fxs-part-error-text{text-align:center}.fxs-tilesize-small .fxs-part-error-reason{margin-top:auto}html[lang^=ja] .fxs-part-error-subtitle,html[lang^=ko] .fxs-part-error-subtitle,html[lang^=zh] .fxs-part-error-subtitle{font-size:11px}')})
);define("_generated/Templates/PartError",["require","exports"],(function(){"use strict";return function(){return"<div class='fxs-part-error-content'> <div class='fxs-part-error-text'> <h3 class='fxs-part-error-title' data-bind='visible: data.title, text: data.title'><\/h3> <div class='fxs-part-error-subtitle fxs-portal-title' data-bind='visible: data.subtitle, text: data.subtitle'><\/div> <\/div> <img class='fxs-part-error-icon' data-bind='attr: { src: data.uri.icon, title: data.title, alt: data.title}'/> <div class='fxs-part-error-reason' data-bind=\"text: data.reason\"><\/div> <\/div> "}}));define("MsPortalImpl/Widgets/Widgets.PartError",["require","exports","f","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/PartError","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var c=MsPortalImpl.Resources.Images,l=window,
s="fxs-errorpart",a="fxs-errorpart-clickable",t=u.PartError,v=(function(n){function i(){var i=n!==null&&n.apply(this,arguments)||this;return i.uri=c.getPartError(),i.title=r.observable(l.fx.environment.isDevelopmentMode?t.titleDevMode:t.title),i.subtitle=r.observable(t.subtitle),i.reason=r.observable(""),i.clickable=!0,i}return __extends(i,n),i})(f.ViewModel),h;n.ViewModel=v;h=(function(n){function t(t,r){var u=n.call(this,t,r)||this,f,h;if(t.html(e()).addClass(s),r.clickable){f=function(){t.trigger(o.default.fxerrorpartclicked)};t.addClass(a).on(o.default.click,f);u.ltm.registerForDispose((function(){t.off(o.default.click,f)}))}return u._bindDescendants(),h=i.getUniqueId(),t.findByClassName("fxs-part-error-title").attr("aria-describedby",h),t.findByClassName("fxs-part-error-subtitle").attr("id",h),u}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(s);n.prototype.dispose.call(this)},t})(f.Widget);n.Widget=h})(s||(s={})),s}));define("_generated/Less/MsPortalImpl/CustomForm.css",
["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.msportalfx-form .azc-checkBoxField-inlineLabelContainer label,.msportalfx-form .azc-form-labelcontainer label,.msportalfx-form .msportalfx-form-labelcontainer label{font-size:12px;line-height:normal}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-elementContainer{display:inline-block;vertical-align:middle;width:66%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:80px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-labelcontainer{width:32%;display:inline-block}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular .msportalfx-form-extralabel{display:block;width:66%;margin-left:33%;margin-right:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:nth-child(odd),.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:nth-child(odd){margin-right:1%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement{min-height:43px;width:48.75%!important;display:inline-block;vertical-align:top;margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:last-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:last-child{margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-multiLineTextField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-optionsGroupField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-multiLineTextField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-optionsGroupField{height:auto;margin-right:1px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:100px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-labelcontainer{display:block;margin-bottom:0;width:auto;min-height:20px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-elementContainer{display:block;width:100%;margin-left:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-extralabel>.msportalfx-form-extralabel{display:inline-block;width:47.75%;margin:43px 1% 0 -49.75%!important}.msportalfx-form.msportalfx-form-custom .msportalfx-form-extralabel{margin-top:0}.fxs-bladestyle-create .msportalfx-form{margin-top:14px}.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement{padding-bottom:15px;width:100%;min-height:23px}.msportalfx-form:not(.msportalfx-form-custom) .fxc-has-sublabel:not(.fxc-right-sublabel),.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement .msportalfx-form-formelement{padding-bottom:0}.msportalfx-form:not(.msportalfx-form-custom) .fxc-has-sublabel:not(.fxc-right-sublabel) .azc-validation-messages{padding-bottom:15px}.msportalfx-form.msportalfx-vertical-compact .fxc-section>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact>div>.msportalfx-form-formelement{padding-bottom:7px}.msportalfx-form .azc-checkBoxField-inlineLabelContainer,.msportalfx-form .azc-form-labelcontainer,.msportalfx-form .msportalfx-form-labelcontainer{box-sizing:border-box;min-height:20px}.msportalfx-form .azc-checkBoxField-inlineLabelContainer label,.msportalfx-form .azc-form-labelcontainer label,.msportalfx-form .msportalfx-form-labelcontainer label{max-width:calc(100% - 25px)}.msportalfx-form:not(.msportalfx-selectable) .azc-checkBoxField-inlineLabelContainer label,.msportalfx-form:not(.msportalfx-selectable) .azc-form-labelcontainer label,.msportalfx-form:not(.msportalfx-selectable) .msportalfx-form-labelcontainer label{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.msportalfx-form .azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px)}.msportalfx-form .azc-validatableControl-invalid+.azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px - 6px)}.msportalfx-form.msportalfx-form-row{padding:0 25px;width:calc(100% - 50px)}.msportalfx-form .azc-multiLineTextField .azc-multiLineTextBox{height:100%}.azc-text-sublabel{float:right;margin-bottom:-1px}.azc-formElementSubLabelContainer::after{content:"";display:table;clear:both}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor{padding-bottom:16px}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-form-labelcontainer{padding-bottom:calc(19px)}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-checkBoxField-inlineLabelContainer{padding-bottom:0}.azc-required-balloon{display:inline-block}.msportalfx-form-extralabel{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:right;margin-top:-15px;padding-bottom:3px}.msportalfx-customHtml .msportalfx-form-extralabel{margin-top:0}')})
);define("_generated/Less/MsPortalImpl/CustomPart.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.azc-graph-node-container .msportalfx-overflowY,.fxs-tilesize-fittocontainer .msportalfx-overflowY,.msportalfx-docking-body{overflow-x:hidden;overflow-y:auto}.msportalfx-layoutChildren-horizontal-inlineblock{white-space:nowrap;line-height:0;font-size:0}.msportalfx-layoutChildren-horizontal-inlineblock>.msportalfx-layoutChildren-child{display:inline-block;box-sizing:border-box;white-space:normal;font-size:12px;line-height:18px;line-height:normal}.msportalfx-clearfix::after,.msportalfx-layoutChildren-horizontal-float::after{content:"\\0000a0";clear:both;visibility:hidden;font-size:0;line-height:0}.msportalfx-layoutChildren-horizontal-float>.msportalfx-layoutChildren-child{float:left;box-sizing:border-box}.msportalfx-layoutChildren-horizontal-float::after{display:block;height:0}.msportalfx-docking,.msportalfx-fill{height:100%;width:100%}.msportalfx-bgcolor-themeMain{background-color:#00bcf2}.msportalfx-bgcolor-themeWarning{background-color:#ff8c00}.msportalfx-bgcolor-themeError{background-color:#e81123}.msportalfx-bgcolor-themeSuccess{background-color:#7fba00}.msportalfx-bgcolor-paletteDiffAdd{background-color:#c7f1c7}.msportalfx-bgcolor-paletteDiffDel{background-color:#fcd6f1}.msportalfx-bgcolor-white{background-color:#fff}.msportalfx-padding{padding:25px;box-sizing:border-box}.msportalfx-docking{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column}.msportalfx-docking-header{-webkit-flex:0 0 auto;flex:0 0 auto}.msportalfx-docking-body{-webkit-flex:1 1 100%;flex:1 1 100%;min-height:0}.msportalfx-docking-footer{-webkit-flex:0 0 auto;flex:0 0 auto;border-top:1px solid}.msportalfx-vertical-center{display:-webkit-flex;display:flex;-webkit-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-align-items:center;align-items:center}.msportalfx-removeTableBorders{border-spacing:0;border-collapse:collapse}.msportalfx-boxsizing-borderbox{box-sizing:border-box}.msportalfx-removeDefaultListStyle{list-style-type:none;padding:0;margin:0}.msportalfx-removeDefaultListStyle>li{margin:0;padding:0}.msportalfx-clearfix::after{display:block;height:0}.msportalfx-unselectable{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.msportalfx-removepartpadding{height:calc(100% + 15px + 15px);width:calc(100% + 15px + 15px);margin:-15px}.msportalfx-removepartpaddingside{width:calc(100% + 15px + 15px);margin:0 -15px}.fxs-blade-locked .msportalfx-removepartpadding{height:calc(100% + 15px);width:100%;margin:0 0 15px}.fxs-blade-locked .msportalfx-removepartpaddingside{width:100%;margin:0}.fxs-blade-locked .fxs-tilesize-fittocontainer .msportalfx-removepartpadding{height:100%;width:100%;margin:0}.msportalfx-partdivider:after{content:"";display:block;width:calc(100% + 15px + 15px);margin:0 -15px;border-bottom-width:1px;border-bottom-style:solid}.msportalfx-text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-font-regular{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_normal,"Segoe WP",Tahoma,Arial,sans-serif;font-weight:400}.msportalfx-font-bold{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700}.msportalfx-font-semibold{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.msportalfx-font-light,.msportalfx-font-semilight{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_light,"Segoe UI Light","Segoe WP Light","Segoe WP",Tahoma,Arial,sans-serif;font-weight:200}.msportalfx-font-monospace{font-family:Consolas,"Courier New",monospace;font-size:12px}.msportalfx-text-preview,.msportalfx-text-subheader{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;text-transform:uppercase}.msportalfx-text-header{font-size:14px;line-height:18px}a.msportalfx-text-header{cursor:pointer}.msportalfx-text-header-small,.msportalfx-text-label{font-size:12px;line-height:normal;text-transform:uppercase}.msportalfx-text-small{font-size:12px;line-height:normal}.msportalfx-text-subheader{font-size:10px;line-height:10px}html[lang^=ja] .msportalfx-text-subheader,html[lang^=ko] .msportalfx-text-subheader,html[lang^=zh] .msportalfx-text-subheader{font-size:11px;line-height:11px}.msportalfx-text-header-regular{font-size:14px;line-height:18px}.msportalfx-text-regular{font-size:12px;line-height:18px}.msportalfx-text-preview{font-size:11px;line-height:11px;color:#fff}.msportalfx-text-createsectionheader{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_light,"Segoe UI Light","Segoe WP Light","Segoe WP",Tahoma,Arial,sans-serif;font-weight:200;font-size:20px;line-height:normal}.msportalfx-number-jumbo,.msportalfx-number-large,.msportalfx-number-medium,.msportalfx-number-small{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.msportalfx-number-jumbo{font-size:60px;line-height:60px;letter-spacing:-.02em}.msportalfx-number-large{font-size:43px;line-height:43px;letter-spacing:-.02em}.msportalfx-number-medium{font-size:30px;line-height:30px;letter-spacing:-.025em}.msportalfx-number-small{font-size:17px;line-height:17px;letter-spacing:-.02em}.msportalfx-number-jumbo-adorn,.msportalfx-number-large-adorn,.msportalfx-number-medium-adorn,.msportalfx-number-small-adorn{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-number-jumbo-adorn{font-weight:700;font-size:20px;line-height:20px;letter-spacing:-.02em}.msportalfx-number-large-adorn,.msportalfx-number-medium-adorn{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em}.msportalfx-number-small-adorn{font-weight:700;font-size:10px;line-height:10px;letter-spacing:-.05em}.msportalfx-code{font-family:Consolas,"Courier New",monospace;font-size:12px;background-color:#f1f1f8;color:#32383f;border:1px solid #dcdfe2;border-left:5px solid #dcdfe2;padding:10px 10px 10px 15px;margin:5px 0;overflow-x:auto}.msportalfx-lineheight-reset{line-height:normal}.msportalfx-gettingstarted-part{color:#fff}.msportalfx-refresh-icon img,.msportalfx-refresh-icon svg{height:12px;width:12px;vertical-align:baseline}.msportalfx-tile-status-icon img,.msportalfx-tile-status-icon svg{height:16px;width:16px;vertical-align:middle}.msportalfx-gridcolumn-asseticon img,.msportalfx-gridcolumn-asseticon svg{margin-top:4px;height:21px;width:21px}.msportalfx-gridcolumn-assetsvg-icon .fx-grid-formatters-svgicon{width:21px!important;height:21px!important}.msportalfx-gridcolumn-assetsvg-badge,.msportalfx-gridcolumn-assetsvg-icon img,.msportalfx-gridcolumn-assetsvg-icon svg{height:21px;width:21px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-badge{margin-left:-21px;display:inline-block}.msportalfx-gridcolumn-assetsvg-badge img,.msportalfx-gridcolumn-assetsvg-badge svg{height:10px;width:10px;margin-top:11px}.msportalfx-gridcolumn-assetsvg-text{margin-left:10px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-textbox{vertical-align:middle;display:inline-block;margin-left:20px}.msportalfx-gridcolumn-assetsvg-strongtext{vertical-align:middle;margin-left:0}.msportalfx-gridcolumn-assetsvg-linkicon{margin-left:10px;display:inline-block;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon{display:inline-block}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon img,.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon svg{opacity:.4;height:10px;width:10px;vertical-align:middle}.msportalfx-iconcontainer{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.msportalfx-iconcontainer>img,.msportalfx-iconcontainer>svg{height:50px;width:50px}.fxs-tilesize-mini .msportalfx-iconcontainer>img,.fxs-tilesize-mini .msportalfx-iconcontainer>svg,.fxs-tilesize-small .msportalfx-iconcontainer>img,.fxs-tilesize-small .msportalfx-iconcontainer>svg{height:30px;width:30px}.msportalfx-gridcolumn-statusicon{text-align:center}.msportalfx-gridcolumn-statusicon img,.msportalfx-gridcolumn-statusicon svg{text-align:center;height:15px;width:15px}.msportalfx-gridcolumn-statusicon svg{margin-top:4px}.msportalfx-grid-borderless .azc-grid table tbody tr td,.msportalfx-grid-borderless .azc-grid table tbody tr.azc-grid-row:first-of-type td,.msportalfx-grid-borderless .azc-grid table tbody:last-child tr:last-child td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-br-muted{border-top-width:0;border-bottom-width:0;border-color:transparent!important}.msportalfx-customtopo-text-name-donotuse{font-size:12px;line-height:normal}.msportalfx-customtopo-text-description-donotuse{font-size:10px;line-height:normal;color:#8f9ca8}.msportalfx-inherit-color{color:inherit!important}.msportalfx-statuspart{position:relative;height:100%;width:100%}.msportalfx-statuspart>*{box-sizing:border-box}.msportalfx-statuspart .msportalfx-statuspart-statussection{height:calc(100% - 55px);padding-top:10px}.msportalfx-statuspart .msportalfx-statuspart-statussection>*{vertical-align:middle}.msportalfx-statuspart .msportalfx-statuspart-statussection>img{height:30px;width:30px}.msportalfx-statuspart .msportalfx-statuspart-statussection>span{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700;font-size:11px;text-transform:uppercase;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-messagesection{position:absolute;bottom:55px;margin-bottom:25px;height:40px;line-height:0;white-space:normal}.msportalfx-statuspart .msportalfx-statuspart-messagesection>span{font-size:12px;line-height:18px}.msportalfx-statuspart .msportalfx-statuspart-metricsection,.msportalfx-statuspart .msportalfx-statuspart-propertysection{position:absolute;bottom:0;width:100%;height:55px}.msportalfx-statuspart .msportalfx-statuspart-propertysection{padding-top:5px;font-size:12px;line-height:18px}.msportalfx-statuspart .msportalfx-statuspart-propertysection>div,.msportalfx-statuspart .msportalfx-statuspart-propertysection>span{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div{float:left;width:calc(100% / 3 - 3px);box-sizing:border-box;border-right:1px solid #8f9ca8;padding-left:7px}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:first-child{padding-left:0}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:last-child{border-right:none}.msportalfx-statuspart .msportalfx-statuspart-metricsection .msportalfx-statuspart-metrictitle{white-space:normal;height:30px;font-size:12px;line-height:normal;text-transform:uppercase}.msportalfx-bgcolor-a1{background-color:#fcd116;color:#000}.msportalfx-bgcolor-b1{background-color:#eb3c00;color:#fff}.msportalfx-bgcolor-c1{background-color:#ba141a;color:#fff}.msportalfx-bgcolor-d1{background-color:#b4009e;color:#fff}.msportalfx-bgcolor-e1{background-color:#442359;color:#fff}.msportalfx-bgcolor-f1{background-color:#002050;color:#fff}.msportalfx-bgcolor-g1{background-color:#0072c6;color:#fff}.msportalfx-bgcolor-h1{background-color:#008272;color:#fff}.msportalfx-bgcolor-i1{background-color:#007233;color:#fff}.msportalfx-bgcolor-j1{background-color:#7fba00;color:#fff}.msportalfx-bgcolor-k1{background-color:#a0a5a8;color:#fff}.msportalfx-bgcolor-a0{background-color:#fff100;color:#000}.msportalfx-bgcolor-b0{background-color:#ff8c00;color:#fff}.msportalfx-bgcolor-c0{background-color:#e81123;color:#fff}.msportalfx-bgcolor-d0{background-color:#ec008c;color:#fff}.msportalfx-bgcolor-e0{background-color:#68217a;color:#fff}.msportalfx-bgcolor-f0{background-color:#00188f;color:#fff}.msportalfx-bgcolor-g0{background-color:#00bcf2;color:#fff}.msportalfx-bgcolor-h0{background-color:#00b294;color:#fff}.msportalfx-bgcolor-i0{background-color:#009e49;color:#fff}.msportalfx-bgcolor-j0{background-color:#bad80a;color:#000}.msportalfx-bgcolor-k0{background-color:#bbc2ca;color:#000}.msportalfx-bgcolor-a2{background-color:#fffc9e;color:#000}.msportalfx-bgcolor-b2{background-color:#ffb900;color:#000}.msportalfx-bgcolor-c2{background-color:#dd5900;color:#fff}.msportalfx-bgcolor-d2{background-color:#f472d0;color:#fff}.msportalfx-bgcolor-e2{background-color:#9b4f96;color:#fff}.msportalfx-bgcolor-f2{background-color:#4668c5;color:#fff}.msportalfx-bgcolor-g2{background-color:#6dc2e9;color:#000}.msportalfx-bgcolor-h2{background-color:#00d8cc;color:#000}.msportalfx-bgcolor-i2{background-color:#55d455;color:#000}.msportalfx-bgcolor-j2{background-color:#e2e584;color:#000}.msportalfx-bgcolor-k2{background-color:#d6d7d8;color:#000}.msportalfx-bgcolor-a0s2{background-color:#807900;color:#fff}.msportalfx-bgcolor-b0s2{background-color:#804600;color:#fff}.msportalfx-bgcolor-c0s2{background-color:#740912;color:#fff}.msportalfx-bgcolor-d0s2{background-color:#760046;color:#fff}.msportalfx-bgcolor-e0s2{background-color:#34113d;color:#fff}.msportalfx-bgcolor-f0s2{background-color:#000c48;color:#fff}.msportalfx-bgcolor-g0s2{background-color:#005e79;color:#fff}.msportalfx-bgcolor-h0s2{background-color:#084c41;color:#fff}.msportalfx-bgcolor-i0s2{background-color:#063d20;color:#fff}.msportalfx-bgcolor-j0s2{background-color:#3d460a;color:#fff}.msportalfx-bgcolor-k0s2{background-color:#32383f;color:#fff}.msportalfx-bgcolor-a0s1{background-color:#bfb500;color:#000}.msportalfx-bgcolor-b0s1{background-color:#bf6900;color:#fff}.msportalfx-bgcolor-c0s1{background-color:#ae0d1a;color:#fff}.msportalfx-bgcolor-d0s1{background-color:#b10069;color:#fff}.msportalfx-bgcolor-e0s1{background-color:#4e195c;color:#fff}.msportalfx-bgcolor-f0s1{background-color:#00126b;color:#fff}.msportalfx-bgcolor-g0s1{background-color:#008db5;color:#fff}.msportalfx-bgcolor-h0s1{background-color:#00856f;color:#fff}.msportalfx-bgcolor-i0s1{background-color:#0f5b2f;color:#fff}.msportalfx-bgcolor-j0s1{background-color:#8ba208;color:#fff}.msportalfx-bgcolor-k0s1{background-color:#464f59;color:#fff}.msportalfx-bgcolor-a0t1{background-color:#fcf37e;color:#000}.msportalfx-bgcolor-b0t1{background-color:#ffba66;color:#000}.msportalfx-bgcolor-c0t1{background-color:#f1707b;color:#fff}.msportalfx-bgcolor-d0t1{background-color:#f466ba;color:#fff}.msportalfx-bgcolor-e0t1{background-color:#a47aaf;color:#fff}.msportalfx-bgcolor-f0t1{background-color:#6674bc;color:#fff}.msportalfx-bgcolor-g0t1{background-color:#66d7f7;color:#000}.msportalfx-bgcolor-h0t1{background-color:#66d1bf;color:#000}.msportalfx-bgcolor-i0t1{background-color:#66c592;color:#000}.msportalfx-bgcolor-j0t1{background-color:#d6e86c;color:#000}.msportalfx-bgcolor-k0t1{background-color:#8f9ca8;color:#fff}.msportalfx-bgcolor-a0t2{background-color:#fffccc;color:#000}.msportalfx-bgcolor-b0t2{background-color:#ffe8cc;color:#000}.msportalfx-bgcolor-c0t2{background-color:#facfd3;color:#000}.msportalfx-bgcolor-d0t2{background-color:#fbcce8;color:#000}.msportalfx-bgcolor-e0t2{background-color:#e1d3e4;color:#000}.msportalfx-bgcolor-f0t2{background-color:#ccd1e9;color:#000}.msportalfx-bgcolor-g0t2{background-color:#ccf2fc;color:#000}.msportalfx-bgcolor-h0t2{background-color:#ccf0ea;color:#000}.msportalfx-bgcolor-i0t2{background-color:#ccecdb;color:#000}.msportalfx-bgcolor-j0t2{background-color:#f0f7b2;color:#000}.msportalfx-bgcolor-k0t2{background-color:#63707e;color:#fff}.msportalfx-property{padding:5px 0;white-space:nowrap;line-height:0;font-size:0}.msportalfx-property>*{display:inline-block;vertical-align:middle;box-sizing:border-box;white-space:normal;font-size:medium;line-height:normal}.msportalfx-property .msportalfx-property-label-wrapper{font-size:12px;line-height:normal;width:32%;margin-top:5px}.msportalfx-property .msportalfx-property-label-wrapper .msportalfx-property-name{text-transform:uppercase;max-width:100%;width:auto;white-space:wrap;overflow:hidden;text-overflow:ellipsis;display:inline-block}.msportalfx-property .msportalfx-property-name{font-size:12px;line-height:normal;text-transform:uppercase;width:32%;white-space:wrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-property .msportalfx-property-value{font-size:14px;line-height:normal;width:64%;margin-left:3%;margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon,.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-tooltip-overflow{display:inline-block;vertical-align:middle}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon+.msportalfx-tooltip-overflow{max-width:calc(100% - 27px)}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield{margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield input{padding-left:9px}.msportalfx-property.msportalfx-property-compact>*{vertical-align:top}.msportalfx-property.msportalfx-property-compact .msportalfx-property-name{margin-top:4px;width:95px}.msportalfx-property.msportalfx-property-compact .msportalfx-property-value{font-size:12px;line-height:18px;max-width:calc(100% - 3% - 95px)}.msportalfx-property-callback-icon,.msportalfx-property-text-icon{width:27px}.msportalfx-property-callback-icon svg,.msportalfx-property-text-icon svg{height:25px;width:25px}.msportalfx-property-callback-icon{float:left}')})
);define("_generated/Less/MsPortalImpl/Parts/Parts.Part.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-part,.fxs-part .fxs-part-content,.fxs-part::after{width:100%;box-sizing:border-box}.fxs-part,.fxs-part-content{background-color:inherit}.fxs-part{height:100%;position:relative;overflow:hidden;padding:15px}.fxs-part.fxs-part-clickable:hover{cursor:pointer}.fxs-part.fxs-part-clickable:focus::after,.fxs-part.fxs-part-clickable:hover::after{opacity:1}.fxs-part::after{content:"";pointer-events:none;position:absolute;top:0;left:0;height:100%;border-width:2px;border-style:solid;opacity:0;transition:opacity .1s}.fxs-part .fxs-part-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.fxs-part .fxs-part-title{height:49px;position:relative;top:-4px;box-sizing:border-box}.fxs-part .fxs-part-title .fxs-part-assetname,.fxs-part .fxs-part-title .fxs-part-titleText{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part .fxs-part-title .fxs-part-titleText{font-size:14px;line-height:17px;padding-bottom:1px}.fxs-part .fxs-part-title .fxs-part-assetname{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;line-height:10px;text-transform:uppercase;margin-top:3px}.fxs-part .fxs-part-content{font-size:12px;line-height:18px;line-height:normal;position:relative;height:100%}.fxs-part.fxs-part-part-title-visible .fxs-part-content{height:calc(100% - 45px);top:-4px}.fxs-part .fxs-part-color-white{color:#fff}.fxs-part.fxs-part-is-v2{padding:0}.fxs-part.fxs-part-is-v2.fxs-part-part-title-visible .fxs-part-title{padding:15px 15px 0}.fxs-part.fxs-part-is-v2.fxs-part-part-title-visible .fxs-part-content>.msportalfx-padding:first-child{padding:0 15px 15px}.fxs-part.fxs-part-is-v2 .fxs-part-content>.msportalfx-padding{padding:15px}.fxs-part.fxs-part-is-v2.fxs-part-for-template-blade .fxs-part-content>.msportalfx-padding{padding:10px 25px 25px}.fxs-part.fxs-part-selected-command::after,.fxs-part.fxs-part-selected::after{border-width:3px;opacity:1}.fxs-tile-selected .fxs-part::after,.fxs-tile-selectedfromhover .fxs-part::after{border-width:2px;opacity:1}.fxs-part.fxs-part-nodata,.fxs-part.fxs-part-notfound{-webkit-filter:grayscale(100%);filter:grayscale(100%);min-height:85px}.fxs-part .fxs-part-noaccessmessage,.fxs-part .fxs-part-nodatamessage,.fxs-part .fxs-part-notfoundmessage{position:absolute;left:0;top:0;height:100%!important;width:100%;text-align:left;padding:15px;box-sizing:border-box;z-index:1}.fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-text,.fxs-part .fxs-part-nodatamessage>.fxs-part-nodatamessage-text,.fxs-part .fxs-part-notfoundmessage>.fxs-part-notfoundmessage-text{position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);margin-top:20px;padding:15px 10px;width:calc(100% - 30px);box-sizing:border-box;font-size:12px;line-height:18px;text-align:center;border-width:1px;border-style:solid}.fxs-tile.fxs-tilesize-mini .fxs-part,.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage{padding-left:3px;padding-right:3px}.fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-textsmall{display:none;position:absolute;bottom:0;margin-bottom:13px;font-size:12px;line-height:18px;text-align:left}.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-text,.fxs-tilesize-small .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-text{display:none}.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-textsmall,.fxs-tilesize-small .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-textsmall{display:block;bottom:0}.fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-text{display:none}.fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall{display:block}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall,.fxs-tile.fxs-tilesize-small .fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall{margin-bottom:7px}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall{top:0;bottom:auto;width:calc(94%);text-align:center}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-title{display:none!important}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-content{height:100%!important;top:0!important}.fxs-blade .fxs-blade-locked .fxs-part{padding:0 0 15px}.fxs-blade .fxs-blade-locked .fxs-part .fxs-part-title{height:29px;top:0}.fxs-blade .fxs-blade-locked .fxs-part .fxs-part-title h5,.fxs-blade .fxs-blade-locked .fxs-part::after{display:none}.fxs-blade .fxs-blade-locked .fxs-tilesize-fittocontainer .fxs-part{padding:0}html[lang^=ja] .fxs-part .fxs-part-title,html[lang^=ko] .fxs-part .fxs-part-title,html[lang^=zh] .fxs-part .fxs-part-title{top:-5px}html[lang^=ja] .fxs-part .fxs-part-title .fxs-part-titleText,html[lang^=ko] .fxs-part .fxs-part-title .fxs-part-titleText,html[lang^=zh] .fxs-part .fxs-part-title .fxs-part-titleText{font-size:11px;line-height:11px}')})
);define("_generated/Templates/Part",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-part-title"> <h3 data-bind="text: container.partTitle" class="fxs-part-titleText msportalfx-tooltip-overflow"><\/h3> <div data-bind="visible: container.assetName() && !context.inContainerOfSameAsset(), text: container.assetName" class="fxs-part-assetname msportalfx-tooltip-overflow"><\/div> <\/div> <div class="fxs-part-content"><\/div> <!-- ko if: context.isUiBlocked --> <div class="fxs-part-blockui-shield"><\/div> <!-- ko if: !context.notFoundMessage() --> <div class="fxs-part-nodatamessage" data-bind="visible: container.noDataMessage"> <!--The extra nested div is to enable vertical centering--> <div data-bind="text: container.noDataMessage" class="fxs-part-nodatamessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white"><\/div> <\/div> <div class="fxs-part fxs-part-noaccessmessage" data-bind="visible: container.unauthorizedMessage, css: { \'fxs-part-noaccessmessage-withtitle\': container.partTitle }"> <!--The extra nested div is to enable vertical centering--> <div class="fxs-part-title" data-bind="visible: container.partTitle"> <h3 data-bind="text: container.partTitle" class="fxs-part-titleText msportalfx-tooltip-overflow"><\/h3> <div data-bind="visible: container.assetName() && !context.inContainerOfSameAsset(), text: container.assetName" class="fxs-part-assetname msportalfx-tooltip-overflow"><\/div> <\/div> <div data-bind="text: container.unauthorizedMessage" class="fxs-part-noaccessmessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white"><\/div> <div data-bind="text: container.unauthorizedMessage" class="fxs-part-noaccessmessage-textsmall msportalfx-tooltip-overflow"><\/div> <\/div> <!-- /ko --> <!-- ko if: context.notFoundMessage --> <div class="fxs-part-notfoundmessage"> <!--The extra nested div is to enable vertical centering--> <div data-bind="text: context.notFoundMessage" class="fxs-part-notfoundmessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white"><\/div> <\/div> <!-- /ko --> <!-- /ko -->'}
}));define("MsPortalImpl/Parts/Parts",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Interactions/Interactions.FocusHandler","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.PartError","_generated/Templates/Part","MsPortalImpl/Base/Base.Selectable2.ClickContext","MsPortalImpl/UI/UI.DesktopManager","FxInternal/Composition/ViewModel","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Parts/Parts.Part.css","_generated/Less/MsPortalImpl/CustomPart.css","_generated/Less/MsPortalImpl/CustomForm.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt){"use strict";function vt(n){n.findByClassName("fxs-bg-error").eq(0).closest(
"[data-validatable='true']").findByClassName("azc-input").focus()}function oi(n,t){if(st[n])throw new Error("The part kind '"+n+"' has already been registered and cannot be registered again.");st[n]=t}function yt(n){return st[n]}function pt(n){var t=n&&n.initialSize;return et.InternalPartSize[t]!==undefined?t:2}function si(n,t,i){t.addClass(ut(i.extensionWindowId)).addClass((i.styleSheets||[]).map((function(n){return ut(n.file)})).join(" "));wt(n,i)}function wt(n,t){var s=t.styleSheets||[],i=t.extensionWindowId,u="",h=s.filter((function(n){return n.content&&!(ft[i]||{})[n.file]})).map((function(n){var e=ft[i]||(ft[i]={}),r,t,f;return e[n.file]=!0,r="."+ut(i),n.file&&(r+="."+ut(n.file)),t=[],f=o.sanitizeStyleSheetText(n.content,r,t),t.length&&t.forEach((function(t){u+="\n"+n.file+" - "+t.errorMessage+"\nCSS rule: "+t.rule.cssText})),f})),f;u&&Q.fcall((function(){r.Rpc.internalClient.log(i||"fx",{level:i?2:1,code:1,area:"Parts",message:"Sanitization error found in following extension("+i+") styleSheets:"+
u})}));f=h.map((function(i){var r=n.createElement("style");return r.type="text/css",r.textContent=i,r.setAttribute("data-extensionwindowid",t.extensionWindowId),r}));e(f).appendTo(n.head)}function hi(n,t,i,r,u){return new n.Part(t,i,r,u)}function ci(n,t,i){var u=t.partKind,r,f;if(u===ot.Custom){var o=t.htmlTemplateInline,s=t.htmlTemplate,e=o||i[s];r=kt(e&&e.content,{supportedSizes:t.supportedSizes})}else r=u===ot.Frame?bt("MsPortalImpl/Parts/Parts.Frame",hi,{supportedSizes:t.supportedSizes}):yt(ot[u]);return f=r.supportedSizes,f&&f.length||(r.supportedSizes=[pt(t)]),r}function bt(n,t,r){return{createPart:function(r,u,f,e){return i.tryImmediateResolve(i.require(n),(function(n){return t(n,r,u,f,e)}))},defaultSize:r.defaultSize,supportedSizes:r.supportedSizes,viewStateProperties:r.viewStateProperties,moduleId:n}}function kt(n,t){return t===void 0&&(t={}),{createPart:function(i,r,u,f){var o=t.partClass||ct,e=new o(i,r,u,f);return e.template=n,Q(e)},defaultSize:t.defaultSize,supportedSizes:t.supportedSizes,
viewStateProperties:t.viewStateProperties}}var ht,ct,ft;u.defineProperty(t,"__esModule",{value:!0});var dt=r.TriggerableLifetimeManager,gt=i.Base,lt=gt.Diagnostics,ni=lt.Telemetry,et=i.Parts,ti=i.ViewModels,ot=et.PartKind,it=et.PartState,rt=window,li=rt.fx.environment,ii=lt.createLog(n),ri=h.Parts.partSettingNotReceivedErrorDescription,e=jQuery,st={},ui="attr: { 'role': context._computedRole },css: context._computedClasses,click: function (data, evt) { return context._onClick(data, evt); },event: {'keydown': function (data, evt) { return context._onKeyDown(data, evt); } }",fi="fxs-part-is-v2",ei="fxs-part-for-template-blade",ut=o.getScopeName,at=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(ti.ClickableLink);t.InternalClickableLink=at;ht=(function(){function n(){this._onStartboard=f.observable();this.inContainerOfSameAsset=f.observable(!0);this.partSettingFailed=f.observable(!1);this.notFoundMessage=f.observable();this.lockedUiContext=f.
observable(!0)}return n.prototype.getSelectable=function(){return this._selectable},n.prototype.configure=function(n){this._onStartboard(n.onStartboard);this._selectable=n.selectable||this._selectable},n})();t.PartBase=ht;t.runFocusOnFirstInvalid=vt;ct=(function(t){function u(n,u,o,c){var l=t.call(this)||this,b,nt,p,ot,ft,et,rt,st,g,ht;l.ariaLabel=f.observable();var w=l._lifetime=new dt,y=u.container,ut=r.tryGetSelectableViewModelContract(y);if(!y)throw new Error("Cannot create a part without a container viewmodel.");return l._selectable=ut&&ut._msPortalFxSelectable2?v.getOrCreate(ut._msPortalFxSelectable2):undefined,b=l._selectable=l._selectable||y.selectable,b||(nt=u.content,nt&&typeof nt.onClick=="function"&&(b=l._selectable=d.getSelectableWithClickHandler(nt,e(n),nt.onClick))),l._viewModel=u,p=l._partContainer=e(n).attr("data-bind",ui).html(k()),l._accessibility(),o.isV2Part&&p.addClass(fi),o.isVirtualPartForTemplateBlade&&p.addClass(ei),l._partContent=p.findByClassName("fxs-part-content")[
0],ot=p.findByClassName("fxs-part-title"),ft=l.validateElements=f.observableArray([]),ft.extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),l._options=o,l._services=c,et=function(n){return!!l.notFoundMessage()||!!n.noDataMessage()||!!n.unauthorizedMessage()},l.isUiBlocked=f.pureComputed((function(){return l._viewModel.internal.allowUiBlocking()&&(y.operations.blockingUi()||et(y))})),rt=f.pureComputed((function(){return l._viewModel.internal.allowUiBlocking()&&et(y)})),l._isPartClickable=f.computed(w,(function(){return y.operations.blockingUi()||y.partState&&y.partState()===it.Failed||l.notFoundMessage()||y.unauthorizedMessage()!==null&&y.unauthorizedMessage()!==undefined?!1:y.clickableLink||y.isSelectable()&&!!b})),f.computed(w,(function(){y.partTitle();setTimeout((function(){p.trigger(tt.default.fxsizechanged)}),50)})),f.computed(w,(function(){l.lockedUiContext()?p.removeAttr("aria-label"):p.attr("aria-label",y.ariaLabel()||l.ariaLabel()||y.partTitle())})),st=f.computed(w,(function()
{var n=y.partTitle()&&y.partState()!==it.Failed;return a.toggle(ot,n),n})),l._computedClasses=f.computed(w,(function(){var n=[];st()&&n.push("fxs-part-part-title-visible");l._isPartClickable()&&n.push("fxs-part-clickable");l.notFoundMessage()?n.push("fxs-part-notfound"):y.noDataMessage()&&n.push("fxs-part-nodata");b&&y.isSelectable()&&(b.isSelected()&&n.push("fxs-part-selected"),b.isCommandSelected&&b.isCommandSelected()&&n.push("fxs-part-selected-command"));switch(y.contentState()){case 1:n.push("fxs-part-success");break;case 2:n.push("fxs-part-warning");break;case 3:n.push("fxs-part-error");break;case 4:n.push("fxs-part-dirty");break;case 5:n.push("fxs-part-info")}return n.join(" ")})),l._computedRole=f.computed(w,(function(){if(l.lockedUiContext())return null;if(l._isPartClickable()){var n=i.newGuid();l._partContainer.append('<div style="display:none" id="'+n+'">'+h.Parts.clickableAriaDesc+"<\/div>");l._partContainer.attr("aria-describedby",n)}else l._partContainer.removeAttr("aria-describedby");
return"group"})),f.dataFor(p[0])&&f.cleanNode(p[0]),f.applyBindings({container:y,context:l},p[0]),rt.subscribeAndRun(w,(function(n){if(n){if(!g){g=w.createChildLifetime();var t=l._partContainer,i,r;t.on(tt.default.focus,l._onFocus=i=function(){l._toggleDisableTabbableElements(rt())});t.on(tt.default.focusin,l._onFocusIn=r=function(){rt()&&t[0].focus()});g.registerForDispose((function(){t.off(tt.default.focus,i);t.off(tt.default.focusin,r);l._onFocus=l._onFocusIn=null}))}p.find(document.activeElement).length>0&&p[0].focus()}else g&&(g.dispose(),g=null),l._toggleDisableTabbableElements(n)})),f.reactor(w,(function(){!l.lockedUiContext()&&(l._isPartClickable()||l._onStartboard())?p.attr("tabindex",0):p.removeAttr("tabindex")})),ht=r.shellInterface(y),ht.triggerValidation((function(n){return s.ensureFormFieldValidation(p,!0).then((function(t){return n&&vt(l._partContainer),t}))})),f.computed(w,(function(){var u=ft(),i=s.gatherFormFieldsFromElements(u),n=y.form.validationState,t=i.map((function(n){var t=
n.field;return t.validatableViewModel&&t.validatableViewModel.validators().length?t.validatableViewModel.validationState():2})),r;~t.indexOf(1)?n(1):~t.indexOf(0)?n(0):~t.indexOf(3)?n(3):n(2);r=i.some((function(n){return f.unwrap(n.viewmodel&&n.viewmodel.dirty)}));y.form.dirty(r)})).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),l}return __extends(u,t),u.prototype.setupContent=function(n){var t=this;f.computed(this._lifetime,(function(){if(t.partSettingFailed())ii.error(ri),f.ignoreDependencies((function(){t._bindErrorTemplate()}));else{var r=nt.isV2(t._viewModel.content)&&!t._viewModel.content._msPortalFx_contentRevealedOnce(),i=t._viewModel.container.partState();if(r&&i!==it.Failed)return;f.ignoreDependencies((function(){t._bindContentTemplate(i,t.template,n)}))}})).extend({deferred:!0})},u.prototype.selectOnReady=function(n,t){var i=this,c=function(){i._selectable.isSelected(!0)},f,e;t=t||{};t.selectablePath=t.selectablePath||"container.selectable";t.timeoutInMilliseconds=t.
timeoutInMilliseconds===undefined?5e3:t.timeoutInMilliseconds;t.execute=t.execute||c;var o=this._viewModel.container.operations.inProgress,u=Q.defer(),s=p.getModelValue(this._viewModel,t.selectablePath),l=typeof this._viewModel.content.onInputsSet=="function"&&o(),h=function(){var r=n();r&&t.execute(i._viewModel);u.resolve(r)};return s.exists&&s.value?l?this._inProgressLifetime||(f=t.timeoutInMilliseconds,e=rt.setTimeout((function(){i._inProgressLifetime.dispose();i._inProgressLifetime=null;u.reject(r.createError("Unable to select part because its onInputsSet promise did not resolve after {0} milliseconds.".format(f)))}),f),this._inProgressLifetime=this._lifetime.createChildLifetime(),o.subscribe(this._inProgressLifetime,(function(n){n||(i._inProgressLifetime.dispose(),i._inProgressLifetime=null,rt.clearTimeout(e),e=null,h())}))):h():u.reject(r.createError("Unable to select part because it is missing selectable property '{0}' from its view model.".format(t.selectablePath))),u.promise},u.prototype.
_setupAutofocusReadyListener=function(){var t=this,n=this._partContainer[0];l.FocusHandler.Instance.registerTargetForFocus(n);w.waitForBindings(n).then((function(){return Q(t._viewModel.onInputsSetPromise).catch(i.noop)})).then((function(){l.FocusHandler.Instance.notifyTargetReadyForFocus(n)})).catch((function(){}))},u.prototype._logClick=function(n){ni.trace({extension:this._options.locator.getExtensionLocator().name,source:this._onStartboard()?y.Source.StartBoardPart:y.Source.Blade,action:y.Action.PartClick,name:this._options.locator.toFriendlyString(),data:n})},u.prototype._onClick=function(n,t){return this._activatePart(n,t)},u.prototype._onKeyDown=function(n,t){return t.target===this._partContainer[0]&&t.keyCode===13?this._activatePart(n,t):!0},u.prototype._activatePart=function(n,t){if(this._services.desktop.mode.peek()===1)return!0;var c=this._viewModel.container,o=e(t.target),l=!0,s=rt.getSelection(),h=s.rangeCount>0&&s.getRangeAt(0),r=c.clickableLink;if(this._isPartClickable()&&!(o.
closest("a").length>0)&&(s.isCollapsed||!h||h.commonAncestorContainer.ownerSVGElement||h.commonAncestorContainer.nodeName==="svg"))if(r)if(r instanceof at&&e.isFunction(r.onClick))r.onClick();else{var u=r.target(),f=String(r.uri()||""),a=i.startsWith(f,"#"),v=!1;u==="auto"&&(u=a?"_self":"_blank");u==="_self"&&(t.ctrlKey||t.shiftKey?u="_blank":a&&(this._services.router.route(f),v=!0));v||window.open(f,u);this._logClick({effectiveTarget:u,target:r.target(),scrubbedUri:f.split("?")[0]})}else t.shiftKey||t.ctrlKey||t.which===2?o.trigger(tt.default.fxopeninnewtab,{selectable:c.selectable}):(this._selectable&&(this._selectable.isSelected()?o.trigger(tt.default.fxensurebladevisible,{}):(this._selectable.onClick(),this._logClick())),l=!1);return l},u.prototype._accessibility=function(){for(var t,r,u=this._partContainer.findByClassName("fxs-part-title"),n=0;n<u.length;n++)t=i.getUniqueId(),r=e(u[n]),r.findByClassName("fxs-part-titleText").attr("aria-describedby",t),r.findByClassName("fxs-part-assetname").
attr("id",t)},u.prototype._bindContent=function(n,t,i){i&&si(document,e(this._partContent),i);e(n).html(t);f.applyBindings(this._getContentForBinding(this._lifetime,this._viewModel),n);this._nodeToCleanup=n},u.prototype.dispose=function(){var n,t;this._lifetime.dispose();n=this._nodeToCleanup;n&&f.cleanNode(n);t=this._partContainer[0];t&&(f.cleanNode(t),this._partContainer[0]=this._partContent=null);i.disposeViewModelProperties(this._viewModel)},u.prototype._getContentForBinding=function(n,t){return t.content},u.prototype._getCloudName=function(){return this._options.locator.getExtensionLocator().cloudName},u.prototype._getExtensionName=function(){return this._options.locator.getExtensionLocator().name},u.prototype._bindContentTemplate=function(t,i,u){var f=this._viewModel.container;if(t===it.Ready)try{f.contentState(0);this._resetContentTemplateContainer();this._bindContent(this._partContent,i,u)}catch(e){c.logToExtension(n,this._partContainer,2,"Part {0} failed to bind. Error: {1}".format(
this._options.getDebugId(),r.Diagnostics.getLogFriendlyMessage(e)),{});this._bindErrorTemplate()}else t===it.Failed&&(this._options.traceErrorTelemetry(f.failureMessage()),this._bindErrorTemplate());this._setupAutofocusReadyListener()},u.prototype._bindErrorTemplate=function(){this.notFoundMessage(null);this._viewModel.container.contentState(3);this._resetContentTemplateContainer();var n=new b.ViewModel;new b.Widget(e(this._partContent),n);n.title(this._options.locator.name);n.subtitle(this._getExtensionName());l.FocusHandler.Instance.notifyTargetReadyForFocus(this._partContainer[0])},u.prototype._resetContentTemplateContainer=function(){f.cleanNode(this._partContent);e(this._partContent).html("")},u.prototype._toggleDisableTabbableElements=function(n){var r,t,u,i,f="tabindex",o="data-initialtabindex";if(n)for(r=this._partContainer.find(":tabbable"),i=0;i<r.length;++i)t=e(r[i]),u=t.attr(f),t.attr(f,"-1"),t.attr(o,u||"unset");else for(r=this._partContainer.find("["+o+"]"),i=0;i<r.length;
++i)t=e(r[i]),u=t.attr(o),u!=="unset"?t.attr(f,u):t.removeAttr(f),t.removeAttr(o)},u})(ht);t.PartImpl=ct;t.registerFactory=oi;t.getFactory=yt;t.getPartSizeOrDefault=pt;ft={};t.injectStyles=wt;t.getPartFactory=ci;t.createAmdPartFactory=bt;t.createPartFactory=kt}));define("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase",["require","exports","f","o","ko","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/UI.DesktopManager"],(function(n,t,i,r,u,f,e,o){"use strict";function v(n,t,i){b.error("Error invoking detail blade for master '{0}'. ".format(t)+n+"Selection model: '{0}'".format(JSON.stringify(i)))}function k(n,t){var i=arguments.length===2?s(n,t).value:n,r;return i?(r=[i.selectedValue,i.value,i.isSelected,i.isActivated,i.isCommandSelected,i.hasChildEdits],r.every(u.isObservable)):!1}function d(n,t){var i=arguments.length===2?s(n,t).value:n,r;return i?(r=[i.selectableItems,i.selectedItems,i.activatedItems,
i.itemsWithChildEdits],r.every(u.isObservable)):!1}function g(n){var t=n;return!!t.isLocked()}function nt(n){return n.blade?n.selectablePath||"container.selectable":tt(n)}function l(n){var t=n&&n.invocationInputArguments,i=t&&t[0],r=i&&i.valuesFrom,u=r&&r[0];return u&&u.property}function tt(n){var r=l(n),t,i,u;return r&&(t=r.split("."),i=t.length,i>1)?(u=t[i-1],["value","activatedItems","selectedItems","selectedItem"].some((function(n){return n===u}))&&(t=t.slice(0,i-1)),t.join(".")):null}function it(n){var t,i,r;return n?(t=n.filter((function(n){return n&&!n.selectablePath&&!n.invocationInputArguments})),!t.length&&(i=n.filter((function(n){return n&&n.selectablePath==="container.selectable"})),!i.length&&(r=n.filter((function(n){var t=l(n);return t==="container.selectable.value"||!n.blade&&t==="container.selectable"})),!r.length)))?!1:!0:!1}function rt(n,t,i){var r,f=n.invocationInputArguments,o=f&&f.length!==1,e=f&&!o&&f[0].valuesFrom,u=n.outputArguments;return(o?r="Invocation arguments must exist and have only one element.":
e&&e.length>1?r="Multiple 'valuesFrom' not supported for invocation arguments.":!n.blade&&f[0].property?r="Static invocation property is not supported when omitting the details blade name.":e&&e[0].constantValue!==undefined?r="Constants are not allowed on invocation argument.":u&&u.length>0&&(u.some((function(n){return!n.property}))?r="Output arguments must specify a target property.":u.some((function(n){return n.valuesFrom.length!==1}))?r="Output arguments support only one valueFrom property.":u.some((function(n){return n.valuesFrom[0].constantValue!==undefined}))?r="Constants are not allowed on output arguments.":u.some((function(n){return n.valuesFrom[0].referenceType!==1}))&&(r="Output arguments only support source ReferenceType.BladeInput.")),!r&&i&&(r=i(n)),r)?(t.push(r),!1):!0}function ut(n,t,r,u){var l=t,a=t,y=t,w,e,c,o={},s;return st(u,t)&&(c=t.cloudName||r.cloudName,t.extension&&(s=t.extension,i.isFeatureEnabled("extensionredirect")&&(s=f.redirects()[s]||s),r=h.forExtension(s,c)),w=h.
forExtensionManifest(r.name,r.cloudName),l.detailBlade?e=r.withBlade(l.detailBlade):a.assetType&&n.finder.tryLocate(w.withAssetType(a.assetType),o)?e=p(r.name,r.cloudName,o.value):y.resourceId&&f.tryLocateAssetDefinitionFromResourceId(n.extensionManager,y.resourceId,o,c)?e=p(o.extensionName,c,o.value):v("Unable to locate asset. Error: '{0}'. ".format(o.error),u,t)),e||(e=r.withBlade("##NOT_SPECIFIED##")),e}function ft(n,t,i){var r=t&&t.container,u=i.details;return r&&r.selectable===n?u.first((function(n){return y(n)})):n?(u||[]).first((function(i){var r=i.invocationInputArguments,u=i.selectablePath;return r?r.some((function(i){return i.valuesFrom.some((function(i){var r=[];return i.property.split(".").some((function(i){return r.push(i),s(t,r.join(".")).value===n}))}))})):u?s(t,u).value===n:!1})):null}function y(n){var r=l(n),u=n.selectablePath,i=!0;return r?i=r===t.PartContainerSelectableValue_ViewModelPath:u&&(i=u===t.PartContainerSelectable_ViewModelPath),i}function et(n,t,r,u,f){var o,s;if(t.
setLifetimeReference(8,r),s=function(){var t={},h,s;o=new e.PropertyBindings(r.id+"-"+n,t,!1);h=r.getViewModel(1);o.addPropertyChangedHandler((function(){s=i.clone(t,!0)}));u.forEach((function(n){o.mapProperty(n,n).bind(r.id,h,!0)}));s&&f(s);o.addPropertyChangedHandler((function(){var n=i.clone(t,!0);f(n)}))},u.length){r.isComposed?s():r.awaitComposed().then(s);r.onDispose((function(){o&&(o.unbind(),o=null)}))}}function ot(n,t,i,r,f){function e(){return i.referenceComposition.getPartsContainer().detailContainers.map((function(n){return"\n    "+n.toString()+". Model: "+u.toJSON(n.getInputsOnlyViewModel())})).join("")||"<None>"}o.isTraceEnabled&&n.verbose("[BladeOpener] "+t+("\n Master Identifier: "+i.masterModelId+".")+("\n  Master Property: '"+r.source.property)+("\n  Master Value: "+(f!==undefined?u.toJSON(f):"<undefined>")+".")+("\n  Current Detail Blades from Container: "+e()))}function st(n,t){var i,r=t,u=t,f=t;return t?r.detailBlade||u.assetType||f.resourceId?r.detailBlade&&u.assetType?i="'detailBlade' and 'assetType' cannot be specified at the same time.":
r.detailBlade&&f.resourceId?i="'detailBlade' and 'resourceId' cannot be specified at the same time.":u.assetType&&f.resourceId?i="'assetType' and 'resourceId' cannot be specified at the same time.":t.detailBladeInputs||(i="Model must define a 'detailBladeInputs' property."):i="Either 'detailBlade', 'assetType' or 'resourceId' must be specified on the model. ":i="Dynamic selection must be specified. ",i&&v(i,n,t),!i}function p(n,t,i){return i?(i.contracts&c)===c?h.forExtension(a.ExtensionNames.Hubs,t).withBlade(a.BladeNames.Hubs.ResourceMenuBlade):h.forExtension(i.bladeExtensionName||n,t).withBlade(i.bladeName):null}var s,c;r.defineProperty(t,"__esModule",{value:!0});var h=f.Locator,a=i.Base.Constants,w=i.Base.Diagnostics,b=w.createLog(n);t.PartContainerSelectable_ViewModelPath="container.selectable";t.PartContainerSelectableValue_ViewModelPath=t.PartContainerSelectable_ViewModelPath+".value";s=e.getModelValue;c=8;t.DefaultConfiguration={services:null,masterModelId:null,masterModel:null,
referenceComposition:null,referenceExtension:null,isBladeOpenedByMaster:null,invocationThrottleDuration:25,configureBladeDescriptor:i.noop,onBladesOpening:i.noop,onBladeOpened:i.noop,addOutputBindings:i.noop,removeOutputBindings:i.noop,getCloseOwnedDetailBladesHandler:i.wrap(null),getCloseOtherDetailBladesHandler:i.wrap(null)};t.isSelectable=k;t.isSelectableSet=d;t.isSelectableLocked=g;t.getSelectablePath=nt;t.needContainerSelectable=it;t.validateDetailsDefinition=rt;t.mapDynamicSelectionToBladeLocator=ut;t.getAssociatedDetailDefinition=ft;t.detailsIsPartContainer=y;t.bindOutputsToSelectable2=et;t.traceInvocationChange=ot}));define("MsPortalImpl/UI/Compositions/UI.Composition",["require","exports","f","o","MsPortalImpl/Extension/Extension.Definition.Locator"],(function(n,t,i,r,u){"use strict";function l(n){return function(t){return t.id===n}}function a(n,t,i){if(n)if(t){if(!i)throw new Error("Command container name is required.");}else throw new Error("Command name is required.");else throw new
Error("Commands list is required.");var r=n.first((function(n){return n.commandName===t}));return r||o.error("Command container '{0}' does not have a command named '{1}'.".format(i,t)),r}function v(n){var t=n.locator&&n.locator.type;return t===u.LocatorType.PartInstance||t===u.LocatorType.PartType||t===u.LocatorType.StartboardPartInstance}function y(n,t){return r.keys(t).every((function(r){return n.hasOwnProperty(r)&&i.deepEquals(t[r],n[r])}))}function p(n,t,i){var h;try{return t()}catch(r){var c="Error deserializing composition.",f=void 0,s=void 0;try{f=JSON.stringify(n)}catch(l){f="<Invalid> {0}".format(l.toString())}try{s=u.Locator.fromJSON(n.locator)}catch(a){s=u.Locator.forExtension(c+"-"+a,e.EmptyCloudName)}return h="{0}\nJSON: {1}\nException Message: {2}\nException StackTrace: {3}".format(c,f,r.message||"<N/A>",r.stack||r.toString()),o.error(h),i(s,h)}}function w(n){var t=n&&n.assetTypeId;if(typeof t=="string")return t}function b(n){var t=n;return t&&t.beforeActivateCommandMenuItems&&
typeof t.beforeActivateCommandMenuItems=="function"}var c;r.defineProperty(t,"__esModule",{value:!0});var f=i.Base,e=f.Constants,s=e.BladeParameterNames,h=f.Diagnostics,o=h.createLog(n);t.referenceTypeMap={};t.referenceTypeMap[0]="Part";t.referenceTypeMap[1]="BladeInput";t.referenceTypeMap[2]="BladeActionBar";t.referenceTypeMap[3]="BladeProperty";t.referenceTypeMap[4]="Command";t.referenceTypeMap[5]="Constant";t.referenceTypeMap[6]="SelectedItem";t.referenceTypeMap[7]="Adapter";t.referenceTypeMap[8]="Dashboard";t.referenceTypeMap[9]="AdapterInput";t.EditScopeIdPropertyName=s.EditScopeId;t.PartContainerModelIdProperty="##SnapshotContainerId##";t.CompositionInstanceDataName="MsPortalImplCompositionInstance";t.fxreplacedpartcomposing="fxreplacedpartcomposing",(function(n){n[n.Unknown=0]="Unknown";n[n.Part=1]="Part";n[n.StartboardPart=2]="StartboardPart";n[n.Lens=3]="Lens";n[n.BladeActionBar=4]="BladeActionBar";n[n.Blade=5]="Blade";n[n.Journey=6]="Journey";n[n.Startboard=7]="Startboard"})(c=
t.CompositionType||(t.CompositionType={}));t.getIdMatchFunc=l;t.findCommand=a;t.isPartComposition=v;t.deepSubset=y;t.createCompositionFromJSON=p;t.tryGetAssetType=w;t.isContextMenuContainer=b}));define("MsPortalImpl/UI/Compositions/UI.Composition.CloudName",["require","exports","f","i","ko","MsPortalImpl/UI/Compositions/UI.Composition"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function w(n,t){if(!s.multiCloudEnabled)return n;var i=d(t),r=t.locator.getExtensionLocator();if(i.name===o)r.name===o&&v.assert(n[e],"Hubs extension should provide cloud name.");else if(n[e])throw new Error("Use of {0} by extensions is not supported".format(e));else r.name===o&&(n[e]=y(i.cloudName),t.masterInputKeys&&t.masterInputKeys.push(e));return n}function b(n,t){return s.multiCloudEnabled?(t&&t.hasOwnProperty(e)&&!n[e]&&(n[e]=t[e]()),n):n}function k(n,t){var u,i,r;if(!s.multiCloudEnabled)return!1;if(u=!1,n===o&&t)for(r=0;r<t.length;r++)if(i=t[r],i&&i.additionalInputArguments&&i.additionalInputArguments.
some((function(n){return n.property===e}))){u=!0;break}return u}function d(n){var t,r=n.masterContainer,i=n.masterContainer.getCompositionType();if(n.masterCommandExtension)t=n.masterCommandExtension;else if(i===h.Startboard)t=c(n.masterPartId,r.children);else if(i===h.Blade)t=c(n.masterPartId,r.getParts());else throw"Can not handle composition type {0}".format(h[i]);return t}function c(n,t){var i=t.first(p(n));return i&&i.extension}var s=r.Extension,o=i.Base.Constants.ExtensionNames.Hubs,l=i.Base.Diagnostics,h=f.CompositionType,a=r.Constants,e=a.CloudName.inputBindingKey,v=l.createLog(n),y=u.observable,p=f.getIdMatchFunc;t.ensureInputToHubsBlade=w;t.ensureRebindToHubsBlade=b;t.needInternalProperty=k})(e||(e={})),e}));define("MsPortalImpl/Services/Services.PortalIdentity",["require","exports","f","i","o","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f){"use strict";function v(n,t){return(n&t)===t}function d(n){c=s.getHubsWindowId();var t=!1;n||(n={},t=!0);e={displayName:
n.displayName,firstName:n.firstName,lastName:n.lastName,avatarUri:n.avatarUri,defaultAvatarUri:n.defaultAvatarUri,tenantId:n.tenantId,tenantDomain:n.tenantDomain,perTenantId:n.perTenantId,changePasswordUri:n.changePasswordUri,isAnonymous:t,isOrgId:n.isOrgId}}function g(n){var t={};n.forEach((function(n){if(n.tokenSettings&2){var i=n.features,r=(i&&i.allowedUserInfo||"").toLowerCase(),u=b[r]||0;t[s.getWindowId(n)]=u}}));s.getUserInfoEndPoint.register(h.client,null,(function(n,i){return y(t[i.srcWindowId])}))}function y(n){return i.tryImmediateResolve(w(),(function(t){var r=p(),e=r.tenantId||"",l=t.tenants,s=e,h=e,a=e,u=l.first((function(n){return e.toLowerCase()===(n.id||"").toLowerCase()})),c,o;return u&&(s=(u.displayName||"").toLocaleLowerCase(),h=u.domainName,a=l.filter((function(n){return(n.displayName||"").toLocaleLowerCase()===s})).length>1?f.Services.PortalIdentity.tenantNameAndDomainFormat.format(u.displayName,h):u.displayName),c=i.isNullOrUndefined(n)?7:n,o={},v(c,3)&&i.extend(o,{email:
r.displayName,givenName:r.firstName,surname:r.lastName}),v(c,4)&&i.extend(o,{isOrgId:r.isOrgId,directoryId:r.tenantId,directoryName:s,uniqueDirectoryName:a,domainName:h}),o}))}function nt(){return e?e.tenantDomain||"":""}function p(){return e}function tt(){if(!o){var n=Q.defer();a.updateSubscriptionInfoEndPoint.register(h.client,[c],(function(t){n.resolve(t)}));o=n.promise}return o}function w(){if(!t.Internal.tenantsPromise){var n=Q.defer();a.updateTenantInfoEndPoint.register(h.client,[c],(function(t){n.resolve(t.tenantInfo)}));t.Internal.tenantsPromise=n.promise}return i.tryImmediateResolve(t.Internal.tenantsPromise,(function(n){var t=n.tenants.first((function(n){return(n.id||"").toLowerCase()===(e.tenantId||"").toLowerCase()})),i=e.tenantDomain;return t&&(t.displayName||(t.displayName=i),t.domainName||(t.domainName=i)),n}))}u.defineProperty(t,"__esModule",{value:!0});var l=r,s=l.Extension,h=r.Rpc,a=HubsExtension.Internal.Azure,b={directory:4},c,e,o,k;l.registerGlobalState({reset:function(){o=
undefined;k=undefined}});t.initialize=d;t.initializeRpc=g;t.getUserInfo=y;t.getSignedInUserTenant=nt;t.getSignedInUser=p;t.getSubscriptions=tt;t.getTenants=w;t.Internal={}}));define("MsPortalImpl/Services/Services.Storage",["require","exports","f","i","a"],(function(n,t,i,r){"use strict";var u;return (function(t){function a(){return u.forEach((function(n){var t=f[n.name];t.count=t.keySize=t.valueSize=0})),f}function v(){return new s}var h=i.Base.Diagnostics,c=h.createLog(n),o=JSON.stringify,l=r.Diagnostics.getLogFriendlyMessage,e,u,f,s;(function(n){n[n.DesktopManager=2]="DesktopManager";n[n.AssetMruList=3]="AssetMruList";n[n.ExtensionManager=4]="ExtensionManager";n[n.Router=5]="Router";n[n.UserSettings_Journeys=6]="UserSettings_Journeys";n[n.UserSettings_EditScopes=7]="UserSettings_EditScopes";n[n.Relex=8]="Relex";n[n.ManifestVersions=9]="ManifestVersions";n[n.Redirect=10]="Redirect";n[n.Cdn=11]="Cdn";n[n.UserSettings_NewJourneys=12]="UserSettings_NewJourneys";n[n.Telemetry=13]="Telemetry";
n[n.Dashboard=14]="Dashboard";n[n.Avatar=15]="Avatar";n[n.UserSettingsService=16]="UserSettingsService";n[n.HelpContent=17]="HelpContent"})(e=t.ComponentName||(t.ComponentName={}));u=i.getEnumArray(e);f={};u.forEach((function(n){f[n.name]={count:0,keySize:0,valueSize:0}}));t.create=v;s=(function(){function n(){function t(n){return e[n]+"_"}function r(n,i){return t(n)+(i||"")}function n(n){return n===1?s:h}function f(n,t,i){for(var u,r=0;r<n.length;r++)u=n.key(r),t.call(i,n.getItem(u),u,n)}function v(n){var e=a(),t=0,s="",r;f(n,(function(n,r){var c=i.find(u,(function(n){return i.startsWith(r,n.name)})),f,h;c&&(f=e[c.name],f.count++,f.keySize+=r.length,h=o(n).length,f.valueSize+=h,h>t&&(t=h,s=r))}));try{r=o(e)}catch(h){r="Could not stringify the summary. Exception: "+l(h)}return"Summary: {0}. The longest value (key == {1}) took {2} bytes. The total storage length is {3}.".format(r,s,t,n.length)}var s=MsPortalImpl.sessionStorage,h=MsPortalImpl.localStorage;this.getValue=function(t,i,u){return n(
u).getItem(r(t,i))};this.getAllComponentItems=function(i,r){var u=t(i),o=n(r),e={},s=u.length;return f(o,(function(n,t){if(t.startsWith(u)){var i=t.substring(s,t.length);e[i]=n}})),e};this.setValue=function(t,i,u,f){var o=n(f),s=r(t,i),e;try{o.setItem(s,u)}catch(h){e=new Error("Storage.setItem failed.");e.innerError=h;e.storageState=v(o);e.key=s||i;c.error(e)}};this.clearValue=function(t,i,u){var f=n(u),e=r(t,i),o=f.getItem(e);return f.removeItem(e),o};this.clearAllComponentItems=function(i,r){var o=t(i),u=n(r),e=[];f(u,(function(n,t){t.startsWith(o)&&e.push(t)}));e.forEach((function(n){return u.removeItem(n)}))};this.clearAll=function(){h.clear();s.clear()}}return n})()})(u||(u={})),u}));define("MsPortalImpl/Base/Base.Router",["require","exports","f","i","o","ko","FxHubs/ResourceProvider","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Base/Base.ImplUtils","FxHubs/CloudNameCommon",
"FxHubs/MarketplaceRpc","MsPortalImpl/Services/Services.PortalIdentity","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function ui(n,t,r){var o={},f,e,u;try{for(f=0;f<n.length;){if(e=ii(n[f++]),!e)throw new Error("invalid decodeKey:"+e);u=ii(n[f++]);r&&u&&u.match(/^\s*\{.*\}\s*$/)&&(u=yt.safeJSONParse(u));o[e]=u}}catch(s){throw new i.Errors.Error({message:"Deep link "+t+" has illegal inputs",innerErrors:s});}return o}function ei(n,t){return function(){var r,u;try{t.apply(n,arguments)}catch(i){r=!0;i instanceof DOMException&&(u=i,(u.code===DOMException.SECURITY_ERR||u.name==="SecurityError")&&(r=!1));r&&st.error(i,0)}}}function w(){return new l.Uri(location.href)}function ut(n){return n===void 0&&(n=w()),n.getHashParts().category.localeCompareIgnoreCase("dashboard")===0}function at(n){return n===void 0&&(n=w()),n.isHashEmpty()||ut(n)}function bi(n){return n===void 0&&(n=w()),["asset","blade","create","resource"].indexOf(n.getHashParts().category)>=
0}function vt(n){return(pt()+"dashboard/"+n).toLowerCase()}function ki(n,i,r){var u=vt(n),f;r=r||w();r.hash.toLowerCase()!=="#"+u&&(r.setHash(u),f=i?t.history_replaceState:lt,f(null,null,r.href))}function di(n){return n===void 0&&(n=w()),ut(n)?n.getHashParts().rest:""}function gi(n,t){return t===void 0&&(t=w()),n.getValue(b,ft,1)===t.hashWithHashQueryString&&n.getValue(b,nt,1)||""}function nr(n,t,i,r){r===void 0&&(r="");var u=i;return u&&typeof u=="string"&&kt.isResourceManagerId(u)&&(u=u.substring(1)),new l.Uri(r).setHash("#{0}{1}/{2}/{3}/{4}".format(pt(),"asset",rt(n.name,n.cloudName,!1),t,u)).toString()}function tr(n,t,i,r,u){var o=rt(n,i,!1),e="#{0}/{1}";return u&&(f.unwrap(u.additionalConfig)||{}).preview&&(e+="/preview"),new l.Uri(t).setHash(e.format("create",o)).toString()}function ir(n,t,r,u,e,o){e===void 0&&(e=!1);var s=new l.Uri(r),c=n.cloudName,a=!0,h="";return(o&&(h="/"+o),u&&(i.forEachKey(u,(function(n,t){if(n!=="editScopeId"){var i=f.unwrap(t);if(n===vi){c=i;return}if(i&&typeof
i=="object")if(e)i=JSON.stringify(i);else{a=!1;return}i!==undefined&&(h+="/{0}/{1}".format(encodeURIComponent(n),encodeURIComponent(i||"")))}})),!a))?"":(s.setHash("#{0}{1}/{2}/{3}{4}".format(pt(),"blade",rt(n.name,c,!1),t,h)),s.href.length>2082)?"":s.toString()}function rr(n){return new yt.RouterImpl(n,r.Rpc.client)}function pt(){var n=y.getSignedInUserTenant();return n?"@"+n+"/":""}var fi,g,lt,yt;u.defineProperty(t,"__esModule",{value:!0});var oi=r.Extension,si=oi.CloudName,wt=i.Base,d=wt.Constants,hi=d.BladeNames.Hubs,ci=d.AssetNames,bt=wt.Diagnostics,li=bt.Telemetry,ai=i.Hubs.Notifications.NotificationStatus,kt=i.ViewModels.Services.ResourceTypes,dt=c.DesktopManagerEvents,vi=r.Constants.CloudName.inputBindingKey,nt="sessionStorageJourneyId",ft="sessionStorageDeepLink",tt=o.Shell,gt=tt.deepLinkInvalid,ni=tt.deepLinkErrorLoading,et=window,ot=et.fx.environment,ti=o.Portal.defaultPageTitle.format(o.NavBar.home,ot.branding.title),st=bt.createLog(n),b=s.ComponentName.Router,it=li.trace,yi=
/^[\w-]+$/,k=et.history,ii=decodeURIComponent,rt=a.addCloudNameToId,ht=tt.deepLinkNotFound,ri=d.ExtensionNames,ct=ri.Marketplace,pi=i.isFeatureEnabled("plusnewv2"),wi=i.isFeatureEnabled("sideBarAutoCollapsedInJourney");fi={linkFormat:"",invalidLink:"",unfoundAsset:"",noResourceAsset:""};g=r.getErrorMap(fi);lt=ei(k,k.pushState);t.history_replaceState=ei(k,k.replaceState);t.isDashboardRoute=ut;t.isDashboardUri=at;t.isBladeUri=bi;t.getDashboardDeepLink=vt;t.updateDashboardUri=ki;t.getDashboardIdFromUri=di;t.getStoredJourneyId=gi,(function(n){function f(n){try{return JSON.parse(n)}catch(t){return n}}function u(n,t,i,r,u){return{extension:n,assetType:t,detailBladeInputs:i,cloudName:r,defaultMenuItemId:u}}function s(n){var e=a.getCloudNameFromId(n),t,i,u,r,f;return(n=a.removeCloudNameFromId(n),t=(n||"").split("/"),i=t.length,i<2)?null:(r=i%2,r===1&&(u=t[2]),f=ui(t.slice(2+r),n,!0),{extension:t[0],detailBlade:t[1],detailBladeInputs:f,cloudName:e,defaultMenuItemId:u})}n.safeJSONParse=f;var c=(function(
){function n(n,t){var f=this,u;this._assetTypes=n.assetTypeService;this._desktop=n.desktop;this._extensions=n.extensionManager;this._notifications=n.notificationManager;this._storage=n.storageService;this._ltm=new r.TriggerableLifetimeManager;u={};this._getHandler=function(n){var t=n.getHashParts().category;return u[t]};i.forEachKey({asset:this._handleAssetRoute,blade:this._handleBladeRoute,create:this._handleCreateRoute,menu:this._handleMenuRoute,resource:this._handleResourceRoute,dashboard:this._handleDashboardRoute},(function(n,t){u[n]=function(n){return t.call(f,n)}}));i.ViewModels.navigateToDashboardEndPoint.register(t,null,(function(n){var t=n[0],i=n[1];f.navigateToDashboard(t,i)}))}return n.prototype.route=function(n){return this._route(new l.Uri(n))},n.prototype._route=function(n,t){var u=this;return i.tryImmediateResolve(Q(),(function(){var e=t&&t.dashboardRouteHandled,f=t&&t.skipFocus,i;if(n.isHashEmpty()||ut(n)&&e)u._handleStartBoardRoute(f);else return i=u._getHandler(n),i?i(n.getHashParts(
).rest,f):r.QReject("{0} is not a valid deep link".format(n.hashWithHashQueryString))}))},n.prototype.initialRoute=function(n,t){var f=this,r=w(),i,u;return i=this._getHandler(r)?this._route(r,{dashboardRouteHandled:!0,skipFocus:t.skipFocus}).catch(n):n(),this.startListening(),i=i.catch((function(n){st.warning(n,1,"Unable to load initial route.");f.goToDashboardOnInit("InitialRouteFailed")})),u=r.getHashParts().category,!u||u==="dashboard"?Q():i},n.prototype.startListening=function(){var n=this,t=this._desktop,i=this._isListening;i&&i.dispose();i=this._isListening=this._ltm.createChildLifetime();i.registerForDispose([$(window).setEvents([p.default.hashchange,function(){var t=w();n._route(t,!1).catch((function(){n._desktop.portalWidget.trigger(p.default.fxhomebuttonclick)}))}]),$(t.portalWidget.element).setEvents([p.default.fxhomebuttonclick,function(){n.navigateToDashboard("HomeClick")}]),$(t).setEvents([dt.activeJourneyChanged,function(){var r=w(),i=n._getActiveJourneyId(),u=n._storage.getValue(
b,nt,1),f=u===i||(k.state||{}).journeyId===i,e,o;f||i?(f||at(r)||u&&u!==i)&&(o=!0):(t.isJourneyLoading||(n._clearStorage(),at(r)||k.pushState({},ti,r.setHash("#").href),n._updateTitle()),e=!0);e||n._updateNavHistory({addToHistory:o});wi&&!f&&i&&t.portalWidget.getSideBarWidget().options.isCollapsed(!0)},],[dt.bladeRebound,function(){n._updateNavHistory()}])])},n.prototype._clearStorage=function(){var n=this._storage;n.clearValue(b,nt,1);n.clearValue(b,ft,1)},n.prototype.stopListening=function(){var n=this._isListening;n&&n.dispose();this._isListening=null},n.prototype.dispose=function(){this.stopListening();var n=this._ltm;n&&(n.dispose(),this._ltm=null)},n.prototype.navigateToDashboard=function(n,t){var i=!t?w():w().setHash(vt(t)),r;it({source:n||"Base.Router",action:h.Action.DashboardNavigation});r=t?i.href:i.setHash("#").clearHashQueryStringIfEmpty().href;k.pushState({},"",r);this._route(i)},n.prototype.goToDashboardOnInit=function(n,t){var i=this._desktop;return i.portalWidget.trigger(
p.default.fxshowstartboard,null,{skipFocus:t}),i.getDashboardManager().then((function(t){var i=t.currentDashboardId();return t.switchDashboard({id:i,title:i},n)}))},n.prototype._handleStartBoardRoute=function(n){var u=this._getActiveJourneyId(),r=this._desktop,f=r.portalWidget,t,i;r.tryDeactivateJourney()&&(u||(t=f.getPanorama(),i=t&&t.getJourneyWidget(),i&&i.close()),this.goToDashboardOnInit("Router",n),this._updateTitle())},n.prototype._handleDashboardRoute=function(n,t){var i=this;return this._desktop.getDashboardManager().then((function(t){return t.switchDashboard({id:n,title:n},"Router")})).then((function(){i._handleStartBoardRoute(t)}))},n.prototype._handleBladeRoute=function(n,t){var f=this,r,u;return t=t||s(n),r=this._desktop,u=r.generateLoadingJourneyGuid(),t.extension.toLowerCase()===ri.Hubs.toLowerCase()&&(si.addToModel(t.cloudName,t.detailBladeInputs),t.cloudName=d.DefaultCloudName),i.tryImmediateResolve(r.createJourneyForBlade(t,u),i.identity,(function(t){return f._notify(ni.format(
n)),Q.reject(t)}))},n.prototype._handleCreateRoute=function(n){var c=this,f=a.getCloudNameFromId(n),t,u,e,o,s;return(n=a.removeCloudNameFromId(n),t=(n||"").split("/"),!t.length)?(this._notify(gt.format(n)),r.QReject("Deep link "+n+" should be #{routeTypes.create}/{package-id}.")):(it({source:h.Source.Gallery,action:h.Action.DeepLinkVisited,name:n}),u=t.shift(),e=ui(t,n),u!=="hub"&&u!=="Microsoft.Support"?i.tryImmediateResolve(this._extensions.getExtensionByName(ct,f),(function(){return Q(v.getCreateFlow({marketplaceGalleryItemId:u,launchingContext:{source:["DeepLink"]},additionalConfig:e,alternateCreateFlowOptions:{useStackSelectionIfAvailable:!0}},f))})).then((function(i){var r=i.bladeSelection;return c._handleBladeRoute(n,{extension:r.extension,detailBlade:r.detailBlade,detailBladeInputs:r.detailBladeInputs,cloudName:f,defaultMenuItemId:t[2]})})):(o="",this._extensions.initializedExtensions.some((function(n){return n.name===ct}))||(o="/useDelayedBlade/true/bladeWidth/{0}".format(pi?1:0)),s=
rt("{0}/{1}/package/{2}/additionalConfig/{3}/selectedMenuItemId/undefined/createLanding/undefined{4}".format(ct,hi.CreateHubBlade,encodeURIComponent(u),encodeURIComponent(JSON.stringify(e)),o),f,!1),this._handleBladeRoute(s)))},n.prototype._handleMenuRoute=function(n){yi.test(n)||g.linkFormat(n);var t=this._desktop.portalWidget.element.find(".fxs-menu-"+n.toLowerCase());return t.length!==1&&g.invalidLink(n),this._updateNavHistory({skipFocus:!0}),t.click(),Q()},n.prototype._handleAssetRoute=function(n){var c=this,l=a.getCloudNameFromId(n),t,s,v;if(n=a.removeCloudNameFromId(n),t=n.split("/"),t=n.match(/([^\/]+)\/([^\/]+)\/(.+)/i),!t||t.length<4)return this._notify(gt.format(n)),r.QReject("'"+n+"' is invalid. Correct format is #asset/{ExtensionName}/{AssetType}/{AssetId}");var e=t[1],f=t[2],o=t[3];return typeof o=="string"&&kt.isResourceManagerId("/"+o)&&(o="/"+o),s=this._desktop,v=s.generateLoadingJourneyGuid(),i.tryImmediateResolve(this._extensions.getManifestByName(e,l),(function(n){e=n.
name;var i=f.toLowerCase(),t=n.assetTypes.first((function(n){return n.name.toLowerCase()===i}));return t||(c._notify(ht.format(f)),g.unfoundAsset(f)),f=t.name,it({source:h.Source.Asset,action:h.Action.DeepLinkVisited,name:e,data:f}),s.createJourneyForAsset(u(e,f,{},l,null),v,o)}),(function(n){c._notify(ht.format(e));throw n;}))},n.prototype._handleResourceRoute=function(n){var f=this,t,r,o,s;return n="/"+n.replace(/^\//,""),n=decodeURI(n),t=n.split("/"),r=null,t.length%2==0&&(r=t[t.length-1],n=n.substr(0,n.length-r.length-1)),o=this._desktop,s=o.generateLoadingJourneyGuid(),i.tryImmediateResolve(Q(),(function(){var t=e.buildResourceTypeWithCloudName(n);return i.tryImmediateResolve(f._assetTypes.getAssetTypeByResourceTypePromiseWithFallback(t.resourceType,t.cloudName),(function(i){var c=i.assetTypeManifest,l=c.name,v=i.extension,e=c.resourceType.resourceTypeName,y=t.cloudName;return l||(f._notify(ht.format(e)),g.noResourceAsset(e)),it({source:h.Source.Resource,action:h.Action.DeepLinkVisited,name:
v,data:e||ci.NonAssetResource}),o.createJourneyForAsset(u(v,l,{},y,r),s,a.removeCloudNameFromId(n))}))}),(function(t){f._notify(ni.format(n));throw t;}))},n.prototype._updateTitle=function(){var r=this._desktop,t=r.getActiveJourney(),u=r.startBoard,f=u&&u.getDashboard()||{},n;if(document.title=f.title?o.Portal.windowTitleFormat.format(f.title,ot.branding.title):ti,n=this._titleLifetime,n&&n.dispose(),t&&t.blades.length>0){n=this._titleLifetime=this._ltm.createChildLifetime();var i=t.blades[t.blades.length-1],e=i.isDefaultTitle(),s=i.title.subscribe(n,(function(n){et.document.title=o.Portal.windowTitleFormat.format(n,ot.branding.title)}));e||s.callback(i.title())}},n.prototype._getActiveJourneyId=function(){var n=this._desktop.getActiveJourney();return!n||n.isStartedWithContextBlade()?"":n.id},n.prototype._notify=function(n){var t=new Date;this._notifications.addClientNotification({title:tt.deepLinkInvalidTitle,description:n,status:ai.Error,timestamp:t,correlationIds:[t.getTime().toString()],
cloudName:d.DefaultCloudName})},n.prototype._updateNavHistory=function(n){var r=this,f=n&&n.addToHistory,e=n&&n.skipFocus,u=this._desktop.getActiveJourney();return u?i.tryImmediateResolve(u.getDeepLink(),(function(n){var o=r._getActiveJourneyId(),i,e,l;if(o){var s=u.blades,h=s[s.length-1],c=h&&h.bladeDefinition;c&&c.menuBlade||(i=w(),i.setHash(n),e=r._storage,e.setValue(b,nt,o,1),e.setValue(b,ft,i.hashWithHashQueryString,1),i.href.toLowerCase()!==location.href.toLowerCase()&&(l=f?lt:t.history_replaceState,l({},document.title,i.href)),r._updateTitle())}}),(function(n){st.warning(new i.Errors.Error({message:"Failed to update address bar.",data:{id:r._getActiveJourneyId(),key:u.templateKey},innerErrors:n}))})):(this._handleStartBoardRoute(e),Q())},n})();n.RouterImpl=c})(yt=t.Internal||(t.Internal={}));t.getAssetDeepLink=nr;t.getGalleryDeepLink=tr;t.getBladeDeepLink=ir;t.createRouter=rr}));define("MsPortalImpl/UI/Hubs/UI.NotificationManager",["require","exports","f","i","o","a","ko","MsPortalImpl/Base/Base.Router",
"MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u,f,e,o,s){"use strict";function ui(n){return ht=new ut(n)}function fi(){return ht}function lt(n,t,i){var r=o.getBladeDeepLink({cloudName:i,name:t.extension},t.detailBlade,"",t.detailBladeInputs,!0);n.route(r)}function at(n,t,i){return b.getWindowId({name:n,cloudName:t},{forceCloudName:!!i})}function ei(n,t){return at(n.name,n.cloudName,t)}function w(n){return n&&n.trim()}function vt(n){if(n.additionalProperties||(n.additionalProperties={}),!n.additionalProperties[it]){var t=n.asset,i=t&&t.assetId,r=void 0;st.isResourceManagerId(i)&&(r=st.parseResourceManagerDescriptor(i).subscription);n.additionalProperties[it]=r}}function yt(n){return vt(n),r.ViewModels.getBladeSelection(n.cloudName,tt,d.BladeNames.AzureMonitoring.EventsBrowseBlade,{queryInputs:{notification:{title:n.title,timestamp:n.timestamp.toString(),subscriptionId:(n.additionalProperties||{})[it]||null}}})}function oi(n,t,i){var b=t.isRecommendation?nt.RecommendationClicked:nt.NotificationClicked,
w,r,h,u;wt(t,b);var c=n.router,f=t.cloudName,s=t.asset;if(s){var l=s.assetType,a=l.toLowerCase(),y=s.extensionName,p=y.toLowerCase(),d=i||!n.extensionManager.getExtension(tt,f)||p===v.Billing.toLowerCase()&&a===et.SubscriptionDetail.toLowerCase()||p===ti.toLowerCase()&&a===et.Deployments.toLowerCase();if(d){w={};w[ii]=e.observable(f);c.route(o.getAssetDeepLink({name:y,cloudName:f},l,s.assetId));return}}if(r=t.uri,r){h=t.uriAction||k.Resources.isUriAbsolute(r)&&ct||g.NavigatePortal;h===ct?n.openWindow(r):h===g.OpenInCurrentTab?gt.location.href=r:c.route(r);return}u=t.linkedBlade;u||i||(u=yt(t));u&&lt(n.router,u,f)}function si(n){switch(n){case 0:return c.Error;case 1:return c.Warning;case 2:return c.Success;case 3:return h;case 4:return c.Information}}function wt(n,t){var u=n.additionalProperties||{},f=n.correlationIds,r;i.extend(u,{status:c[n.status],correlationId:f&&f.join(",")});r=n.asset;bt.trace({source:ni,action:t,assetType:r&&r.assetType||"UnknownAsset",data:u})}function a(n,t,i)
{if(t&&i)return at(t,n,!0)+"."+i}var pt,ut;u.defineProperty(t,"__esModule",{value:!0});var ft=r.Constants,b=r.Extension,k=i.Base,d=k.Constants,et=d.AssetNames,v=d.ExtensionNames,ot=k.Diagnostics,bt=ot.Telemetry,kt=i.Hubs.Notifications,c=kt.NotificationStatus,dt=i.ViewModels,y=r.Hubs.Notifications,g=y.ClientNotificationUriAction,p=r.NotificationManager,nt=s.Action,st=dt.Services.ResourceTypes,gt=window,hi=ot.createLog(n),ht,ni=s.Source.NotificationHub,ti=v.Hubs,tt=v.AzureMonitoring,ii=ft.CloudName.inputBindingKey,ri=b.getHubsWindowId(),l=b.getDescriptor,it="subscriptionId",ct=g.OpenInNewTab,h=c.InProgress,rt=u.keys;t.createNotificationManager=ui;t.getNotificationManager=fi;pt=(function(){function n(n,t){this.extensionWindowId=n;this.notificationDefinition=t}return n})();ut=(function(){function t(n){var t=this,u,f,o,s,h;this._listOfNotifications=e.observableArray();this._notificationDefinitions={};this._extensionNotifications={};this._serverEventToNotificationMap={};this._extensionsHeldByCorrelationId=
{};this._extensionsLoaded={};this._notificationsLifetime=new r.TriggerableLifetimeManager;this._services=n;u=n.rpcClient;f=function(n){return Q(t._extensionsLoaded[n]?!0:t.itemsPromise)};p.addNotificationsEndPoint.register(u,null,(function(n,i){var r=i.srcWindowId;r&&f(r).finally((function(){var i=n.notifications.map((function(n){return t._mapFxNotificationV1ToClientNotification(n,l(r).cloudName)}));i=i.filter((function(n){return!!n}));i.forEach((function(n){return t._addOrUpdateNotification(n,r)}))}))}));p.addNotification2EndPoint.register(u,null,(function(n,i){var r=i.srcWindowId;r&&f(r).finally((function(){var i=t._mapNotificationV2ToClientNotification(r,n.id,n.name,n.status,n.subStatus,n.assetId,n.properties);t._addOrUpdateNotification(i,r)}))}));p.updateNotificationEndPoint.register(u,null,(function(n,i){f(i.srcWindowId).finally((function(){var i=t.notifications().first((function(t){return(t.correlationIds||[]).some((function(t){return t.toLowerCase()===n.id}))}));if(i){var u=n.propertyName.toLowerCase(
),f=n.propertyValue,r=i.correlationIds;u==="correlationid"?(r||(i.correlationIds=r=[]),r.push(f),t._addOrUpdateNotification(i)):u==="percentcomplete"&&(i.percentComplete=f,t._addOrUpdateNotification(i))}}))}));o=function(n,r){var u=r.srcWindowId,f,e;u&&(f=l(u).cloudName,e=i.merge(n),e.forEach((function(n){n.cloudName=n.cloudName||f;t._addOrUpdateNotification(n,u)})))};s=[ri];y.addClientNotificationDefinition.register(u,null,o);y.addClientNotificationsDefinition.register(u,null,o);p.addServerEventsEndPoint.register(u,s,(function(n,i){n.serverEvents.forEach((function(r){r&&f(i.srcWindowId).finally((function(){t._addServerEvent(r,n.cloudName)}))}))}));y.showModalNotification.register(u,s,(function(i){var r=i.notification;return t.addClientNotification(r),t._services.getService("DialogManager").then((function(n){return t.addClientNotification(r),n.showModalDialog({title:r.title,description:r.description,buttons:2,defaultButtonText:i.primaryButtonText,cancelButtonText:i.secondaryButtonText,showErrorIcon:
!0})})).then((function(u){var f=undefined;return u===4?f=i.primaryButtonClickAction:u===1&&(f=i.secondaryButtonClickAction),f===1?t.handleNotificationClick(r):f===2&&n.redirect("/"),u}))}));h=this._services.extensionManager;this.itemsPromise=i.memoizeQ((function(){return h.on("notifications",(function(n){return t._collectNotificationDefinitions(n)}))}));h.onLoad((function(n){return t._collectNotificationDefinitions(n.getManifest("notifications"))}))}return t.prototype.listenForClientNotifications=function(){var i=this,n=[],t=this._services;t.extensionManager.getExtensions().forEach((function(t){t.name===v.AzureInsights?n.push(t.getWindowId()):t.name===tt&&n.push(t.getWindowId())}));t.rpcClient.registerRpcEndPoint(ft.RpcMethods.getClientNotifications,{allowedOrigin:n,handler:function(){return i.notifications()}})},t.prototype.addClientNotification=function(n){vt(n);this._addOrUpdateNotification(n)},t.prototype.showNotificationDetails=function(n){lt(this._services.router,yt(n),n.cloudName)},t.prototype.
handleNotificationClick=function(n,t){oi(this._services,n,t)},u.defineProperty(t.prototype,"notifications",{get:function(){return this._listOfNotifications},enumerable:!0,configurable:!0}),t.prototype.definitionCount=function(){return rt(this._notificationDefinitions).length},t.prototype.newDefinitionCount=function(){return rt(this._extensionNotifications).length},t.prototype.serverEventsCount=function(){return rt(this._serverEventToNotificationMap).length},t.prototype._setLoadedExtension=function(n){this._extensionsLoaded[n]=!0},t.prototype.removeNotification=function(n){var t=this.notifications().first((function(t){return(t.correlationIds||[]).some((function(t){return t===n}))}));t&&this.notifications.remove(t)},t.prototype._addOrUpdateNotification=function(t,r){var u=this,f;t&&w(t.title)&&w(t.description)&&(f=function(){t.clickable=e.observable(!!t.asset||!!t.linkedBlade||!!t.uri);t.descriptionAsHtml||(t.descriptionAsHtml=!1);(t.correlationIds||[]).length||(t.correlationIds=["clientNotification-"+
i.getUniqueId()]);var n=u.notifications(),f=n.first((function(n){var i=n.correlationIds||[];return i.filter((function(n){return t.correlationIds.indexOf(n)!==-1})).length>0}));if(f)if(f.timestamp.getTime()<t.timestamp.getTime()||f.status===h)n.remove(f);else return;n.unshift(t);t.status!==h&&(n=i.stableSort(n,(function(n,t){return n.status===h?t.status===h?0:-1:t.status===h?1:t.timestamp.getTime()-n.timestamp.getTime()})));n.length>100&&n.pop();u.notifications(n);t.isRecommendation&&wt(t,nt.RecommendationAdded);r&&u._holdOntoExtension(r,t)},t.inlineForm?i.require(n.normalize("./UI.ActionableNotifications")).then((function(n){var i=u._notificationsLifetime;n.makeActionable(i,t,u._services);f()})):(t.formSection=undefined,f()))},t.prototype._addServerEvent=function(n,t){var i,r;n.source&&n.operationName&&(i=this._serverEventToNotificationMap[a(t,n.source,n.operationName)],i&&(r=this._mapNotificationV2ToClientNotification(i.extensionWindowId,n.correlationId,i.notificationName,n.status,n.subStatus,
n.assetId,n.properties,n.timestamp,!0),r&&this.addClientNotification(r)))},t.prototype._collectNotificationDefinitions=function(n){var t=this,i=ei(n,!0),e=n.name,r=n.cloudName,f=n.notifications,u;return f&&f.forEach((function(n){var u=a(r,n.eventSource,n.eventType);t._notificationDefinitions[u]||(t._notificationDefinitions[u]=new pt(i,n))})),u=n.notifications2,u&&u.forEach((function(n){var f=n.name,s=a(r,e,f),u,o;t._extensionNotifications[s]=n;u=n.serverEvent;u&&u.operation&&u.source&&(o=a(r,u.source,u.operation),t._serverEventToNotificationMap[o]={extensionWindowId:i,notificationName:f})})),this._extensionsLoaded[i]=!0,!0},t.prototype._holdOntoExtension=function(n,t){var i=this,r=t.correlationIds,f,u;if(r)if(t.status===h){if(f=r.some((function(n){return!!i._extensionsHeldByCorrelationId[n]})),!f){var e=l(n),o=this._services,s=o.extensionManager.getExtension(e.name,e.cloudName);s&&(u=o.rpcClient.acquireWindow(s.getWindowId(),600),r.forEach((function(n){i._extensionsHeldByCorrelationId[n]=u;u.
onDispose((function(){i._extensionsHeldByCorrelationId[n]&&delete i._extensionsHeldByCorrelationId[n]}))})))}}else r.forEach((function(n){var t=i._extensionsHeldByCorrelationId[n];t&&t.dispose()}))},t.prototype._mapNotificationV2ToClientNotification=function(n,t,i,r,u,f,e,o,s){var v,c,h,y,p,w,b;if(s===void 0&&(s=!1),v=l(n),c=this._extensionNotifications[a(v.cloudName,v.name,i)],c&&(h=void 0,y=c.messages.filter((function(n){return n.status.toLowerCase()===r.toLowerCase()})),u?h=y.first((function(n){return n.subStatus&&n.subStatus.toLowerCase()===u.toLowerCase()})):y.length===1&&(h=y[0]),h))return p=h.message,e&&(p=p.format(e)),w={title:h.title,description:p,timestamp:o||new Date,isRecommendation:!1,status:si(h.type),cloudName:v.cloudName,correlationIds:[t],additionalProperties:[],isServerEvent:s},!!(h.assetType||c.assetType)&&f&&(b=h.assetType||c.assetType,w.asset={extensionName:l(n).name,assetType:b,assetId:f}),w},t.prototype._mapFxNotificationV1ToClientNotification=function(n,t){var i=this._formatNotificationV1FromExtensionManifest(
n,t),r,u;if(i)return r={title:i.label,description:i.description,timestamp:i.timestamp,isRecommendation:!1,cloudName:t,percentComplete:i.percentOperationComplete,status:i.state,correlationIds:[],additionalProperties:{}},u=i.clientDetails,i.assetId&&u&&(r.asset={extensionName:l(u.assetOwner).name,assetType:u.assetType,assetId:i.assetId}),i.correlationId&&r.correlationIds.push(i.correlationId),i.operationId&&r.correlationIds.push(i.operationId),i.subscriptionId&&(r.additionalProperties.subscriptionId=i.subscriptionId),r},t.prototype._formatNotificationV1FromExtensionManifest=function(n,t){var r=n.eventType,f=n.source,u,i;if(f&&r&&(u=this._notificationDefinitions[a(t,f,r)],i=void 0,u?(i=u.notificationDefinition,n.label=i.label,n.description=i.message.format(n.descriptionArgs),n.clientDetails=i.assetType?{assetOwner:u.extensionWindowId,assetType:i.assetType}:null):(n.label=n.label||r,n.description=n.description||r,n.assetId||(n.clientDetails=null))),w(n.label)&&w(n.description))return n},t})
();t.NotificationManager=ut}));define("MsPortalImpl.Controls/Controls/Base/OptionsBase",["require","exports","f","o","ko","$","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","_generated/Less/MsPortalImpl.Controls/Controls/Base.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(t){var v=i.Base,p=s.ProvenanceContainer,w=v.Promises.CancelationToken,b=v.Promises.makeCancelable,k=i.Errors,c=jQuery,y="fxc-base",l="fxc-base-fill-container-width",a="fxc-base-fill-container-height",f=[],d=(function(t){function e(n,i,r){var e=t.call(this,n,i,r)||this,s,h,v;e._addDisposablesToCleanUp=function(n){return e.ltm.registerForDispose(n)};e.vm=i;e._options=i;e._widgets=[];e._waitToken=new w;e._createOptions=u.utils.extend({isTrusted:!1,fillBehavior:0},r);e.isTrusted=e._createOptions.isTrusted;n.addClass(y);switch(e._createOptions.fillBehavior){case 1:n.addClass(
l);break;case 2:n.addClass(a);break;case 3:n.addClass(l+" "+a)}s=f.length;s&&(h=f[s-1],h.push(e));var p=e.tabindex=u.observable(0),b=e.disabled=u.observable(!1),c=e.bindingContext||o.getContext(n)||{};return e.$disabled=o.chainDisabledProperties([c.$disabled,b,i.disabled]),v=e.$tabIndex=o.chainTabindexProperties([c.$tabIndex,p],[i.disabled]),e.$focusIndex=u.pureComputed((function(){return v()===null?null:-1})),e}return __extends(e,t),e.prototype.dispose=function(){var n,r;this._checkExistsOrRegisterDestroyId(t.prototype.dispose)||(this._waitToken.cancel(k.disposedCanceledError),this._widgets&&(this._widgets.forEach((function(n){n&&n.dispose()})),this._widgets=null),this.element.removeClass(y+" "+l+" "+a).removeAttr("role"),n=f.length,n&&(r=f[n-1],i.remove(r,this)),t.prototype.dispose.call(this))},r.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),e.prototype.widget=function(){return this.element},r.defineProperty(e.prototype,"widgets",
{get:function(){return this._widgets},enumerable:!0,configurable:!0}),e.prototype.awaitContentRevealed=function(){return Q(!1)},e.beginTracking=function(n){n===void 0&&(n=[]);f.push(n)},e.endTracking=function(){return f.pop()},e.prototype.trigger=function(n,t,i,r){var f=this.options[n],u=this.element;return i=i||{},t=t||c.Event(n),t.type=n,t.target=r||u[0],u.trigger(t,i),!(c.isFunction(f)&&f.apply(u[0],[t].concat(i))===!1||t.isDefaultPrevented())},e.prototype.waitFor=function(n){return b(n,this._waitToken)},e.prototype.sanitizeTemplate=function(t){return t&&!this.isTrusted?h.sanitizeHTML(new p(t,n)).sanitizedMarkup:t},e.prototype._bindDescendants=function(n,t){var i,r,f;n===void 0&&(n={});i=this.options;r=c(t||this.element)[0];u.utils.extend(n,{data:i,func:this});f=o.createChildContext(r,n,{$ctl:this,$vm:i,$disabled:this.$disabled,$tabIndex:this.$tabIndex,$focusIndex:this.$focusIndex},this.bindingContext);u.applyBindingsToDescendants(f,r)},e.prototype._bindElement=function(n,t){var i=c(
t)[0],r=o.createChildContext(i,n,{$ctl:this,$vm:n,$disabled:this.$disabled,$tabIndex:this.$tabIndex,$focusIndex:this.$focusIndex},this.bindingContext);u.applyBindings(r,i)},e.prototype._isRtl=function(){return c("html").attr("dir")==="rtl"},e})(e.Widget);t.Widget=d})(c||(c={})),c}));define("MsPortalImpl/Base/Base.KeyboardHelper",["require","exports","o"],(function(){"use strict";var n;return (function(n){function o(n){switch(n){case 18:case 17:case 40:case 35:case 27:case 36:case 37:case 34:case 33:case 39:case 16:case 9:case 38:return!0;default:return!1}}function s(n){return(n.altKey&&1)|(n.metaKey&&2)|(n.shiftKey&&4)|(n.ctrlKey&&8)}function h(n,r){var f=n?t:i;return f[r]||u[r]}var e=window,f=/Firefox\//i.test(e.navigator.userAgent),r,u,t,i;(function(n){n[n.Equals=f?61:187]="Equals";n[n.Minus=f?173:189]="Minus"})(r=n.VariableKeyCode||(n.VariableKeyCode={})),(function(n){n[n.Alt=18]="Alt";n[n.Backslash=220]="Backslash";n[n.Backspace=8]="Backspace";n[n.Comma=188]="Comma";n[n.Control=17]="Control";
n[n.Delete=46]="Delete";n[n.Down=40]="Down";n[n.End=35]="End";n[n.Enter=13]="Enter";n[n.Equals=r.Equals]="Equals";n[n.Escape=27]="Escape";n[n.F1=112]="F1";n[n.F2=113]="F2";n[n.F10=121]="F10";n[n.Home=36]="Home";n[n.Left=37]="Left";n[n.Menu=93]="Menu";n[n.Minus=r.Minus]="Minus";n[n.PageDown=34]="PageDown";n[n.PageUp=33]="PageUp";n[n.Period=190]="Period";n[n.Right=39]="Right";n[n.Shift=16]="Shift";n[n.Slash=191]="Slash";n[n.Space=32]="Space";n[n.Tab=9]="Tab";n[n.Up=38]="Up";n[n.A=65]="A";n[n.B=66]="B";n[n.C=67]="C";n[n.D=68]="D";n[n.E=69]="E";n[n.F=70]="F";n[n.G=71]="G";n[n.H=72]="H";n[n.I=73]="I";n[n.J=74]="J";n[n.K=75]="K";n[n.L=76]="L";n[n.M=77]="M";n[n.N=78]="N";n[n.O=79]="O";n[n.P=80]="P";n[n.Q=81]="Q";n[n.R=82]="R";n[n.S=83]="S";n[n.T=84]="T";n[n.U=85]="U";n[n.V=86]="V";n[n.W=87]="W";n[n.X=88]="X";n[n.Y=89]="Y";n[n.Z=90]="Z";n[n.Num0=48]="Num0";n[n.Num1=49]="Num1";n[n.Num2=50]="Num2";n[n.Num3=51]="Num3";n[n.Num4=52]="Num4";n[n.Num5=53]="Num5";n[n.Num6=54]="Num6";n[n.Num7=55]="Num7";
n[n.Num8=56]="Num8";n[n.Num9=57]="Num9";n[n.NumPad0=96]="NumPad0";n[n.NumPad1=97]="NumPad1";n[n.NumPad2=98]="NumPad2";n[n.NumPad3=99]="NumPad3";n[n.NumPad4=100]="NumPad4";n[n.NumPad5=101]="NumPad5";n[n.NumPad6=102]="NumPad6";n[n.NumPad7=103]="NumPad7";n[n.NumPad8=104]="NumPad8";n[n.NumPad9=105]="NumPad9"})(u||(u={}));n.isNonWrittenCharacter=o;n.getModifierKeys=s;t=[];t[192]="~";t[219]="{";t[221]="}";t[220]="|";t[59]=":";t[188]="<";t[r.Equals]="+";t[r.Minus]="_";t[49]="!";t[50]="@";t[51]="#";t[52]="$";t[53]="%";t[54]="^";t[55]="&";t[56]="*";t[57]="(";t[48]=")";t[190]=">";t[191]="?";t[32]="SHIFT+SPACE";t[40]="SHIFT+Down";t[38]="SHIFT+Up";i=[];i[220]="\\";i[188]=",";i[r.Minus]="-";i[49]="1";i[50]="2";i[51]="3";i[52]="4";i[53]="5";i[54]="6";i[55]="7";i[56]="8";i[57]="9";i[48]="0";i[190]=".";i[32]="SPACE";i[191]="/";n.mapKeyCodeToString=h})(n||(n={})),n}));define("MsPortalImpl.Controls/Controls/Base/WidgetBindingHandler",["require","exports","ko","MsPortalImpl.Controls/Controls/Base/Base"],(function(
n,t,i,r){"use strict";var u;return (function(n){function t(n,t){return t=t||{controlsDescendantBindings:!0},{init:function(){return t},update:function(t,u,f,e,o){var s=i.unwrap(u());i.ignoreDependencies((function(){var i=r.getWidget($(t),n);i!==null&&i.dispose();s&&(i=new n($(t),s,{bindingContext:o}))}))}}}n.getBindingHandler=t})(u||(u={})),u}));define("_generated/Less/Viva.Controls/Controls/Base/Viva.Base.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,"body>div[data-popup=true].azc-control{z-index:250}.azc-before-color-index-76::before,.azc-color-index-76,div.azc-before-color-k0t2::before,div.azc-color-k0t2,div.msportalfx-bgcolor-k0t2{background-color:#63707e!important}.azc-before-color-index-75::before,.azc-color-index-75,div.azc-before-color-j0t2::before,div.azc-color-j0t2,div.msportalfx-bgcolor-j0t2{background-color:#f0f7b2!important}.azc-before-color-index-74::before,.azc-color-index-74,div.azc-before-color-i0t2::before,div.azc-color-i0t2,div.msportalfx-bgcolor-i0t2{background-color:#ccecdb!important}.azc-before-color-index-73::before,.azc-color-index-73,div.azc-before-color-h0t2::before,div.azc-color-h0t2,div.msportalfx-bgcolor-h0t2{background-color:#ccf0ea!important}.azc-before-color-index-72::before,.azc-color-index-72,div.azc-before-color-g0t2::before,div.azc-color-g0t2,div.msportalfx-bgcolor-g0t2{background-color:#ccf2fc!important}.azc-before-color-index-71::before,.azc-color-index-71,div.azc-before-color-f0t2::before,div.azc-color-f0t2,div.msportalfx-bgcolor-f0t2{background-color:#ccd1e9!important}.azc-before-color-index-70::before,.azc-color-index-70,div.azc-before-color-e0t2::before,div.azc-color-e0t2,div.msportalfx-bgcolor-e0t2{background-color:#e1d3e4!important}.azc-before-color-index-69::before,.azc-color-index-69,div.azc-before-color-d0t2::before,div.azc-color-d0t2,div.msportalfx-bgcolor-d0t2{background-color:#fbcce8!important}.azc-before-color-index-68::before,.azc-color-index-68,div.azc-before-color-c0t2::before,div.azc-color-c0t2,div.msportalfx-bgcolor-c0t2{background-color:#facfd3!important}.azc-before-color-index-67::before,.azc-color-index-67,div.azc-before-color-b0t2::before,div.azc-color-b0t2,div.msportalfx-bgcolor-b0t2{background-color:#ffe8cc!important}.azc-before-color-index-66::before,.azc-color-index-66,div.azc-before-color-a0t2::before,div.azc-color-a0t2,div.msportalfx-bgcolor-a0t2{background-color:#fffccc!important}.azc-before-color-index-65::before,.azc-color-index-65,div.azc-before-color-k0t1::before,div.azc-color-k0t1,div.msportalfx-bgcolor-k0t1{background-color:#8f9ca8!important}.azc-before-color-index-64::before,.azc-color-index-64,div.azc-before-color-j0t1::before,div.azc-color-j0t1,div.msportalfx-bgcolor-j0t1{background-color:#d6e86c!important}.azc-before-color-index-63::before,.azc-color-index-63,div.azc-before-color-i0t1::before,div.azc-color-i0t1,div.msportalfx-bgcolor-i0t1{background-color:#66c592!important}.azc-before-color-index-62::before,.azc-color-index-62,div.azc-before-color-h0t1::before,div.azc-color-h0t1,div.msportalfx-bgcolor-h0t1{background-color:#66d1bf!important}.azc-before-color-index-61::before,.azc-color-index-61,div.azc-before-color-g0t1::before,div.azc-color-g0t1,div.msportalfx-bgcolor-g0t1{background-color:#66d7f7!important}.azc-before-color-index-60::before,.azc-color-index-60,div.azc-before-color-f0t1::before,div.azc-color-f0t1,div.msportalfx-bgcolor-f0t1{background-color:#6674bc!important}.azc-before-color-index-59::before,.azc-color-index-59,div.azc-before-color-e0t1::before,div.azc-color-e0t1,div.msportalfx-bgcolor-e0t1{background-color:#a47aaf!important}.azc-before-color-index-58::before,.azc-color-index-58,div.azc-before-color-d0t1::before,div.azc-color-d0t1,div.msportalfx-bgcolor-d0t1{background-color:#f466ba!important}.azc-before-color-index-57::before,.azc-color-index-57,div.azc-before-color-c0t1::before,div.azc-color-c0t1,div.msportalfx-bgcolor-c0t1{background-color:#f1707b!important}.azc-before-color-index-56::before,.azc-color-index-56,div.azc-before-color-b0t1::before,div.azc-color-b0t1,div.msportalfx-bgcolor-b0t1{background-color:#ffba66!important}.azc-before-color-index-55::before,.azc-color-index-55,div.azc-before-color-a0t1::before,div.azc-color-a0t1,div.msportalfx-bgcolor-a0t1{background-color:#fcf37e!important}.azc-before-color-index-54::before,.azc-color-index-54,div.azc-before-color-k0s1::before,div.azc-color-k0s1,div.msportalfx-bgcolor-k0s1{background-color:#464f59!important}.azc-before-color-index-53::before,.azc-color-index-53,div.azc-before-color-j0s1::before,div.azc-color-j0s1,div.msportalfx-bgcolor-j0s1{background-color:#8ba208!important}.azc-before-color-index-52::before,.azc-color-index-52,div.azc-before-color-i0s1::before,div.azc-color-i0s1,div.msportalfx-bgcolor-i0s1{background-color:#0f5b2f!important}.azc-before-color-index-51::before,.azc-color-index-51,div.azc-before-color-h0s1::before,div.azc-color-h0s1,div.msportalfx-bgcolor-h0s1{background-color:#00856f!important}.azc-before-color-index-50::before,.azc-color-index-50,div.azc-before-color-g0s1::before,div.azc-color-g0s1,div.msportalfx-bgcolor-g0s1{background-color:#008db5!important}.azc-before-color-index-49::before,.azc-color-index-49,div.azc-before-color-f0s1::before,div.azc-color-f0s1,div.msportalfx-bgcolor-f0s1{background-color:#00126b!important}.azc-before-color-index-48::before,.azc-color-index-48,div.azc-before-color-e0s1::before,div.azc-color-e0s1,div.msportalfx-bgcolor-e0s1{background-color:#4e195c!important}.azc-before-color-index-47::before,.azc-color-index-47,div.azc-before-color-d0s1::before,div.azc-color-d0s1,div.msportalfx-bgcolor-d0s1{background-color:#b10069!important}.azc-before-color-index-46::before,.azc-color-index-46,div.azc-before-color-c0s1::before,div.azc-color-c0s1,div.msportalfx-bgcolor-c0s1{background-color:#ae0d1a!important}.azc-before-color-index-45::before,.azc-color-index-45,div.azc-before-color-b0s1::before,div.azc-color-b0s1,div.msportalfx-bgcolor-b0s1{background-color:#bf6900!important}.azc-before-color-index-44::before,.azc-color-index-44,div.azc-before-color-a0s1::before,div.azc-color-a0s1,div.msportalfx-bgcolor-a0s1{background-color:#bfb500!important}.azc-before-color-index-43::before,.azc-color-index-43,div.azc-before-color-k0s2::before,div.azc-color-k0s2,div.msportalfx-bgcolor-k0s2{background-color:#32383f!important}.azc-before-color-index-42::before,.azc-color-index-42,div.azc-before-color-j0s2::before,div.azc-color-j0s2,div.msportalfx-bgcolor-j0s2{background-color:#3d460a!important}.azc-before-color-index-41::before,.azc-color-index-41,div.azc-before-color-i0s2::before,div.azc-color-i0s2,div.msportalfx-bgcolor-i0s2{background-color:#063d20!important}.azc-before-color-index-40::before,.azc-color-index-40,div.azc-before-color-h0s2::before,div.azc-color-h0s2,div.msportalfx-bgcolor-h0s2{background-color:#084c41!important}.azc-before-color-index-39::before,.azc-color-index-39,div.azc-before-color-g0s2::before,div.azc-color-g0s2,div.msportalfx-bgcolor-g0s2{background-color:#005e79!important}.azc-before-color-index-38::before,.azc-color-index-38,div.azc-before-color-f0s2::before,div.azc-color-f0s2,div.msportalfx-bgcolor-f0s2{background-color:#000c48!important}.azc-before-color-index-37::before,.azc-color-index-37,div.azc-before-color-e0s2::before,div.azc-color-e0s2,div.msportalfx-bgcolor-e0s2{background-color:#34113d!important}.azc-before-color-index-36::before,.azc-color-index-36,div.azc-before-color-d0s2::before,div.azc-color-d0s2,div.msportalfx-bgcolor-d0s2{background-color:#760046!important}.azc-before-color-index-35::before,.azc-color-index-35,div.azc-before-color-c0s2::before,div.azc-color-c0s2,div.msportalfx-bgcolor-c0s2{background-color:#740912!important}.azc-before-color-index-34::before,.azc-color-index-34,div.azc-before-color-b0s2::before,div.azc-color-b0s2,div.msportalfx-bgcolor-b0s2{background-color:#804600!important}.azc-before-color-index-33::before,.azc-color-index-33,div.azc-before-color-a0s2::before,div.azc-color-a0s2,div.msportalfx-bgcolor-a0s2{background-color:#807900!important}.azc-before-color-index-32::before,.azc-color-index-32,div.azc-before-color-k2::before,div.azc-color-k2,div.msportalfx-bgcolor-k2{background-color:#d6d7d8!important}.azc-before-color-index-31::before,.azc-color-index-31,div.azc-before-color-j2::before,div.azc-color-j2,div.msportalfx-bgcolor-j2{background-color:#e2e584!important}.azc-before-color-index-30::before,.azc-color-index-30,div.azc-before-color-i2::before,div.azc-color-i2,div.msportalfx-bgcolor-i2{background-color:#55d455!important}.azc-before-color-index-29::before,.azc-color-index-29,div.azc-before-color-h2::before,div.azc-color-h2,div.msportalfx-bgcolor-h2{background-color:#00d8cc!important}.azc-before-color-index-28::before,.azc-color-index-28,div.azc-before-color-g2::before,div.azc-color-g2,div.msportalfx-bgcolor-g2{background-color:#6dc2e9!important}.azc-before-color-index-27::before,.azc-color-index-27,div.azc-before-color-f2::before,div.azc-color-f2,div.msportalfx-bgcolor-f2{background-color:#4668c5!important}.azc-before-color-index-26::before,.azc-color-index-26,div.azc-before-color-e2::before,div.azc-color-e2,div.msportalfx-bgcolor-e2{background-color:#9b4f96!important}.azc-before-color-index-25::before,.azc-color-index-25,div.azc-before-color-d2::before,div.azc-color-d2,div.msportalfx-bgcolor-d2{background-color:#f472d0!important}.azc-before-color-index-24::before,.azc-color-index-24,div.azc-before-color-c2::before,div.azc-color-c2,div.msportalfx-bgcolor-c2{background-color:#dd5900!important}.azc-before-color-index-23::before,.azc-color-index-23,div.azc-before-color-b2::before,div.azc-color-b2,div.msportalfx-bgcolor-b2{background-color:#ffb900!important}.azc-before-color-index-22::before,.azc-color-index-22,div.azc-before-color-a2::before,div.azc-color-a2,div.msportalfx-bgcolor-a2{background-color:#fffc9e!important}.azc-before-color-index-21::before,.azc-color-index-21,div.azc-before-color-k0::before,div.azc-color-k0,div.msportalfx-bgcolor-k0{background-color:#bbc2ca!important}.azc-before-color-index-20::before,.azc-color-index-20,div.azc-before-color-j0::before,div.azc-color-j0,div.msportalfx-bgcolor-j0{background-color:#bad80a!important}.azc-before-color-index-19::before,.azc-color-index-19,div.azc-before-color-i0::before,div.azc-color-i0,div.msportalfx-bgcolor-i0{background-color:#009e49!important}.azc-before-color-index-18::before,.azc-color-index-18,div.azc-before-color-h0::before,div.azc-color-h0,div.msportalfx-bgcolor-h0{background-color:#00b294!important}.azc-before-color-index-17::before,.azc-color-index-17,div.azc-before-color-g0::before,div.azc-color-g0,div.msportalfx-bgcolor-g0{background-color:#00bcf2!important}.azc-before-color-index-16::before,.azc-color-index-16,div.azc-before-color-f0::before,div.azc-color-f0,div.msportalfx-bgcolor-f0{background-color:#00188f!important}.azc-before-color-index-15::before,.azc-color-index-15,div.azc-before-color-e0::before,div.azc-color-e0,div.msportalfx-bgcolor-e0{background-color:#68217a!important}.azc-before-color-index-14::before,.azc-color-index-14,div.azc-before-color-d0::before,div.azc-color-d0,div.msportalfx-bgcolor-d0{background-color:#ec008c!important}.azc-before-color-index-13::before,.azc-color-index-13,div.azc-before-color-c0::before,div.azc-color-c0,div.msportalfx-bgcolor-c0{background-color:#e81123!important}.azc-before-color-index-12::before,.azc-color-index-12,div.azc-before-color-b0::before,div.azc-color-b0,div.msportalfx-bgcolor-b0{background-color:#ff8c00!important}.azc-before-color-index-11::before,.azc-color-index-11,div.azc-before-color-a0::before,div.azc-color-a0,div.msportalfx-bgcolor-a0{background-color:#fff100!important}.azc-before-color-index-10::before,.azc-color-index-10,div.azc-before-color-k1::before,div.azc-color-k1,div.msportalfx-bgcolor-k1{background-color:#a0a5a8!important}.azc-before-color-index-9::before,.azc-color-index-9,div.azc-before-color-j1::before,div.azc-color-j1,div.msportalfx-bgcolor-j1{background-color:#7fba00!important}.azc-before-color-index-8::before,.azc-color-index-8,div.azc-before-color-i1::before,div.azc-color-i1,div.msportalfx-bgcolor-i1{background-color:#007233!important}.azc-before-color-index-7::before,.azc-color-index-7,div.azc-before-color-h1::before,div.azc-color-h1,div.msportalfx-bgcolor-h1{background-color:#008272!important}.azc-before-color-index-6::before,.azc-color-index-6,div.azc-before-color-g1::before,div.azc-color-g1,div.msportalfx-bgcolor-g1{background-color:#0072c6!important}.azc-before-color-index-5::before,.azc-color-index-5,div.azc-before-color-f1::before,div.azc-color-f1,div.msportalfx-bgcolor-f1{background-color:#002050!important}.azc-before-color-index-4::before,.azc-color-index-4,div.azc-before-color-e1::before,div.azc-color-e1,div.msportalfx-bgcolor-e1{background-color:#442359!important}.azc-before-color-index-3::before,.azc-color-index-3,div.azc-before-color-d1::before,div.azc-color-d1,div.msportalfx-bgcolor-d1{background-color:#b4009e!important}.azc-before-color-index-2::before,.azc-color-index-2,div.azc-before-color-c1::before,div.azc-color-c1,div.msportalfx-bgcolor-c1{background-color:#ba141a!important}.azc-before-color-index-1::before,.azc-color-index-1,div.azc-before-color-b1::before,div.azc-color-b1,div.msportalfx-bgcolor-b1{background-color:#eb3c00!important}.azc-before-color-index-0::before,.azc-color-index-0,div.azc-before-color-a1::before,div.azc-color-a1,div.msportalfx-bgcolor-a1{background-color:#fcd116!important}")})
);define("Viva.Controls/Controls/Base/Viva.Base",["require","exports","f","i","o","a","ko","$","MsPortalImpl/Base/JQueryHelper","Viva.Controls/Util/Viva.Util","MsPortalImpl.Controls/Controls/Base/OptionsBase","_generated/Less/Viva.Controls/Controls/Base/Viva.Base.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){function w(n){return n=n||{},n.viewModelType=n.viewModelType||p,n}function b(n,t,i){i=w(i);var r=t;return r&&r instanceof i.viewModelType||(r=new i.viewModelType({ltm:n()}),r.populateFromObject(t)),r}var l=i.initObservable,a=i.isNullOrUndefined,v="azc-control",y="azc-control-disabled",p=(function(n){function t(t){var i=n.call(this,t.ltm)||this;return i.disabled=l(t.disabled,!1),i.loading=l(t.loading,!1),i}return __extends(t,n),t.prototype.dispose=function(){n.prototype.dispose.call(this)},t.prototype.populateFromObject=function(n){t.copyObject(n,this)},t.copyObject=function(n,i){t._copyObject(n,i,[],[])},t._copyObject=function(n,i,r,u){var h=n,s=i,c,o,e;
r.push(n);u.push(i);for(e in h)!h.hasOwnProperty(e)||e.startsWith("#")||e.startsWith("_")&&!e.startsWith("_msPortalFx")||(o=h[e],o!==undefined&&(f.isArray(o)?s[e]=o:o instanceof Date?s[e]=o:typeof o=="object"&&o!==null?(c=r.indexOf(o),c>=0?s[e]=u[c]:(s[e]||(s[e]={}),t._copyObject(o,s[e],r,u))):s[e]=o))},t})(i.ViewModels.Controls.Base.ViewModel),t;n.ViewModel=p;t=(function(n){function t(i,u,f){var s=this,k,d=function(){return k=new r.TriggerableLifetimeManager},c,l,p;if(s=n.call(this,i,b(d,u,f),w(f))||this,s._dataFocusableCallback=e.observable(),s._markFocusFirstElements=e.observable(),s._supportsFocus=e.observable(!1),c=h.Constants,!i||i.length===0)throw new Error("You must specify an element to associate a widget to it. Your element is either null or an empty collection.");return l=s.ltm,k&&l.registerForDispose(k),s._disposablesLifetimeManager=l.createChildLifetime(),t.setupCleanData(),p=s.element,p.addClass(v).attr(c.dataControlAttribute,"true"),e.computed(l,(function(){s.widget().toggleClass(
y,s.$disabled())})),e.computed(l,(function(){var n=s._dataFocusableCallback();a(n)?(p.removeAttr(c.dataCanFocusAttribute),delete p[0][c.dataCanFocusAttribute]):(p.attr(c.dataCanFocusAttribute,"true"),p[0][c.dataCanFocusAttribute]=function(){return n.apply(s,[p,s])})})),e.computed(l,(function(){var t=s._supportsFocus(),n=s._dataFocusableCallback.peek();t?n!==s._setFocus&&s._dataFocusableCallback(s._setFocus):a(n)||s._dataFocusableCallback(null)})),e.computed(l,(function(){var t=s._markFocusFirstElements(),n=t?t():null;s._prevElement&&o(s._prevElement).removeAttr(c.dataFocusFirstAttribute);n&&o(n).attr(c.dataFocusFirstAttribute,"true");s._prevElement=n})),s._initializeSubscriptions(s.options),s}return __extends(t,n),t.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._supportsFocus(!1),this._disposeSubscriptions(),this.element.removeClass(v).removeClass(y).removeAttr(h.Constants.dataControlAttribute).removeAttr("role"),n.prototype.dispose.call(this))}
,u.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),u.defineProperty(t.prototype,"subLifetime",{get:function(){return this._subLifetimeManager},enumerable:!0,configurable:!0}),u.defineProperty(t.prototype,"_disposables",{get:function(){return this._disposablesLifetimeManager},enumerable:!0,configurable:!0}),t.prototype._canSetFocus=function(){var n=this.element;return n.attr(h.Constants.dataCanFocusAttribute)&&!this.$disabled.peek()&&s.isVisible(n)&&!n.is(":disabled")},t.prototype._getElementToFocus=function(){return this.widget()[0]},t.prototype._setFocus=function(){if(this._canSetFocus()){var n=this._getElementToFocus();if(n)return n.focus(),!0}return!1},t.prototype._disposeSubscriptions=function(){this._subLifetimeManager&&(this._subLifetimeManager.dispose(),this._subLifetimeManager=null)},t.prototype._initializeSubscriptions=function(){this._disposeSubscriptions();this._subLifetimeManager=this.ltm.createChildLifetime()},t.prototype.
_afterCreate=function(){},t.setupCleanData=function(){t._cleanData||(t._cleanData=o.cleanData,o.cleanData=function(n){for(var r,u=0,i=void 0;(i=n[u])!==null&&i!==undefined;u++)o.hasData(i)&&(o(i).triggerHandler(t._widgetRemoveEvent),r=!0);r&&t._cleanData.call(o,n)})},t})(c.Widget);t._widgetEventNamespace=".azcWidget";t._widgetRemoveEvent="remove"+t._widgetEventNamespace;n.Widget=t})(l||(l={})),l}));define("Viva.Controls/Util/Viva.DateUtil",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function b(n,t,i){return i=i?i:"0",t+1>=n.length&&(n=Array(t+1-n.length).join(i)+n),n}function f(n,t,i){return b(n+"",t,i)}function a(n,t){return n.substr(Math.max(n.length-t,0))}function r(n,t){return a(n+"",t)}function u(n,t){return a(f(n,t,"0"),t)}function v(n){return n=n%12,n===0?12:n}function o(n){return n&&n.split("").reverse().join("")}function e(n){return n&&"\\"+n.split("").join("\\")}function k(i){var o=i.length,h,c,l,a,s=n.getLocaleValues();switch(i[0]){case"y":switch(
o){case 3:return f(t.getFullYear(),o);case 1:return parseInt(r(t.getFullYear(),2),10)+"";default:return u(t.getFullYear(),o)}case"M":switch(o){case 4:return e(s.months[t.getMonth()]);case 3:return e(s.monthsAbbr[t.getMonth()]);case 2:return u(t.getMonth()+1,2);default:return r(t.getMonth()+1,2)}case"d":switch(o){case 4:return e(s.days[t.getDay()]);case 3:return e(s.daysAbbr[t.getDay()]);case 2:return u(t.getDate(),2);default:return r(t.getDate(),2)}case"h":return o===2?u(v(t.getHours()),2):r(v(t.getHours()),2);case"H":return o===2?u(t.getHours(),2):r(t.getHours(),2);case"m":return o===2?u(t.getMinutes(),2):r(t.getMinutes(),2);case"s":switch(o){case 4:return u(t.getMilliseconds(),3);case 3:return r(t.getMilliseconds(),3);case 2:return u(t.getSeconds(),2)}return r(t.getSeconds(),2);case"t":return o===2?s.ampm[t.getHours()<12?0:1]:s.ampmAbbr[t.getHours()<12?0:1];case"z":return(h=-t.getTimezoneOffset()/60,c=h<0,c&&(h=-h),l=parseInt(h+"",10),a=(h-l)*60,o===3)?(c?"-":"+")+f(l,2)+":"+f(a,2):(c?
"-":"+")+f(l,o);case"/":return s.dateSeparator;case":":return s.timeSeparator}return""}function d(n){return o(k(n))}function g(i){for(var r,s,f=[],u=1;u<arguments.length;u++)f[u-1]=arguments[u];return f.length?(r=f[0],s=n.getLocaleValues(),r=s.standard[r]||r,r=r.replace(/'([^']*)'/g,(function(n,t){return e(t)})),t=i,o(o(r).replace(/(y{1,5}|M{1,4}|d{1,4}|h{1,2}|H{1,2}|m{1,2}|s{1,4}|t{1,2}|z{1,3}|\/|:)(?!\\)/g,d).replace(/\\(?!\\)/g,""))):p.apply(i,arguments)}function nt(n,t){var i;return c(n)?null:(i=n.getTime()+n.getTimezoneOffset()*6e4,new Date(i+t*6e4))}function tt(){return s===undefined&&(s=(new Date).getTimezoneOffset()),s}function it(n,t){var i;return c(n)?null:(i=n.getTime()-t*6e4,new Date(i-n.getTimezoneOffset()*6e4))}function rt(n,t){return n&&t?n.getFullYear()===t.getFullYear()?n.getMonth()===t.getMonth()?n.getDate()===t.getDate()?0:n.getDate()<t.getDate()?-1:1:n.getMonth()<t.getMonth()?-1:1:n.getFullYear()<t.getFullYear()?-1:1:-1}function ut(n,t){return n&&t?n.getHours()===t.getHours(
)?n.getMinutes()===t.getMinutes()?n.getSeconds()===t.getSeconds()?0:n.getSeconds()<t.getSeconds()?-1:1:n.getMinutes()<t.getMinutes()?-1:1:n.getHours()<t.getHours()?-1:1:-1}function ft(n,t){return n instanceof Date&&t instanceof Date&&l(n)===l(t)}var h=i,c=h.isNullOrUndefined,y=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(i.DateUtil.DateTimeRange),t,s;n.DateTimeRange=y;var p=Date.prototype.toString,w=i.uncurryThis,l=h.toSeconds;n.getLocaleValues=i.getLocaleValues;n.setLocaleValues=i.setLocaleValues;n.toRelativeString=w(i.dateToRelativeString);n.toString=g;n.parse=i.dateParse;n.getDateWithOffset=nt;n.getDefaultTimezoneOffset=tt;n.getLocalDate=it;n.compareDatePartOnly=rt;n.compareTimePartOnly=ut;n.areDatesEqualBySeconds=ft})(r||(r={})),r}));define("MsPortalImpl/Base/Base.ImageHelper",["require","exports","f","o","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.SvgHelper"],
(function(n,t,i,r,u,f,e,o){"use strict";function h(t,r){var f=t&&t.type,u=t&&t.options||{},v,e,y;return v=f===0||f===1||f===2?Q(o.getSvgReferenceOrFallBackToData(t,u,r)):i.require("MsPortalImpl/Base/Base.ImageLibrary").then((function(t){var h,i,e;return f>=999?(h=!u.title?"":l(new c(u.title,n)).sanitizedMarkup,'<img alt="'+h+'" aria-hidden="'+!u.title+'" src="'+s(t[f]&&t[f].data)+'"/>'):(i=o.getSvgReferenceOrFallBackToData(t[f],u,r),e=u._badgeWidth,e&&(i=i.replace(o.SvgPlaceholderClass,o.SvgBadgeClass),typeof e=="number"&&(i=i.replace("<svg ",'<svg style="width:{0}%; height:{0}%" '.format(e)))),i)})),u.badge&&(e=u.badge.width,e&&typeof e=="number"||(e=a),y=i.extend2(u.badge.image,{options:{_badgeWidth:e}}),v=Q.spread([v,h(y,r)],(function(n,t){return n+t}))),v}function v(n){var t=null;return n&&n.type===2&&f.sanitizeUri(n.data)&&(t=s(n.data)),t}r.defineProperty(t,"__esModule",{value:!0});var c=e.ProvenanceContainer,s=i.encodeAttribute,l=u.sanitizeHTML,a=40;t.GetImageData=h;t.GetImageUri=v}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.Image",["require","exports","f","ko","MsPortalImpl/Base/Base.ImageHelper"],(function(n,t,i,r,u){"use strict";var f;return (function(){function f(n,i,f){return u.GetImageData(n,f).then((function(n){return r.utils.parseHtmlFragment(n).map((function(n){var i=n.tagName;return i&&i.length===3&&i.toLowerCase()==="svg"&&$(n).attr(t),n}))}))}function e(n,t){$(n).empty().append(t.map((function(n){return n.cloneNode(!0)})))}var t={"aria-hidden":!0,role:"presentation",focusable:!1},n=!i.isFeatureEnabled("nokosvgcaching")&&new i.Map;r.bindingHandlers.image={init:function(){return{controlsDescendantBindings:!0}},update:function(t,u){var h=r.unwrap(u()),s,o;h&&(s=JSON.stringify(h),o=n&&n.get(s),o||(o=f(h,s,t),n&&n.set(s,o)),i.tryImmediateResolve(o,(function(n){e(t,n)})))}}})(f||(f={})),f}));define("Viva.Controls/Controls/Base/Viva.EditableControl",["require","exports","o","ko","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Base/Viva.Base"],(function(n,t,i,
r,u,f){"use strict";var e;return (function(n){var t="azc-editableControl",e="azc-is-edited",h="",o=(function(n){function t(t){var i=n.call(this,t)||this;return i.name=null,i.value=r.observable(),i.dirty=r.observable(!1),i.focused=r.observable(!1),i}return __extends(t,n),t})(f.ViewModel),s;n.ViewModel=o;s=(function(n){function f(i,f,e){var s=this,c,l,a;return e=e||{},e.viewModelType=e.viewModelType||o,s=n.call(this,i,f,e)||this,s._ready=!0,s.element.addClass(t).attr(u.Constants.dataEditableAttribute,"true").html(h),c=s.options,l=c.dirty,l||(a=c.value()||"",c.dirty=r.observable(!1),r.reactor(s.ltm,(function(){var n=c.value()||"";c.dirty(!s._isSameValue(n,a))}))),s._initializeSubscriptions(c),s._supportsFocus(!0),s}return __extends(f,n),f.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this.element.removeClass(t).removeClass(e).removeAttr(u.Constants.dataEditableAttribute),n.prototype.dispose.call(this))},i.defineProperty(f.prototype,"options",{get:function(
){return this._options},enumerable:!0,configurable:!0}),f.prototype._isSameValue=function(n,t){return n==t},f.prototype._initializeSubscriptions=function(t){var i=this,r,u;n.prototype._initializeSubscriptions.call(this,t);this._ready&&(r=function(n){i.element.toggleClass(e,n)},r(t.dirty()),u=this.subLifetime,t.dirty.subscribe(u,r),this.options.focused.subscribe(u,(function(n){n||i.element.trigger("editableControl-blur",{widget:i,model:i.options})})))},f})(f.Widget);n.Widget=s})(e||(e={})),e}));define("Viva.Controls/Controls/Base/Viva.Validators",["require","exports","f","i","o","ko","$","Viva.Controls/Util/Viva.DateUtil","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function rt(n){return(n||"").toLowerCase()}function ut(n){return(n||"").toLocaleLowerCase()}function si(n){return n().map((function(n){var i=n.validationState(),t=i!==1,r=t?n.passMessage&&n.passMessage():n.
message();return t&&n.type===21&&(r=n.message()),{valid:t,message:r,state:i,type:n.type}})).filter((function(n){return n}))}var v,y,d,ft,et,tt,ot,st,ht,ct,lt,at,p,vt,yt,pt,g,it,wt,bt,kt,nt,dt,gt,ni,ti,ii,ri,ui;u.defineProperty(t,"__esModule",{value:!0});var w=i,fi=w.Base,ei=w.ViewModels,a=w.isNullOrUndefined,l=s.Viva.Validators,b=l.DateTimeRange,oi=fi.Diagnostics.createLog(n),k=i.regexEscape;v=(function(){function n(n,t,i,r){var u=this,s=this._ltm=n.createChildLifetime(),e,o;this.fxViewModel=t;e=i;t&&t.message&&(e=t.message);o=r;o=t&&t.successMessage?t.successMessage:r&&r.length?r:null;this.message=f.observable(e);this.passMessage=f.observable(o);this.validationState=f.observable(0);this.validate=f.observable();this.isEmptyValid=f.observable(!1);this.type=t&&t.type;this.valid=f.computed(s,(function(){return u.validationState()===2}));this.validate.subscribe(s,(function(n){u.validationState(u._validate(n))}))}return n.prototype.dispose=function(){var n=this._ltm;n&&(n.dispose(),this._ltm=null)}
,n.prototype._validate=function(){return 0},n})();t.Validator=v;y=(function(n){function t(t,i,r,u,f,e){var o=this;return i&&i.type===2&&(r=i.pattern,u=undefined),o=n.call(this,t,i,f||l.match.format(i.pattern),e||"Match found.")||this,o._expression=new RegExp(r,u),o}return __extends(t,n),t.prototype._validate=function(n){return(a(n)||e.trim(n)==="")&&this.isEmptyValid()?2:this._expression.test(n||"")?2:1},t})(v);t.Match=y;d=(function(n){function t(t,i,r,u,f,e){var o=this;return i&&i.type===3&&(r=i.pattern,u=undefined),o=n.call(this,t,i,f||l.notMatch.format(i.pattern),e||l.Success.notMatch)||this,o._expression=new RegExp(r,u),o}return __extends(t,n),t.prototype._validate=function(n){return(a(n)||e.trim(n)==="")&&this.isEmptyValid()?2:this._expression.test(n||"")?1:2},t})(v);t.NotMatch=d;ft=(function(n){function t(t,i){return n.call(this,t,i,k(i.searchString),"i",l.contains.format(i.message),l.Success.contains.format(i.searchString))||this}return __extends(t,n),t})(y);t.Contains=ft;et=(function(n)
{function t(t,i){return n.call(this,t,i,k(i.searchString),"i",l.notContains.format(i.searchString),l.Success.notMatch.format(i.searchString))||this}return __extends(t,n),t})(d);t.NotContains=et;tt=(function(n){function t(t,i,r,u,f){var e=this;return i&&i.type===6&&(r=i.characters),n.call(this,t,i,"["+k(r)+"]","",u||l.containsCharacters.format(r),f||l.Success.containsCharacters.format(r))||this}return __extends(t,n),t})(y);t.ContainsCharacters=tt;ot=(function(n){function t(t,i){return n.call(this,t,i,"["+k(i.characters)+"]","",l.notContainsCharacters.format(i.characters),l.Success.notContainsCharacters.format(i.characters))||this}return __extends(t,n),t})(d);t.NotContainsCharacters=ot;st=(function(n){function t(t,i){return n.call(this,t,i,"[0-9]",undefined,l.hasDigit,l.Success.hasDigit)||this}return __extends(t,n),t})(y);t.HasDigit=st;ht=(function(n){function t(t,i){return n.call(this,t,i,"[A-Za-z]",undefined,l.hasLetter,l.Success.hasLetter)||this}return __extends(t,n),t})(y);t.HasLetter=ht;ct=(function(
n){function t(t,i){return n.call(this,t,i,"[A-Z]",undefined,l.hasUpperCaseLetter,l.Success.hasUpperCaseLetter)||this}return __extends(t,n),t})(y);t.HasUpperCaseLetter=ct;lt=(function(n){function t(t,i){return n.call(this,t,i,"[a-z]",undefined,l.hasLowerCaseLetter,l.Success.hasLowerCaseLetter)||this}return __extends(t,n),t})(y);t.HasLowerCaseLetter=lt;at=(function(n){function t(t,i){return n.call(this,t,i,"!@#$%^&*()_+-={}|[]\\:\";'<>,.?/~`",l.hasPunctuation,l.Success.hasPunctuation)||this}return __extends(t,n),t})(tt);t.HasPunctuation=at;p=(function(n){function t(t,i,r){var u=n.call(this,t,i,r,l.Success.equals.format(f.unwrap(i.compareTo)))||this;return u._compareTo=f.isObservable(i.compareTo)?i.compareTo:function(){return i.compareTo},u}return __extends(t,n),t.prototype._validate=function(n){return this._compare(n,this._compareTo())?2:1},t.prototype._compare=function(){return!1},t})(v);t.Compare=p;vt=(function(n){function t(t,i){return n.call(this,t,i,l.equals.format(f.unwrap(i.compareTo)))||
this}return __extends(t,n),t.prototype._compare=function(n,t){return n===t},t})(p);t.Equals=vt;yt=(function(n){function t(t,i){return n.call(this,t,i,l.caseInsensitiveComparison)||this}return __extends(t,n),t.prototype._compare=function(n,t){return rt(n)===rt(t)},t})(p);t.CaseInsensitiveComparison=yt;pt=(function(n){function t(t,i){return n.call(this,t,i,l.localeAwareCaseInsensitiveComparison)||this}return __extends(t,n),t.prototype._compare=function(n,t){return ut(n)===ut(t)},t})(p);t.LocaleAwareCaseInsensitiveComparison=pt;g=(function(n){function t(t,i,r,u,f,e){var o=this;return i&&i.type===14&&(r=i.min,u=i.max),o=n.call(this,t,i,f||l.lengthRange.format(r,u),e||l.Success.lengthRange.format(r,u))||this,o._min=r,o._max=u,o}return __extends(t,n),t.prototype._validate=function(n){var t,i;return(n=e.trim(n),(a(n)||e.trim(n)==="")&&this.isEmptyValid())?2:(t=0,a(n)||(t=n.length),i=0,a(this._min)||(i=this._min),t>=i&&(a(this._max)||t<=this._max))?2:1},t})(v);t.LengthRange=g;it=(function(n){function t(
t,i,r,u){var f=this;return i&&i.type===15&&(r=i.min),n.call(this,t,i,r,null,u||l.minLength.format(r),l.Success.minLength.format(r))||this}return __extends(t,n),t})(g);t.MinLength=it;wt=(function(n){function t(t,i){return n.call(this,t,i,0,i.max,l.maxLength.format(i.max),l.Success.maxLength.format(i.max))||this}return __extends(t,n),t})(g);t.MaxLength=wt;bt=(function(n){function t(t,i){return n.call(this,t,i,1,l.required)||this}return __extends(t,n),t})(it);t.Required=bt;kt=(function(n){function t(t,i){return n.call(this,t,i,l.numeric,l.Success.numeric)||this}return __extends(t,n),t.prototype._validate=function(n){return(a(n)||e.trim(n)==="")&&this.isEmptyValid()?2:!a(n)&&n!==""?isNaN(+n)?1:2:1},t})(v);t.Numeric=kt;nt=(function(n){function t(t,i,r,u,e,o){var c=this,s,h;return i&&i.type===18&&(r=i.min,u=i.max),s=r,f.isObservable(s)||(s=function(){return r}),h=u,f.isObservable(h)||(h=function(){return u}),c=n.call(this,t,i,e||l.valueRange.format(s(),h()),o||l.Success.valueRange.format(s(),h()))||
this,c.min=s,c.max=h,c}return __extends(t,n),t.prototype._validate=function(n){var t;return(a(n)||e.trim(n)==="")&&this.isEmptyValid()?2:(a(n)||n==="")&&a(this.min())&&a(this.max())?2:!a(n)&&(typeof n=="string"||typeof n=="number")&&n!==""&&(t=+n,!isNaN(t))?!a(this.min())&&t<this.min()?1:!a(this.max())&&t>this.max()?1:2:1},t})(v);t.ValueRange=nt;dt=(function(n){function t(t,i,r){var u=this;return i&&i.type===19&&(r=i.min),n.call(this,t,i,r,null,l.minValue.format(r),l.Success.minValue.format(r))||this}return __extends(t,n),t})(nt);t.MinValue=dt;gt=(function(n){function t(t,i,r){var u=this;return i&&i.type===20&&(r=i.max),n.call(this,t,i,null,r,l.maxValue.format(r),l.Success.maxValue.format(r))||this}return __extends(t,n),t})(nt);t.MaxValue=gt;ni=(function(n){function t(t,i,r,u,f){var e=this,o;return o=f?f:i&&r?b.minMax.format(i.toUTCString(),r.toUTCString()):i?b.min.format(i.toUTCString()):r?b.max.format(r.toUTCString()):b.correctFormat,e=n.call(this,t,null,o)||this,e.minDateTime=i,e.maxDateTime=
r,e.timezoneOffset=u,e}return __extends(t,n),t.prototype._validate=function(n){if(a(n))return this.isEmptyValid()?2:1;var t=n.getTime();return!a(this.minDateTime)&&Math.floor(t/1e3)<Math.floor(o.getDateWithOffset(this.minDateTime,this.timezoneOffset()).getTime()/1e3)?1:!a(this.maxDateTime)&&Math.floor(t/1e3)>Math.floor(o.getDateWithOffset(this.maxDateTime,this.timezoneOffset()).getTime()/1e3)?1:2},t})(v);t.DateTimeRange=ni;ti=(function(){function n(n,t){this.promise=n;this.asyncRequestId=t}return n})();ii=(function(n){function t(t,i,r){var u=n.call(this,t,i,"")||this,f;return i&&i.type?(f=function(n){return i.validate(n)},u._validationHandler=u._convertValidateFunction(f,r)):u._validationHandler=i,u._pendingAsyncRequests=[],u._latestValidationAsyncRequestId=null,u}return __extends(t,n),t.prototype._validate=function(n){var i=this,r=!1,t;return this._validationHandler?(this._latestValidationAsyncRequestId=w.getUniqueId(),t=this._validationHandler(n),this._pendingAsyncRequests.push(new ti(t,
this._latestValidationAsyncRequestId)),t.then((function(n){i._updateValidationResult(t,n,2)})).catch((function(n){i._updateValidationResult(t,n&&n.message||"",1)})).finally((function(){r=!0})),r)?(this._removePendingAsyncRequest(t),this.validationState()):3:2},t.prototype._convertValidateFunction=function(n,t){return function(u){var e=n(u),f;return e?Q(e).then((function(n){if(n){if(n.valid)return n.message;throw r.createError(n.message);}else{var u=r.createError(c.Field.invalidValidationResult,{data:{message:"CustomValidation function '"+t+"' was resolved with invalid ValidationResult: "+n+". ValidationResult.message is required to inform customer why customer's input is invalid."}}),f=-1,e=void 0;t&&(f=t.indexOf("-"))>0&&(e=t.substr(0,f));r.Rpc.internalClient.log(e||"fx",{level:2,code:0,area:"Viva.Validators",message:i.getLogFriendlyMessage(u)});throw u;}})):(f=r.createError("Extension validation handler did not return a promise. Proxied observable id is: '{0}'".format(t)),oi.error(f),Q.reject(
f))}},t.prototype._updateResult=function(n,t){n&&this.message(n);this.validationState(t)},t.prototype._updateValidationResult=function(n,t,i){var r;r=this._pendingAsyncRequests.length<=1?this._pendingAsyncRequests.pop():this._removePendingAsyncRequest(n);r&&r.asyncRequestId===this._latestValidationAsyncRequestId&&this._updateResult(t,i)},t.prototype._removePendingAsyncRequest=function(n){for(var t=0,i=-1,r=null,t=0;t<this._pendingAsyncRequests.length;t++)if(this._pendingAsyncRequests[t].promise===n){i=t;break}return i>=0?(r=this._pendingAsyncRequests[i],this._pendingAsyncRequests.splice(i,1),r):null},t})(v);t.CustomAsyncValidator=ii;ri=(function(n){function t(t,i){var r=this;return i instanceof ei.InvalidValidation?n.call(this,t,i,l.invalid)||this:n.call(this,t,null,i||l.invalid)||this}return __extends(t,n),t.prototype._validate=function(){return 1},t})(v);t.Invalid=ri;ui=(function(n){function t(t,i){var r=n.call(this,t,i,"",l.Success.uri)||this;return r._options=i.options,r}return __extends(
t,n),t.prototype._validate=function(n){var t=h.validateAbsoluteHttpUri(n,this._options);return t?2:1},t})(v);t.Uri=ui;t.getValidationResults=si}));define("Viva.Controls/Controls/Base/Viva.ValidatableControl",["require","exports","f","o","ko","Viva.Controls/Controls/Base/Viva.EditableControl","Viva.Controls/Controls/Base/Viva.Validators"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){var t="azc-validatableControl",o=(function(n){function t(t){var i=n.call(this,t)||this;i.enableValidation=u.observable(!0);i.validationState=u.observable(0);i.validators=u.observableArray();i.validationPlacements=u.observableArray();i.validationResults=u.observableArray();var r=i.validationState(),f=i.validators().length,e=!i.enableValidation()||f===0||i.enableValidation()&&f>0&&(r===0||r===2);return i.valid=u.observable(e),i}return __extends(t,n),t})(f.ViewModel),s;n.ViewModel=o;s=(function(n){function f(i,r,u){var f=this;return u=u||{},u.viewModelType=u.viewModelType||o,f=n.call(this,i,r,u)||this,
f._validationStateInternal=null,f.element.addClass(t),f._initializeValidation(),f._initializeSubscriptions(f.options),f._initialized=!0,f.options.dirty()&&f.validate(!0),f._validationState.notifySubscribers(f._validationState()),f}return __extends(f,n),f.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(n.prototype.dispose.call(this),this.element.removeClass(t),i.disposeDisposable([].concat(this.options.validators.removeAll(),this.options.validationPlacements.removeAll())))},r.defineProperty(f.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),f.prototype.validate=function(n){var u=this,t,i,f=!!n,r;this._shouldValidate()&&(r=this.options,t=r.validators(),t&&t.length>0&&(i=r.value(),t.forEach((function(n){var r=n&&n.fxViewModel&&n.fxViewModel.map,t,e=function(i){i===null&&(i=undefined);i!==n.validate()?n.validate(i):i===undefined&&i===n.validate()||f?n.validate.notifySubscribers(i):t!==undefined&&n.validationState(
t)};r?n.validationState.fxOnceAndRun(u._validationLifetimeManager,(function(u){t=u;n.validationState(3);Q(r(i)).then(e).catch((function(){return n.validationState()===3&&n.validationState(t)}))}),(function(n){return n!==3})):e(i)}))))},f.prototype._initializeSubscriptions=function(t){var i=this,r,f,e,o;n.prototype._initializeSubscriptions.call(this,t);r=this.options;f=this.ltm;r.value.subscribe(f,(function(n){i._onValueChanged(n)}));e=this._validationState;e||(e=this._validationState=u.observable(0));e.subscribe(f,(function(n){r.validationState(n)}));this._validationStateInternal&&(o=function(n){var t=i._validationLifetimeManager;t&&(t.dispose(),i._validationLifetimeManager=null);n&&(t=i._validationLifetimeManager=f.createChildLifetime(),i._validationStateInternal.subscribe(t,(function(n){e(n)})),r.dirty()&&i.validate(!0))},r.enableValidation.subscribe(f,o),o(r.enableValidation()));t.validators.subscribeArrayChanges(f,(function(){i._onValidatorsChanged()}),(function(){i._onValidatorsChanged()}))},f.prototype.
_afterCreate=function(){n.prototype._afterCreate.call(this);this._initializeValidationPlacements()},f.prototype._onValueChanged=function(){this._hasValidators()&&this._valueChangeValidation()},f.prototype._valueChangeValidation=function(){this.validate()},f.prototype._initializeValidationPlacements=function(){var n=this,t=this.options.validationPlacements.removeAll();this.options.validationPlacements.subscribeArrayChanges(this.ltm,(function(t){t.initialize(n.element,n.options)}),(function(n){n.dispose()}));this.options.validationPlacements(t)},f.prototype._hasValidators=function(){var n=this.options.validators();return this.options.enableValidation()&&!this.$disabled()&&n&&n.length>0},f.prototype._initializeValidation=function(){var i=this,n=this.options,t=this.ltm;this._valid=u.computed(t,(function(){var t=!n.enableValidation()||n.validators().length===0||n.enableValidation()&&n.validators().length>0&&(n.validationState()===0||n.validationState()===2);return t!==n.valid.peek()&&n.valid(t),
t}));this._validationStateInternal=u.computed(t,(function(){var t=0;if(i._shouldValidate()&&(n.validators().some((function(n){return t=n.validationState(),t===1||t===3||t===0})),t===1)){var r=0,u=0,f=!0;n.validators().forEach((function(n){var t=n.validationState();n.maxDateTime?(r++,t===2&&u++):t!==2&&(f=!1)}));f&&r>0&&u>0&&(t=2)}return t}));u.reactor(t,(function(){n.validationResults(e.getValidationResults(n.validators))}))},f.prototype._onValidatorsChanged=function(){this._initialized&&this.validate(!0)},f.prototype._shouldValidate=function(){var n=this.options.validators();return this.options.enableValidation()&&!this.$disabled()&&n&&n.length>0?!0:!1},f})(f.Widget);n.Widget=s})(o||(o={})),o}));define("MsPortalImpl/Interactions/Interactions.DismissHandler",["require","exports","f","i","o","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f){"use strict";function k(n,t){c.error("An error occurred on dismiss. Unregister might have been forgotten on cleanup of the dismissable element. DismissHandle log name: {0}".
format(t&&t.logName||"unknown"),0,n)}function d(n){var i="function",t=!!n;return n.shouldDismissOnFocusOutFn&&(t=t&&typeof n.shouldDismissOnFocusOutFn===i),n.restoreFocus&&(t=t&&typeof n.restoreFocus===i),n.shouldDismissOnMouseDownFn&&(t=t&&typeof n.shouldDismissOnMouseDownFn===i),n.shouldDismissOnMouseWheelFn&&(t=t&&typeof n.shouldDismissOnMouseWheelFn===i),t}function o(n){var t=n&&typeof n.dismissFn=="function"&&d(n);return t||c.error("The dismiss handle object is null or malformed."),t}function h(n){var r,i,t,u;if(e.length)for(r=e[e.length-1],i=r.length-1;i>=0;i--){t=r[i];try{u=n(t);u!==0&&(t.dismissFn(),u===2&&t.restoreFocus&&t.restoreFocus())}catch(f){k(f,t)}}}function v(n){h((function(t){return t.shouldDismissOnFocusOutFn&&o(t)?t.shouldDismissOnFocusOutFn(n.target):0}))}function y(n){n.keyCode===27&&h((function(n){return o(n)?2:0}))}function s(n){h((function(t){return t.shouldDismissOnMouseDownFn&&o(t)?t.shouldDismissOnMouseDownFn(n.target,n):0}))}function p(n){l||(l=!0,b.setTimeout((function(
){l=!1}),250),h((function(t){return t.shouldDismissOnMouseWheelFn&&o(t)?t.shouldDismissOnMouseWheelFn(n.target):0})))}function w(n){h((function(t){return t.shouldDismissOnMouseWheelFn&&t.shouldDismissOnScroll&&o(t)&&!$(n.target).hasClass("azc-resize")?t.shouldDismissOnMouseWheelFn(n.target):0}))}function g(){var n=a.body;n.addEventListener(f.default.focus,v,!0);n.addEventListener(f.default.keydown,y,!0);n.addEventListener(f.default.mousedown,s,!0);n.addEventListener(f.default.touchstart,s,!0);n.addEventListener(f.default.pointerdown,s,!0);n.addEventListener(f.default.mousewheel,p,!0);n.addEventListener(f.default.scroll,w,!0)}function nt(){var n=a.body;n.removeEventListener(f.default.focus,v,!0);n.removeEventListener(f.default.keydown,y,!0);n.removeEventListener(f.default.mousedown,s,!0);n.removeEventListener(f.default.touchstart,s,!0);n.removeEventListener(f.default.pointerdown,s,!0);n.removeEventListener(f.default.mousewheel,p,!0);n.removeEventListener(f.default.scroll,w,!0);e.length=0}function tt(
n,t){if(!o(n))throw new Error("The dismiss handle object is null or malformed.");e.some((function(t){return t.indexOf(n)>=0}))||((t||!e.length)&&e.push([]),e.last().push(n))}function it(n){e.forEach((function(t){t.remove(n)}));e=e.filter((function(n){return n.length!==0}))}function rt(n,t){var u="DismissHandle for '"+n.logName+"': previouslyFocusedElement";if(t){if(typeof t.focus!="function")return c.error(r.createError(u+" focus member is not a function. _previouslyFocusedElement.focus: "+t.focus,{data:{previous:i.getObjectDescriptor(t)}})),!1}else return c.warning(u+" was not defined."),!1;return!0}u.defineProperty(t,"__esModule",{value:!0});var b=window,a=document,c=i.Base.Diagnostics.createLog(n),l=!1,e=[];t.initialize=g;t.dispose=nt;t.register=tt;t.unregister=it;t.validatePreviousFocusedElement=rt}));define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding",["require","exports","f","o","ko","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.ImplUtils"],(function(n,
t,i,r,u,f,e){"use strict";var o;return (function(){function o(n,t){var i=u.unwrap(n()),r=c(i,t);return function(){return r}}function c(n,t){if(n&&typeof n=="object"){var e={};return r.getOwnPropertyNames(n).forEach((function(r){if(i.isSerializableProperty(r)){var o=u.unwrap(n[r]);if(f.getWhitelistedAttr().indexOf(r)>-1)e[r]=o?o:null;else switch(r){case"href":case"poster":case"src":o?f.validateUriOrBlank(o)||r==="src"&&f.validateDataImage(o)?e[r]=o:t.push('The value "'+o+'" is not a valid absolute URI, which should start with "http://" or "https://".'):e[r]=null;break;default:t.push("The attribute '{0}' is not allowed.".format(r))}}})),e}return null}var s=i.Base,l=s.Diagnostics,h="Sanitization error found in 'sanitizedAttr' binding\nTag name: {0}; Binding attribute: \"{1}\"\nMessage: {2}",t=u.bindingHandlers;t.sanitizedAttr={init:function(n,i,r,u,f){var e=t.attr,s;return e.init?(s=o(i,[]),e.init(n,s,r,u,f)):null},update:function(i,r,u,f,s){var c=[],a=o(r,c),l;return c.length>0&&(l=c.reduce(
(function(n,t){var r=i.getAttribute("data-bind")||"None",u=h.format(String(i.tagName),r,t);return n+(u+"\n")}),""),e.logToExtension(n,i,2,l,{})),t.attr.update(i,a,u,f,s)}}})(o||(o={})),o}));define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding",["require","exports","ko","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer"],(function(n,t,i,r,u){"use strict";var f;return (function(){var e=r.ProvenanceContainer,o=1e5,t=i.bindingHandlers,f=t.html;t.sanitizedHtml={init:function(n,t,i,r,u){return f.init(n,t,i,r,u)},update:function(t,r,s,h,c){var l=i.unwrap(r());(l===null||l===undefined)&&(l="");var a=l.toString().substring(0,o),v=u.sanitizeHTML(new e(a,n,t),{allowKnockoutBindings:!1}),y=v.sanitizedMarkup,p=function(){return y};return f.update(t,p,s,h,c)}};t.html=t.sanitizedHtml;t.unsanitizedHtml=f})(f||(f={})),f}));define("Viva.Controls/Controls/Base/Viva.ValueUpdateTrigger",["require","exports"],(function(){"use strict";var n;return (function(n){n.DefaultDelayValidationTimeout=
500;var t;(function(n){n[n.Default=0]="Default";n[n.AfterKeyDown=1]="AfterKeyDown";n[n.KeyPress=2]="KeyPress";n[n.Blur=3]="Blur";n[n.Input=4]="Input"})(t=n.ValueUpdateTrigger||(n.ValueUpdateTrigger={}))})(n||(n={})),n}));define("Viva.Controls/Controls/Base/Viva.TypableControl",["require","exports","o","ko","$","Viva.Controls/Controls/Base/Viva.ValueUpdateTrigger","Viva.Controls/Controls/Base/Viva.ValidatableControl"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function o(n){s.clearTimeout(n)}var t=f.ValueUpdateTrigger,s=window,l=r.observable,h=(function(n){function i(i){var r=n.call(this,i)||this;return r.delayValidationTimeout=l(500),r.valueUpdateTrigger=t.Default,r.onEnterPressed=u.noop,r}return __extends(i,n),i})(e.ViewModel),c;n.ViewModel=h;c=(function(n){function r(t,i,r){var u=this;return r=r||{},r.viewModelType=r.viewModelType||h,u=n.call(this,t,i,r)||this,u.ltm.registerForDispose(u.element.setEvents(["keyup",function(n){n.which===13&&u.element.trigger("typableControl-commit",
{widget:u,model:u.options})}])),u}return __extends(r,n),r.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._timer=o(this._timer),n.prototype.dispose.call(this))},i.defineProperty(r.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),r.prototype.validate=function(t){this._timer=o(this._timer);n.prototype.validate.call(this,t)},r.prototype._valueChangeValidation=function(){var t=this,i=this.options.delayValidationTimeout();if(i>0&&this._shouldDelayValidation()){o(this._timer);this._timer=s.setTimeout((function(){t._timer=o(t._timer);t.validate()}),i);return}n.prototype._valueChangeValidation.call(this)},r.prototype._getValueUpdateTrigger=function(){var n;switch(this.options.valueUpdateTrigger){case t.AfterKeyDown:case t.KeyPress:case t.Input:n="input";break;case t.Blur:case t.Default:n=""}return n},r.prototype._shouldDelayValidation=function(){switch(this.options.valueUpdateTrigger){case t.AfterKeyDown:case t.
KeyPress:case t.Input:return!0}return!1},r})(e.Widget);n.Widget=c})(o||(o={})),o}));define("_generated/Less/Viva.Controls/Controls/Forms/Viva.TextBox.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".azc-textBox{height:23px}.azc-textBox-wrapper{width:100%}.azc-textBox-wrapper .azc-input{border-style:solid;border-width:1px;box-sizing:border-box;font-size:12px;height:23px;outline:0;padding:2px 8px 4px;width:100%}.azc-textBox-wrapper .azc-input::-moz-placeholder{font-style:italic}.azc-textBox-wrapper .azc-input:-ms-input-placeholder{font-style:italic}.azc-textBox-wrapper .azc-input::-webkit-input-placeholder{font-style:italic}.azc-textBox-wrapper [placeholder]{text-overflow:ellipsis}.fxc-inputhasvalue ::placeholder{color:transparent!important}")}));define("Viva.Controls/Controls/Forms/Viva.TextBox",["require","exports","o","ko","Viva.Controls/Controls/Base/Viva.TypableControl","MsPortalImpl.Controls/Controls/Base/WidgetBindingHandler",
"MsPortalImpl/Base/Base.EventTypes","_generated/Less/Viva.Controls/Controls/Forms/Viva.TextBox.css"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){var o="azc-inputbox azc-textBox",s="azc-has-focus",c="__azc-textBox",l="<div class='azc-inputbox-wrapper azc-textBox-wrapper' tabindex='-1'><input class='azc-input azc-formControl azc-validation-border' type='text' aria-multiline='false' data-bind='value: data.value, css: { \"fxs-br-error\": data.validationState() === 1, \"fxs-br-dirty\": data.dirty(), \"azc-disabled\": $disabled, \"azc-br-focused\": data.focused() }, valueUpdate: $ctl._getValueUpdateTrigger(), attr: { name: $ctl._name, placeholder: data.placeholder, readonly: data.readonly, spellcheck: data.spellcheck().toString(), disabled: $disabled, tabindex: $tabIndex, \"aria-readonly\": data.readonly, \"aria-disabled\": $disabled }' /><\/div>",a=0,h=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.placeholder=r.observable(null),t.readonly=
r.observable(!1),t.spellcheck=r.observable(!1),t}return __extends(t,n),t})(u.ViewModel),t;n.ViewModel=h;t=(function(n){function t(t,i,r){var u=this,f;return r=r||{},r.viewModelType=r.viewModelType||h,u=n.call(this,t,i,r)||this,f=u.options,t.addClass(o).html(l),u._name=f.name||c+a++,u._input=t.find("input"),u._attachEvents(),u._bindDescendants(),u._afterCreate(),u._supportsFocus(!0),u}return __extends(t,n),t.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._cleanElement(o),n.prototype.dispose.call(this))},i.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),t.prototype._getElementToFocus=function(){return this._input[0]},t.prototype._attachEvents=function(){var i=this,t=this.options,n=t.events;this.ltm.registerForDispose(this.element.setEvents([e.default.keyup,function(r){if(r.which===13){r.preventDefault();var u=i._input.val();if(t.value(u),n&&n.enterPressed)n.enterPressed(u);else if(t.onEnterPressed)
t.onEnterPressed(u)}else r.which===40&&n&&n.downPressed&&n.downPressed()}]));this.ltm.registerForDispose(this._input.setEvents([e.default.focus,function(){t.focused(!0);i.element.toggleClass(s,!0);n&&n.focus&&n.focus()}],[e.default.blur,function(){t.focused(!1);i.element.toggleClass(s,!1);n&&n.blur&&n.blur()}]))},t})(u.Widget);n.Widget=t;r.bindingHandlers.azcTextBox=f.getBindingHandler(t)})(o||(o={})),o}));define("MsPortalImpl/Base/Base.SelectableSet2",["require","exports","f","i","o","a","ko"],(function(n,t,i,r,u,f,e){"use strict";function rt(n){var i="SelectableSet",t=b.disposableData(n,i);return t||(t=new v(n),b.disposableData(n,i,t)),t}function ut(n){return n instanceof v?n.selectedItems():n.selectableItems().filter((function(n){return n.isSelected()}))}function ft(n){return n?!!n._msPortalFxSelectableSet:!1}function o(){return{added:[],removed:[]}}function g(n,t){var r=o(),u=n.peek(),f=u.length,i;return f&&(t?(i=!1,t.forEach((function(t){var f=u.firstIndex((function(n){return s(n,t)}));f>=
0&&(i||(n.valueWillMutate(),i=!0),u.splice(f,1),r.removed.push(t))})),i&&n.valueHasMutated()):r.removed=n.removeAll()),r}function a(n,t,i,r,u,f){var e=o(),h=n.peek(),c,l;return u?h.length&&n.removeAll():t.peek().length===0?h.length>0&&(e.removed=n.removeAll()):(c=!1,l=[],e.removed=h.slice(0),t.peek().forEach((function(n){var t,r,u;i&&(t=et(i,n));r=ot(e.removed,n);r>=0&&(u=e.removed.splice(r,1)[0],t?t.data!==u.data&&(c=!0):t=u);t&&(l.push(t),r<0&&e.added.push(t))})),(e.removed.length||e.added.length||c)&&n(l)),r&&(e.removed=e.removed.concat(r.filter((function(n){return f.some((function(t){return s(n.id,t)&&!e.removed.some((function(n){return s(t,n.id)}))}))})))),e}function nt(n,t,i,r){var u=o(),e,h,f;return!i&&t.length>1&&(t=t.slice(0,1)),e=n.peek(),h=e.length,t=t.filter((function(n){return!e.some((function(t){return s(t,n)}))})),u.added=t,u.added.length&&(f=void 0,f=i?r?[0,0]:[h,0]:[0,h],f=f.concat(u.added),u.removed=n.splice.apply(n,f)),u}function et(n,t,i){var u,f=l(t),r;return k(f)||(r=l(n),r&&(
u=r.first((function(n){var t=n.id;return(!i||i(n))&&s(t,f)})))),u}function ot(n,t,i){var u=-1,f=l(t),r;return k(f)||(r=l(n),r&&(u=r.firstIndex((function(n){var t=n.id;return(!i||i(n))&&s(t,f)})))),u}function p(n){return{id:n.id,data:n.data}}var w,v;u.defineProperty(t,"__esModule",{value:!0});var tt=r.TriggerableLifetimeManager,c=r.Po,b=i.Base.ProxiedObservables,it=i.ViewModels,s=it.Internal.Selection2.compareIds,k=i.isNullOrUndefined,y=e.observable,h=e.observableArray,l=e.utils.peekObservable,d;(function(n){n.None=1;n.Single=2;n.Multiple=3})(d=t.ActivationModeInternal||(t.ActivationModeInternal={}));t.getSelectableSet2=rt;t.getSelectedItems=ut;t.isSelectableSet2=ft;w=(function(){function n(n,t,i,r,u,f){this.ids=n;this.includeAll=t;this._allowMultiple=r;this._prepend=u;this._onChanged=f;this.itemsArePinnable=y(!0);this.items=h();this.excludedIds=i;this.excludedItems=h()}return n.prototype.addAll=function(){var r=this._allowMultiple,u=this.includeAll.peek(),i=!1,n,t;r&&(this.excludedIds.removeAll(
),u||(this.includeAll(!0),i=!0),n=this.ids,n.peek().length&&n.removeAll(),t=this.items,t.peek().length&&t.removeAll());this._fireChanged([],[],[],[],i,!1,[],[],[],[])},n.prototype.addId=function(n){this._add([n])},n.prototype.addIds=function(n){this._add(n)},n.prototype.addItem=function(n){this._add([n.id],[n])},n.prototype.addItems=function(n){var t=n.map((function(n){return n.id}));this._add(t,n)},n.prototype.removeId=function(n){this._remove([n],null)},n.prototype.removeIds=function(n){this._remove(n,null)},n.prototype.removeItem=function(n){this._remove([n.id],[n])},n.prototype.removeItems=function(n){var t=n.map((function(n){return n.id}));this._remove(t,n)},n.prototype._add=function(n,t){var e=this.includeAll.peek(),i=o(),r=o(),u=o(),f;e?(r=g(this.excludedIds,n),u=a(this.excludedItems,this.excludedIds,t,null,!1,r.removed)):i=nt(this.ids,n,this._allowMultiple,this._prepend);f=a(this.items,this.ids,t,null,e,i.removed);this._fireChanged(i.added,i.removed,f.added,f.removed,!1,!1,r.added,
r.removed,u.added,u.removed)},n.prototype._remove=function(n,t){var e=this.includeAll.peek(),i=o(),r=o(),u=o(),f;e?(r=nt(this.excludedIds,n,!0,!1),u=a(this.excludedItems,this.excludedIds,t,null,!1,r.removed)):i=g(this.ids,n);f=a(this.items,this.ids,null,t,e,i.removed);this._fireChanged(i.added,i.removed,f.added,f.removed,!1,!1,r.added,r.removed,u.added,u.removed)},n.prototype.removeAll=function(){var n=!1,t=[],i=[],r=[],u=[];this.includeAll.peek()&&(n=!0,this.includeAll(!1),this.excludedIds.peek().length&&(r=this.excludedIds.removeAll()),this.excludedItems.peek().length&&(u=this.excludedItems.removeAll()));this.ids.peek().length&&(t=this.ids.removeAll());this.items.peek().length&&(i=this.items.removeAll());this._fireChanged([],t,[],i,!1,n,[],r,[],u)},n.prototype._fireChanged=function(n,t,i,r,u,f,e,o,s,h){(n.length||t.length||i.length||r.length||u||f||e.length||o.length||s.length||h.length)&&this._onChanged(n,t,i,r,u,f,e,o,s,h)},n.prototype.fireCurrentChanges=function(){this._fireChanged(
this.ids(),[],this.items(),[],this.includeAll(),!1,this.excludedIds(),[],this.excludedItems(),[])},n})();v=(function(){function n(n){var t=this,r=n,i;if(!r._msPortalFxSelectableSet)throw new Error("SelectableSet is missing internal members.  Ensure the SelectableSet is constructed from FxViewModels.SelectableSet2Contract.");this._viewModel=r;this._lifetime=new tt;i=this._lifetime;this.activationMode=n.activationMode||1;this.selectionMode=n.selectionMode||1;var u=n.activatedIds||h(),f=n.selectedIds||h(),e=n.selectedAll||y(!1),o=n.unselectedIds||h();c.disallowRemoteMutations(u);c.disallowRemoteMutations(f);c.disallowRemoteMutations(e);c.disallowRemoteMutations(o);this._activationSet=new w(u,y(!1),h(),this.activationMode===d.Multiple,!0,function(n,i,r,u){t._onActivationChanged&&t._onActivationChanged(n,r,i,u)});this._selectionSet=new w(f,e,o,this.selectionMode===3,!1,function(n,i,r,u,f,e,o,s,h,c){var l=t.selectedAll.peek();t._onSelectionChanged&&t._onSelectionChanged(f,l?s:n,l?c:r,e,l?o:i,l?
h:u)});this.activatedItems=this._activationSet.items.mapInto(i,(function(n,t){return p(t)}));this.selectedItems=this._selectionSet.items.mapInto(i,(function(n,t){return p(t)}));this.unselectedItems=this._selectionSet.excludedItems.mapInto(i,(function(n,t){return p(t)}));this.activatedIds=this._activationSet.ids;this.selectedIds=this._selectionSet.ids;this.selectedAll=this._selectionSet.includeAll;this.unselectedIds=this._selectionSet.excludedIds;this.itemsArePinnable=this._selectionSet.itemsArePinnable;this.commandGroupProvider=this._viewModel.commandGroupProvider;this.dynamicSelectionProvider=this._viewModel.dynamicSelectionProvider}return n.prototype.dispose=function(){this._lifetime&&(this._lifetime.dispose(),this._lifetime=null)},n.prototype.registerItemController=function(n,t,i,r){var f=this._activationSet,e=this._selectionSet,u=function(i){return{id:n(i),data:t(i),item:i}};return i&&(this._onActivationChanged=function(n,t,r,u){i(n,t.map((function(n){return n.item})),r,u.map((function(n){return n.
item})))},f.fireCurrentChanges()),r&&(this._onSelectionChanged=function(n,t,i,u,f,e){r(n,t,i.map((function(n){return n.item})),u,f,e.map((function(n){return n.item})))},e.fireCurrentChanges()),{activateItem:function(n){var t=u(n);f.addItem(t)},activateItems:function(n){var t=n.map(u);f.addItems(t)},deactivateItem:function(n){var t=u(n);f.removeItem(t)},deactivateItems:function(n){var t=n.map(u);f.removeItems(t)},selectItem:function(n){var t=u(n);e.addItem(t)},selectItems:function(n){var t=n.map(u);e.addItems(t)},unselectItem:function(n){var t=u(n);e.removeItem(t)},unselectItems:function(n){var t=n.map(u);e.removeItems(t)}}},n.prototype.activateId=function(n){this._activationSet.addId(n)},n.prototype.activateIds=function(n){this._activationSet.addIds(n)},n.prototype.activateAllSelectedItems=function(){this._activationSet.addIds(this._selectionSet.ids.peek())},n.prototype.deactivateId=function(n){this._activationSet.removeId(n)},n.prototype.deactivateIds=function(n){this._activationSet.removeIds(
n)},n.prototype.deactivateAll=function(){this._activationSet.removeAll()},n.prototype.selectId=function(n){this._selectionSet.addId(n)},n.prototype.selectIds=function(n){this._selectionSet.addIds(n)},n.prototype.selectAll=function(){this._selectionSet.addAll()},n.prototype.unselectId=function(n){this._selectionSet.removeId(n)},n.prototype.unselectIds=function(n){this._selectionSet.removeIds(n)},n.prototype.unselectAll=function(){this._selectionSet.removeAll()},n})();t.SelectableSet2=v}));define("MsPortalImpl/Base/Base.Events",["require","exports","f","o"],(function(n,t,i,r){"use strict";function f(){var n=document;return!!(n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement)}function e(){var n=document,t=n.exitFullscreen||n.webkitExitFullscreen||n.mozCancelFullScreen||n.msExitFullscreen;t&&t.call(n)}function o(){var n=document.documentElement,t=n.requestFullscreen||n.webkitRequestFullscreen||n.mozRequestFullScreen||n.msRequestFullscreen;t&&t.call(
n)}function u(n){return n._handle}function s(n,t){var r=i.find(t(),(function(t){return u(t)===n}));return r||(r={_handle:n},t.push(r)),r}r.defineProperty(t,"__esModule",{value:!0});t.fxpinmultipleparts="fxpinmultipleparts";t.fullscreen="fullscreenchange MSFullscreenChange mozfullscreenchange webkitfullscreenchange";t.isFullscreen=f;t.exitFullscreen=e;t.requestFullscreen=o;t.unwrapFxElement=u;t.getOrCreateFxElement=s}));define("MsPortalImpl.Controls/Controls/ResourceFilterHelper",["require","exports","f","i","o","ko","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f,e){"use strict";function v(n){o.getOrSet(n.cloudName,[]).push(n)}function p(n){if(n){var t=o.get(n.cloudName),i=t&&t.first((function(t){return t.id===n.id}));i&&t.remove(i);t.length?o.set(n.cloudName,t):o.set(n.cloudName,[])}}function w(){return t.Internal.assetTypeService.assetTypes().forEach((function(n){v(n)})),o}function b(n,i){t.Internal.assetTypeService=n;n.assetTypes.subscribeArrayChanges(c,(function(n){v(n)}),(function(n){p(n)}));i.registerForDispose(
c)}function k(n,t){var u=[],r,e;return t&&t.length?(r=f.observable(),u=t.map((function(n){return{name:n.compositeDisplayName.plural,key:n.resourceType.toLowerCase(),keywords:n.keywords}})),r(i.stableSort(u,(function(n,t){return n.name.localeCompareIgnoreCase(t.name)}))),r):(r=l.get(n),r||(r=f.observable(),l.set(n,r),e=o.get(n)?o:w(),u=(e.get(n)||[]).filter((function(n){var i=n.assetTypeManifest.browseType,t=n.assetTypeManifest.resourceType,r=i===1&&!n.assetTypeManifest.privateBrowse&&n.lowerCaseResourceType!==h.Constants.ResourceTypes.ResourceGroups.toLowerCase();return r&&!(t&&(t.routingType===s.Tenant||t.routingType===s.ProviderProxy||t.routingType===s.Extension))})).map((function(n){return{name:n.compositeDisplayName.plural,key:n.lowerCaseResourceType,keywords:n.assetTypeManifest.keywords&&n.assetTypeManifest.keywords.split(",")}})),r(i.stableSort(u,(function(n,t){return n.name.localeCompareIgnoreCase(t.name)})))),r)}function d(n){var t=a.get(n);return t?Q.resolve(t):Q(e.Location.locationEndpoint.
invoke(r.Rpc.client,h.Constants.ExtensionNames.Hubs,{cloudName:n,onlyAllowedRegions:!0})).then((function(r){var u=i.forEachKey(r,(function(n,t,i){i.push({displayName:t,name:n})}),[]);return t=i.stableSort(u,(function(n,t){return n.displayName.localeCompareIgnoreCase(t.displayName)})),a.set(n,t),Q.resolve(t)}))}u.defineProperty(t,"__esModule",{value:!0});var h=i.Base,y=r.TriggerableLifetimeManager,s=i.Extension.ResourceRoutingType,c=new y;t.Internal={};var o=r.getCloudMap(),l=r.getCloudMap(),a=r.getCloudMap();t.initialize=b;t.getResourceTypes=k;t.getLocations=d}));define("MsPortalImpl/Services/Services.Settings",["require","exports","f","i","o","ko","FxHubs/HubsSettingsSchema","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Storage"],(function(n,t,i,r,u,f,e,o,s){"use strict";function ut(n){return function(t){this[t]=n}}function ht(){return i.map(l,i.identity)}function ct(n){return y[n+1e3]}function lt(n){return l[n]}function at(n){var t={manager:new p.InMemorySettingsManagerImpl,
stores:[8,9,13,]};return p.createUserSettingsManager(new p.UserSettingsManagerImpl(n),[t])}function vt(n,t){if(!t||!t.length)return Q({});var i=t.map(n.queryStore,n);return Q.all(i).then((function(n){var i={};return n.forEach((function(n,r){i[t[r]]=n})),i}))}var l,y,p;u.defineProperty(t,"__esModule",{value:!0});var c=i.Base,w=i.Hubs.Notifications.NotificationStatus,d=c.Net2,b=i.tryImmediateResolve;var ft=window,g=ft.fx,h=o.Services.Settings,k=g.environment,nt=i.isFeatureEnabled,a=k.settingsBaseUri+"{0}"+k.settingsUriQuery,tt=a.format("/Update"),it=a.format("/Select"),et=a.format("/Clear"),ot=a.format("/ClearAll"),v=c.Diagnostics.createLog(n),rt=g.early,st=rt&&rt.preloadSettings;c.getVersionFromString(k.version).revision=0;l={General:0,Blade:1,Part:2,LensState:3,Startboard:4,SharedPart:5,HubsExtension:6,CrossTenant:7,JourneySession:8,EditScopeSession:9,Favorites:10,DashboardInventory:11,FileUpload:12};y=i.forEachKey(l,(function(n,t,i){i[t]=n}),[]),(function(){for(var t,i,n=0;n<100;n++)t="Dashboard"+
n,i=n+1e3,l[t]=i,y[i]=t})();t.getAllStoreIds=ht;t.getDashboardStoreName=ct;t.getDashboardStoreId=lt;t.createUserSettingsManager=at;t.queryStores=vt,(function(n){function pt(n,t,i){return new rt(new g(new p(k.createWithWriteDeleteBufferTimeout(n,i),t)))}function l(n){var t=y[n];if(!t)throw new Error("Invalid store: "+n);return t}function ht(n,t){var r={},u;return i.forEachKey(t||{},(function(t,i){var f=l(t);r[f]=i;n&&delete n[f];u=r})),u}function ct(n){var i={},t;return n.keys.forEach(ut(null),i),t={},t[n.store]=i,t}function wt(n,t){var u=i.merge(n,t),r={settingsToSet:{},settingsToDelete:{}};return r=u.reduce((function(n,t){return a(n.settingsToSet,n.settingsToDelete,t.settingsToSet),a(n.settingsToDelete,n.settingsToSet,t.settingsToDelete),n}),r),[r]}function a(n,t,r){r&&i.forEachKey(r,(function(u){var f=parseInt(u),o=r[f],e;n&&(n[f]||(n[f]={}),lt(o,n[f]));t&&(e=t[f],e&&(at(o,e),i.isEmpty(e)&&delete t[f]))}))}function lt(n,t){i.forEachKey(n,(function(n,i){t[n]=i}))}function at(n,t){i.forEachKey(n,
(function(n){delete t[n]}))}function bt(n,t,i){var r={};return r[t]=i,{store:n,settings:r}}function ft(n){return JSON.parse(JSON.stringify(n))}var e,o,t,vt,p,yt,k,g,rt;n.createUserSettingsManager=pt;n.getSettingStoreName=l;n.convertSettingQueryToDictionary=ct;n.updateDictionary=a;n.updateSettingsDictionary=lt;n.sanitizeSettingsDictionary=at;e=(function(){function n(){this._eventsTriggered=f.observableArray()}return u.defineProperty(n.prototype,"eventsTriggered",{get:function(){return this._eventsTriggered},enumerable:!0,configurable:!0}),n.prototype._fireEvent=function(n,t,i){var r={status:i,title:n,description:t,timestamp:new Date,cloudName:c.Constants.DefaultCloudName};this.eventsTriggered.push(r)},n.prototype._fireError=function(n){this._fireEvent(h.useInMemorySettings,n||h.settingsCallFailed,w.Error)},n})();n.SettingsManagerVeryBase=e;t=(function(n){function t(t){var i=n.call(this)||this;return o?i._baseManager=t||o:(i._baseManager=undefined,i._eventsTriggered=undefined),i}return __extends(
t,n),u.defineProperty(t.prototype,"eventsTriggered",{get:function(){var n=this._baseManager;return n&&n.eventsTriggered||this._eventsTriggered},enumerable:!0,configurable:!0}),t.prototype.flushSettings=function(){var n=this._baseManager;return Q(n&&n.flushSettings())},t.prototype.dispose=function(){this._baseManager&&(this._baseManager.dispose(),this._baseManager=null)},t.prototype.setSettings=function(n){var t=this._baseManager;t&&t.setSettings(n)},t.prototype.deleteSettings=function(n,t){var i=this._baseManager;i&&i.deleteSettings(n,t)},t.prototype.queryStore=function(n){var t=this._baseManager;return Q(t&&t.queryStore(n))},t.prototype.clearSettings=function(){var n=this._baseManager;return Q(n&&n.clearSettings())},t})(e);n.SettingsManagerBase=t;o=new t;vt=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t._maps={},t}return __extends(t,n),t.prototype.setSettings=function(n){var t=n.settings;t&&i.forEachKey(t,(function(n,t,i){i.set(n,JSON.stringify(t))}),this.
_getMap(n.store))},t.prototype.queryStore=function(n){var i=this._getMap(n),t={};return i.forEach((function(n,i){t[i]=JSON.parse(n)})),Q(t)},t.prototype.deleteSettings=function(n){if(n.keys){var t=this._getMap(n.store);n.keys.forEach((function(n){t.delete(n)}))}},t.prototype.clearSettings=function(){return Q(this._maps={})},t.prototype._getMap=function(n){return this._maps[n]=this._maps[n]||new i.Map},t})(t);n.InMemorySettingsManagerImpl=vt;p=(function(n){function t(t,i){var r=n.call(this,t)||this;return r._initialize(i),r}return __extends(t,n),t.prototype.queryStore=function(n){return this._getManager(n).queryStore(n)},t.prototype.deleteSettings=function(n){this._getManager(n.store).deleteSettings(n)},t.prototype.setSettings=function(n,t){this._getManager(n.store).setSettings(n,t)},t.prototype.clearSettings=function(){return Q.all(this._managers.map((function(n){return n.clearSettings()})))},t.prototype._initialize=function(n){var t=this;this._managersDictionary={};this._managers=[this._baseManager];
n&&n.forEach((function(n){t._managers.push(n.manager);n.stores.forEach((function(i){t._managersDictionary[i]=n.manager}))}))},t.prototype._getManager=function(n){return this._managersDictionary[n]||this._baseManager},t})(t);n.RoutingSettingsManager=p;yt=(function(n){function t(t,r){r===void 0&&(r=st);var u=n.call(this)||this;return u._ajaxState=0,u._memoizedQueryStore=i.memoizeQ((function(n){var t=i.startTimer();return u._ajax(it,[n]).then((function(i){u._setAjaxState(1);var f=i&&i.content&&i.content[n]||{},r=t();return r>5e3&&v.warning("Request to store '"+n+"' took more than 5s to complete.\n                                                    Request time: "+r+"ms.\n                                                    Response size: "+(i&&i.jqXHR&&i.jqXHR.responseText.length)),f})).catch((function(n){return u._setAjaxState(2,n,"queryStore(duration:"+t()+")"),u._fireEvent(h.useInMemorySettings,h.querySettingsCallFailed,w.Error),Q({})}))})),u._storageService=t,r&&(u._preloadStores=i.forEachKey(r,(function(
n,t,r){r[n]=i.tryImmediateResolve(Q(t),(function(n){return u._setAjaxState(1),n}),(function(t){return i.Helpers.isXMLHttpRequestLike(t)&&d.isRetryable(t)||v.error(new i.Errors.Error({message:"Early Failed to preload store '"+n+"'.",innerErrors:t}),1),u._memoizedQueryStore(n)}))}),{})),u}return __extends(t,n),t.prototype._ajax=function(n,t){var u=this;return!t&&(n===tt||n===it)?Q.reject(r.createError("Invalid setting ajax call uri: "+n+", data: "+i.getObjectDescriptor(t))):Q(d.ajaxExtended({uri:n,headers:{"x-ms-user-settings-session":this._storageService.getValue(s.ComponentName.UserSettingsService,"x-ms-user-settings-session",1)||""},type:"POST",dataType:"json",data:t&&JSON.stringify(t),contentType:"application/json;charset=utf-8",performRetry:!0})).then((function(n){return u._storageService.setValue(s.ComponentName.UserSettingsService,"x-ms-user-settings-session",n.jqXHR.getResponseHeader("x-ms-user-settings-session"),1),n})).catchError(i.Errors.AjaxError,(function(r){return r.jqXHR.status===
400&&v.error("Setting _ajax 400 occurred. uri: "+n+", data: "+i.getObjectDescriptor(t,!0)+"."),Q.reject(r)}))},t.prototype._setAjaxState=function(n,t,r){n>this._ajaxState&&(this._ajaxState=n,n===2&&v.error(new i.Errors.Error({message:r+" Setting is transitioned into HasFailRequests state. All further querystore/updatesetting will be in-memory mode.",innerErrors:t})))},t.prototype.queryStore=function(n){var i=l(n),t,r;return this._ajaxState>=2?Q({}):(t=this._preloadStores,r=t&&t[i],r||this._memoizedQueryStore(i))},t.prototype.clearSettings=function(){var t=this,n=this._preloadStores,r;return n&&u.keys(n).forEach((function(t){delete n[t]})),this._memoizedQueryStore.clear(),r=i.startTimer(),this._ajax(nt("clearallusersettings")?ot:et).catch((function(n){t._setAjaxState(2,n,"clearSetting(duration:"+r()+"):");t._fireError(h.clearSettingsCallFailed)}))},t.prototype.updateSettings=function(n){var f=this,r,t,u;return this._ajaxState===1&&(r=this._preloadStores,t={save:ht(r,n.settingsToSet),remove:ht(
r,n.settingsToDelete)},t.save||t.remove)?(u=i.startTimer(),this._ajax(tt,t).catch((function(n){return f._setAjaxState(2,n,"updateSettings(duration:"+u()+"):"),Q.reject(n)}))):Q()},t})(e);n.UserSettingsManagerImpl=yt;k=(function(n){function t(t,i,r,u){var f=n.call(this,null)||this;return f._primitiveSettingsManager=t,f._sequencer=i(wt,(function(n){return f._executeMethod(n[0])}),r,!0,{optionalDataInterval:u}),f}return __extends(t,n),t.createWithWriteDeleteBufferTimeout=function(n,i,r){var u=i!==undefined?i:5e3,f=r!==undefined?r:3e5;return new t(n,function(n,t,i,r,u){return new c.Debouncer(n,t,i,r,u)},u,f)},t.prototype.queryStore=function(n){return this._primitiveSettingsManager.queryStore(n)},t.prototype.setSettings=function(n,t){if(!i.isEmpty(n.settings)){var r={};r[n.store]=n.settings;this._sequencer.execute([{settingsToSet:r,settingsToDelete:{}}],t===1)}},t.prototype.deleteSettings=function(n,t){n.keys&&n.keys.length&&this._sequencer.execute([{settingsToDelete:ct(n),settingsToSet:{}}],t===
1)},u.defineProperty(t.prototype,"eventsTriggered",{get:function(){return this._primitiveSettingsManager.eventsTriggered},enumerable:!0,configurable:!0}),t.prototype.flushSettings=function(){return this._sequencer.flush()},t.prototype.clearSettings=function(){var t=this,n=Q.defer();return this.flushSettings().finally((function(){t._primitiveSettingsManager.clearSettings().finally((function(){n.resolve()}))})),n.promise},t.prototype.dispose=function(){this.flushSettings();n.prototype.dispose.call(this)},t.prototype._executeMethod=function(n){return this._primitiveSettingsManager.updateSettings(n)},t})(t);n.SequencingSettingsManager=k;g=(function(n){function t(t){var r=n.call(this,t)||this;return r._cache={},r._activeUpdatePromises=new i.Map,r._uniqueId=1,r._memoizedQueryPromises=i.memoizeQ((function(n){var t=r._verifySettings()?r._baseManager.queryStore(n):Q({});return b(t,(function(t){return r._updateCaches(n,t)}))})),r}return __extends(t,n),t.prototype.queryStore=function(n){return this._memoizedQueryPromises(
n)},t.prototype.setSettings=function(n,t,i){this._execute(this._setSettingsInternal,n,t,i)},t.prototype._setSettingsInternal=function(n,t,i,r){var f=this,e=this._writeSettingsToCache(n,!0),u=function(){f._baseManager.setSettings(e,t)};r?(u(),this._resolveSetPromise(i)):this._executeIfBaseManagerCallIsAllowed(u,i)},t.prototype._resolveSetPromise=function(n){var t=this._activeUpdatePromises.get(n);t&&(t.resolve(),this._activeUpdatePromises.delete(n))},t.prototype._execute=function(n,t,i,r){var o=this,e=this._uniqueId++,u,f;this._activeUpdatePromises.set(e,Q.defer());t&&(u=t.store,f=function(){n.call(o,t,i,e,r)},this._cache[u]?f():b(this.queryStore(u),f))},t.prototype.deleteSettings=function(n,t){this._execute(this._deleteSettingsInternal,n,t)},t.prototype._deleteSettingsInternal=function(n,t,i){var r=this;this._deleteSettingsFromCache(n);this._executeIfBaseManagerCallIsAllowed((function(){r._baseManager.deleteSettings(n,t)}),i)},t.prototype.clearSettings=function(){var n=this,t=Q.defer();return this.
flushSettings().finally((function(){return Q(n._baseManager.clearSettings()).finally((function(){n._cache={};n._memoizedQueryPromises.clear();t.resolve()}))})),t.promise},t.prototype.flushSettings=function(){var t=this,n=[];return this._activeUpdatePromises.forEach((function(t){return n.push(t)})),Q.all(n).then((function(){return t._baseManager.flushSettings()}))},t.prototype._updateCaches=function(n,t){return this._writeSettingsToCache({store:n,settings:t}),this._cache[n]},t.prototype._verifySettings=function(){var n=this._baseManager===o;return nt("inmemorysettings")||n?(this._fireEvent(h.useInMemorySettings,n?h.noBaseManager:h.inMemorySettingsMode,w.Warning),!1):!0},t.prototype._executeIfBaseManagerCallIsAllowed=function(n,t){n();this._resolveSetPromise(t)},t.prototype._deleteSettingsFromCache=function(n){var t=this._cache[n.store];n.keys&&t&&n.keys.forEach((function(n){delete t[n]}))},t.prototype._writeSettingsToCache=function(n,t){if(n){var r=this._cache[n.store]||(this._cache[n.store]={}),
u={};return i.forEachKey(n.settings||{},(function(n,i){t&&(r[n]===i||JSON.stringify(r[n])===JSON.stringify(i))||(r[n]=u[n]=i)})),{store:n.store,settings:u}}return null},t})(t);n.CachingSettingsManagerImpl=g;rt=(function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.queryStore=function(n,t){return b(this._baseManager.queryStore(n),(function(n){return t?n:ft(n)}))},t.prototype.querySettings=function(n){return n.keys&&n.keys.length>0?this.queryStore(n.store,!0).then((function(t){var i={},r;return t&&(r=n.keys.filter((function(n){return n in t})),r.forEach((function(n){i[n]=t[n]}))),ft(i)})):this.queryStore(n.store)},t.prototype.querySetting=function(n,t){return this.querySettings({store:n,keys:[t]}).then((function(n){if(n){var i=n[t];return i===undefined?null:i}return null}))},t.prototype.setSettings=function(n,t){this._baseManager.setSettings(ft(n),t)},t.prototype.setSetting=function(n,t,i,r){this.setSettings(bt(n,t,i),r)},t})(t);n.ExtendedSettingsManager=rt})(p=t.Internal||
(t.Internal={}))}));define("MsPortalImpl/Services/Services.SelectedSubscriptions",["require","exports","f","i","o","a","ko","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function rt(){v=r.getCloudMap();l=r.getCloudMap()}function ut(n){var i=(n||[]).map((function(n){return n.subscriptionId})).join(";");t.userSettingsManager.setSetting(p,tt,i)}function ht(n,t){var r=(n.state||"").toLowerCase(),u=(t.state||"").toLowerCase(),i;if(r!==u){if(r===it)return 1;if(u===it)return-1}return i=n.displayName.localeCompareIgnoreCase(t.displayName),i===0&&(i=n.subscriptionId.localeCompareIgnoreCase(t.subscriptionId)),i}function w(n,t){var u=n||[],r=[],f;return t&&t.length&&(f=i.convertArrayToMap(t,(function(n){return n})),r=u.filter((function(n){return!!f[n.subscriptionId]}))),(r.length?r:u).stableSort(ht)}function ct(n){rt();t.userSettingsManager=n;k.Azure.getSelectedSubscriptionsEndPoint.
register(a.client,null,(function(n,t){return t.srcWindowId!==d.Shell&&t.srcWindowId!==g.getHubsWindowId()&&(n=g.getDescriptor(t.srcWindowId).cloudName),ft(n)}));t.selectedSubsUpdateTriggered.subscribe(new k.TriggerableLifetimeManager,(function(n){st.pingSelectedSubscriptionsListEndPoint.invoke(a.client,d.ExtensionNames.Hubs,n)}))}function ft(n){var i=v.get(n),r;return i?Q(i):(l.get(n)||(r=Q(b.getAllSubscriptions(a.client,n)).then((function(i){return t.userSettingsManager.querySetting(p,tt).then((function(r){var e=(r||"").split(";"),u=w(i,e),f;return t.allSubscriptionsSelected(i.length===u.length),u.length>t.selectedSubscriptionsCap&&(u=u.slice(0,t.selectedSubscriptionsCap),ut(u),f=i.length,nt.ClientNotification.publish({status:nt.NotificationStatus.Information,title:y.cappedTitleFmt.format(t.selectedSubscriptionsCap,f),description:y.cappedFmt.format(t.selectedSubscriptionsCap,f),uri:"#menu/settings"})),v.set(n,u),u}))})),l.set(n,r.catch((function(t){return l.set(n,null),Q.reject(t)})))),l.get(n))}
function lt(n,i){return t.getAllSubscriptionsForCloudName({selectedSubscriptions:n,cloudName:i}).then((function(r){var u=w(r,n),f=u.length===r.length;v.set(i,u);t.selectedSubsUpdateTriggered({cloudName:i,selectedSubscriptions:u});ut(f?[]:u);t.allSubscriptionsSelected(f)}))}var y,p,l,v;u.defineProperty(t,"__esModule",{value:!0});var b=r.Azure,et=o.Keys,k=r,ot=i.Base,d=ot.Constants,a=r.Rpc,st=s.SelectedSubscriptions,g=r.Extension,nt=i.Hubs.Notifications,tt=et.subscriptionsSelected,it="disabled";t.selectedSubscriptionsCap=60;y=c.SubscriptionsNotification;p=6;t.allSubscriptionsSelected=e.observable(!0);t.selectedSubsUpdateTriggered=e.observable();t.resetState=rt;t.getValidSelectedSubscriptions=w;t.init=ct;t.getSelectedSubscriptions=ft;t.getAllSubscriptionsForCloudName=i.memoizeQ((function(n){return Q(b.getAllSubscriptions(a.client,n.cloudName))}));t.setSelectedSubscriptions=lt}));define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers",["require","exports","f","a","ko","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],
(function(n,t,i,r,u,f){"use strict";var e;return (function(t){var o=i.Base.Diagnostics,e=o.createLog(n),s;(function(n){function h(){var n=function(n){var t=n.propertyChanges||[],i=t.length===1&&t[0].propertyValue,r=(i||{}).hasOwnProperty("detailBladeInputs");return i&&!r&&e.error(o.invalidNewValue.format(n.sourceModelId,JSON.stringify(n))),r};return function(t){if(n(t)){var i=t.propertyChanges[0],r=i.propertyValue;i.propertyValue=r.detailBladeInputs}}}function c(){return function(n){var t,r,u=n.propertyChanges||[];if(u.length===1&&i.isPlainObject(u[0].propertyValue)){t=n.propertyChanges[0].propertyValue;n.propertyChanges=[];for(r in t)t.hasOwnProperty(r)&&n.propertyChanges.push(f.ObservableChangeArgs.forObject(r,t[r]))}}}function l(){var n=function(n,t){var i=!0;return r.isArray(t)?t.length!==1&&(i=!1):(e.error(s.invalidNewValue.format(n.sourceModelId,JSON.stringify(t))),i=!1),i};return function(t){var r=u.unwrap(f.getModelValue(t.sourceModel,t.sourceProperty).value)||[],i;n(t,r)?(i=t.propertyChanges[
0],i.kind=0,i.propertyValue=r[0],i.propertyArrayEdits=null):t.cancel=!0}}function a(){var n=null,o=function(n,i){var u=!0;return!i||!i.propertyChanges||i.propertyChanges.length<1?(e.error(t.invalidPropertyChange.format(i.sourceModelId,JSON.stringify(i))),u=!1):r.isArray(i.propertyChanges[0].propertyValue)||i.propertyChanges[0].propertyArrayEdits&&i.propertyChanges[0].propertyArrayEdits.length>0?(e.error(t.invalidNewValue.format(i.sourceModelId,JSON.stringify(i))),u=!1):r.isArray(n)||(e.error(t.invalidCurrentValue.format(i.sourceModelId,n)),u=!1),u};return function(t){var s=u.unwrap(f.getModelValue(t.targetModel,t.targetProperty).value),r,h,e,c=function(n,t){return n.firstIndex((function(n){return i.deepEquals(n,t)}))};o(s,t)&&(h=n===undefined?-1:c(s,n),r=t.propertyChanges[0],e=u.unwrap(r.propertyValue),r.propertyArrayEdits=[],r.kind=1,h>=0&&n!==e&&r.propertyArrayEdits.push({status:"deleted",index:h,moved:null,value:n}),e!==undefined&&c(s,e)===-1&&r.propertyArrayEdits.push({status:"added",
index:0,moved:null,value:e}),n=e);t.cancel=!r||!r.propertyArrayEdits||!r.propertyArrayEdits.length}}var o={invalidNewValue:"[DynamicSelectionTransformer] [{0}] Source value does not implement MsPortalFx.ViewModels.DynamicSelection. Transformer Args: '{1}'"},s={invalidNewValue:"[ManyToOneTransformer] [{0}]: Source value '{1}' must be an array."},t={invalidPropertyChange:"[OneToManyMergeTransformer] [{0}]: No property change detected on source. Transformer Args: '{1}'.",invalidNewValue:"[OneToManyMergeTransformer] [{0}]: Source cannot be an array. Transformer args: '{1}'",invalidCurrentValue:"[OneToManyMergeTransformer] [{0}]: Target value '{1}' must be an array."};n.getDynamicSelectionMapper=h;n.getModelToPropertyMapper=c;n.getManyToOne=l;n.getOneToManyMerge=a})(s=t.PropertyTransformers||(t.PropertyTransformers={}))})(e||(e={})),e}));define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder",["require","exports","f","o","a","ko","$","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding",
"MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function rt(n){var t=Q();return{getStateAsyncSequenced:function(){return t=t.then(n,n)}}}var ut;r.defineProperty(t,"__esModule",{value:!0});var k=FxImpl,d=k.TelemetryContext,g=i.Base,nt=g.Diagnostics,l=o.ReferenceScope,v=i.Helpers;t.onInputsSetTimeout=5e3;var p=window,w=p.fx.environment.trace,tt=w.inputsset,it=w.shellinputsset,a=nt.createLog(n),b=o.extractTraceOptions,y=o.ReferenceCardinality;(function(n){function et(n,t,i,r){var u=function(i,r){var u=t.mapProperty(i.source.property,i.targetProperty);u.transformers=si(i);u.compositionBindingDefinition=i;r?u.bind(r.sourceModelName,r.sourceModel):yt(n,u)};i&&i.forEach((function(n){var i=r&&r(n),e=n.source.constantValue,c,s,h;i&&i.overridesConstantBindings?u(n,i):e!==undefined?(c="[Constant: {0}]".format(f.toJSON(e)),s={},o.setModelValue(
s,n.source.property,e),h=t.mapProperty(n.source.property,n.targetProperty),h.compositionBindingDefinition=n,h.bind(c,s)):u(n,i)}))}function wt(n,t,i){var r=(t||[]).every((function(n){return i&&o.getModelValue(i,n).exists}));return r||a.error("Model '{0}' is missing properties. Expected properties:'{1}', model:'{2}'".format(n,JSON.stringify(t)||"<null>",JSON.stringify(f.toJS(i))||"<null>")),r}function bt(n,t,i){var r=(t||[]).every((function(n){var t=i&&o.getModelValue(i,n);return t&&t.exists&&f.unwrap(t.value)!==undefined}));return r||a.error("Model '{0}' is missing required properties or has them set to undefined. Required properties:'{1}', model:'{2}'".format(n,JSON.stringify(t)||"<null>",JSON.stringify(f.toJS(i))||"<null>")),r}function kt(n){var r={},t,i;for(t in n)n.hasOwnProperty(t)&&(i=f.toJS(n[t]),r[t]=u.isArray(i)?f.observableArray(i):f.observable(i));return r}function ot(n,t,r){return i.mapMany(n||[],(function(n){return(n.valuesFrom||[]).map((function(i){var u={property:i.property,modelType:
i.referenceType,constantValue:i.constantValue,scope:l.CurrentContainer,cardinality:n.valuesFrom.length>1?y.OneToMany:y.OneToOne},e={targetProperty:n.property,source:u,optional:!!n.optional,isIdentityInput:!!n.isIdentityInput},f=i.part,o=t.locator.name;return(i.referenceType===0||i.partCommand)&&(u.partLocator=t.locator.getExtensionLocator().withPartInstance(f||o),s.isPartComposition(t)&&(!f||f===o)&&(u.id=t.id)),i.referenceType===4&&(u.modelId=i.bladeCommand||i.partCommand),r&&r(e,i),e}))}))}function dt(n){return(n||[]).forEach((function(n){var t=n.source,i=t&&t.partLocator;i&&(t.partLocator=h.Locator.fromJSON(i))})),n}function gt(n){return(n||[]).map((function(n){var t={targetProperty:n.targetProperty};return n.source&&(t.sourceProperty=n.source.property,t.sourcePartLocator=n.source.partLocator&&n.source.partLocator.toString(),t.sourceType=s.referenceTypeMap[n.source.modelType]||n.source.modelType,t.sourceScope=l[n.source.scope],t.sourceCardinality=y[n.source.cardinality]),t}))}function st(
n,t){var i=!1;return s.isPartComposition(n)&&!n.isDisposed()&&(i=t.id?n.id===t.id:n.eligibleForBinding&&n.locator.getExtensionLocator().withPartInstance(n.locator.name).equals(t.partLocator)),i}function ni(n){var t=ht(n);return t.inputsWatcherConfig&&g(t.inputsWatcherConfig),t}function ht(n){var i=[],t={allInputsSet:f.observable(!1),calledOnInputsSet:f.observable(!1),failedOnInputsSet:f.observable(!1),definitionBindings:[],propertyBindings:new o.PropertyBindings(n.bindableTarget.viewModelName,{},!1)};return ct(n.referenceComposition,n.inputs,i,n.customInputBindingValidator)?(t.definitionBindings=ot(n.inputs,n.referenceComposition),et(n.referenceComposition,t.propertyBindings,t.definitionBindings,n.customBindHandler),t.inputsWatcherConfig=k({bindableTarget:n.bindableTarget,allInputsSet:t.allInputsSet,calledOnInputsSet:t.calledOnInputsSet,failedOnInputsSet:t.failedOnInputsSet,propertyBindings:t.propertyBindings,referenceComposition:n.referenceComposition,referenceCompositionIsContainer:n.
referenceCompositionIsContainer,notifyWhenInputsChangeWithSameValues:!1,beforeViewModelPropertyUpdate:n.beforeViewModelPropertyUpdate,inputsSetCalled:n.inputsSetCalled})):a.error("{0} Reference: {1}.".format(JSON.stringify(i),n.bindableTarget.viewModelName)),t}function ti(n){g(k(n))}function k(n){return i.extend2(n,{propertyBindingsState:undefined,inputsSetTrace:tt,shellInputsSetTrace:it,stateReader:!!n.getStateAsync&&rt(n.getStateAsync)})}function g(n){var t,i;if(w(n,null,n.calledOnInputsSet()),!n.allInputsSet()){t=oi(n.propertyBindings);n.referenceComposition.onDispose((function(){ut(t)}))}i=n;i.onInputsSetDiagnosticsHandle=t;n.propertyBindings.addPropertyChangedHandler((function(){i.onInputsSetCallsSuppressed||w(n,t)}))}function ct(n,t,i,r){var u,f=s.isPartComposition(n);return(t&&t.some((function(n){return n.property?n.valuesFrom&&n.valuesFrom.length===1?f||n.valuesFrom[0].referenceType!==0||n.valuesFrom[0].part?n.valuesFrom[0].referenceType===5&&n.valuesFrom[0].constantValue===undefined?
u="'constantValue' must be defined if using 'Constant' reference type.":n.valuesFrom[0].constantValue!==undefined&&n.valuesFrom[0].referenceType!==5?u="'constantValue' can only be be defined when using 'Constant' reference type.":r&&(u=r(n)):u="Input binding that reference a Part must specify the source part name.":u="Input binding must define one and only one source valueFrom property.":u="Input binding must define a target property.",u||n.valuesFrom[0].referenceType!==4||(n.valuesFrom[0].bladeCommand||n.valuesFrom[0].partCommand?n.valuesFrom[0].bladeCommand&&n.valuesFrom[0].partCommand?u="Only one, 'bladeCommand' or 'partCommand' is allowed when using 'Command' reference type.":n.valuesFrom[0].part&&(u="'part' is not allowed when using 'Command' reference type."):u="'bladeCommand' or 'partCommand' is required if using 'Command' reference type."),!!u})),u)?(i.push(u),!1):!0}function r(n,t){var r=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return"| "+t.map((function(
n){return(n.toString()+"                    ").slice(0,15)})).join("")},i=["┌-----------",r("Optional","isBound","hasValue","Input: Value")],u=t.properties.map((function(n){return"{0}{1}: {2}".format(r(nt(n),n.isBound,n.targetHasValue),n.targetProperty,f.toJSON(n.targetHasValue?o.getModelValue(t.targetModel,n.targetProperty).value:undefined))}));i=i.concat(u);i.push("└-----------");a.verbose("{0} Target Model: {1}\n{2}".format(n,t.targetModelName,i.join("\n")))}function w(n,t,i,r,u,f){function o(t){var i;return t&&(t.dontCallViewModelOnInputsSet=u,d.usingState((function(){i=Q(ui(n,t))}),n.referenceComposition.getCreationState())),f?Q(i):undefined}var e=lt(n,t,i,!0,r);return f?Q(e).then(o):e.then(o)}function ii(n){var t=n;t.onInputsSetCallsSuppressed=!0}function ri(n,t,i){var r;t===void 0&&(t=1);i===void 0&&(i=!1);r=n;r.onInputsSetCallsSuppressed=!1;var u=r.onInputsSetDiagnosticsHandle,f=!!(t&1),e=!!(t&2),o=!!(t&4);return w(n,u,f,e,o,i)}function lt(n,t,u,o,s){var y=!n.propertyBindings.properties.
some(ei),c=b(n.bindableTarget.viewModelName,n.inputsSetTrace),l=c&&c.verbose,h,a;return y?(h=f.toJS(n.propertyBindings.targetModel),!o&&!i.canSendThroughPostMessage(h))?(n.propertyBindingsState=undefined,v.Deferred().resolve(null).promise()):(ut(t),!u&&n.notifyWhenInputsChangeWithSameValues||s||!i.deepEquals(h,n.propertyBindingsState)?(n.allInputsSet(!0),n.propertyBindingsState=h,a=void 0,a=n.beforeViewModelPropertyUpdate?n.beforeViewModelPropertyUpdate(h).then((function(t){if(t)return at(n,c);l&&r("onInputsSet not called, RBAC check failed.",n.propertyBindings)})):at(n,c),e.when(a,n.getInputsMetadata&&n.getInputsMetadata()).then((function(t,i){var r={inputs:h,settings:t,traceOptions:c,viewModelName:n.bindableTarget.viewModelName,inputsMetadata:i,dontCallViewModelOnInputsSet:undefined,dashboardFilters:n.getDashboardFilters&&n.getDashboardFilters()};return fi(n,r)?r:null}))):(l&&r("onInputsSet not called, new values are the same as current values.",n.propertyBindings),v.Deferred().resolve(null).
promise())):(l&&r("onInputsSet not called, missing required properties.",n.propertyBindings),n.propertyBindingsState=undefined,v.Deferred().resolve(null).promise())}function at(n,t){var e=n.referenceComposition,u,f,i;return(!e||!e.isDisposed())&&(u=n.bindableTarget,!u.viewModel||u.viewModel.updatePartInputValues)?(f=n.stateReader,f?(i=v.Deferred(),f.getStateAsyncSequenced().then(i.resolve.bind(i),i.reject.bind(i)),i.promise().then((function(n){return n||{}}),(function(){t&&t.verbose&&r("onInputsSet not called, failed to retrieve part settings.",n.propertyBindings);n.failedOnInputsSet(!0)}))):v.Deferred().resolve({}).promise()):v.Deferred().resolve(null).promise()}function ui(n,t){var r=n.bindableTarget.viewModel,u=t.inputs,f=t.settings,e=t.traceOptions,o=t.viewModelName,s=t.inputsMetadata,h=t.dontCallViewModelOnInputsSet,c=t.dashboardFilters,i=r.updatePartInputValues(u,f,e,o,s,h,c);return vt(n,t,i),i}function fi(n,t){var s=t.inputs,e=t.settings,o=t.traceOptions,i,u;return e&&(!n.referenceComposition||
!n.referenceComposition.isDisposed())?(i=n.bindableTarget.viewModelName,u=b(i,n.shellInputsSetTrace),o&&o.verbose&&r("onInputsSet will be called, all required properties are set.",n.propertyBindings),u&&(a.verbose("Invoking onInputsSet of view model '{0}'.\nInputs: {1}.\nSettings: {2}".format(i,f.toJSON(s),f.toJSON(e))),!!u.breakOnInputsSet),!0):!1}function vt(n,t,i){n.calledOnInputsSet(!0);n.inputsSetCalled&&n.inputsSetCalled(t.inputs,i||Q({}))}function ei(n){return n.targetHasValue?!1:!nt(n)}function nt(n){var t=n.compositionBindingDefinition,r=t&&t.optional,i=t&&t.source,u=i&&i.scope===l.DetailsContainer,f=r||u;return!!f}function oi(n){var i={handle:p.setTimeout((function(){var t,r,u;ut(i);t=[];r=[];n.properties.forEach((function(i){var u=nt(i),s=i.targetHasValue?o.getModelValue(n.targetModel,i.targetProperty).value:undefined,e="Target Input Name: {0} \nSource Model Name: {1} \nSource Property Name: {2} \nCurrent Value: {3} \nOptional: {4}".format(i.targetProperty,i.isBound?i.sourceModelName:
"<UNBOUND>",i.isBound?i.sourceProperty:"<UNBOUND>",i.isBound?f.toJSON(s):"<UNBOUND>",u);i.targetHasValue||u?r.push(e):t.push(e)}));u="onInputsSet is taking more time than expected for target model: {0}\n=== Missing Required Properties === \n{1}\n\n=== All Other Properties === \n{2}";a.warning(u.format(n.targetModelName,t.join("\n\n"),r.join("\n\n")))}),t.onInputsSetTimeout)};return i}function ut(n){n&&n.handle&&(p.clearTimeout(n.handle),n.handle=null)}function si(n){var t=[];return n.source.cardinality===y.OneToMany?t.push(c.PropertyTransformers.getOneToManyMerge()):n.source.cardinality===y.ManyToOne&&t.push(c.PropertyTransformers.getManyToOne()),n.opensDynamicBlades&&t.push(c.PropertyTransformers.getDynamicSelectionMapper()),n.targetProperty||t.push(c.PropertyTransformers.getModelToPropertyMapper()),t}function yt(n,t){if(!n.isDisposed()){var i=hi(n,t.compositionBindingDefinition.source),r=pt(n,i,t,t.compositionBindingDefinition.source);r(n,i,t,t.compositionBindingDefinition.source)}}function hi(
n,t){var u=n.getPartsContainer(),i,r;switch(t.scope){case l.MasterContainer:i=u.masterContainer;break;case l.DetailsContainer:r=u.detailContainers.filter((function(n){return n&&!(n.flags&2)}));r.length>1?a.error("Unable to bind composition to detail blade, multiple detail blades found. Reference Composition: '{0}', Detail Blades: '{1}'.".format(n.toString(),r.map((function(n){return n.toString()})).join(","))):i=r.first();break;default:i=u}return i}function pt(n,t,i,r){return t?r.partLocator?r.modelType===4&&i.compositionBindingDefinition.source.scope!==l.MasterContainer?ai:li:vi:ci}function ci(n,t,i){n.getPartsContainer().awaitContainer(n,(function(t){return yi(n.getPartsContainer(),t,i.compositionBindingDefinition.source)})).done((function(t){var r=pt(n,t,i,i.compositionBindingDefinition.source);r(n,t,i,i.compositionBindingDefinition.source)}))}function li(n,t,i,r){t.awaitComposedPart(n,(function(n){return st(n,r)})).done((function(t){ft(n,t,i)}))}function ai(n,t,i){ft(n,n,i)}function vi(n,t,i){
ft(n,t.getBindableContainer(),i)}function yi(n,t,i){var r=t.masterContainer;return t.isDisposed()?!1:t.locator.type!==h.LocatorType.Blade?!1:i.scope===l.MasterContainer?n.masterContainer&&n.masterContainer.id===t.id:i.scope===l.DetailsContainer?r&&r.id===n.id&&n.detailContainers.length===1:r&&r.id===n.id}function ft(n,t,i){var o=i.compositionBindingDefinition.source,r=o.modelType,u=o.modelId,h="[Composition: {0}, ModelType:{1}, ModelId:{2}]".format(t.toString(),r,u||"<null>"),c,f,e;r===1||r===8?(c=t.getViewModel(r,u),i.bind(h,c)):t.getViewModelAsync(r,u).done((function(n){t.isDisposed()||i.bind(h,n)})).fail((function(){n.isDisposed()||a.error("Failed to retrieve view model type '{0}' with id '{1}' from composition '{2}' to bind source property '{3}'.".format(s.referenceTypeMap[r]||r,u||"<none>",t.toString(),i.sourceProperty))}));f=function(){i.unbind();t.offDispose(e)};e=function(){i.unbind();i.compositionBindingDefinition.autoRebindWhenSourceDisposes&&yt(n,i);n.offDispose(f)};t.onDispose(
e);n.onDispose(f)}n.setupPropertyBindings=et;n.modelHasProperties=wt;n.modelHasPropertiesWithValue=bt;n.createObservableModel=kt;n.mapInputBindingDefinitions=ot;n.bindingsFromJSON=dt;n.mapBindingsToFriendlyObjects=gt;n.isSourcePart=st;n.bindViewModelInputs=ni;n.createBindViewModelResult=ht;n.setupAllInputsSetWatcher=ti;n.createAllInputsSetWatcherConfigExtended=k;n.setupAllInputsSetWatcherFromExtendedConfig=g;n.validateInputBindings=ct;n.callOnInputsSetIfNeeded=w;n.turnOnInputsSetSuppressionOn=ii;n.turnOnInputsSetSuppressionOff=ri;n.loadOnInputsSetParameters=lt;n.notifyOnInputsSetCalled=vt})(ut=t.CompositionBinder||(t.CompositionBinder={}))}));define("MsPortalImpl/Interactions/Interactions.PortalReader",["require","exports","f","o"],(function(n,t,i,r){"use strict";function o(n){if(e)throw new Error("Interactions.PortalReader cannot be initialized twice");else e=!0,$(n).append(f)}function s(){f.remove();e=!1}function h(n,t,r){var e,u,f;return r===void 0&&(r=""),n=(n||"").trim(),n?(e=l(r),u=
{active:!0,msg:n,msgElem:null},e.queue.push(u),e.act(),f=function(){u&&(u.active=!1,u.msgElem&&(u.msgElem.remove(),u.msgElem=null),u=null)},t===0?setTimeout(f,2e3):t===1&&setTimeout(f,5e3),f):i.noop}function l(n){var t=u[n];return t||(t={queue:[],act:i.debounce((function(){for(var e,o=t.queue,i=null,r=o.length-1;r>=0;--r)if(e=o[r],e.active){i=e;break}i&&f.append(i.msgElem=$("<div/>").text(i.msg));t.queue=null;t.act=null;u[n]=null}),c)},u[n]=t),t}var u;r.defineProperty(t,"__esModule",{value:!0});t.initialize=o;t.shutdown=s;t.read=h;var f=$("<div class='fxs-hide-accessible-label' aria-live='polite' aria-relevant='additions' />"),c=500,e=!1;u={}}));define("MsPortalImpl/Interactions/Interactions.RightClick",["require","exports","$","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function f(n,f,e){function l(){n.removeClass(t);var i=f();i&&i.forEach((function(n){n.dispose()}));o&&(n.off(u.default.fxcontextmenurequest,
o),o=null);s&&(n.off(u.default.keydown,s),s=null);h&&(n.off(u.default.remove,h),h=null)}function a(n){var t=f();t&&t.length>0&&(n.preventDefault(),n.stopPropagation(),v(n.clientX,n.clientY))}function v(t,r){var e=i.Event(u.default.fxcontextmenu);e.clientX=t;e.clientY=r;c||(c=n.hasClass("fxs-bladecontent")?n:null);n.trigger(e,{commands:f(),formTarget:c,srcElement:n[0]})}var c=e&&e.formTarget,o,s,h;n.addClass(t);n.on(u.default.fxcontextmenurequest,o=function(n){a(n)});n.on(u.default.keydown,s=function(n){if(n.which===121&&r.getModifierKeys(n)===4){var t=n.target.getClientRects()[0];n.clientX=t&&t.left;n.clientY=t&&t.top;a(n)}});n.on(u.default.remove,h=l);return{dispose:l}}var t="fx-rightClick";n.setup=f})(f||(f={})),f}));define("MsPortalImpl/Interactions/Interactions.Command",["require","exports","f","o","ko","$"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var o=(function(){function n(n,t){this.target=n;this.getFormTarget=t}return n})(),t,e;n.CommandContext=o;t=(function(){function n(
n,t){this.accept=n;this.maxFiles=t;this.files=u.observable(null)}return n})();n.FileInputOptions=t;e=(function(){function n(n,t,r){var o=this,e;this._ariaLabel=u.observable();this._inheritIcon=u.observable();this.fxEnabled=u.observable(!0);this.hasPopup=u.observable(!1);this.ariaLabel=this._ariaLabel;this.visible=u.observable(!0);this.unauthorized=u.observable(!1);this.pressed=u.observable();this.fileInputOptions=u.observable(null);this.tooltip=u.observable();this.isShellCommand=!1;e=this._ltm=n.createChildLifetime();this.text=u.isObservable(t)?t:u.observable(t?t:"");this.enabled=u.observable(r!==undefined?r:!0);this.icon=u.computed(e,{read:this._inheritIcon,write:function(n){return o._inheritIcon(n&&i.extend2(n,{options:f.extend({palette:99},n.options)}))}})}return r.defineProperty(n.prototype,"canRebind",{get:function(){return!0},enumerable:!0,configurable:!0}),n.prototype.activate=function(){},n.prototype.execute=function(){},n.prototype.bind=function(n){var t=n&&n.getFormTarget;n.getFormTarget=
function(){return t().then((function(t){if(t&&typeof t.showForm!="function")throw new Error("invalid context"+JSON.stringify(n,(function(n,t){return""+n+typeof t})));return t}))};this._currentContext=n},n.prototype.dispose=function(){this._ltm&&(this._ltm.dispose(),this._ltm=null)},n})();n.CommandImpl=e})(e||(e={})),e}));define("MsPortalImpl/Interactions/Interactions.KeyboardNavigation",["require","exports","o","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.Timers"],(function(n,t,i,r,u,f,e){"use strict";function o(n,t,i,r){i=i||t;e.requestAnimationFrame((function(){var e=n.find(i),f,h=r&&r.checkVisibility,o=r&&r.force,s=n.find(t);s.filter(":not([tabindex])").attr("tabindex","-1");o||(f=e.filter("[tabindex='0']"),h&&(f=f.filter((function(n,t){return u.isElementVisible(t)}))));(o||!f[0])&&(s.filter(":not([tabindex='-1'])").attr("tabindex","-1"),e.first().attr("tabindex","0"))}))}i.defineProperty(t,"__esModule",{value:
!0});t.resetTabbableItem=o;var s=(function(){function n(n,t,i){var r=this;this._element=n;this._tabTriggers=t||6;this._itemSelector=i||":tabbable";this._arrowsOnly=!(this._tabTriggers&2);this._element.on(f.default.keydown,this._keyDownHandler=function(n){r._handleMenuKeyDown(n)});if(this._arrowsOnly)this._element.on(f.default.mousedown,this._itemSelector,this._mouseDownHandler=function(n){var i=r._element.find(r._itemSelector),t=$(n.target).closest(r._itemSelector,r._element[0]);t.length&&i.index(t[0])>=0&&(i.attr("tabindex","-1"),t.attr("tabindex","0").focus())})}return n.prototype.dispose=function(){this._keyDownHandler&&(this._element.off(f.default.keydown,this._keyDownHandler),this._keyDownHandler=null);this._mouseDownHandler&&(this._element.off(f.default.mousedown,this._mouseDownHandler),this._mouseDownHandler=null)},n.prototype._handleMenuKeyDown=function(n){var u=r.getModifierKeys(n),i=!1,f=this._tabTriggers&2,e=this._tabTriggers&4,o=this._tabTriggers&8,t=u===0;f&&n.keyCode===9&&
t||e&&n.keyCode===40&&t||o&&n.keyCode===39&&t?i=this._moveFocusToItem(1,n.target):(f&&n.keyCode===9&&u===4||e&&n.keyCode===38&&t||o&&n.keyCode===37&&t)&&(i=this._moveFocusToItem(-1,n.target));i&&n.preventDefault()},n.prototype._moveFocusToItem=function(n,t){var f=!1,e=this._element.find(this._itemSelector),i=$(e.filter((function(n,t){return u.isElementVisible(t)}))),o=i.index(t),r;return o!==-1&&(r=$(i[(o+n+i.length)%i.length]),this._arrowsOnly&&(e.attr("tabindex","-1"),r.attr("tabindex","0")),r.focus(),f=!0),f},n})();t.KeyboardNavigation=s}));define("MsPortalImpl/Widgets/Widgets.CommandBarBase",["require","exports","f","o","ko","$","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){function c(n){return typeof n=="string"}var h=i.Base.Diagnostics.Telemetry,l=i.ViewModels.Dialogs,t=(function(n){function t(t,r,e,o){var s=this,l=o&&o.commandName,h;return s=n.call(this,t,r.label)||this,h=s._ltm,s._executeLifetime=
o&&o.executeLifetime||h,s._model=r,s._locator=e,s.icon=u.computed(h,{read:function(){var n=u.unwrap(s._model.icon);return n&&i.extend2(n,{options:f.extend({palette:99},n.options)})},write:s._model.icon}),s.commandName=l||i.getUniqueId(),s.enabled=u.computed(s._executeLifetime,(function(){var n=r,t=!r.disabled(),i=!n.command||n.command.canExecute();return t&&i})),u.computed(h,(function(){s.unauthorized(!!u.unwrap(r.unauthorizedMessage))})),u.computed(h,(function(){var n=u.unwrap(r.unauthorizedMessage),t;n||(t=u.unwrap(r.disabled),n=c(t)?t:null);n=n||u.unwrap(r.tooltip);s.tooltip(n)})),s.isSeparator=u.observable(r.type===12),s}return __extends(t,n),r.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),r.defineProperty(t.prototype,"type",{get:function(){return this._model&&this._model.type},enumerable:!0,configurable:!0}),t.prototype.execute=function(t){h.trace({source:this._locator&&this._locator.toFriendlyString(),action:o.Action.CommandExecuted,
name:this.model.name||"Toolbar name not specified",extension:this._locator&&this._locator.getExtensionLocator().name});n.prototype.execute.call(this,t)},t})(e.CommandImpl),s;n.ItemViewModel=t;s=(function(n){function t(t,i,r,f,e){var o=n.call(this,t,i,r,e)||this,s;return o.hasOpenDialog=u.observable(!1),o._services=f,s=i.dialogOptions,o.hasPopup(!!s&&s.type===4),o}return __extends(t,n),r.defineProperty(t.prototype,"dialogOptions",{get:function(){return this._model.dialogOptions},enumerable:!0,configurable:!0}),t.prototype.execute=function(t){var r=this;i.Base.Promises.cancelOnDispose(this._executeLifetime,Q.all([this._services.getService("DialogManager"),this._currentContext.getFormTarget()]).spread((function(u,e){if(r.hasOpenDialog())u.dismissOpenDialog(),r.hasOpenDialog(!1);else{var o=r._currentContext,s=o&&o.target,c=e&&e.getForm(),h=r._model;r.hasOpenDialog(!0);i.Base.Promises.cancelOnDispose(r._executeLifetime,u.showDialog(f(c),r.dialogOptions,r._locator)).then((function(n){r.hasOpenDialog(
!1);h.command&&h.command.execute(n);e&&e.getDismissHandler&&e.getDismissHandler()&&(e.hideForm(),e.getDismissHandler().restoreFocus())}),(function(){r.hasOpenDialog(!1)}));e&&s&&i.Base.Promises.cancelOnDispose(r._executeLifetime,i.require("Viva.Controls/Controls/Viva.Balloon")).then((function(n){e.showForm(n.getBox(s))}))}n.prototype.execute.call(r,t)})))},t})(t);n.DialogButton=s})(s||(s={})),s}));define("_generated/Templates/WidgetsDropMenu",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-dropmenu" role="presentation"> <button class="fxs-dropmenu-button" aria-haspopup="true" aria-expanded="false"><\/button> <div class="fxs-dropmenu-content fxs-text-link" role="menu"><\/div> <\/div>'}}));define("MsPortalImpl/Widgets/Widgets.DropMenu",["require","exports","f","o","ko","$","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsDropMenu","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Interactions/Interactions.KeyboardNavigation",
"_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var w;r.defineProperty(t,"__esModule",{value:!0});var l="fxs-dropmenu-button",a="fxs-dropmenu-hidden",v="fxs-dropmenu-is-open",y="fxs-dropmenu-invisible",b="fxs-popup-button",k="fxs-popup",d="fxs-portal-bg-txt-br",p="aria-label",g=(function(n){function t(t,i,r,f){var e=n.call(this)||this;return e.isMenuOpen=u.observable(!1),e.buttonLabel=u.observable(),e.buttonTooltip=u.observable(),e.menuLabel=u.observable(),e.buttonTemplate=t,e.menuTemplate=i,e.togglesVisibility=!!f,e.itemSelector=r,e}return __extends(t,n),t.prototype.open=function(){this.isMenuOpen(!0)},t.prototype.close=function(){this.isMenuOpen(!1)},t.prototype.toggle=function(){this.isMenuOpen(!this.isMenuOpen.peek())},t})(o.ViewModel);t.ViewModel=g;w=(function(n){function t(t,r){var e=n.call(this,t,r)||this,v=e.ltm,nt=i.getUniqueId(),a=e._dropMenu=f(s()),ut=e._dropMenuButton=a.findByClassName(l).addClass(r.buttonClass).addClass(
b).html(r.buttonTemplate).attr("aria-controls",nt),o=e._dropMenuContent=a.findByClassName("fxs-dropmenu-content").html(r.menuTemplate).attr("id",nt).addClass(k).addClass(d),y=r.menuWidth||220,w=y===220?"fxs-dropmenu-defaultWidth":y===355?"fxs-dropmenu-extendWidth":"",tt,it,c,g,rt;w&&o.addClass(w);o.addClass(r.alignMenu===0?"fxs-dropmenu-right":"fxs-dropmenu-left");t.append(e._dropMenu);w||o.width(y);u.reactor(v,r.isMenuOpen,(function(n){n?e._show():e._hide()}));u.reactor(v,(function(){ut.attr("title",r.buttonTooltip()).attr(p,r.buttonLabel());o.attr(p,r.menuLabel())}));c=h.default.click;g=h.default.contextmenu;a.on(c,"."+l,tt=function(n){n.preventDefault();r.toggle()});o.on(c,"a",it=function(){r.close()});t.on(g,rt=function(){if(r.isMenuOpen())return!1});return v.registerForDispose((function(){a.off(c,"."+l,tt);o.off(c,"a",it);t.off(g,rt)})),e}return __extends(t,n),t.prototype._show=function(){var n=this,t,r,i;this._dropMenuButton.attr("aria-expanded",!0);this._dropMenuContent.removeClass(y+
" "+a).addClass(v).attr("aria-hidden",!1);this._dismissHandle||(t=function(t){return f.contains(n._dropMenu[0],t)?0:2},this._dismissHandle={dismissFn:function(){n.options.close()},shouldDismissOnFocusOutFn:function(){return f.contains(n._dropMenu[0],document.activeElement)?0:1},shouldDismissOnMouseDownFn:t,shouldDismissOnMouseWheelFn:t,restoreFocus:function(){n._dropMenuButton[0].focus()},logName:"dropMenu"});this._dismissLifetime||(r=this._dismissLifetime=this.ltm.createChildLifetime(),i=this._dismissHandle,e.register(i),r.registerForDispose([function(){e.unregister(i)},new c.KeyboardNavigation(this.element,12,this.options.itemSelector)]));this.options.setItemFocusWhenOpen&&this.element.find(this.options.itemSelector).filter("[tabindex='0']:first").focus()},t.prototype._hide=function(){this._dropMenuButton.attr("aria-expanded",!1);this._dropMenuContent.addClass(this.options.togglesVisibility?y:a).removeClass(v).attr("aria-hidden",!0);this._dismissLifetime&&(this._dismissLifetime.dispose(
),this._dismissLifetime=null)},t.prototype.setFocus=function(){this._dropMenuButton.focus()},t})(o.Widget);t.Widget=w}));define("MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip",["require","exports","o","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r){"use strict";var u;return (function(n){function u(n){var t=n.currentTarget,r;t.offsetWidth<t.scrollWidth&&!t.title&&(r=$(t),r.attr("title",r.text()).addClass(i))}function f(n){var t=$(n.currentTarget);t.hasClass(i)&&t.removeAttr("title").removeClass(i)}function e(n){n.on(r.default.mouseover,t,u).on(r.default.mouseleave,t,f)}function o(n){n.off(r.default.mouseover,t,u).off(r.default.mouseleave,t,f)}var t=".msportalfx-tooltip-overflow,.msportalfx-text-ellipsis",i="fxs-autotooltip";n.register=e;n.unregister=o})(u||(u={})),u}));define("_generated/Templates/WidgetsContextMenu",["require","exports"],(function(){"use strict";return function(){return'<ul role="menu" class="fxs-contextMenu-itemList" data-bind="foreach: { data: commands, afterRender: afterRender }, attr: { \'aria-label\': ariaLabel }"> <li role="menuitem" class="fxs-contextMenu-item fxs-portal-hover" data-bind="css: { \'fxs-contextMenu-itemDisabled\': !enabled(), \'fxs-contextMenu-extensioncommand\': !!$data._extension }, attr: { title: $data.tooltip(), \'aria-disabled\': !enabled(), \'aria-label\': ariaLabel, \'aria-posinset\': $index() + 1, \'aria-setsize\': $parent.commands().length }" tabindex="0"> <div class="fxs-contextMenu-text fxs-portal-text msportalfx-text-ellipsis" data-bind="text: text"><\/div> <div class="fxs-contextMenu-icon fxs-portal-svg" data-bind="image: icon"><\/div> <\/li> <\/ul>'}
}));define("MsPortalImpl/Widgets/Widgets.ContextMenu",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsContextMenu","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y;return (function(t){function y(n,t){return t||ft.error("ContextMenuViewModel."+n+" is not accessible. Please call registerForCleanup first."),t}function tt(n){return n.isShellCommand}var rt=i.Base,ut=rt.Diagnostics,w=window,ft=ut.createLog(n),b="fxs-contextMenu",k="fxs-contextMenu-active",d="fxs-contextMenu-item",et="fxs-contextMenu-itemDisabled",g="fxs-popup",nt="fxs-portal-bg-txt-br",p=(function(n){function t()
{var t=n.call(this)||this;return t.visible=u.observable(!1),t.menuItems=u.observableArray(),t}return __extends(t,n),t.prototype.getOrderedMenuItemsCommandsComputed=function(){return y("orderedMenuItemsCommands",this._orderedMenuItemsCommands)},t.prototype.getOrderedMenuItemsComputed=function(){return y("orderedMenuItems",this._orderedMenuItems)},r.defineProperty(t.prototype,"hasVisibleCommands",{get:function(){return y("hasVisibleCommands",this._hasVisibleCommands)},enumerable:!0,configurable:!0}),t.prototype.registerForCleanup=function(n){var t=this,r=this.menuItems,i=this._ltm=n.createChildLifetime(),f=this._orderedMenuItemsCommands=r.filter(i,(function(n){return n.visible()&&!tt(n)&&!n.hasPopup()})),e=this._orderedMenuItems=r.filter(i,(function(n){return n.visible()&&tt(n)&&n.enabled()}));this._hasVisibleCommands=u.computed(i,(function(){return f().length+e().length>0}));i.registerForDispose((function(){t._ltm=t._orderedMenuItemsCommands=t._orderedMenuItems=t._hasVisibleCommands=null}))},t})
(l.ViewModel),it;t.ViewModel=p;it=(function(n){function t(t,i){var r=n.call(this,t,i&&i instanceof p?i:new p)||this;r._lastShowArgs=u.observable(null);i=r.options;var h=r.ltm,c=function(n){var t=r.element[0];return!(t===n)&&!f.contains(t,n)?2:0},e=r._dismissHandle={dismissFn:function(){r.hide()},shouldDismissOnMouseDownFn:c,shouldDismissOnMouseWheelFn:c,logName:"contextmenu"};return i.registerForCleanup(h),t.html(a()).addClass(b+" "+g+" "+nt),r._bindDescendants({ariaLabel:o.ContextMenu.ariaLabel,commands:u.explicitComputed(h,[i.getOrderedMenuItemsComputed(),i.getOrderedMenuItemsCommandsComputed()],(function(n,t){return n.concat(t)})),afterRender:function(){r.updateRenderedPositionFromLastShow()}}),r._initializeHandlers(),i.visible.subscribeAndRun(h,(function(n){var t=r.element,i;n?(i=document.activeElement,e.restoreFocus=function(){s.validatePreviousFocusedElement(e,i)&&i.focus()},t.css(r._ensureInViewPort(r._lastShowArgs())).addClass(k),r.setFocus(),s.register(e,!0)):(r._lastShowArgs(null),
t[0].contains(document.activeElement)&&e.restoreFocus&&e.restoreFocus(),t.removeClass(k),s.unregister(e))})),r}return __extends(t,n),t.prototype.dispose=function(){this.hide();this._dismissHandle=null;this._cleanElement(b,g,nt);n.prototype.dispose.call(this)},t.prototype.hide=function(){this.options.visible(!1)},t.prototype.show=function(n,t,i){if(n===void 0&&(n=0),t===void 0&&(t=0),i===void 0&&(i=!1),e.isFullscreen()){this.hide();return}this._lastShowArgs({xCoord:n,yCoord:t,forceLeft:i});this.options.visible(!0)},t.prototype.updateRenderedPositionFromLastShow=function(){var n=this._lastShowArgs();n&&this.element.css(this._ensureInViewPort(n))},t.prototype.setFocus=function(){var n=this;Q.fcall((function(){n.element.find("[tabindex=0]:first-of-type").focus()}))},t.prototype._initializeHandlers=function(){var t=this,n=this.element,i=this.ltm,r=function(n){if(n.stopPropagation(),n.preventDefault(),!f(n.currentTarget).hasClass(et)){t.hide();var i=u.dataFor(n.target);i&&i.enabled()&&i.execute(
!0)}},e=new h.KeyboardNavigation(n);c.register(n);u.computed(i,(function(){t._lastShowArgs()&&(t.options.menuItems().forEach((function(n){n.enabled()})),t.updateRenderedPositionFromLastShow())}));i.registerForDispose([function(){c.unregister(n);e.dispose()},n.setEvents([v.default.contextmenu,function(){return!1}]),n.find("ul").setEvents([v.default.click,"."+d,r],[v.default.keydown,"."+d,function(n){n.which===13&&r(n)}])])},t.prototype._ensureInViewPort=function(n){var o=n.xCoord,c=n.yCoord,s=n.forceLeft,r=c,t="auto",h=this.element,u=h.outerHeight(),f=h.outerWidth(),e;return this._isRtl()?(t=o-f,(s||t-f<0)&&(t+=f)):(t=o,(s||t+f>w.innerWidth)&&(t-=f)),e=w.innerHeight,r+u>e&&(r-u>=0?r-=u:r=u<e?i.truncate((e-u)/2):0),{top:r,left:t}},t})(l.Widget);t.Widget=it})(y||(y={})),y}));define("MsPortalImpl/Widgets/Widgets.UIElementBase",["require","exports","ko","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i,r){"use strict";var u;return (function(n){var t="Not implemented in base class.",f=(function(
n){function r(t){var r=n.call(this)||this;return r.locked=i.observable(!0),r.id=t,r}return __extends(r,n),r.prototype.getViewSettings=function(){throw new Error(t);},r.prototype.applyViewSettings=function(){throw new Error(t);},r})(r.ViewModel),u;n.ViewModel=f;u=(function(n){function i(t,r){var u=n.call(this,t,r)||this;if(!r.id||typeof r.id!="string")throw new Error("An unique identifier is required and it must be a string.");return i.attachId(t,r.id),u}return __extends(i,n),i.prototype.dispose=function(){i.detachId(this.element);n.prototype.dispose.call(this)},i.attachId=function(n,t){n.data(i._fxsIdKey,t)},i.detachId=function(n){n.removeData(i._fxsIdKey)},i.getId=function(n){return n.data(i._fxsIdKey)},i.prototype.addChild=function(){throw new Error(t);},i.prototype.insertChild=function(){throw new Error(t);},i.prototype.removeChild=function(){throw new Error(t);},i.prototype.moveChild=function(){throw new Error(t);},i.prototype.saveViewSettings=function(){throw new Error(t);},i.prototype.
setSize=function(){throw new Error(t);},i.prototype.discardStateOfUnusedChildren=function(){return{stateDiscarded:!1}},i})(r.Widget);u.viewSettingsChanged="viewSettingsChanged";u.errorEvent="widgetError";u._fxsIdKey="fxsId";n.Widget=u})(u||(u={})),u}));define("MsPortalImpl/Widgets/Widgets.LayoutBase",["require","exports","o","ko","MsPortalImpl/Widgets/Widgets.UIElementBase"],(function(n,t,i,r,u){"use strict";var f;return (function(n){var e,f,t;(function(n){n[n.Horizontal=0]="Horizontal";n[n.Vertical=1]="Vertical"})(e=n.Orientation||(n.Orientation={}));f=(function(n){function t(t){var i=n.call(this,t)||this;return i.positionUpdatedSignal=r.observable(0),i.positions=[],i}return __extends(t,n),i.defineProperty(t.prototype,"positions",{get:function(){return this._positions},set:function(n){this._positions=n?n:[]},enumerable:!0,configurable:!0}),t})(u.ViewModel);n.ViewModel=f;t=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(u.Widget);t.layoutUpdatedEventName=
"layoutUpdated";n.Widget=t})(f||(f={})),f}));define("MsPortalImpl/UI/Compositions/UI.Composition.PartSize",["require","exports","f","o","$"],(function(n,t,i,r,u){"use strict";function h(n,t,i){return n<0?-1:n===0?0:Math.max(0,n*t+(n-1)*i)}function c(n,t){return{width:h(n,f.CellWidth,f.CellSpacingWidth),height:h(t,f.CellHeight,f.CellSpacingHeight)}}function l(n,t,i){return Math.ceil(n/(t+i))}function p(n,t){return{colSpan:l(n,f.CellWidth,f.CellSpacingWidth),rowSpan:l(t,f.CellHeight,f.CellSpacingHeight)}}function w(n,t){var i=function(n){return Math.ceil(Math.min(Math.max(n,1),25))};return c(i(n),i(t))}function b(n,r){var f=i.find(t.AllSizes,(function(t){var i=t&&t.size;return t&&i.width===n&&i.height===r}));return f||(f=e(99),f.size={width:n,height:r},f.span=p(n,r)),u.extend(!0,{},f)}function k(){return e(2)}function e(n){return u.extend(!0,{},i.find(t.AllSizes,(function(t){return t&&t.name===n})))}function o(n){return function(t){return t===n}}function d(n){var t=o(n);return a.some(t)}function g(
n){var t=o(n);return v.some(t)}function nt(n){var t=o(n);return y.some(t)}var s,f,a,v,y;r.defineProperty(t,"__esModule",{value:!0});s=i.Parts;f=i.Widgets.AzureGrid;t.AllSizes=(function(){var t=[],n=function(n,i,r){t[n]={name:n,css:"fxs-tilesize-"+s.InternalPartSize[n].toLowerCase(),size:c(i,r),span:{colSpan:i,rowSpan:r}}};return n(0,1,1),n(1,2,1),n(2,2,2),n(3,4,2),n(4,2,4),n(5,6,4),n(6,4,6),n(7,6,0),n(8,-1,0),n(9,-1,-1),n(10,4,4),n(11,6,6),n(99,0,0),t})();t.AllCssClasses=t.AllSizes.map((function(n){return n.css}));t.getGridPixelSize=w;t.getCorrespondingStandardSize=b;t.getDefaultSize=k;t.getSize=e;a=[0,1,2,3,4,10,5,6,11,99,];t.isFixedSize=d;v=[7,8,9,];t.isVariableSize=g;y=[8,9,];t.isAdaptiveWidth=nt}));define("_generated/Templates/WidgetsTileActionBar",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-tile-actionbar-actionlist" role="menubar" data-bind="foreach: func._actionsForUi"> <!-- ko if: command.enabled() --> <button type="button" class="fxs-tile-actionbar-action" role="menuitem" data-bind="css: className, image: command.icon, attr: { title: command.text, \'aria-label\': command.text }"><\/button> <!-- /ko --> <\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.TileActionBar",["require","exports","f","ko","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextMenu","_generated/Templates/WidgetsTileActionBar","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){var b=i.Base,k=b.Diagnostics.Telemetry,d=k.trace,y="fxs-tile-actionbar-actionlist",t="fxs-tile-actionbar",g=i.isFeatureEnabled("skipautofocus"),l=[],a,p,v,w;n.widgetClassName=t;n.actionClassName="fxs-tile-actionbar-action";a=(function(){function n(){}return n})();n.TileActionViewModel=a;p=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.actions=r.observableArray(),t.visible=r.observable(!1),t}return __extends(t,n),t.prototype.update=function(){var t=this.visible(),n;t&&(n=this.actions(),n.forEach((function(n){n.command.
activate();n.bindCommand()})))},t})(o.ViewModel);n.ViewModel=p;v=(function(n){function i(i,o,v,p){var w=n.call(this,i,v)||this,rt=w.options,b=w.ltm,k,g,nt,tt,it;l.push(w);g=r.observable(k);w._actionsForUi=r.computed(b,g,(function(n){return r.unwrap(n)||[]}));i.addClass(t).html(h());nt=new s.ViewModel;tt=w.contextMenuWidget=new s.Widget(o,nt);b.registerForDispose(i.setEvents(["click","."+y,function(n){var t=n.target;u(t).hasClass(y)&&(p(t),n.preventDefault(),n.stopPropagation())}]));rt.visible.subscribeAndRun(b,(function(n){if(!n){var t=document.activeElement;w.has(t)&&p(t)}n?(w.options.update(),g(k||(k=rt.actions.filter(b,(function(n){return n.command.enabled()}))))):tt.hide();f.toggle(i,n);n&&l.forEach((function(t){t!==w&&t.options.visible(!n)}))}));it=function(n){n.stopPropagation();var t=r.dataFor(n.target);t&&t instanceof a&&t.command&&(d({source:e.Source.TileAction,action:e.Action.TileActionClicked,name:t.command.commandName}),t.command.execute(!1))};i.on(c.default.click,it);return b.registerForDispose(
(function(){i.off(c.default.click,it);tt.dispose();nt.menuItems.removeAll();w.contextMenuWidget=null;l.remove(w)})),w._bindDescendants(),w}return __extends(i,n),i.prototype.dispose=function(){this._cleanElement(t);n.prototype.dispose.call(this)},i.prototype.showTileManagementContextMenu=function(){this.options.actions().forEach((function(n){var t=n.command;typeof t._getActionClassIdentifier=="function"&&t._getActionClassIdentifier()==="opencontextmenu"&&t.execute(!1)}))},i.prototype.setFocus=function(){!g&&this.options.visible()&&this.element.findFirstTabbable().focus()},i.prototype.has=function(n){return!!(this.element.has(n).length||this.contextMenuWidget.element.has(n).length)},i})(o.Widget);n.Widget=v;w=(function(){function n(n){this._getActions=n}return n.prototype.create=function(n){var t;return u.isFunction(this._getActions)&&(t=this._getActions(),r.utils.arrayPushAll(n.options.actions,t)),new v(n.element,n.contextElement,n.options,n.focusBackCallback)},n})();n.FactoryImpl=w})(l||(l={})
),l}));define("_generated/Templates/WidgetsTile",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-tile-actionbarcontainer" data-bind="stopBindings: true"> <div class="fxs-tile-actions"><\/div> <div class="fxs-tile-actions-contextmenu"><\/div> <\/div> <div class="fxs-tile-overlay fxs-br-primary"><\/div> <div class="fxs-tile-progress-transparent fxs-loading5dots-container" data-bind="visible: func._showTransparentSpinner"> <div class="fxs-portal-background"><\/div><div class="fxs-portal-background"><\/div><div class="fxs-portal-background"><\/div><div class="fxs-portal-background"><\/div><div class="fxs-portal-background"><\/div> <\/div> <fxs-progress class="fxs-tile-progress fxs-portal-background-secondary" data-bind="visible: func._showOpaqueSpinner"><\/fxs-progress> '}}));define("MsPortalImpl/Widgets/Widgets.Tile",["require","exports","f","o","ko","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/UI/Compositions/UI.Composition.PartSize",
"MsPortalImpl/Widgets/Widgets.TileActionBar","_generated/Templates/WidgetsTile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function d(n,t,i){return new a(n,t,new o.FactoryImpl(i))}var p,a;r.defineProperty(t,"__esModule",{value:!0});var w=i.Base,b=w.Diagnostics,k=b.createLog(n),l="fxs-tile",v="fxs-tile-overlay",y="fxs-portal-bg-txt-br";t.widgetClassName=l;t.overlayClassName=v;t.actionBarContainerClassName="fxs-tile-actionbarcontainer";p=(function(n){function t(t,i){var r=n.call(this,t)||this;return r.isInBlockingLoadingState=u.observable(!1),r.hasOngoingOperation=u.observable(!1),r.size=u.observable(),r.gridHeight=u.observable(),r.gridWidth=u.observable(),r.supportedSizes=u.observableArray(),r.commands=[],r.actionBarViewModel=new o.ViewModel,r.selected=u.observable(!1),r.selectedFromHover=u.observable(!1),r.showEnhancedTileMgmtMillis=500,r.hideEnhancedTileMgmtMillis=
333,r.userResizable=u.observable(!1),r.inLockedContext=!1,r.applyViewSettings(i),r}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{size:this.size()}}},t.prototype.applyViewSettings=function(n){n&&n.NormalState&&n.NormalState.size!==undefined&&(this.size=u.observable(n.NormalState.size))},t})(h.ViewModel);t.ViewModel=p;t.createTileWidget=d;a=(function(n){function t(t,i,r){var o=n.call(this,t,i)||this,h,c,b,a,v,p,w,d;return o._showTransparentSpinner=u.observable(!1),o._showOpaqueSpinner=u.observable(!1),c=o.ltm,i.size&&i.size()!==undefined||(k.warning("No initial size was set on the Tile view model."),i.size=u.observable(e.getDefaultSize().name)),o._actionBarWidgetFactory=r,h=e.getSize(i.size()),u.computed(c,(function(){var n=0;i.isInBlockingLoadingState()?n=2:i.hasOngoingOperation()&&(n=1);o._showTransparentSpinner(n===1);o._showOpaqueSpinner(n===2)})),b=s(),t.addClass(l).addClass(y).addClass(h&&h.css).html(b),99===h.name?(a=e.getGridPixelSize(i.gridWidth(),
i.gridHeight()),t.css({width:a.width,height:a.height})):e.isFixedSize(i.size())&&(i.gridWidth(h.span.colSpan),i.gridHeight(h.span.rowSpan)),v={func:o,data:i},p=t.findByClassName("fxs-tile-progress")[0],u.applyBindingsToNode(p,null,v),w=t.findByClassName("fxs-tile-progress-transparent")[0],u.applyBindingsToNode(w,null,v),o._attachEventHandlers(),d=f.setup(t,u.observableArray(i.commands)),c.registerForDispose((function(){o._cleanNode(p);o._cleanNode(w);d.dispose()})),o}return __extends(t,n),t.prototype.dispose=function(){this._actionBarWidget&&(this._actionBarWidget.dispose(),this._actionBarWidget=null);this._cleanElement(e.AllCssClasses.join(" "),l,y);n.prototype.dispose.call(this)},t.prototype._cleanNode=function(n){n&&u.cleanNode(n)},t.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");var t=n.element||n;t.insertBefore($(this.element).findByClassName(v))},t.prototype.removeChild=function(){return!1},t.prototype.saveViewSettings=function(){return this.options.getViewSettings(
)},t.prototype.setSize=function(n,t){var i=e.getCorrespondingStandardSize(n,t),s;i||(i=e.getDefaultSize());var u=i.size,f=this.options,o=f.size(),r=this.element;if(o&&o===i.name){if(o!==99)return;if(parseInt(r.css("height"))===u.height&&parseInt(r.css("width"))===u.width)return}f.size(i.name);f.gridHeight(i.span.rowSpan);f.gridWidth(i.span.colSpan);r.css({height:"",width:""}).removeClass(e.AllCssClasses.join(" ")).addClass(i.css);i.name===99&&r.css({height:u.height,width:u.width});s=300;r.handleTransitionEndOnce("height",s,(function(){r.trigger(c.default.fxsizechanged,[i.name])}))},r.defineProperty(t.prototype,"actionBarWidget",{get:function(){return this._actionBarWidget},enumerable:!0,configurable:!0}),t.prototype.setFocus=function(n){var t=this._actionBarWidget,i;!n&&t&&t.options.visible()?t.setFocus():(i=this.element.find(".fxs-part"),i&&i.focus())},t.prototype.showTileManagementContextMenu=function(){var n=this.options,t=this.actionBarWidget;!n.locked()&&n.selected()&&t&&t.showTileManagementContextMenu(
)},t.prototype._createActionBarWidget=function(){var i=this,n,t;!this._actionBarWidget&&this._actionBarWidgetFactory&&(n=this.element,t=this.options,this._actionBarWidget=this._actionBarWidgetFactory.create({element:n.findByClassName("fxs-tile-actions"),contextElement:n.findByClassName("fxs-tile-actions-contextmenu"),options:t.actionBarViewModel,focusBackCallback:function(t){n[0].contains(t)&&i.setFocus(!0)}}))},t.prototype._attachEventHandlers=function(){var r=this,t=this.element,n=this.options,f=this.ltm;if(n.size.subscribe(f,(function(){t.trigger(h.Widget.viewSettingsChanged,r.saveViewSettings())})),n.userResizable.subscribeAndRun(f,(function(n){n&&i.tryImmediateResolve(i.require("MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize"),(function(n){n.addUserResizeBehavior(r)}))})),u.computed(f,n.locked,(function(){t.trigger(c.default.fxsizechanged)})).extend({deferred:!0}),u.computed(f,(function(){var i=n.selected(),f=n.selectedFromHover(),e=i||f;u.ignoreDependencies((function(){e&&r._createActionBarWidget(
)}));n.actionBarViewModel.visible(e);t.toggleClass("fxs-tile-selected",i);t.toggleClass("fxs-tile-selectedfromhover",f)})),!n.inLockedContext){var o,s,l=function(){(clearTimeout(s),s=null,n.selectedFromHover())||(o=setTimeout((function(){n.selectedFromHover(!0);o=null}),n.showEnhancedTileMgmtMillis))},a=function(){(clearTimeout(o),o=null,!n.selectedFromHover()||r.actionBarWidget&&r.actionBarWidget.has(document.activeElement))||(s=setTimeout((function(){n.selectedFromHover(!1);s=null}),n.hideEnhancedTileMgmtMillis))},v=function(n){var i=t[0];return i.contains(n.target)&&i.contains(n.relatedTarget)},y=function(n){v(n)||l(n)},p=function(n){v(n)||a(n)},e=t[0],w=function(n){n.keyCode===27&&n.target&&e.contains(n.target)&&r.setFocus(!0)};t.on(c.default.mouseenter,l).on(c.default.mouseleave,a).on(c.default.keydown,".fxs-tile-actionbar-action",w);e.addEventListener(c.default.focus,y,!0);e.addEventListener(c.default.blur,p,!0);f.registerForDispose((function(){t.off(c.default.mouseenter,l).off(c.default.
mouseleave,a).off(c.default.keydown,w);e.removeEventListener(c.default.focus,y,!0);e.removeEventListener(c.default.blur,p,!0)}))}},t})(h.Widget);t.Widget=a}));define("MsPortalImpl/Commands/FileDownloadUtil",["require","exports","f","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Hubs/UI.NotificationManager"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function o(n,t){(t.showDownloadProgressDialog&&t.showDownloadProgressDialog()||t.showUriCallbackConfirmationDialog&&t.showUriCallbackConfirmationDialog())&&n.dismissOpenDialog()}function d(n){var t=(n.httpMethod&&n.httpMethod()||"GET").toUpperCase();return t!=="GET"&&t!=="POST"?null:t}function g(n,t,i){var u=c(n),r={uri:t,type:i,dataType:u,headers:ft(n),checkVersion:!1};return u==="binary"&&(r.processData=!1,r.responseType="arraybuffer"),i==="POST"&&n.httpRequestContent&&!!n.httpRequestContent()&&(r.data=n.httpRequestContent(),r.contentType=n.httpRequestContentType&&n.httpRequestContentType(
)||"application/json"),r}function nt(i,r,u){var e=i.targetFileName()||t.defaultFileName,f=ot(i,r,u);o(r,i);f!==null&&(n.saveAsDlg(f,e),s(i,"success",200))}function h(i,r,u,f,e){o(r,i);n.notifyError(i,f,t.downloadErrorDetails.format(i.errorMessage&&i.errorMessage()||t.downloadError,u,f,e))}function tt(t,i,u,f,e){var a=l(t,e),v=c(t),y;return r.isSafari?k().then((function(n){return n.safariFileDownload(u,a,ut(v,e),v).then((function(){o(i,t);s(t,f,e.status)}),(function(n){h(t,i,"error",400,n)}))})):(y=new Blob([u],{type:"application/octet-stream"}),o(i,t),n.saveAsDlg(y,a),s(t,f,e.status),Q())}function l(n,i){var f=i.getResponseHeader("Content-Disposition"),r=null,e=0,u;return n.targetFileName&&n.targetFileName()?r=n.targetFileName():f&&(u=f.split(";").first((function(n){return n.indexOf("filename")>=0})),u&&u.length>0&&(e=u.indexOf("="))>=0&&(r=u.substring(e+1),r&&(r=r.replaceAll('"',"").trim()))),r||t.defaultFileName}function it(n,t){if(e.navigator.msSaveOrOpenBlob)e.navigator.msSaveOrOpenBlob(n,
t);else{var r=(e.webkitURL||e.URL).createObjectURL(n),i=e.document.createElement("a");i.style.display="none";i.href=r;i.download=t;document.body.appendChild(i);i.click();$(i).remove()}}function rt(n,i,r){s(n,"error",i,r);f.getNotificationManager().addClientNotification({title:t.downloadCommandError,description:r,status:p.Error,timestamp:new Date,cloudName:y.DefaultCloudName})}function ut(n,t){var i=t.getResponseHeader("content-type");return i?i.split(";")[0]:n==="binary"?"application/octet-stream":"text/plain"}function a(n){return n.headers&&n.headers()?i.clone(n.headers()):null}function ft(n){var i=n.authorizationToken&&n.authorizationToken(),t;return i?(t=a(n)||{},t.Authorization=i,t):a(n)}function c(n){var t=n.downloadType&&n.downloadType();return t===2?"binary":"text"}function et(n){var r="text/plain",t,i;return n.length>0&&n[0]&&(t=n[0].split(":"),t.length>1&&t[1]&&(i=t[1].split(";"),i.length>0&&i[0]&&(r=i[0]))),r}function ot(n,i,r){var f=r.split(","),s="text/plain",u,o,l,e;if(f.length>
1&&f[1])if(s=et(f),c(n)==="binary")try{for(u=atob(f[1]),l=new Uint8Array(new ArrayBuffer(u.length)),e=0;e<u.length;e++)l[e]=u.charCodeAt(e);return new Blob([l],{type:s})}catch(a){o=t.dataUriBinaryEncodingError}else try{return u=decodeURIComponent(f[1]),new Blob([u],{type:s})}catch(a){o=t.dataUriTextEncodingError}else o=t.dataUriParseError;return h(n,i,t.dataUriErrorStatusText,400,o),null}function s(n,t,i,r){var u=new b.Status(t,i,r);n.downloadStatus(u);n.onEnd&&n.onEnd(u)}var v=i.Base,y=v.Constants,p=i.Hubs.Notifications.NotificationStatus,w=i.ViewModels,b=w.Controls.FileDownload,e=window,t=u.FileDownloadCommand,k=function(){return i.require("MsPortalImpl/Commands/SafariDownloadUtil")};n.saveAsDlg=it;n.notifyError=rt;n.dismissDialog=o;n.getHttpMethod=d;n.getAjaxOptions=g;n.dataUriHandler=nt;n.onError=h;n.onSuccess=tt;n.getFilename=l})(e||(e={})),e}));define("MsPortalImpl/Services/Services.EditScopeManagement",["require","exports","i","ko"],(function(n,t,i,r){"use strict";var u;return (function(
n){function w(n){return new f(n,c.client)}function h(n,t){return"{0}-{1}-{2}".format(l,n,t)}function e(n){var t=n.split("-"),i=t.slice(1,t.length-1).join("-"),r=t[t.length-1];return{editScopeId:i,extension:r}}var o=i,t=o.Data,s=o.Extension,c=i.Rpc,l="editScopes",a=t.saveSerializedEditScopeEndPoint,v=t.loadSerializedEditScopeEndPoint,y=t.onEditScopeDiscardedEndPoint,p=t.updateEditScopeIsSavingStateEndPoint,u,f;(function(n){n[n.NotDirty=0]="NotDirty";n[n.Dirty=1]="Dirty";n[n.DirtyAndSaving=2]="DirtyAndSaving"})(u=n.EditScopeState||(n.EditScopeState={}));n.createEditScopeManager=w;f=(function(){function n(n,t){var i=this;this._editScopes={};this._extensionManager=n;this._rpcClient=t;v.register(t,null,(function(n,t){var r=t.srcWindowId;return i.loadEditScopeForExtension(n,r)}));a.register(t,null,(function(n,t){var r=t.srcWindowId;i.saveEditScopeForExtension(n.editScopeId,r,n.edits)}));p.register(t,null,(function(n,t){var r=t.srcWindowId;i.updateEditScopeIsSavingStateForExtension(n.editScopeId,r,
n.isSaving)}));n.onUnload((function(n){var t=s.getWindowId(n);return i._onExtensionUnloaded(t),!0}))}return n.prototype.onEditScopeCreated=function(n){this._ensureEditScope(n,!0)},n.prototype.onEditScopeDisposed=function(n){var t=this,i=this._getDirtyExtensionSettings(n);i.forEach((function(i){var f=e(i.key).extension,u=s.getDescriptor(f),r=t._extensionManager.getExtension(u.name,u.cloudName);r&&r.whenInitialized().then((function(){y.invoke(t._rpcClient,r.getWindowId(),n)}))}));this._deleteEditScope(n)},n.prototype.getStateObservable=function(n){var f=this,t=this._ensureEditScope(n),i;return t.stateObservable||(i=r.observable(),t.stateObservable=r.pureComputed((function(){i();var r=f._getDirtyExtensionSettings(n).length>0;return r?t.savingRefCount()>0?u.DirtyAndSaving:u.Dirty:u.NotDirty})),this._loadEditScope(n).then((function(){i(!0)}))),t.stateObservable},n.prototype.logEditsToConsole=function(n){var i=this._editScopes[n]&&this._editScopes[n].settings;i&&i.extensionSettings().forEach((function(n)
{var i=e(n.key);console.debug('Edits for editScopeId: {0}, extension: "{1}"'.format(i.editScopeId,i.extension));t.logEditsToConsole(n.settings)}))},n.prototype.loadEditScopeForExtension=function(n,t){var i=this;return this._loadEditScope(n).then((function(){var f=i._editScopes[n],r,e,u;return f?(r=f.settings,r?(e=h(n,t),u=r.extensionSettings().first((function(n){return n.key===e})),u?u.settings:null):null):null}))},n.prototype.saveEditScopeForExtension=function(n,t,i){var r=this._editScopes[n],u,f,e;this._canEditScopeBeUpdated(r)&&(u=h(n,t),f=r.settings.extensionSettings().firstIndex((function(n){return n.key===u})),f<0?r.settings.extensionSettings.push({key:u,settings:i}):(e=r.settings.extensionSettings()[f],e.settings=i,r.settings.extensionSettings.splice(f,1,e)),r.settings.keys.indexOf(u)<0&&r.settings.keys.push(u))},n.prototype.updateEditScopeIsSavingStateForExtension=function(n,t,i){var r=this._editScopes[n],u;r&&(u=r.savingRefCount()||0,i?r.savingRefCount(u+1):u>0&&r.savingRefCount(u-1))}
,n.prototype.trackingEditScope=function(n){return!!this._editScopes[n]},n.prototype._canEditScopeBeUpdated=function(n){return n?!!n.loadPromise:!1},n.prototype._deleteEditScope=function(n){delete this._editScopes[n]},n.prototype._loadEditScope=function(n){var t=this._ensureEditScope(n);return t.justCreated&&(t.settings={keys:[],extensionSettings:r.observableArray()},t.loadPromise=Q(),t.justCreated=!1),t.loadPromise||(t.loadPromise=this._getAndProcessSettings(n)),t.loadPromise},n.prototype._getAndProcessSettings=function(n){return this._editScopes[n].settings={keys:[],extensionSettings:r.observableArray()},Q()},n.prototype._getDirtyExtensionSettings=function(n){var t=this._editScopes[n]&&this._editScopes[n].settings,i=t&&t.extensionSettings().filter((function(n){var t=n.settings;return t&&t.edits.length>0}));return i||[]},n.prototype._onExtensionUnloaded=function(n){var i,t,r,u;for(i in this._editScopes)t=this._editScopes[i],r=t.savingRefCount()>0,r&&(u=t.settings&&t.settings.extensionSettings(
).some((function(t){return n===e(t.key).extension&&t.settings.edits.length>0})),u&&(this._clearEditScopeEdits(i),t.savingRefCount(0)))},n.prototype._clearEditScopeEdits=function(n){var i=this._editScopes[n],t;this._canEditScopeBeUpdated(i)&&(t=i.settings&&i.settings.extensionSettings,t().forEach((function(n){n.settings=null})),t(t()))},n.prototype._ensureEditScope=function(n,t){t===void 0&&(t=!1);var i=this._editScopes[n];return i||(i=this._editScopes[n]={savingRefCount:r.observable(0),justCreated:t}),i},n})();n.EditScopeManagerImpl=f})(u||(u={})),u}));define("MsPortalImpl/Svg/Startup/Add.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14.969 7.969H7.938V15H7V7.969H-.031v-.938H7V0h.938v7.031h7.031v.938z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/CaretDown.svg",[],(function(){
"use strict";return{type:1,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M11 3.9l-.7-.8L6 7.4 1.7 3.1l-.7.8 5 5z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Clone.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M1 5v11h9V5H1zm7 9H3V7h5v7z'/><path d='M6 0v4h2V2h5v7h-2v2h4V0z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Customize.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 22 22' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path opacity='.9' d='M21.5 3.94c0 .45-.08.89-.26 1.31s-.42.8-.75 1.13l-13.5 13.5L.5 21.5l1.62-6.49 13.5-13.5c.33-.33.7-.58 1.13-.75.42-.17.86-.26 1.31-.26.47 0 .92.09 1.33.27.42.18.78.43 1.09.74s.56.68.74 1.09c.19.42.28.86.28 1.34zm-2.62 2.19c.17-.17.33-.33.49-.48s.3-.31.42-.48.22-.35.29-.54.11-.42.11-.68c0-.29-.06-.57-.17-.82s-.27-.48-.46-.68-.42-.35-.68-.46-.53-.17-.83-.17c-.26 0-.49.04-.68.11-.19.07-.38.17-.54.29s-.33.26-.48.42c-.15.16-.31.32-.48.49l3.01 3zM3.84 15.14c.72.24 1.35.62 1.87 1.14s.9 1.15 1.14 1.87L17.93 7.06l-3-3L3.84 15.14zm-1.53 4.55l3.37-.84c-.07-.31-.18-.61-.33-.89-.15-.28-.34-.53-.56-.75-.22-.22-.47-.41-.75-.56s-.58-.26-.89-.33l-.84 3.37z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/Filter.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M0 1h16v1.711l-6 6V15H6V8.711l-6-6V1zm15 1.289V2H1v.289l6 6V14h2V8.289l6-6z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Fullscreen.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M12 0v4h-1V1.61L1.61 11H4v1H0V8h1v2.38L10.38 1H7.99V0h4z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Share.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M.9 38.9c0 4.1 3.3 7.4 7.4 7.4 1.2 0 2.3-.3 3.3-.8C15.5 48.4 20.2 50 25 50s9.5-1.6 13.4-4.5c1 .5 2.1.8 3.3.8 4.1 0 7.4-3.3 7.4-7.4 0-2.2-1-4.2-2.6-5.6.5-1.8.7-3.7.7-5.5 0-9.4-6.1-17.8-14.9-20.9C32.1 3 28.9 0 25 0s-7.1 3-7.3 6.8C8.8 9.9 2.8 18.3 2.8 27.8c0 1.9.2 3.7.7 5.5C1.9 34.7.9 36.7.9 38.9zm3.7 0c0-2 1.7-3.7 3.7-3.7s3.7 1.7 3.7 3.7-1.7 3.7-3.7 3.7-3.7-1.7-3.7-3.7zm37.1 3.7c-2 0-3.7-1.7-3.7-3.7s1.7-3.7 3.7-3.7 3.7 1.7 3.7 3.7-1.7 3.7-3.7 3.7zM25 3.7c2 0 3.7 1.7 3.7 3.7S27 11.1 25 11.1s-3.7-1.7-3.7-3.7S23 3.7 25 3.7zM6.5 27.8c0-7.7 4.8-14.5 11.8-17.2 1.2 2.5 3.7 4.3 6.7 4.3s5.5-1.8 6.7-4.3c7 2.7 11.8 9.6 11.8 17.2 0 1.3-.1 2.6-.4 3.8-.5-.1-.9-.1-1.4-.1-4.1 0-7.4 3.3-7.4 7.4 0 1.5.5 2.9 1.3 4.1-3.1 2.1-6.7 3.3-10.5 3.3s-7.4-1.2-10.5-3.3c.8-1.2 1.3-2.6 1.3-4.1 0-4.1-3.3-7.4-7.4-7.4-.5 0-1 .1-1.4.1-.5-1.2-.6-2.5-.6-3.8z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/TrashOutline.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14 3h-1v11.5a1.51 1.51 0 0 1-.437 1.063A1.493 1.493 0 0 1 11.5 16h-8a1.51 1.51 0 0 1-1.063-.437A1.482 1.482 0 0 1 2 14.5V3H1V2h4V1a.972.972 0 0 1 .293-.707A.972.972 0 0 1 6 0h3a.972.972 0 0 1 .707.293A.972.972 0 0 1 10 1v1h4v1zm-2 0H3v11.5c0 .136.05.253.148.352A.48.48 0 0 0 3.5 15h8a.48.48 0 0 0 .352-.148A.484.484 0 0 0 12 14.5V3zM6 13H5V5h1v8zM6 2h3V1H6v1zm2 11H7V5h1v8zm2 0H9V5h1v8z'/><\/g><\/svg>"}}));define("MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed",["require","exports","i","ko"],(function(n,t,i,r){"use strict";var u;return (function(){var n;r.extenders.allowOverride||(r.extenders.allowOverride=function(t,u){var e,s,h,o,c,f;if(typeof u=="object"&&u.registerForDispose?
(e=u.createChildLifetime(),s=!0):s=u,s!==!0)throw new Error("'allowOverride' extender only accepts 'true' as a parameter.");return e||(h=n||(n=new i.TriggerableLifetimeManager),e=h.createChildLifetime()),o=!1,f=r.computed(e,{read:t,write:function(n){c=n;o||t(n)}}),f.override=function(n){o=!0;t(n)},f.restoreLastWrittenValue=function(){o=!1;t(c)},f(t()),f})})(u||(u={})),u}));define("MsPortalImpl/Base/Languages",["require","exports","f","o","ko","MsPortalFx/Globalization","MsPortalImpl/Services/Services.Storage"],(function(n,t,i,r,u,f,e){"use strict";function o(n,t){return["en-"+n,"English ("+t+")","English ("+t+")‎"]}function c(n,t,i){return["de-"+n,"German ("+t+")","Deutsch ("+i+")‎"]}function h(n,t,i){return["es-"+n,"Spanish ("+t+")","Español ("+i+")‎"]}function s(n,t,i){return["fr-"+n,"French ("+t+")","Français ("+i+")‎"]}function y(n,t,i){return["pt-"+n,"Portuguese ("+t+")","Português ("+i+")‎"]}function k(){function t(t){var r=this,i=t[0];n[i]={locale:i,name:t[1],localizedName:t[2],neutralCulture:
r,specificCulture:t[3]}}var n={},i=[c("be","Belgium","Belgien"),c("de","Germany","Deutschland"),c("li","Liechtenstein","Liechtenstein"),c("lu","Luxembourg","Luxemburg"),c("ch","Switzerland","Schweiz"),c("at","Austria","Österreich"),o("as","American Samoa"),o("ai","Anguilla"),o("ag","Antigua and Barbuda"),o("au","Australia"),o("bs","Bahamas"),o("bb","Barbados"),o("be","Belgium"),o("bz","Belize"),o("bm","Bermuda"),o("bw","Botswana"),o("io","British Indian Ocean Territory"),o("vg","British Virgin Islands"),o("cm","Cameroon"),o("ca","Canada"),o("029","Caribbean"),o("ky","Cayman Islands"),o("cx","Christmas Island"),o("cc","Cocos (Keeling) Islands"),o("ck","Cook Islands"),o("dm","Dominica"),o("er","Eritrea"),o("150","Europe"),o("fk","Falkland Islands"),o("fj","Fiji"),o("gm","Gambia"),o("gh","Ghana"),o("gi","Gibraltar"),o("gd","Grenada"),o("gu","Guam"),o("gg","Guernsey"),o("gy","Guyana"),o("hk","Hong Kong SAR"),o("in","India"),o("ie","Ireland"),o("im","Isle of Man"),o("jm","Jamaica"),o("je","Jersey"),
o("ke","Kenya"),o("ki","Kiribati"),o("ls","Lesotho"),o("lr","Liberia"),o("mo","Macao SAR"),o("mg","Madagascar"),o("mw","Malawi"),o("my","Malaysia"),o("mt","Malta"),o("mh","Marshall Islands"),o("mu","Mauritius"),o("fm","Micronesia"),o("ms","Montserrat"),o("na","Namibia"),o("nr","Nauru"),o("nz","New Zealand"),o("ng","Nigeria"),o("nu","Niue"),o("nf","Norfolk Island"),o("mp","Northern Mariana Islands"),o("pk","Pakistan"),o("pw","Palau"),o("pg","Papua New Guinea"),o("ph","Philippines"),o("pn","Pitcairn Islands"),o("pr","Puerto Rico"),o("rw","Rwanda"),o("kn","Saint Kitts and Nevis"),o("lc","Saint Lucia"),o("vc","Saint Vincent and the Grenadines"),o("ws","Samoa"),o("sc","Seychelles"),o("sl","Sierra Leone"),o("sg","Singapore"),o("sx","Sint Maarten"),o("sb","Solomon Islands"),o("za","South Africa"),o("ss","South Sudan"),o("sh","St Helena, Ascension, Tristan da Cunha"),o("sd","Sudan"),o("sz","Swaziland"),o("tz","Tanzania"),o("tk","Tokelau"),o("to","Tonga"),o("tt","Trinidad and Tobago"),o("tc","Turks and Caicos Islands"),
o("tv","Tuvalu"),o("um","U.S. Outlying Islands"),o("vi","U.S. Virgin Islands"),o("ug","Uganda"),o("gb","United Kingdom"),o("us","United States"),o("vu","Vanuatu"),o("001","World"),o("zm","Zambia"),o("zw","Zimbabwe"),h("ar","Argentina","Argentina"),h("bo","Bolivia","Bolivia"),h("cl","Chile","Chile"),h("co","Colombia","Colombia"),h("cr","Costa Rica","Costa Rica"),h("cu","Cuba","Cuba"),h("ec","Ecuador","Ecuador"),h("sv","El Salvador","El Salvador"),h("es","Spain, International Sort","España, alfabetización internacional"),h("us","United States","Estados Unidos"),h("ph","Philippines","Filipinas"),h("gt","Guatemala","Guatemala"),h("gq","Equatorial Guinea","Guinea Ecuatorial"),h("hn","Honduras","Honduras"),h("419","Latin America","Latinoamérica"),h("mx","Mexico","México"),h("ni","Nicaragua","Nicaragua"),h("pa","Panama","Panamá"),h("py","Paraguay","Paraguay"),h("pe","Peru","Perú"),h("pr","Puerto Rico","Puerto Rico"),h("do","Dominican Republic","República Dominicana"),h("uy","Uruguay","Uruguay"),
h("ve","Venezuela","Venezuela"),s("dz","Algeria","Algérie"),s("be","Belgium","Belgique"),s("bf","Burkina Faso","Burkina Faso"),s("bi","Burundi","Burundi"),s("bj","Benin","Bénin"),s("cm","Cameroon","Cameroun"),s("ca","Canada","Canada"),s("km","Comoros","Comores"),s("cg","Congo","Congo"),s("cd","French Congo (DRC)","Congo, République démocratique du"),s("ci","Côte d’Ivoire","Côte d’Ivoire"),s("dj","Djibouti","Djibouti"),s("fr","France","France"),s("ga","Gabon","Gabon"),s("gp","Guadeloupe","Guadeloupe"),s("gq","Equatorial Guinea","Guinée équatoriale"),s("gn","Guinea","Guinée"),s("gf","French Guiana","Guyane française"),s("ht","Haiti","Haïti"),s("re","Réunion","La Réunion"),s("lu","Luxembourg","Luxembourg"),s("mg","Madagascar","Madagascar"),s("ml","Mali","Mali"),s("ma","Morocco","Maroc"),s("mq","Martinique","Martinique"),s("mu","Mauritius","Maurice"),s("mr","Mauritania","Mauritanie"),s("yt","Mayotte","Mayotte"),s("mc","Monaco","Monaco"),s("ne","Niger","Niger"),s("nc","New Caledonia","Nouvelle-Calédonie"),
s("pf","French Polynesia","Polynésie française"),s("rw","Rwanda","Rwanda"),s("cf","Central African Republic","République centrafricaine"),s("bl","Saint Barthélemy","Saint-Barthélemy"),s("mf","Saint Martin","Saint-Martin"),s("pm","Saint Pierre and Miquelon","Saint-Pierre-et-Miquelon"),s("sc","Seychelles","Seychelles"),s("ch","Switzerland","Suisse"),s("sy","Syria","Syrie"),s("sn","Senegal","Sénégal"),s("td","Chad","Tchad"),s("tg","Togo","Togo"),s("tn","Tunisia","Tunisie"),s("vu","Vanuatu","Vanuatu"),s("wf","Wallis and Futuna","Wallis-et-Futuna"),["it-it","Italian (Italy)","Italiano (Italia)‎"],["it-sm","Italian (San Marino)","Italiano (San Marino)‎"],["it-ch","Italian (Switzerland)","Italiano (Svizzera)‎"],["hu-hu","Hungarian (Hungary)","Magyar (Magyarország)‎"],["nl-aw","Dutch (Aruba)","Nederlands (Aruba)‎"],["nl-be","Dutch (Belgium)","Nederlands (België)‎"],["nl-bq","Dutch (Bonaire, Sint Eustatius and Saba)","Nederlands (Bonaire, Sint Eustatius en Saba)‎"],["nl-cw","Dutch (Curaçao)","Nederlands (Curaçao)‎"],
["nl-nl","Dutch (Netherlands)","Nederlands (Nederland)‎"],["nl-sx","Dutch (Sint Maarten)","Nederlands (Sint-Maarten)‎"],["nl-sr","Dutch (Suriname)","Nederlands (Suriname)‎"],["pl-pl","Polish (Poland)","Polski (Polska)‎"],y("br","Brazil","Brasil"),y("pt","Portugal","Portugal"),["sv-fi","Swedish (Finland)","Svenska (Finland)‎"],["sv-se","Swedish (Sweden)","Svenska (Sverige)‎"],["sv-ax","Swedish (Åland Islands)","Svenska (Åland)‎"],["tr-cy","Turkish (Cyprus)","Türkçe (Kıbrıs)‎"],["tr-tr","Turkish (Turkey)","Türkçe (Türkiye)‎"],["qps-ploc","Pseudo (Pseudo)","[Þšéųδô (Ρŝέũδθ) !!! !!]‎"],["cs-cz","Czech (Czechia)","Čeština (Česko)‎"],["ru-by","Russian (Belarus)","Русский (Беларусь)‎"],["ru-kz","Russian (Kazakhstan)","Русский (Казахстан)‎"],["ru-kg","Russian (Kyrgyzstan)","Русский (Киргизия)‎"],["ru-md","Russian (Moldova)","Русский (Молдова)‎"],["ru-ru","Russian (Russia)","Русский (Россия)‎"],["ru-ua","Russian (Ukraine)","Русский (Украина)‎"],["zh-cn","Chinese (Simplified, China)","中文(中国)‎"],
["zh-tw","Chinese (Traditional, Taiwan)","中文(台灣)‎"],["zh-sg","Chinese (Simplified, Singapore)","中文(新加坡)‎"],["zh-mo","Chinese (Traditional, Macao SAR)","中文(澳門特別行政區)‎"],["zh-hk","Chinese (Traditional, Hong Kong SAR)","中文(香港特別行政區)‎"],["ja-jp","Japanese (Japan)","日本語 (日本)‎"],["ko-kp","Korean (North Korea)","한국어 (조선민주주의인민공화국)‎"],["ko-kr","Korean (Korea)","한국어(대한민국)‎"],];return[["de","German","Deutsch‎","de-de"],["en","English","English‎","en-us"],["es","Spanish","Español‎","es-es"],["fr","French","Français‎","fr-fr"],["it","Italian","Italiano‎","it-it"],["hu","Hungarian","Magyar‎","hu-hu"],["nl","Dutch","Nederlands‎","nl-nl"],["pl","Polish","Polski‎","pl-pl"],["pt","Portuguese","Português‎","pt-br"],["sv","Swedish","Svenska‎","sv-se"],["tr","Turkish","Türkçe‎","tr-tr"],["cs","Czech","Čeština‎","cs-cz"],["ru","Russian","Русский‎","ru-ru"],["zh","Chinese","中文‎","zh-cn"],["zh-hans","Chinese (Simplified)","中文(简体)‎","zh-cn"],["zh-chs","Chinese (Simplified) Legacy","中文(简体) 旧版‎","zh-cn"],["zh-hant",
"Chinese (Traditional)","中文(繁體)‎","zh-tw"],["zh-cht","Chinese (Traditional) Legacy","中文(繁體) 舊版‎","zh-tw"],["ja","Japanese","日本語‎","ja-jp"],["ko","Korean","한국어‎","ko-kr"],].forEach(t,!0),i.forEach(t,!1),n}function d(n){var i=t.knownCulturesMap[n];return i?i.localizedName:null}function g(n){var i=a.NativeIntl||a.Intl,t=n.split(".")[1];try{if(!i||t==="en-in"&&i.DateTimeFormat(t).format(new Date(2016,0,9))==="1/9/2016")return!0;t&&i.DateTimeFormat(t,{hour:"numeric",minute:"numeric"})}catch(r){return!0}return!1}function nt(n,t){var i=[];return n.forEach((function(n){n in t&&i.push(t[n])})),i}function tt(n){var r=i.convertArrayToMap(n,(function(n){return n.locale.split("-")[0]}));return v(t.knownCulturesMap,(function(n,t,i){var u=n.split("-");u.length>1&&!t.neutralCulture&&r[u[0]]&&i.push(t)}),[])}function it(n,t,i){return n?n.split(".")[1]:i}function p(n){var i=n.displayLanguage,r=nt(n.supportedLocales,t.knownCulturesMap);return{selectableDisplayLanguages:r,selectedDisplayLanguage:i,selectedFormatCulture:
it(n.rawLocaleSetting,i,n.formatCulture),selectableFormatCultures:tt(r)}}function rt(n,r,e,o,s){r.setValue(l,"LastUsedLocale",o,0);var h=!1;return u.reactor(n,(function(){var c=e(),n=JSON.parse(r.getValue(l,t.redirectQueryKey,0)||"{}"),u,f;n.l=c||"";u=c||o;s||u===o||(h=!0);f=i.getFeatureValue("intlpolyfill");f!=="false"&&(n["feature.intlpolyfill"]=g(u)?"true":"",n["feature.intlpolyfill"]&&f==="true"&&(h=!0));r.setValue(l,t.redirectQueryKey,JSON.stringify(n),0)})),t.currentLocaleContext=p({supportedLocales:b,displayLanguage:f.displayLanguage,formatCulture:f.formatCulture,rawLocaleSetting:e()}),h}var v,l;r.defineProperty(t,"__esModule",{value:!0});var a=window,w=a.fx.environment,b=w.supportedLocales;t.knownCulturesMap=k();v=i.forEachKey;t.redirectQueryKey="LocaleQuery";t.localeDelimiter=".";l=e.ComponentName.Redirect;t.getLocalizedName=d;t.createLocaleContext=p;t.initialize=rt}));define("MsPortalImpl/Services/Services.AssetTypes",["require","exports","f","i","o","a","ko","FxHubs/RpcEndPoints",
"MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.Router","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Services/Services.PortalIdentity"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function kr(n){dt.push(n)}function ut(n){return ct(n)||lt(n)}function ft(n){return ut(n)||fi(n)}function uf(n,t){return ct(n)&&ct(t)&&yr(n,t)}function ff(n,t){return lt(n)&&lt(t)&&bu(n,t)}function ef(n,t){return fi(n)&&fi(t)&&ku(n,t)}function vi(n,t){return uf(n,t)||ff(n,t)||ef(n,t)}function of(n,t){return n===et.ExtensionNames.Billing&&t===bt.SubscriptionDetail}function at(n){return wr(n).toLowerCase()}function dr(n,t){return pr(n)&&pr(t)?k.compareResourceManagerId(n,t):i.deepEquals(n,t)}function yi(n,t){var i=t;return(n&1)==1&&(i.startsWith("/subscriptions/")||(i="/subscriptions/"+i)),i}function gr(n,t){var i=pi(n);return!!(i&&(typeof t.assetId=="string"||i.mappingViewModel))}function nu(n){return ct(n)?ot.Subscriptions:lt(n)?
ot.ResourceGroups:wr(n)}function sf(n,t,i){return i&&i.toLowerCase()}function iu(n){return n.replace(tu,sf)}function hf(n){return n.match(ru)}function cf(n,t,i){return iu(n+" "+t+i||(i?" "+i:""))}function uu(n,t,r){var u;return au(n,er)?u=tt(n,r):lu(n)?(u=tt(n.message||t,n.stack,r),i.shallowCopyFromObject(u,n,["readyState","status","statusText","responseText"])):u=tt(new er({message:t,data:r,innerErrors:n})),u}function lf(n){var t=n.text||n.name,i=n.pluralDisplayName||t;return{plural:i,singular:n.singularDisplayName||t,lowerPlural:n.lowerPluralDisplayName||t,lowerSingular:n.lowerSingularDisplayName||t,service:n.serviceDisplayName||i}}function fu(n,t,i){var r;return dt.some((function(u){return r=u.provideAssetTypeKeywords(n,t,i),!!r})),r}function af(n){var t;return dt.some((function(i){return t=i.provideCategoryName(n),!!t})),t||n}function vf(){return ai}function yf(n){ai=n}function d(n){return n.resourceType}function pi(n){return d(n.assetTypeManifest)}function wi(n){var t=d(n);return t&&t.
resourceTypeName&&t.resourceTypeName.toLowerCase()}function gt(n,t,i,u,f){var e;return i===void 0&&(i=null),u===void 0&&(u=null),f===void 0&&(f=null),e=n.assetTypeManifest,u=u||e.bladeExtensionName||n.extension,i=i||e.bladeName,!i&&d(e)&&(i=rt,u=b),{icon:f||n.icon,selection:r.ViewModels.getBladeSelection(n.cloudName,u,i,{id:t}),isPreview:n.isPreview}}function bi(n,t){var r;if(t){var u=n.assetTypeManifest,f=wi(u),i=function(n){return(t&n)===n};if(i(1)&&((r=u.browseType,r===undefined)||i(5)&&(r!==vr||!f)||i(9)&&(r!==ui||!u.browseLinkUri||i(25)&&r!==ui))||i(2)&&!f)return!1}return!0}function vt(n,t,i){return n.extensionName===t&&n.assetType===i}function yt(n,t,i,r){return vt(n,t,i)&&dr(n.assetId,r)}function pf(n,t){return"Extension <"+n+"> : AssetType <"+t+"> : ID <REDACTED>"}function ki(n,t,i){return tt("Asset type does not specify a resource type. Extension <"+t+"> : AssetType <"+i+"> : "+n)}function pt(n){return tt("Resource ID <"+k.sanitizeId(n)+"> is not a subscription ID, resource group ID or resource ID.")}
function ni(n,t,i){return new Error("The "+n+" view model was already disposed. Extension <"+t+"> : ViewModel <"+i+">")}function wf(n,t){var r=function(n,t){return hr((n||"").split(",").filter((function(n){return!!n})).concat(t)).join(",")},u=t.name,i=fu(n,u,""),f;i&&i.length&&(t.keywords=r(t.keywords,i));f=d(t)||{};(f.kinds||[]).forEach((function(t){var f=(t.name||"").toLowerCase(),i=fu(n,u,f);i&&i.length&&(t.keywords=r(t.keywords,i))}))}function eu(n,t,i,r){var u=t.name;return{lowerCaseAssetType:i.name.toLowerCase(),lowerCaseExtension:u.toLowerCase(),lowerCaseResourceType:wi(i)||"",assetTypeManifest:i,id:n,extension:u,cloudName:r,compositeDisplayName:lf(i),icon:i&&i.icon||du,isPreview:t.isPreview||!!i.isPreview}}function bf(n){if(n.routingType===kt.Tenant||n.routingType===kt.ProviderProxy){var t=n.resourceTypeName.split("/");return i.first(t)+"/"+i.last(t)}}function di(n){return nt.getDescriptor(n.srcWindowId).cloudName}function kf(n,t){nt.getAssetTypeInformationEndPoint.register(n,null,
(function(n,i){return t.getAssetTypeInformation(n.extensionName,n.assetType,di(i))}));nt.getResourceTypeAssetTypeInformationEndPoint.register(n,null,(function(n,i){return t.getResourceTypeAssetTypeInformation(n,di(i))}));nt.mapAssetIdToDynamicSelectionAndIconEndPoint.register(n,null,(function(n,i){var r={reason:"mapAssetIdToDynamicSelectionAndIcon",extension:i.srcWindowId};return t.mapAssetIdToDynamicSelectionAndIcon(n.assetId,di(i),r)}))}function df(n,t){var i=nt.getHubsWindowId(),u=new r.TriggerableLifetimeManager,f={assetTypesInformation:e.computed(u,(function(){return t.assetTypes().map((function(n){return t.mapAssetTypeToResourceTypeAssetTypeInformation(n)}))})),isPartialSet:e.computed(u,(function(){return t.allManifestsLoaded()}))};o.AssetTypes.getAssetTypesInformationObservableEndPoint.registerObjectFactory(n,{allowedOrigin:[i],allowRemoteChanges:!1,handler:function(){return Q(e.observable(f))}});o.AssetTypes.mapAssetIdToDynamicSelectionAndIconEndPoint.register(n,[i],(function(n){return t.mapAssetIdToDynamicSelectionAndIcon(
n.assetTriplet,n.cloudName,{reason:"mapAssetIdToDynamicSelectionAndIcon",extension:"HubsExtension"}).then((function(n){return n}))}))}function gi(n,t){i.disposeViewModelProperties(t);n.releaseViewModel(t)}function gf(n){return Q({icon:n.icon,kind:null,isPreview:n.isPreview})}function g(n,t,i){var r=t&&(f.isArray(t)?t:[t]),u;r&&(u=n.length+r.length-i,u>0&&n.splice(0,u),n.push.apply(n,r))}function w(n,t){return i.find(n,t,-1)}function ne(n,t,i){return new ou(i,n,t||a.getSignedInUser())}function te(n){var t=n.rpcClient,i=n.assetTypeService;kf(t,i);df(t,i)}function nr(n,t){n&&n.split(",").forEach(t)}var dt,tu,ru,ou;u.defineProperty(t,"__esModule",{value:!0});var nt=r.Extension,wt=i.Base,et=wt.Constants,bt=et.AssetNames,tr=et.BladeNames.Hubs,b=et.ExtensionNames.Hubs,ot=et.ResourceTypes,su=i.Extension,hu=r.Rpc,ir=i.ViewModels,k=ir.Services.ResourceTypes,rr=i.Assets,ur=r.Assets,kt=su.ResourceRoutingType,cu=ir.Services.DynamicBlade,lu=i.Helpers.isXMLHttpRequestLike,fr=i.Errors,au=fr.isInstanceOfErrorType,
er=fr.Error,p=i.tryImmediateResolve,vu=window,or=vu.fx.environment,st=wt.Diagnostics.createLog(n),sr=function(n){return st.warning(n)};t.allAssetTypesRetrievalTimeoutInMilliseconds=5e3;var it="Timeout trying to load extension manifest",v=i.remove,hr=i.unique,cr=i.require,ti=i.getFeatureValue,yu=i.isFeatureEnabled,ii=i.clone,lr="ResourceMap$ResourceProviderViewModel",ar="MsPortalImpl/Services/Services.AssetTypesDelayed",pu="(none)",rt=tr.ResourceMenuBlade,ri=-1,vr=1,ui=3,wu=0,ht=rr.supportsContract,tt=wt.Diagnostics.createIgnoreUnhandledRejectionError,ct=k.isSubscriptionId,yr=k.compareSubscriptionId,lt=k.isResourceGroupId,bu=k.compareResourceGroupId,fi=k.isResourceId,ku=k.compareResourceId,pr=k.isResourceManagerId,wr=k.buildResourceTypeFromResourceId,ei=ur.getAssetTypeOrResourceTypeId,oi=nt.isEqualDescriptor,y=nt.isEqualCloudName,si=nt.getWindowId,br=bt.NonAssetResource,hi=c.getBladeDeepLink,ci=nt.getDescriptor(b),li=nt.CloudName.addToModel,du=wt.Images.Polychromatic.ResourceDefault(),gu=
ti("assettypeapiversion"),nf=ti("showassettypes"),tf=ti("hideassettypes"),ai=[],rf=yu("servicemenu");t.failedToFindAssetTypePrefix="Could not find the asset type";dt=[];t.registerStringProvider=kr;t.compareAssetId=dr;tu=/(^|[^A-Za-z0-9]*)([A-Za-z0-9]+)/g;ru=/^https?:\/\//i;kr({provideCategoryName:function(n){return s.BrowseCategories[iu(n)]||n},provideAssetTypeKeywords:function(n,t,i){var r=s.AssetTypeKeywords[cf(n,t,i)];return r?r.split(","):[]}});t.provideCategoryName=af;t.getCloudNames=vf;t.setCloudNames=yf;t.createViewModelDisposedError=ni;t.createAssetTypeService=ne;t.setupAssetTypeServiceRpc=te;t.Internal={};ou=(function(){function n(n,t,u){var f=this,h,o,s;this._resourceMappingCache=r.getCloudMap();this._resourceAssetIdCache=r.getCloudMap();this._assetIdToResourceIdPromises=[];this._resourceIdToAssetIdPromises=[];this._assetIdSelectionCache=r.getCloudMap();this._resourceIdSelectionCache=r.getCloudMap();this._assetIdIconAndKindCache=r.getCloudMap();this._resourceGroupCache=r.getCloudMap(
);this._resourceCache=r.getCloudMap();this._assetTypePromises=[];this._assetTypeByIdPromises=[];this._assetTypeByIdBrowseLink={};this._assetTypeByResourceTypePromises=[];this._resourceTypeMappingPromises=[];this._selectionFromAssetIdPromises=[];this._selectionFromResourceIdPromises=[];this._iconAndKindFromResourceIdPromises=[];this._resourceGroupPromises=[];this._resourcePromises=[];this._apiVersionOverrides={};this._assetTypeOverrides={};this._callbacks=[];this._preprocess=Q(!0);this._memoizedManifestsLoadedError=i.memoize((function(n){return tt(n)}));this._getResourceProvider=i.memoizeQ((function(){return p(f._extensionManager.getHubsExtension(),(function(n){return Q(n.getViewModel(lr)).then((function(t){f._resourceProviderLifetime||(f._resourceProviderLifetime=f._lifetimeManager.createChildLifetime());return(f._resourceProviderLifetime.registerForDispose((function(){gi(n,t)})),!0)?t.content:Q.reject(ni("resource map provider",b,lr))}))}))}));this._getResourceTypeCachePromise=i.memoizeQ((function(
n){return p(f._getResourceProvider(),(function(t){return Q(t.getResourceTypeCache(n))}))}));this.getAssetTypeByIdPromise=this._getAssetTypeById;this.getAssetTypeByResourceTypePromise=this._getAssetTypeByResourceType;this.getResourceTypeAssetTypeInformation=this._getResourceTypeAssetTypeInformation;h=this._lifetimeManager=new r.TriggerableLifetimeManager;o=this._assetTypes=e.observableArray();o.extend({deferred:!0});this._extensionManager=t;this._client=n;this._cachedUser=u;this._initialLoad=this._listenForExtensions();this._initialLoad.then((function(){v(f._callbacks,(function(n){return!n()}))}));nr(gu,(function(n){var t=n.split(":");t.length===2&&(f._apiVersionOverrides[t[0].toLowerCase()]=t[1])}));s=function(n){return function(t){f._assetTypeOverrides[t.toLowerCase()]=n}};nr(nf,s(!0));nr(tf,s(!1));this._getAssetTypeInfoComputed=o.map(h,(function(n,t){return f._mapAssetTypeToInternalResourceTypeAssetTypeInformation(t)}))}return n.prototype._onManifestLoaded=function(n){return this._callbacks.push(
n),n},n.prototype._offManifestLoaded=function(n){v(this._callbacks,n)},n.prototype._getDynamicBladePromiseForAssetType=function(n,t){var u=n.assetTypeManifest,i=n.extension,r=u.dynamicBladeServiceViewModel;if(!r)throw tt("Missing dynamic blade service view model. Extension <"+i+"> : AssetType <"+u.name+">");return this._extensionManager.getExtensionByName(i,n.cloudName).then((function(n){return Q(n.getViewModel(r)).then((function(u){var f=!1;if(t.registerForDispose((function(){f=!0;gi(n,u)})),!f)return u.content;throw ni("dynamic blade service",i,r);}))}))},n.prototype._mapAssetTypeToInternalResourceTypeAssetTypeInformation=function(n){var t=this.mapAssetTypeToResourceTypeAssetTypeInformation(n);return t.cloudName=n.cloudName,t},n.prototype._getAssetTypePromise=function(n,i){var f=this,r=i(),o;if(r)return Q(r);if(o=t.failedToFindAssetTypePrefix+" "+n+" after all extension manifests loaded.",this.allManifestsLoaded())return Q.reject(this._memoizedManifestsLoadedError(o));var e=Q.defer(),u=e.promise,
s=this._onManifestLoaded((function(){return Q.isPending(u)&&(r=i(),r&&e.resolve(r),Q.isPending(u)&&f.allManifestsLoaded()&&e.reject(f._memoizedManifestsLoadedError(o))),Q.isPending(u)}));return Q.delay(2e4).then((function(){f._offManifestLoaded(s);Q.isPending(u)&&e.reject(f._memoizedManifestsLoadedError(it))})),u},n.prototype._getAssetTypeByResourceType=function(n,t,i){var f=this,e=n.toLowerCase(),o=w(this._assetTypeByResourceTypePromises,(function(n){return y(n.cloudName,t)&&n.resourceType===e&&n.requirements===i})),r,u;return o?o.promise:(r=this._getAssetTypePromise("resourceType: <"+n+">",(function(){return f.getAssetTypeByResourceType(n,t,i)})),Q.isRejected(r)||(u={resourceType:e,promise:r,requirements:i,cloudName:t},g(this._assetTypeByResourceTypePromises,u,200),Q.isPending(r)&&r.catch((function(n){n.message===it&&st.warning(it);v(f._assetTypeByResourceTypePromises,u)}))),r)},n.prototype._getResourceTypeMappingPromiseForAssetType=function(n,t){var u=pi(n),i=u&&u.mappingViewModel,r;if(!i)throw tt(
"Resource type missing resource type mapping view model. AssetType <"+n+">");return r=n.extension,this._extensionManager.getExtensionByName(r,n.cloudName).then((function(n){return Q(n.getViewModel(i)).then((function(u){var f=!1;if(t.registerForDispose((function(){f=!0;gi(n,u)})),!f)return u.content;throw ni("resource type mapping",r,i);}))}))},n.prototype._getMappingViewModel=function(n){var i=this._resourceTypeMappingPromises,u=this._resourceMappingCache,r,t;if(u.getOrSet(n.cloudName,new h.LifetimeItemCache(3e4)).hasEntry(n.id))return Q(u.get(n.cloudName).getEntry(n.id));if(r=n.lowerCaseResourceType,t=w(i,(function(t){return y(t.cloudName,n.cloudName)&&t.resourceType===r})),t)return t.promise;var f=this._lifetimeManager.createChildLifetime(),e=this._getResourceTypeMappingPromiseForAssetType(n,f).then((function(e){return u.get(n.cloudName).addEntry(n.id,e,f),t=w(i,(function(t){return y(t.cloudName,n.cloudName)&&t.resourceType===r})),t&&v(i,t),e})),o={resourceType:r,cloudName:n.cloudName,promise:e};
return g(i,o,200),e},n.prototype._getDynamicBladeReference=function(n,t){var i=this._lifetimeManager.createChildLifetime();return this._getDynamicBladePromiseForAssetType(n,i).then((function(n){if(typeof n.onInputsSet!="function")return null;var i=n.onInputsSet({assetId:t.assetId,usage:cu.Usage.DynamicAssetSelection});return Q(i||!0).then((function(){return n})).catch((function(){return null}))})).then((function(n){return n&&n.bladeName()?{blade:n.bladeName(),extension:n.extensionName()}:null})).finally((function(){i.dispose();i=null}))},n.prototype._getDynamicSelectionAndIconFromAssetId=function(n,t){var r=gt(n,t.assetId),u=this._selectionFromAssetIdPromises,f=w(u,(function(i){return y(i.cloudName,n.cloudName)&&yt(i.assetId,t.extensionName,t.assetType,t.assetId)})),i;return f?f.promise:(i=function(i){return g(u,{assetId:t,cloudName:n.cloudName,promise:i},200),i},n.assetTypeManifest.dynamicBladeServiceViewModel)?i(this._getDynamicBladeReference(n,t).then((function(i){return i?gt(n,t.assetId,i.blade,
i.extension):r}))):i(Q(r))},n.prototype._getResourceReference=function(n,t,i){var o=this,u=this._resourceCache,r=t.cloudName,f,e;return u.getOrSet(r,new h.ItemCache(3e5)).hasEntry(n)?Q(u.get(r).getEntry(n)):(f=w(this._resourcePromises,(function(t){return y(t.cloudName,r)&&t.resourceId===n})),f)?f.promise:(e=this._getResourceProvider().then((function(f){var e;return e=ht(t.assetTypeManifest.contracts,64)?Q(f.getExtensionResource(n,o.mapAssetTypeToResourceTypeAssetTypeInformation(t),r,i)):Q(f.getResource(n,r,i)),e.then((function(t){return u.get(r).addEntry(n,t),v(o._resourcePromises,(function(t){return y(t.cloudName,r)&&t.resourceId===n})),t}))})),g(this._resourcePromises,{resourceId:n,cloudName:r,promise:e},200),e)},n.prototype._getResourceGroupReference=function(n,t,i){var o=this,r=this._resourceGroupCache,u,f,e;return r.getOrSet(t,new h.ItemCache(3e5)).hasEntry(n)?Q(r.get(t).getEntry(n)):(u=function(){return w(o._resourceGroupPromises,(function(i){return y(i.cloudName,t)&&i.resourceGroupId===n})
)},f=u(),f)?f.promise:(e=p(this._getResourceProvider(),(function(f){return Q(f.getResourceGroup(n,t,i)).then((function(i){r.get(t).addEntry(n,i);var f=u();return f&&v(o._resourceGroupPromises,f),i}))})),g(this._resourceGroupPromises,{resourceGroupId:n,cloudName:t,promise:e},200),e)},n.prototype._getDynamicSelectionAndIconFromResourceId=function(n,t,i,u,f){var v=this,o=gt(n,i.assetId),e=o.selection,s=n.assetTypeManifest,h,l,c,a;return ct(t)?Q(r.Azure.getAllSubscriptions(this._client||hu.client,u)).then((function(n){if(!n.first((function(n){return yr("/subscriptions/"+n.subscriptionId,t)}))){var i=tt("Could not find subscription",null,{subId:t});i.status=404;throw i;}return e.extension=b,e.detailBlade=rt,o})):lt(t)?this._getResourceGroupReference(t,u,f).then((function(n){if(n.error)throw n.error;return e.extension=b,e.detailBlade=rt,o})).catch((function(r){var e=uu(r,"_getDynamicSelectionAndIconFromResourceId have unexpected error.",{assetType:n,resourceId:t,assetId:i,cloudName:u,telemetry:f});return Q.
reject(e)})):(h=d(s),h&&h.routingType===kt.Extension&&!ht(n.assetTypeManifest.contracts,64))?Q(o):(l=w(this._selectionFromResourceIdPromises,(function(i){return y(i.cloudName,n.cloudName)&&i.resourceId===t})),l)?l.promise:(c=this._getResourceReference(t,n,f).then((function(t){var r,u;if(t.error)throw t.error;return s.name===br?(e.extension=b,e.detailBlade=rt,o):(r=!1,s.viewModel&&ht(s.contracts,8)&&(e.extension=b,e.detailBlade=rt,r=!0),u=function(){return s.dynamicBladeServiceViewModel?v._getDynamicBladeReference(n,i).then((function(t){return t?gt(n,i.assetId,t.blade,t.extension,o.icon):o})):Q(o)},cr(ar).then((function(i){if(h&&h.kinds){var c=!1,l=!1,f=!1;if(i.getIconAndBladeFromAssetTypeInformation(t,h.kinds,null,(function(n){n?s.viewModel&&ht(s.contracts,16)&&(e.extension=b,e.detailBlade=rt,r=!0):r=!1}),(function(n){l||(l=!0,o.isPreview=n)}),(function(n){c||(c=!0,o.icon=n)}),(function(t,i){f||r||(f=!0,e.extension=t||n.extension,e.detailBlade=i)})),f||r)return o}return u()})))})).catch((function(r){var
e=uu(r,"_getDynamicSelectionAndIconFromResourceId have unexpected error.",{assetType:n,resourceId:t,assetId:i,cloudName:u,telemetry:f});return Q.reject(e)})),a={resourceId:t,cloudName:n.cloudName,promise:c},g(this._selectionFromResourceIdPromises,a,200),c.catch((function(){v._selectionFromResourceIdPromises.remove(a)})),c)},n.prototype._getIconAndKindFromResourceId=function(n,t,i,r,u){var c=this,f={icon:n.icon,kind:null,isPreview:n.isPreview},l=n.assetTypeManifest,e,s,o,h;return ut(t)?Q(f):(e=d(l),e&&e.routingType===kt.Extension&&!ht(n.assetTypeManifest.contracts,64))?Q(f):(s=w(this._iconAndKindFromResourceIdPromises,(function(n){return n.resourceId===t&&y(n.cloudName,r)})),s)?s.promise:(o=p(this._getResourceReference(t,n,u),(function(n){return n.error?Q.reject(n.error):p(cr(ar),(function(t){if(e&&e.kinds){var i=!1,r=!1,u=!1;t.getIconAndBladeFromAssetTypeInformation(n,e.kinds,(function(n){i||(i=!0,f.kind=n)}),null,(function(n){u||(u=!0,f.isPreview=n)}),(function(n){r||(r=!0,f.icon=n)}))}return Q(f)})
)})),h={resourceId:t,promise:o,cloudName:r},g(this._iconAndKindFromResourceIdPromises,h,200),o.catch((function(){c._iconAndKindFromResourceIdPromises.remove(h)})),o)},n.prototype._getResourceTypeAssetTypeInformation=function(n,i){var e=this,o=t.Internal.getResourceTypeAssetTypeInformationOverride,c;if(o)return Q(o(n,i));var s=function(n,t){return{resourceType:n,topLevelTenantAlias:null,topLevelResourceTypeAlias:null,cloudName:null,extensionName:null,assetType:null,browseType:ri,compositeDisplayName:null,icon:null,viewModel:null,contracts:0,lowerCaseExtension:null,lowerCaseAssetType:null,lowerCaseResourceType:n.toLowerCase(),reason:r.Diagnostics.getLogFriendlyMessage(t)}},u=[],f=[],h=hr(n.map((function(n){return n.toLowerCase()}))).filter((function(n){var t=n.split("/").length>=2;return t||f.push(n),t}));return f.length&&(c=new Error("Invalid resource type"),u.push.apply(u,f.map((function(n){return s(n,c)})))),h.sort(),h.forEach((function(n){var t=p(e.getAssetTypeByResourceTypePromise(n,i),(function(
n){return e.mapAssetTypeToResourceTypeAssetTypeInformation(n)}),(function(t){return s(n,t)}));u.push(t)})),Q.all(u)},n.prototype._flushCachesForAssetType=function(n){var r=n.assetTypeManifest.name,u=n.extension,t=n.cloudName,f,i;this._resourceMappingCache.getOrSet(t,new h.LifetimeItemCache(3e4)).removeEntry(n.id);this._resourceAssetIdCache.getOrSet(t,new h.ItemArrayCache(216e5)).removeEach((function(n){return vt(n.assetId,u,r)}));v(this._assetIdToResourceIdPromises,(function(n){return y(n.cloudName,t)&&vt(n.assetId,u,r)}));this._assetIdSelectionCache.getOrSet(t,new h.ItemArrayCache(216e5)).removeEach((function(n){return vt(n.assetId,u,r)}));v(this._assetTypePromises,(function(n){return y(n.cloudName,t)&&n.extension===u&&n.assetType===r}));f=ei(u,t,r);v(this._assetTypeByIdPromises,(function(n){return n.assetTypeId===f}));this._assetTypeByIdBrowseLink[f]&&delete this._assetTypeByIdBrowseLink[f];v(this._selectionFromAssetIdPromises,(function(n){return y(n.cloudName,t)&&vt(n.assetId,u,r)}));u===b&&r===bt.
ResourceGroups&&(this._resourceGroupCache.all().forEach((function(n){n.flush()})),v(this._resourceGroupPromises,(function(n){return y(n.cloudName,t)})));i=n.lowerCaseResourceType;i&&(v(this._resourceIdToAssetIdPromises,(function(n){return ut(n.resourceId)||!y(n.cloudName,t)?!1:at(n.resourceId)===i})),this._resourceIdSelectionCache.getOrSet(t,new h.ItemArrayCache(216e5)).removeEach((function(n){return ut(n.resourceId)?!1:at(n.resourceId)===i})),this._resourceCache.getOrSet(t,new h.ItemCache(3e5)).removeEach((function(n){return ut(n)?!1:at(n)===i})),v(this._assetTypeByResourceTypePromises,(function(n){return y(n.cloudName,t)&&n.resourceType===i})),v(this._resourceTypeMappingPromises,(function(n){return y(n.cloudName,t)&&n.resourceType===i})),v(this._selectionFromResourceIdPromises,(function(n){return ut(n.resourceId)||!y(n.cloudName,t)?!1:at(n.resourceId)===i})),v(this._resourcePromises,(function(n){return ut(n.resourceId)||!y(n.cloudName,t)?!1:at(n.resourceId)===i})))},n.prototype._preventDuplicateResourceTypes=
function(n,t){var i=wi(t),u=function(t){sr("Extension <"+n.name+"> has duplicate resource type <"+i+"> also found in <"+t+"> extension")},r=w(this._assetTypes(),(function(t){return y(t.cloudName,n.cloudName)&&t.lowerCaseResourceType===i}));return r?(u(r.extension),!1):!0},n.prototype._listenForExtensions=function(){var n=this,r=this._extensionManager,t=this._mappedBrowseBlades={};return r.on("assetTypes",(function(r){return p(n._preprocess,(function(){var f=n._assetTypes(),u,e,o,s;n._assetTypes.valueWillMutate();u=f.filter((function(n){return oi(r,{name:n.extension,cloudName:n.cloudName})}));u.forEach((function(t){n._flushCachesForAssetType(t)}));e=si(r).toLowerCase();t[e]=t[e]||{};o=r.assetTypes;o&&o.forEach((function(e){var h=i.find(u,(function(n){return n.assetTypeManifest.name===e.name})),o,s,w,l,a,y,p;if((h&&(v(u,h),f.remove(h)),e.browseType!==4)&&(e.browseType!==3||hf(e.browseLinkUri||""))){if(o=d(e),s=o&&o.resourceTypeName,s){if(w=s.split("/"),w.length<2){sr("Skipping asset type <"+e.name+
"> with invalid resource type <"+s+"> in extension <"+r.name+">");return}if(!n._preventDuplicateResourceTypes(r,e))return}var k=function(n,i,u){if(n&&u){var f=si({cloudName:r.cloudName,name:i||r.name}).toLowerCase(),e=t[f]||(t[f]={});e[n.toLowerCase()]=!0}},c=o&&o.kinds,g=rr.supportsContract(e.contracts,8);c&&c.length?c.forEach((function(n){k(n.bladeName||e.bladeName,n.bladeExtensionName||e.bladeExtensionName,n.useResourceMenu!==undefined?n.useResourceMenu:g)})):k(e.bladeName,e.bladeExtensionName,g);wf(r.name,e);l=ei(r.name,r.cloudName,e.name);a=l.toLowerCase();o&&(y=n._apiVersionOverrides[a],y&&(d(e).apiVersion=y));p=n._assetTypeOverrides[a];p!==undefined&&(e.privateBrowse=!p);r.name===b?ai.forEach((function(n){var t=ei(r.name,n,e.name);f.push(eu(t,r,e,n))})):f.push(eu(l,r,e,r.cloudName));n._assetTypes.valueHasMutated()}}));s=n._assetTypes();v(s,(function(n){return u.indexOf(n)>=0}));n._assetTypes(s);v(n._callbacks,(function(n){return!n()}))})),!0}))},n.prototype._getAssetTypeById=function(n,t){
var u=this,f=w(this._assetTypeByIdPromises,(function(i){return i.assetTypeId===n&&i.requirements===t})),i,r;return f?f.promise:(i=this._getAssetTypePromise("assetTypeId <"+n+">",(function(){return w(u._assetTypes(),(function(i){return i.id===n&&bi(i,t)}))})),r={assetTypeId:n,promise:i,requirements:t},g(this._assetTypeByIdPromises,r,200),i.catch((function(n){n.message===it&&st.warning(it);v(u._assetTypeByIdPromises,r)})),i)},n.prototype._getAssetType=function(n,t,i,r,u){var s=this,a={name:n,cloudName:i},h=w(this._assetTypePromises,(function(n){var i={name:n.extension,cloudName:n.cloudName};return oi(i,a)&&n.assetType===t&&n.requirements===u})),c,f,o,l;return h?(r&&r(h.options()),h.promise):(c=function(){return s._getAssetTypePromise("assetType <"+i+", "+n+", "+t+">",(function(){return s.getAssetType(n,t,i,u)}))},o=e.observable(0),f=of(n,t)?this._getAssetTypeByResourceType(ot.Subscriptions,i,u).then((function(n){return o(1),r&&r(o()),n})).catch((function(){return c()})):c(),l={extension:n,assetType:t,promise:
f,requirements:u,cloudName:i,options:o},g(this._assetTypePromises,l,200),f.catch((function(n){n.message===it&&st.warning(it);v(s._assetTypePromises,l)})),f)},n.prototype.dispose=function(){i.disposeDisposable(this._memoizedManifestsLoadedError,this._getResourceProvider,this._getResourceTypeCachePromise,this._lifetimeManager,this._resourceCache,this._resourceGroupCache,this._assetIdIconAndKindCache,this._resourceIdSelectionCache,this._assetIdSelectionCache,this._resourceAssetIdCache,this._resourceMappingCache);this._resourceProviderLifetime=null},u.defineProperty(n.prototype,"assetTypes",{get:function(){return this._assetTypes},enumerable:!0,configurable:!0}),n.prototype.getMappedBladeLocator=function(n){if(n.type===l.LocatorType.Blade){var t=this._mappedBrowseBlades[si(n.getExtensionLocator()).toLowerCase()];if(t&&t[n.name.toLowerCase()])return l.Locator.forExtension(ci.name,ci.cloudName).withBlade(rt)}return n},n.prototype.getAssetType=function(n,t,i,r){var u={name:n,cloudName:i};return w(
this._assetTypes(),(function(n){return oi({name:n.extension,cloudName:n.cloudName},u)&&n.assetTypeManifest.name===t&&bi(n,r)}))},n.prototype.hasAssetType=function(n,t,i,r){return!!this.getAssetType(n,t,i,r)},n.prototype.getAssetTypePromise=function(n,t,i,r){return this._getAssetType(n,t,i,null,r)},n.prototype.getAssetTypeByResourceType=function(n,t,i){if(n){var r=n.toLowerCase();return w(this._assetTypes(),(function(n){return(n.extension===b||y(n.cloudName,t))&&n.lowerCaseResourceType===r&&bi(n,i)}))}},n.prototype.getAssetTypeByResourceTypePromiseWithFallback=function(n,t,r){var u=this;return p(this._getAssetTypeByResourceType(n,t,r),i.identity,(function(){return p(u._getAssetType(b,br,t,null,r),(function(t){return t=ii(t),t.assetTypeManifest.resourceType={resourceTypeName:n},t}))}))},n.prototype.allManifestsLoaded=function(){return Q.isFulfilled(this._initialLoad)},n.prototype.getAssetTypeDeepLink=function(n,t){var r=n.assetTypeManifest,c=r.name,l=r.bladeName,u=n.cloudName,a=n.extension,e=r.bladeExtensionName||
a,f=d(r),v=f&&f.resourceTypeName,o=function(n,t){return hi(ci,n,"",li(u,t),!1)},i="",y=rf&&r.serviceMenuBlade,s,p,w,h;if(y)i=hi({name:r.serviceMenuBladeExtension||n.extension,cloudName:u},y,"",li(u,{id:r.serviceMenuItemId}),!1);else switch(r.browseType){case wu:i=o(tr.BrowseServiceBlade,{assetTypeId:ur.getAssetTypeOrResourceTypeIdByWindowId(a,c)});break;case vr:s=t&&t.toLowerCase();p=(s&&f&&f.kinds||[]).some((function(n){return n.name.toLowerCase()===s}));t=p||t===pu?t:undefined;i=o("Resources",{resourceType:v,kind:t});break;case 2:e===b&&(w={BrowseAllResourcesBlade:ot.AllResources,BrowseRecentResourcesBlade:ot.RecentResources},h=w[l],h&&(i=o("Resources",{resourceType:h})));i||(i=hi({name:e,cloudName:u},l,"",e===b?li(u,{}):{},!1),c===bt.Gallery&&(i+="/selectedMenuItemId/undefined"));break;case ui:i=this.getBrowseLinkUri(n)}return i||st.error("<"+v+"> asset type does not have a deep link. Side bar & search results will not be able to open any blades."),i},n.prototype.getBrowseLinkUri=function(
n){var t=this._cachedUser,r=this._assetTypeByIdBrowseLink[n.id],i,u;return r?r:(i=n.assetTypeManifest.browseLinkUri,i&&(u=or.links.classicPortal.format({domain:t&&t.tenantDomain}),i=i.format({accountPortal:or.links.accountPortal,classicPortal:u,domain:t&&t.tenantDomain,tenantId:t&&t.tenantId})),this._assetTypeByIdBrowseLink[n.id]=i,i)},n.prototype.getAssetTypeInformation=function(n,i,r){var f=this,u=t.Internal.getAssetTypeInformationOverride;return u?Q(u(n,i,r)):p(this.getAssetTypePromise(n,i,r),(function(n){return f.mapAssetTypeToAssetTypeInformation(n)}))},n.prototype.mapAssetIdToResourceId=function(n,t){var a=this,f=this._assetIdToResourceIdPromises,r=n.extensionName,u=n.assetType,i=n.assetId,s=this._resourceAssetIdCache,c=s.getOrSet(t,new h.ItemArrayCache(216e5)).first((function(n){return yt(n.assetId,r,u,i)})),e;if(c)return Q(c.resourceId);if(e=w(f,(function(n){return y(n.cloudName,t)&&yt(n.assetId,r,u,i)})),e)return e.promise;var b=function(n){i=yi(n,i)},o=p(this._getAssetType(r,u,t,b),
(function(f){var o=pi(f),e;return o?(e=function(i){return s.get(t).pushEntry({assetId:n,resourceId:i}),i},ft(i))?e(i):o.mappingViewModel?a._getMappingViewModel(f).then((function(n){return Q(n.mapAssetIdToResourceId(i)).then((function(n){if(!ft(n))throw pt(n);return e(n)}))})):Q.reject(tt("Asset ID not a resource ID but asset type does not provided mapping view model. "+pf(r,u,i))):Q.reject(ki("ID <"+k.sanitizeId(i),r,u))})),l={assetId:n,cloudName:t,promise:o};return g(f,l,200),o.catch((function(){v(f,l)})),o},n.prototype.mapResourceIdToAssetId=function(n,t){var s=this,r=this._resourceIdToAssetIdPromises,u,f,e,i,o;return ft(n)?(u=this._resourceAssetIdCache,f=u.getOrSet(t,new h.ItemArrayCache(216e5)).first((function(t){return vi(t.resourceId,n)})),f)?Q(f.assetId):(e=w(r,(function(i){return y(i.cloudName,t)?vi(i.resourceId,n):!1})),e)?e.promise:(i=this._getAssetTypeByResourceType(nu(n),t).then((function(i){var f=i.assetTypeManifest,e=f.name,o=d(f),h=i.extension,r;if(!o)throw ki("ResourceId <"+k.sanitizeId(
n)+">",h,e);return(r=function(i){var r={extensionName:h,assetType:e,assetId:i};return u.get(t).pushEntry({assetId:r,resourceId:n}),r},!o.mappingViewModel)?r(n):s._getMappingViewModel(i).then((function(t){return Q(t.mapResourceIdToAssetId(n)).then((function(n){return r(n)}))}))})),o={resourceId:n,cloudName:t,promise:i},g(r,o,200),i.catch((function(){v(r,o)})),i):Q.reject(pt(n))},n.prototype.mapAssetIdToDynamicSelectionAndIcon=function(n,t,i){var u=this,f=this._assetIdSelectionCache,o=n.extensionName,s=n.assetType,r=n.assetId,c=f.getOrSet(t,new h.ItemArrayCache(216e5)).first((function(n){return yt(n.assetId,o,s,r)})),l;return c?Q(c.value):(l=function(n){r=yi(n,r)},p(p(this._getAssetType(o,s,t,l),(function(f){var o=ii(n);return(o.assetId=r&&e.unwrap(r),gr(f,o))?p(u.mapAssetIdToResourceId(o,t),(function(n){if(!ft(n))throw pt(n);return u._getDynamicSelectionAndIconFromResourceId(f,n,o,t,i)})):u._getDynamicSelectionAndIconFromAssetId(f,o)})),(function(i){return f.get(t).pushEntry({assetId:n,cloudName:t,value:
i}),i})))},n.prototype.mapAssetIdToIconAndKind=function(n,t,i){var u=this,f=this._assetIdIconAndKindCache,o=n.extensionName,s=n.assetType,r=n.assetId,c=f.getOrSet(t,new h.ItemArrayCache(216e5)).first((function(n){return yt(n.assetId,o,s,r)})),l;return c?Q(c.value):(l=function(n){r=yi(n,r)},p(p(this._getAssetType(o,s,t,l),(function(f){var o=ii(n);return(o.assetId=r&&e.unwrap(r),gr(f,o))?p(u.mapAssetIdToResourceId(o,t),(function(n){return ft(n)?u._getIconAndKindFromResourceId(f,n,o,t,i):Q.reject(pt(n))})):gf(f,o)})),(function(i){return f.get(t).pushEntry({assetId:n,cloudName:t,value:i}),i})))},n.prototype.mapResourceIdToDynamicSelectionAndIcon=function(n,t,i){var u=this,f=this._resourceIdSelectionCache,r;return ft(n)?(r=f.getOrSet(t,new h.ItemArrayCache(216e5)).first((function(t){return vi(t.resourceId,n)})),r)?Q(r.value):p(p(this._getAssetTypeByResourceType(nu(n),t),(function(r){var f=r.assetTypeManifest,e=f.name;if(!d(f))throw ki("ResourceId <"+k.sanitizeId(n)+">",r.extension,e);return p(u.mapResourceIdToAssetId(
n,t),(function(f){return u._getDynamicSelectionAndIconFromResourceId(r,n,f,t,i)}))})),(function(i){return f.get(t).pushEntry({resourceId:n,cloudName:t,value:i}),i})):Q.reject(pt(n))},n.prototype.mapAssetTypeToAssetTypeInformation=function(n){var t=n.assetTypeManifest,i=t.keywords;return{extensionName:n.extension,assetType:t.name,browseType:t.browseType!==undefined?t.browseType:ri,browseLinkUri:this.getBrowseLinkUri(n),compositeDisplayName:n.compositeDisplayName,icon:n.icon,viewModel:t.viewModel,dynamicBladeServiceViewModel:t.dynamicBladeServiceViewModel,contracts:t.contracts,isPreview:n.isPreview,privateBrowse:t.privateBrowse,keywords:!i?undefined:i.split(",")}},n.prototype.mapAssetTypeToResourceTypeAssetTypeInformation=function(n){var t=n.assetTypeManifest,i=d(t)||{},r=t.browseType,u=t.keywords,f=bf(i),e=i.proxyRoutingFilters;return(n.lowerCaseExtension==="microsoft_azure_marketplace"&&n.lowerCaseAssetType==="galleryrpitem"||n.lowerCaseExtension==="microsoft_azure_compute"&&n.lowerCaseAssetType===
"reservation")&&(e=[1,3]),{resourceType:i.resourceTypeName,topLevelTenantAlias:i.topLevelTenantAlias||f,topLevelResourceTypeAlias:i.topLevelResourceTypeAlias||f,apiVersion:i.apiVersion,routingType:i.routingType,bladeName:t.bladeName,bladeExtensionName:t.bladeExtensionName,kinds:i.kinds,proxyRoutingFilters:e,extensionName:n.extension,assetType:t.name,browseType:r!==undefined?r:ri,browseLinkUri:this.getBrowseLinkUri(n),compositeDisplayName:n.compositeDisplayName,icon:n.icon,viewModel:t.viewModel,dynamicBladeServiceViewModel:t.dynamicBladeServiceViewModel,contracts:t.contracts,isPreview:n.isPreview,marketplaceItemId:t.marketplaceItemId,marketplaceMenuItemId:t.marketplaceMenuItemId,staticOverview:t.staticOverview,privateBrowse:t.privateBrowse,keywords:u&&u.split(","),cloudName:n.cloudName,lowerCaseAssetType:n.lowerCaseAssetType,lowerCaseExtension:n.lowerCaseExtension,lowerCaseResourceType:n.lowerCaseResourceType,description:t.description,links:t.links}},n})()}));define("MsPortalImpl/UI/Commands/UI.ExtensionCommands",
["require","exports","f","o","a","ko","Viva.Controls/Util/Viva.Util","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Commands/FileDownloadUtil","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/UI.DesktopManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function vt(n,t,i,r){var u;return t.lc2?u=new ti(n,i,r):t.viewModel?u=new ni(n,i,r):t.execute?u=new ai(n,i,r):t.navigateUriCallback?u=new bt(n,i,r):t.navigateUri?u=new vi(n,i,r):t.listItems?u=new kt(n,i,r):t.targetUri&&t.httpMethod?u=new gt(n,i,r):(r.commandItem.commandDefinition.details||t.bladeName)&&(u=new ct(n,i,r)),u}function st(n){var t=n,i=null;
if(!(n instanceof ht))throw new Error("Command context was not an instance of CompositionInstanceCommandContext. All context objects are expected to be of that type.");return t.compositionInstance&&t.compositionInstance.locator&&(i=t.compositionInstance.locator.toFriendlyString()),i}function rt(n){var t=n&&n.title,i=n&&n.description;l&&l.getNotificationManager()&&l.getNotificationManager().addClientNotification({title:t||d.uriCallbackCommandError,description:i||d.error,status:ui.Error,timestamp:new Date,cloudName:ii.DefaultCloudName})}function wt(n,t){o.sanitizeUri(n)?ut.open(n,t):(k.error(d.invalidUri.format(n)),rt())}function yi(n,t){var i=n;it(["text","icon","enabled"],(function(n){dt(i[n],n,t)}));dt(i.onInputsSet,"onInputSet",t,!0)}function dt(n,t,i,r){ft(n)||typeof n!="function"||!r&&ft(n())||pi(t,i)}function pi(n,t){k.warning("The '"+n+"' property of a command viewModel contains a value. This value will be ignored when passing to '"+t+"' dynamic command viewModel.")}function wi(n){
var t;return n.name?n.details||(t="OpenBladeCommand must provide a details blade definition."):t="OpenBladeCommand must provide a command name.",t&&k.error("{0} Command: '{1}'. CommandDefinition: '{2}'.".format(t,n.name,JSON.stringify(n))),!t}function bi(n){et=Q(n)}var ht,yt,bt,kt,gt,ni,ct,ti;r.defineProperty(t,"__esModule",{value:!0});var ii=i.Base.Constants,lt=i.Base.Diagnostics,nt=lt.Telemetry,ri=i.Base.Resources,ui=i.Hubs.Notifications.NotificationStatus,fi=i.ViewModels,ei=fi.Dialogs,oi=v.CompositionType,si=p.CompositionBinder,hi=w.ReferenceScope,ci=i.Base.Net2,ut=window,k=lt.createLog(n),at=function(){return i.require("MsPortalImpl/UI/UI.DialogManager")},ft=i.isNullOrUndefined,it=i.uncurryThis(u.prototype.forEach),et=null,li={invocationInputArguments:[{valuesFrom:[{referenceType:4,property:"container.selectable"}]}]},b=h.FileDownloadCommand,d=h.UriCallbackCommand,tt=412,ot=s.dismissDialog;t.createExtensionCommand=vt;t.getCommandSourceTelemetryName=st;ht=(function(n){function t(t,i,
r){var u=n.call(this,t,i)||this;return u.compositionInstance=r,u}return __extends(t,n),t})(c.CommandContext);t.CompositionInstanceCommandContext=ht;yt=(function(){function n(){}return n})();t.ExtensionCommandImplOptions=yt;var g=(function(){function n(n,t,r){var u=this,f;this._extension=r.extension;this._viewModelName=r.viewModelName;this.viewModel=t;this.commandItem=r.commandItem;this._commandContainer=r.container;f=this._ltm=n.createChildLifetime();this._propertyBindings=r.propertyBindings;this._services=r.services;f.registerForDispose((function(){u.viewModel&&(i.disposeViewModelProperties(u.viewModel),u._extension.releaseViewModel(u.viewModel),u.viewModel=null);u._propertyBindings&&(u._propertyBindings.unbind(),u._propertyBindings=null)}))}return n.prototype.init=function(){},n.prototype.execute=function(n){nt.trace({extension:this._extension.name,source:st(this._context()),action:a.Action.CommandExecuted,name:this._viewModelName,data:n})},n.prototype.dispose=function(){this._ltm&&(this._ltm.
dispose(),this._ltm=null)},n.prototype._context=function(){return this.commandItem.getCommandContext()},n.prototype._getFormTarget=function(){var n=this._context();return n.getFormTarget()},n.prototype._target=function(){var n=this._context();return n&&n.target},n})(),ai=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u._viewModel=i.content,u._services.desktop.mode.subscribe(u._ltm,(function(n){u._getFormTarget().then((function(t){n===1&&t&&t.hideForm()}))})),u}return __extends(t,n),t.prototype.execute=function(t,i){var u=this,r;n.prototype.execute.call(this,t,i);r=this._viewModel;r.status()===1?Q.all([this._services.getService("DialogManager"),this._getFormTarget()]).spread((function(n,t){u._loadDialog(t,n,f.unwrap(r.dialog))})):r.status(1);r.execute(i)},t.prototype.init=function(){var n=this,t=this._viewModel,i=this._ltm;this._services.getService("DialogManager").then((function(r){t.status.subscribe(i,(function(t){n._context()&&n._getFormTarget().then((function(i){n._statusChanged(
i,r,t)}))}));f.isObservable(t.dialog)&&t.dialog.subscribe(i,(function(t){n._getFormTarget().then((function(i){n._dialogChanged(i,r,t)}))}))}))},t.prototype._statusChanged=function(n,t,i){i===0?this._hideCommandForm(n):i===1&&this._loadDialog(n,t,f.unwrap(this._viewModel.dialog))},t.prototype._dialogChanged=function(n,t,i){this._viewModel.status()===1&&this._loadDialog(n,t,i)},t.prototype._loadDialog=function(n,t,r){var u=this;if(n&&(!i.deepEquals(this._currentDialogOptions,r)||!t.hasOpenDialog))if(this._currentDialogOptions=r,ft(r))this._hideCommandForm(n);else{if(!this._target())return;var o=$(n.getForm()),f=this._commandContainer.locator,s=f&&f.withCommand(this.commandItem.commandName);this.commandItem.pressed(!0);t.showDialog(o,r,s).then((function(n){u.commandItem.pressed(!1);var t=u._viewModel,i=t&&t.dialogClick;typeof i=="function"&&i.call(t,n)}));n.showForm(e.getBox(this._target()))}},t.prototype._hideCommandForm=function(n){n&&n.hideForm()},t})(g),vi=(function(n){function t(t,i,r){var u=n.
call(this,t,i,r)||this;return u._viewModel=i.content,u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.execute=function(t){var i=this._viewModel,r=i.navigateTarget?i.navigateTarget():"_blank";n.prototype.execute.call(this,t);ut.open(i.navigateUri(),r)},t})(g),pt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype._getDlgElem=function(n){var t=n&&n.getForm();return t&&$(t)},t.prototype._getLocator=function(){var n=this._commandContainer.locator;return n&&n.withCommand(this.commandItem.commandName)},t.prototype._showUriCbProgressDlg=function(n,t,i){this._showProgressDlg(n,t,this._uriCbProgressTitle,this._uriCbProgressText,i)},t.prototype._showDownloadProgressDlg=function(n,t,i){this._showProgressDlg(n,t,this._progressTitle,this._progressText,i)},t.prototype._showProgressDlg=function(n,t,i,r,u){var f=new ei.ProgressBox(i,r);t.showDialog(this._getDlgElem(n),f,this._getLocator());this._showForm(n,u)}
,t.prototype._showForm=function(n,t){t&&n&&n.showForm(e.getBox(this._target()))},t.prototype._hideForm=function(n,t){t&&n&&n.hideForm()},t.prototype._getResources=function(n){var t=n.uriCallbackConfirmationDialogOptions||{},i=n.downloadProgressDialogOptions||{};this._uriCbProgressTitle=t.uriCallbackProgressTitle||b.uriCallbackProgressTitle;this._uriCbProgressText=t.uriCallbackProgressText||b.uriCallbackProgressText;this._dnldTitle=t.downloadTitle||b.downloadTitle;this._dnldText=t.downloadText||b.downloadText;this._defaultBtnText=t.defaultButtonText||b.defaultButtonText;this._cancelBtnText=t.cancelButtonText||b.cancelButtonText;this._progressTitle=i.downloadProgressTitle||b.downloadProgressTitle;this._progressText=i.downloadProgressText||b.downloadProgressText},t})(g);bt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u._viewModel=i.content,u._getResources(u._viewModel),u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.execute=function(t){var i=this;n.prototype.
execute.call(this,t);var e=this._viewModel.navigateTarget?this._viewModel.navigateTarget():"_blank",r=this._viewModel,s=r.navigateUriCallback&&r.navigateUriCallback(),l=this.commandItem,h=l.fxEnabled,a=r.showUriCallbackConfirmationDialog&&r.showUriCallbackConfirmationDialog(),c=function(n){i._hideForm(n,t);h(!0)},u,f=!0;s&&a?(h(!1),Q.all([this._services.getService("DialogManager"),this._getFormTarget()]).spread((function(n,o){return i._dlgMgr=n,i._showUriCbProgressDlg(o,n,t),Q(r.navigateUriCallback()()).then((function(t){return f=!1,at().then((function(r){var u=new r.MessageBox(i._dnldTitle,i._dnldText,2);u.defaultButtonText=i._defaultBtnText;u.cancelButtonText=i._cancelBtnText;n.showDialogWithCallback(i._getDlgElem(o),u,(function(n){n===4&&wt(t,e);c(o)}),i._getLocator())}))}),(function(n){rt(n)})).finally((function(){f&&(k.error(d.callbackError.format("navigateUriCallback failed.")),u&&u.close(),i._dlgMgr&&i._dlgMgr.dismissOpenDialog(),c(o))}))})).catch((function(n){k.error(n)}))):s?(h(!1),u=ut.open(
"about:blank",e),Q(s()).then((function(n){f=!1;o.sanitizeUri(n)?u.location.href=n:(k.error(d.invalidUri.format(n)),rt(),u.close())}),(function(n){rt(n)})).finally((function(){f&&(k.error(d.callbackError.format("navigateUriCallback failed.")),u.close());i._getFormTarget().then((function(n){c(n)}))}))):wt(r.navigateUri(),e)},t})(pt);kt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this,s=u._ltm,h=u.commandItem,e=i.content,c=h.widgetViewModel,o=c.dialogOptions;return f.reactor(s,(function(){o.listItems(e.listItems())})),e.selectedItem.subscribe(s,(function(n){o.selectedItem(n)})),o.selectedItem(e.selectedItem()),h.hasPopup(!0),o.selectedItem.subscribe(s,(function(n){e.selectedItem(n)})),u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.execute=function(t){n.prototype.execute.call(this,t)},t})(g);gt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u._viewModel=i.content,u._getResources(u._viewModel),u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.
execute=function(t){var r=this;n.prototype.execute.call(this,t);var u=null,l=this.commandItem,f=l.fxEnabled;if(f()){var i=this._viewModel,o=s.getHttpMethod(i),h=function(n){r._hideForm(n,t);f(!0)};if(!o){s.notifyError(i,tt,b.typeError);this._getFormTarget().then((function(n){h(n)}));return}f(!1);i.downloadStatus(null);var c=this._services.getService("DialogManager"),e=this._getFormTarget(),v=Q.all([c,e]).spread((function(n,i){return r._getUri(i,n,t)}));Q.all([c,v,e]).spread((function(n,f,e){var h=f&&f.startsWith("data:");if(!ri.isUriAbsolute(f)&&!h){s.notifyError(i,tt,b.absoluteUriError);return}if(i.showDownloadProgressDialog&&i.showDownloadProgressDialog()&&r._showDownloadProgressDlg(e,n,t),u=nt.startTrace({extension:r._extension.name,source:st(r._context()),action:a.Action.StartFileDownload,name:r._viewModelName,data:t}),h)s.dataUriHandler(i,n,f);else return ci.ajaxExtended(s.getAjaxOptions(i,f,o)).then((function(t){if(r.viewModel){var f=t.content,e=f&&f.length?f.length:0;return s.onSuccess(
i,n,f,t.textStatus,t.jqXHR).then((function(){nt.completeTrace(u,e)}))}}),(function(t){s.onError(i,n,t.textStatus,t.jqXHR.status,t.errorThrown);return nt.cancelTrace(u),Q.reject(t.errorThrown)}))})).catch((function(n){n&&k.error(n);nt.cancelTrace(u)})).finally((function(){e.then((function(n){h(n)}))}))}},t.prototype._getUri=function(n,t,i){var f=this,u=Q.defer(),r=this._viewModel,o=r.targetUriCallback&&r.targetUriCallback(),h=r.showUriCallbackConfirmationDialog&&r.showUriCallbackConfirmationDialog(),e;return o?(h&&this._showUriCbProgressDlg(n,t,i),Q(o()).then((function(i){if(!i){s.notifyError(r,tt,b.uriError);u.reject(b.uriError);ot(t,r);return}if(h)return at().then((function(i){var r=new i.MessageBox(f._dnldTitle,f._dnldText,2);return r.defaultButtonText=f._defaultBtnText,r.cancelButtonText=f._cancelBtnText,t.showDialog(f._getDlgElem(n),r,f._getLocator())})).then((function(n){n===4?u.resolve(i):u.reject()}));u.resolve(i);ot(t,r)})).catch((function(){var n=r.errorMessage()||b.downloadTargetUriCallbackFailed;
s.notifyError(r,tt,n);ot(t,r);u.reject(n)}))):(e=r.targetUri&&r.targetUri(),e?u.resolve(e):(s.notifyError(r,tt,b.uriError),u.reject(b.uriError))),u.promise},t})(pt);ni=(function(n){function t(t,r,u){var f=n.call(this,t,r,u)||this,o,e;return f._container=u.container,f._viewModel=r.content,f._selectionInList=u.selectionInList,o=f._ltm,f._viewModel.viewModel.subscribeAndRun(o,(function(n){var t,s,h,r,u;e&&e.dispose();e=o.createChildLifetime();t=f._nestedCommand;t&&(t.dispose(),f._nestedCommand=undefined);n&&(s=f.viewModel,h={container:f._container,extension:f._extension,viewModelName:f._viewModelName,commandItem:f.commandItem,propertyBindings:null,services:f._services,selectionInList:f._selectionInList},f.commandItem.commandDefinition.details=li,yi(n,f._viewModelName),r=i.clone(s),r.content=n,u=n,u.bladeName&&r.container.selectable.selectedValue({detailBlade:u.bladeName,detailBladeInputs:u.bladeInputs}),t=f._nestedCommand=vt(e,n,r,h),t.init(),f.canSkipBladeValidation=t.canSkipBladeValidation)})
),f}return __extends(t,n),t.prototype.execute=function(t){n.prototype.execute.call(this,t);this._nestedCommand?this._nestedCommand.execute(t):k.error("The nested command is missed for the {0} dynamic command.".format(this._viewModelName))},t.prototype.dispose=function(){this._nestedCommand&&this._nestedCommand.dispose()},t})(g);ct=(function(n){function t(t,r,u){var f=n.call(this,t,r,u)||this,o,e;f._addedOutputPropertyBindings=[];f._outputBindingDefinitions=[];f._viewModel=r;f._containerViewModel=r.container;f._options=u;o=f.commandItem;e=o.commandDefinition;f._commandInstanceId=u.selectionInList?i.newGuid():undefined;var h=wi(e),s=e.details,c=f._validateDetailsDefinition(s);return h&&c?(f._outputBindingDefinitions=si.mapInputBindingDefinitions(s.outputArguments||[],u.container,(function(n){n.source.scope=hi.DetailsContainer})),f.getBladeOpener()):u.commandItem.setEnabled(!1),f.canSkipBladeValidation=!0,f}return __extends(t,n),t.prototype.getBladeOpener=function(){var n=this,t;return this._ltm?
(t=this._ltm,this._bladeOpenerPromise||(this._bladeOpenerPromise=i.tryImmediateResolve(et||(et=i.require("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener")),(function(i){var u=n._options,r=i.create(n._getBladeOpenerConfig(u.container,u.extension));return r.registerInvocationProperty(n.commandItem.commandDefinition.details),t.registerForDispose(r),r})))):Q.reject(i.Errors.disposedCanceledError)},t.prototype.execute=function(t){var r=this;n.prototype.execute.call(this,t);i.tryImmediateResolve(this.getBladeOpener(),(function(n){if(!n||r._ltm&&!r._ltm.isDisposed()){var t=r._containerViewModel,i=t&&t.selectable;i?i.isSelected(!0):k.error("OpenBladeCommand '{0}' from extension '{1}' was not initialized with a Selectable.".format(r.commandItem.commandDefinition.name,r._extension.name))}}))},t.prototype._getBladeOpenerConfig=function(n,t){var r=this,o=this.commandItem.commandDefinition.details,s=o?!!o.parameterCollector:!1,e=this._services;return{services:e,masterModelId:"{0}-[{1}-{2}]".format(
n.toString(),"OpenBladeCommand",this.commandItem.commandDefinition.name),masterModel:this._viewModel,referenceComposition:n,referenceExtension:t,isBladeOpenedByMaster:function(t){return t.masterCommandName===r.commandItem.commandDefinition.name&&t.masterPartId===n.id&&t.masterCommandId===r._commandInstanceId},configureBindings:function(t){it(t,(function(t){var i=t.source,u=i&&i.modelType;u===4&&(i.modelId=r.commandItem.commandDefinition.name,v.isPartComposition(n)&&(i.partLocator=n.locator,i.id=n.id))}))},configureBladeDescriptor:function(t){var i,e,h;if(t.masterCommandName=r.commandItem.commandDefinition.name,t.masterCommandId=r._commandInstanceId,t.masterCommandExtension=r._extension,t.masterPartId=n.id,i=t.bindings,u.isArray(i))for(e=i.length-1;e>=0;e--){var c=i[e],o=c.source,l=o&&o.modelType;l===4&&(t.model[c.targetProperty]=f.toJS(w.getModelValue(r._viewModel,o.property).value),h=r.commandItem.sourceBindableContainer,!s&&h&&h.isPartListItem&&i.splice(e,1))}},onBladeOpened:function(n)
{r._setCmdActivated(!0);n.onDispose((function(){r._bladeOpenerPromise&&i.tryImmediateResolve(r._bladeOpenerPromise,(function(t){t.notifyDetailBladeClosed(n)}));r._disposeOutputBindings();r._setCmdActivated(!1)}));n.awaitComposed().then((function(){r._createOutputBindings(n)}))},getCloseOtherDetailBladesHandler:function(t,i){if(i.openInContextPane){if(n.getCompositionType()===oi.StartboardPart){var r=e.desktop.getActiveJourney();return!r||r.isStartedWithContextBlade()?null:function(){return e.desktop.tryDeactivateJourney()}}if(!e.contextPane.opened.peek())return function(){return!0}}return null}}},t.prototype._createOutputBindings=function(n){var t=this;it(this._outputBindingDefinitions,(function(i){var u=t._propertyBindings,r;u&&(r=u.mapProperty(i.source.property,i.targetProperty).bind(n.toString()+"LaunchCommandOutputBinding",n.getViewModel()),r.compositionBindingDefinition=i,t._addedOutputPropertyBindings.push(r))}))},t.prototype._disposeOutputBindings=function(){var n=this;this._propertyBindings&&
it(this._addedOutputPropertyBindings,(function(t){n._propertyBindings.removeProperty(t)}));this._addedOutputPropertyBindings.length=0},t.prototype._validateDetailsDefinition=function(n){var t=[],i=function(n){var t,i=n.invocationInputArguments;return n.isMultiple?t="Command cannot open multiple blades. isMultiple value must be false.":i&&i[0].valuesFrom[0].referenceType!==4&&(t="Command invocation argument reference type can only be of type Command."),t},r=y.validateDetailsDefinition(n,t,i);return t.length&&k.error("{0} Command: '{1}'. Details: '{2}'.".format(t[0],this.commandItem.commandDefinition.name,JSON.stringify(n))),r},t.prototype._setCmdActivated=function(n){var t=this._commandContainer.getViewModel(),i=t&&t.container,r=i&&i.selectable;r&&r.isCommandSelected(n);this.commandItem.pressed(n)},t})(g);ti=(function(n){function t(t,i,r){var o=n.call(this,t,i,r)||this,s=o._ltm,h=o.commandItem,u=i.content,c=h.widgetViewModel,e=c.dialogOptions;return f.reactor(s,(function(){e.listItems(u.listItems(
))})),u.selectedItem.subscribe(s,(function(n){e.selectedItem(n)})),e.selectedItem(u.selectedItem()),h.hasPopup(!0),e.selectedItem.subscribe(s,(function(n){u.selectedItem(n)})),o}return __extends(t,n),t.prototype.execute=function(t){n.prototype.execute.call(this,t)},t})(ct);t.setBladeOpenerModule=bi}));define("MsPortalImpl/UI/Compositions/UI.Composition.Security",["require","exports","f","i","ko","$","MsPortalImpl/Services/Services.AssetTypes"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function h(n,t,i,u,f,o,l,a){if(n&&n.length){if(s[t]===undefined)return r.QReject("checkPermission: unexpect requirement: "+t);var v=t===s.All;return n.reduce((function(n,t){return n.then((function(r){var s,p,y;if(d(v,r))return n;if(s=void 0,t.permissionType===0)p=t,s=c(p,i,u,f,o,l,a);else if(t.permissionType===1)y=t,s=h(y.permissions,y.requirement,i,u,f,o,l,a);else throw new Error("unexpected permission.permissionType: "+t.permissionType);return s.catch((function(n){var t=e.warning;return t.call(e,
n,1,["Failed check permissions:","compositionInfo:"+a,"reason: "+n].join("\n")),Q(!0)}))}))}),Q(v))}return Q(!0)}function c(n,t,i,r,f,o,s){var c,h;if(!n)return Q(!1);c=function(t,i){return f.permissionsManager.hasPermission(t,[n.action],i)};r===p&&(o=v.readFromInputs(t));switch(n.assetId.sourceType){case 0:h=Q(t[n.assetId.property]);break;case 1:h=l(n,t,i,r,f,o);break;case 2:h=l(n,t,n.assetType||i,n.extensionName||r,f,o)}return h.then((function(t){var h,l,v,y,a;return t=u.unwrap(t),h=n.extensionName||r,l=n.assetType||i,g(t)?c(t,o):f.assetTypeService.hasAssetType(h,l,o,2)?(v=e.warning,y="",v.call(e,["Performance Warning: assetId is not in the form of resourceID. This result in slow code path to perform the conversion. Please contact the extension below to improve performance","assetTypeExtension: "+h+", assetType: "+l,"composition: "+(s||""),y].join("\n")),a=f.assetTypeService.getAssetType(h,l,o,2),f.getService("ResourceMapManager").then((function(n){return n.mapAssetIdToResourceId({extensionName:
a.extension,assetType:a.assetTypeManifest.name,assetId:t},o)})).then((function(n){return c(n,o)}))):Q(!1)}))}function l(n,t,r,u,e,o){var s="[getAssetIdFromPropertyProvider]:";return e.extensionManager.getExtensionByName(u,o).then((function(u){var e=u.getManifest("assetTypes").assetTypes.first((function(n){return n.name===r}));if(!e)throw new Error(s+"Unknown extension Asset Type : "+r);return Q(u.getViewModel(e.propertyProviderServiceViewModel)).then((function(r){var e=new y;return e.registerForDispose((function(){i.disposeViewModelProperties(r);u.releaseViewModel(r)})),Q.fcall((function(){var i=r.content,u=i&&i.onInputsSet,e,o;if(typeof u=="function")return e=f.extend({providerKey:n.assetId.providerKey},t),o=u.call(i,e)||Q(),o.then((function(){var u=i.properties(),t=n.assetId.property,r=u.first((function(n){return n.property===t}));if(r)return r.value;throw new Error(s+"Can not find propertyDefinition for assetIdProperty: "+t);}));throw new Error(s+"ViewModel.content.onInputsSet is not a function.");
})).finally((function(){e.dispose();e=null}))}))}))}function g(n){return n&&a.some((function(t){return t(n)}))}var v=r.Extension.CloudName,y=r.TriggerableLifetimeManager,o=i.Base,p=o.Constants.ExtensionNames.Hubs,w=o.Diagnostics,b=i.Extension,s=b.SetRequirement,k=i.ViewModels,t=k.Services.ResourceTypes,e=new w.Log("UI/Composition/Security"),d=i.xor,a;n.checkPermissions=h;n.checkPermission=c;a=[t.isResourceGroupId,t.isResourceId,t.isTenantResource,t.isSubscriptionId]})(e||(e={})),e}));define("MsPortalImpl/UI/Commands/UI.Commands",["require","exports","f","i","o","a","ko","MsPortalImpl/Base/Base.SelectableSet2","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/UI/Compositions/UI.Composition.CloudName","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/UI.DesktopManager",
"MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.CommandBarBase","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";function kt(n){return w.getCommandSourceTelemetryName(n)}function dt(n){var t=b.Widget.getWidget(n,null);if(n.hasClass("fxs-bladecontent"))return t}function gt(n){var t=b.Widget.getWidget(n,null);if(n.hasClass("fxs-blade"))return t}function ni(n,t,i,r){var u=i.commandGroupReference,f=u?u.name:i.commandGroup;return f?n.locate(rt.forExtension(t,r).withCommandGroup(f)):null}function ht(n,t,i,r,u){var f=new wt.DialogButton;return f.dialogOptions=new pt.ListPopup,f.dialogOptions.type=u?4:0,new k.DialogButton(n,f,r.locator.withCommand(t.name),i,t.name)}function ti(n,t,i,r,u,f){var e={name:f,details:{invocationInputArguments:[{valuesFrom:[{property:"container.selectable",referenceType:4}]}]}};return lt(n,t,i,(function(n,t){return new d.OpenBladeCommand(
t)}),e,r,u,f)}function ii(n,t,i,r,u,f,e){return lt(n,t,i,(function(){var n=new d.UriCommand;return n.navigateUri=e.uri,n.navigateTarget=e.target,n}),{name:f},r,u,f)}function lt(n,r,u,f,e,o,s,h){var a="__{0}ViewModel__".format(h),c=i.Extension.composeViewModel(f,a,undefined,!0),l=new nt(n,s,u,e,o,r),y={container:u,extension:s,viewModelName:a,commandItem:l,propertyBindings:null,services:r,selectionInList:!1},v=w.createExtensionCommand(n,c.content,c,y);return l.bind(new t.CompositionInstanceCommandContext(null,null,u)),n.registerForDispose([c.container,l,v]),v}var g,st,nt,ct;u.defineProperty(t,"__esModule",{value:!0});var rt=s.Locator,ut=i.Base,at=ut.Diagnostics,ft=ut.Images,vt=i.Extension,yt=vt.SetRequirement,d=i.ViewModels,pt=d.Dialogs,wt=d.Toolbars,bt=v.CompositionBinder,tt=i.Helpers,et=at.createLog(n),ot=l.Commands,it=i.uncurryThis(f.prototype.forEach);t.CompositionInstanceCommandContext=w.CompositionInstanceCommandContext;t.getCommandSourceTelemetryName=kt;t.getBladeContentWidget=dt;t.getBladeContainerWidget=
gt;t.getCommandGroupForDefinitionItem=ni;g=(function(n){function t(t,i,r,u,f){var o=this,h=e.observable(!1),s;return o=n.call(this,t,r)||this,o.commandName=i,o._services=f,o._compositionContainer=u,s=h.extend({allowOverride:u}),o.enabled=s,u.registerForDispose(s),o._init(f.desktop),o}return __extends(t,n),u.defineProperty(t.prototype,"services",{get:function(){return this._services},enumerable:!0,configurable:!0}),u.defineProperty(t.prototype,"container",{get:function(){return this._compositionContainer},enumerable:!0,configurable:!0}),u.defineProperty(t.prototype,"sourceBindableContainer",{get:function(){return null},enumerable:!0,configurable:!0}),t.prototype._init=function(n){var t=this;e.reactor(this._ltm,(function(){var i=t.enabled,r=n.commandsEnabled();r&&n.mode()!==1?i.restoreLastWrittenValue():i.override(!1)}))},t})(a.CommandImpl);t.ExtensionCommandMenuItemBase=g;st=(function(n){function t(t,i,r,u,f,s,h){var c=this,l=u.name;c=n.call(this,t,l,u.text,r,s)||this;var a=c._ltm,v=l?l:u.text,
y=o.getSelectedItems(h);return c._subcommands=y.map((function(n){var t={viewModel:n.data,viewModelName:r.toString()+"[Command: "+v+"]",isPartListItem:!0};return new nt(a,i,r,u,f,s,t)})),e.reactor(a,(function(){var n=c._subcommands.reduce((function(n,t){return t.enabled()&&n}),!0);c.enabled(n)})),c}return __extends(t,n),t.prototype.bind=function(n){it(this._subcommands,(function(t){return t.bind(n)}))},t.prototype.activate=function(){it(this._subcommands,(function(n){return n.activate()}))},t.prototype.execute=function(n){it(this._subcommands,(function(t){return t.execute(n)}))},t})(g);t.ExtensionMultiselectCommandMenuItemImpl=st;nt=(function(t){function e(n,i,r,u,f,e,o,s){var h=t.call(this,n,u.name,u.text,r,e)||this;return h._extension=i,h._commandDefinition=u,h._commandContainerDefinition=f,h._sourceBindableContainer=o,h._selectionInList=s,h}return __extends(e,t),e.prototype.extensionName=function(){return this._extension&&this._extension.name},u.defineProperty(e.prototype,"commandDefinition",{get:
function(){return et.assert(!this._commandDefinition.reference,"External CommandDefinition not resolved."),this._commandDefinition},enumerable:!0,configurable:!0}),e.prototype.getInputBindingsFromDefinition=function(n){var i,t=this._getCommandReference(n);return t&&f.isArray(t.bindings)&&t.bindings.length>0?i=t.bindings:n&&(i=n.bindings),i||[]},u.defineProperty(e.prototype,"widgetViewModel",{get:function(){return this._widgetViewModel},enumerable:!0,configurable:!0}),u.defineProperty(e.prototype,"sourceBindableContainer",{get:function(){return this._sourceBindableContainer},enumerable:!0,configurable:!0}),e.prototype.activate=function(){this._loadViewModel()},e.prototype.execute=function(n){var t=this,i=this.widgetViewModel,r=i&&i.dialogOptions;r&&r.type&&i.type===5?this._getFormTarget().then((function(i){var f=i&&i.getForm(),u=t.container.locator,e=u&&u.withCommand(t.commandName);t._services.getService("DialogManager").then((function(n){return n.showDialog($(f),r,e)})).then((function(){t.
_execute(n)}))})):this._execute(n)},e.prototype.getCommandContext=function(){return this._currentContext},e.prototype._getFormTarget=function(){return this._currentContext&&this._currentContext.getFormTarget()},e.prototype._target=function(){return this._currentContext&&this._currentContext.target},e.prototype._getCommandReference=function(n){var t=this._commandContainerDefinition&&this._commandContainerDefinition.commandGroupReference,i=null;return t&&t.commands&&n.name&&(i=t.commands.first((function(t){return t.name===n.name}))),i},e.prototype._execute=function(n){var i=this,u=this._currentContext.compositionInstance,r;if(!this._extensionCommand){this._loadViewModel();return}r=u&&u.widget;r&&!this._extensionCommand.canSkipBladeValidation?(this._overrideEnabledPropertyWith(!1),h.ensureFormFieldValidation(r.element).then((function(r){t.prototype.execute.call(i,n);i._extensionCommand.execute(n,r)})).finally((function(){i._clearEnabledPropertyOverride()}))):(t.prototype.execute.call(this,n),this.
_extensionCommand.execute(n))},e.prototype.dispose=function(){var r=this,n=this._viewModelLoadedPromise,i=this._ltm;n&&(n.done((function(){i&&(i.dispose(),r._ltm=null)})),this._viewModelLoadedPromise=null);t.prototype.dispose.call(this)},e.prototype.setEnabled=function(n){this._extensionEnabledProperty=n;this._overrideEnabledProperty||this.enabled(n)},e.prototype.getViewModel=function(){return this._extensionCommand&&this._extensionCommand.viewModel},e.prototype.getViewModelAsync=function(){return this._loadViewModel(),this._viewModelLoadedPromise},u.defineProperty(e.prototype,"canRebind",{get:function(){var n=this._getContentViewModel(),t=n&&n.status&&n.status();return t!==1},enumerable:!0,configurable:!0}),e.prototype._getContentViewModel=function(){var n=this.getViewModel();return n&&n.content},e.prototype._overrideEnabledPropertyWith=function(n){this._overrideEnabledProperty=!0;this.enabled(n)},e.prototype._clearEnabledPropertyOverride=function(){this._overrideEnabledProperty&&(this.
_overrideEnabledProperty=!1,this.enabled(this._extensionEnabledProperty))},e.prototype._resolveCommandDefinition=function(){var n=this,r,t=this._commandDefinition,u,f;return t.reference?(u=rt.forExtension(t.reference.extension||this._extension.name,this._extension.cloudName),f=u.withCommandType(t.reference.commandType),this.icon(ft.Loading.EllipsisSquare()),this.text(ot.loading),r=this.services.finder.locateAsync(f).then((function(r){n._extension=n.services.finder.locate(u,n._extension.name);var f=n.getInputBindingsFromDefinition(t);n._commandDefinition=i.extend2(r,{name:t.name});f.length>0&&(n._commandDefinition.bindings=f);n.text(r.text)}))):r=tt.Deferred().resolve().promise(),r},e.prototype._logError=function(t){r.Rpc.internalClient.log(this._extension.name,{level:2,code:0,area:n.normalize("."),message:t+" \nCommand name: "+this._commandDefinition.name+" \nView model name: "+this._commandDefinition.viewModel})},e.prototype._createExtensionCommandHandler=function(n){var f=this,e=this._ltm,
r;if(e){var s=n.content,t=e.createChildLifetime(),u={container:this.container,extension:this._extension,viewModelName:this._commandDefinition.viewModel,commandItem:this,propertyBindings:null,services:this._services,selectionInList:this._selectionInList},o=new ct(t,n,u);o.init();u.propertyBindings=o.propertyBindings;r=this._extensionCommand=w.createExtensionCommand(t,s,n,u);r?(t.registerForDispose([r]),r.init()):this._logError("Error loading command view model. Unknown view model type.");n.container.unauthorizedMessage.subscribeAndRun(t,(function(t){f.unauthorized(!i.isNullOrUndefined(t));f.tooltip(t||n.content.tooltip&&n.content.tooltip())}))}},e.prototype._loadViewModel=function(){var n=this,t;if(!this._viewModelLoadedPromise){if(t=this._ltm,!t)return;this._viewModelLoadedPromise=this._resolveCommandDefinition().then((function(){var f;if(t=n._ltm,t){var r=n._extension,i=n._commandDefinition,u=i.commandKind===4;return(!i.commandKind||u)&&(n._widgetViewModel=ht(n._ltm,i,n._services,n.container,
u)),f=c.needInternalProperty(r.name,[i.details]),r.getViewModel(i.viewModel,{createSelectable:!0,createHubsInternalCloudNameProperty:f})}}));this._viewModelLoadedPromise.done((function(i){(t=n._ltm,t)&&(i.content.lc2&&(n._widgetViewModel=ht(t,n._commandDefinition,n._services,n.container,!0)),n._createExtensionCommandHandler(i))})).fail((function(t){n.icon(ft.Blank());n.text(ot.failedToLoad);n._logError("Error loading command view model.\nReason: {0}".format(t))}))}},e})(g);t.ExtensionCommandMenuItemImpl=nt;ct=(function(){function n(n,t,i){var u=this,r;this._onInputsSetPending=e.observable(!1);this._hasPermissions=e.observable(!0);this._extension=i.extension;this._viewModelName=i.viewModelName;this._composedViewModel=t;this._commandViewModel=t.content;this._commandItem=i.commandItem;this._services=i.services;r=this._ltm=n.createChildLifetime();this._initializeInputBindings(i.container,i.commandItem);r.registerForDispose((function(){u._commandViewModel=null}))}return n.prototype.init=function(){var
n=this._commandViewModel,t=this._commandItem;e.isObservable(n.icon)&&n.icon.subscribeAndRun(this._ltm,t.icon);e.isObservable(n.text)&&n.text.subscribeAndRun(this._ltm,(function(n){return n!==undefined&&t.text(n)}));e.isObservable(n.ariaLabel)&&n.ariaLabel.subscribeAndRun(this._ltm,t.ariaLabel);e.isObservable(n.tooltip)&&n.tooltip.subscribeAndRun(this._ltm,t.tooltip);e.computed(this._ltm,[n.enabled,this._hasPermissions,this._onInputsSetPending],(function(n,i,r){return t.setEnabled(n&&i&&!r)}))},u.defineProperty(n.prototype,"propertyBindings",{get:function(){return this._propertyBindings},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){this._ltm&&(this._ltm.dispose(),this._ltm=null)},n.prototype._initializeInputBindings=function(n,t){var i=this,u=this._ltm,o,r,s;u&&(o=t.getInputBindingsFromDefinition(t.commandDefinition),r={bindableTarget:{viewModelName:n.toString()+"-["+this._viewModelName+"]",viewModel:this._composedViewModel},inputs:o,referenceComposition:n,referenceCompositionIsContainer:
!0,customBindHandler:function(n){var i=t.sourceBindableContainer;if(i&&i.viewModel&&n.source.modelType!==0)return{sourceModelName:i.viewModelName,sourceModel:i.viewModel}},beforeViewModelPropertyUpdate:function(r){var u=t.commandDefinition,f,e;return u&&u.permissions?(i._hasPermissions(!1),f=n&&n.locator&&n.locator.toString()+"-",f=(f||"")+u.name,e=tt.Deferred(),y.checkPermissions(u.permissions,yt.All,r,u.assetType,i._extension.name,i._services,i._extension.cloudName,f).then((function(n){i._updateForHasPermissions(n);e.resolve(n)})).catch((function(n){e.reject(n)})),e.promise()):(i._updateForHasPermissions(!0),tt.Deferred().resolve(!0).promise())}},r.inputs&&f.isArray(r.inputs)&&r.inputs.length>0&&(this._onInputsSetPending(!0),r.inputsSetCalled=function(r,u){i._onInputsSetPending(!0);i._currentOnInputsSetPromise=u;u.then((function(){i._currentOnInputsSetPromise===u&&i._onInputsSetPending(!1)}),(function(u){et.error("Command '{0}' on composition '{1}' rejected its onInputsSet promise.\nView Model Name: {2}\nInputs Provided: {3}\nReason: {4}".
format(t.commandName,n.toString(),i._viewModelName,e.toJSON(r),u||"N/A"))}))}),s=bt.bindViewModelInputs(r),this._propertyBindings=s.propertyBindings,u.registerForDispose((function(){i._propertyBindings&&(i._propertyBindings.unbind(),i._propertyBindings=null)})))},n.prototype._updateForHasPermissions=function(n){var t=this._composedViewModel&&this._composedViewModel.container;t&&(n?t.unauthorizedMessage(undefined):t.unauthorized());this._hasPermissions(n)},n})();t.createOpenBladeCommand=ti;t.createOpenLinkCommand=ii}));define("MsPortalImpl/Services/Services.Settings.Schema",["require","exports","f"],(function(){"use strict";var n;return (function(n){n.desktopSettingsKey="sprint2";n.startBoardSettingsKey="Startboard";n.fxThemeKey="fxs-theme";n.highContrastKey="highContrastKey";n.favoritesKey="favorites";n.testExtensionsKey="TestExtensions";n.testGalleryPackagesKey="TestGalleryPackages";n.testPatchesKey="TestPatches";n.npsTimeMs="npsTimeMs";n.rawLocaleKey="rawLocale";n.sideBarCollapsedKey="sideBarCollapsedKey";
n.sideBarBrowseDisplayModeKey="sideBarBrowseDisplayModeKey";n.showCommandLabelsKey="showCommandLabelsKey";n.notificationToastEnabledKey="notificationToastEnabledKey";n.whatsNewEnabledKey="whatsNewEnabledKey";n.showLabelsKey="showLabelsKey";n.whatsNewVersionKey="whatsNewVersion";n.userConsentForNpsContactKey="userConsentForNpsContact";n.settingsVersionSettingKey="Version";n.defaultAssetTypeIdKey="MsPortalFx.Browse.DefaultAssetTypeId";n.idleTimeoutMinsKey="idleTimeoutMins";n.generalSettingsKeys=[n.defaultAssetTypeIdKey,n.fxThemeKey,n.highContrastKey,n.idleTimeoutMinsKey,n.notificationToastEnabledKey,n.npsTimeMs,n.rawLocaleKey,n.settingsVersionSettingKey,n.showCommandLabelsKey,n.showLabelsKey,n.sideBarCollapsedKey,n.sideBarBrowseDisplayModeKey,n.testExtensionsKey,n.testGalleryPackagesKey,n.userConsentForNpsContactKey,n.whatsNewVersionKey,]})(n||(n={})),n}));define("MsPortalImpl/UI/Compositions/UI.Composition.Base",["require","exports","f","i","o","ko","$","MsPortalImpl/UI/Compositions/UI.Composition",
"MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Services/Services.Settings.Schema"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function a(n,t,r){r=r||i.getUniqueId();var u=k[n];return u+=!t?"":"-"+t.name,u+("-"+r)}function d(n,t,r,u){return i.tryImmediateResolve(i.require(t,u),(function(t){if(!n||!n.isDisposed())try{return r(t)}catch(i){return Q.reject(i)}}))}function y(n,t){for(var i=n,r;i;)(i.hasOwnProperty(t)||typeof i[t]=="function")&&(r=i),i=i.parent;return r||c.error("Could not locate container with property or function '"+t+"' for composition '"+n+"'."),r}var v;u.defineProperty(t,"__esModule",{value:!0});var p=r.TriggerableLifetimeManager,w=i.Base,b=w.Diagnostics,k=o.CompositionType,c=b.createLog(n),l=o.getIdMatchFunc;t.createIdentifier=a;t.compositionRequire=d;v=(function(n){function t(t,r,u,o,s,h){var c=n.call(this)||this;if(c._childObjects=f.observableArray(),c._disposeCallbacks=e.Callbacks("memory once"),c._composedDeferred=i.Helpers.Deferred(),!r)throw new Error("CompositionServices are required.");
return c.services=r,c.locator=u,c.id=h||c.createIdentifier(),c.widgetState=f.observable(s||{}),c._addChildrenInternal(o),c._toStringPrefix="{ Name: "+(t||"<NOT SPECIFIED>")+", Type: ",c}return __extends(t,n),u.defineProperty(t.prototype,"children",{get:function(){return this._childObjects()},enumerable:!0,configurable:!0}),t.prototype.subscribeChildren=function(n){return this._childObjects.subscribe(this,n)},u.defineProperty(t.prototype,"templateKey",{get:function(){return""+(this.locator||this.id)},enumerable:!0,configurable:!0}),t.prototype.getPerfData=function(){return{}},t.prototype.getCompositionType=function(){throw new Error("The getCompositionType method is not implemented.");},t.prototype.getCreationState=function(){return this._creationState},t.prototype.toString=function(){var n=this._toStringPrefix,t=this._toStringPostfix||(this._toStringPostfix=", Id: "+this.id+" }");return n+=this.locator||"<null>",n+t},t.prototype.compose=function(n){for(var r,i=[],t=1;t<arguments.length;
t++)i[t-1]=arguments[t];r=[n,this._composedDeferred].concat(i);this._compose.apply(this,r)},t.prototype._compose=function(){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];throw new Error("Not implemented.");},t.prototype.resetLayout=function(){var n=this.children;n&&n.forEach((function(n){n.resetLayout()}))},t.prototype._attachWidgetErrorEvent=function(){var t=this,i,n;if(!this.widget)throw new Error("Cannot attach to error event of undefined widget.");n=s.Widget.errorEvent;e(this.widget).on(n,i=function(n,i){c.error("[Widget Error] {0}\nCurent State: {1}".format(i,f.toJSON(t.getDiagnosticsData(),null,2)))});this.registerForDispose((function(){e(t.widget).off(n,i)}))},t.prototype.dispose=function(t){this.isDisposed()||(n.prototype.dispose.call(this),this._disposeCallbacks.fire(),t||this._deleteSetting(),this.children.slice(0).forEach((function(n){n.dispose(t)})))},t.prototype._deleteSetting=function(){if(this._store!==undefined)this.services.sharedSettings.deleteSettings({store:
this._store,keys:[this.id]});else if(this.parent){var n=this.parent.children,t=n.first(l(this.id));t&&n.remove(t);this.parent.save()}},t.prototype.save=function(n){if(this._store!==undefined){if(this.services.settings){var t=this.toJSON();this.services.settings.setSetting(this._store,this.id,JSON.parse(JSON.stringify(t)));n===1&&this.services.settings.flushSettings()}}else this.parent&&this.parent.save(n)},u.defineProperty(t.prototype,"isComposed",{get:function(){return this.awaitComposed().state()==="resolved"},enumerable:!0,configurable:!0}),t.prototype.getLoadDelayed=function(){return this._loadDelayed},t.prototype.awaitComposed=function(){return this._composedDeferred.promise()},t.prototype.awaitOnInputsSetComplete=function(){return Q.resolve(null)},t.prototype.awaitContentRevealed=function(){return Q.resolve(!1)},t.prototype.onDispose=function(n){this._disposeCallbacks.add(n)},t.prototype.offDispose=function(n){this._disposeCallbacks.remove(n)},t.prototype.addChild=function(n,t,i)
{i===void 0&&(i=!0);n&&this.addChildren([n],t,i)},t.prototype.addChildren=function(n,t,i){i===void 0&&(i=!0);this._addChildrenInternal(n,t);i&&this.save()},t.prototype._addChildrenInternal=function(n,t){var r=this,i;t===void 0&&(t=this.children.length);n&&n.length>0&&(i=this._childObjects(),n.forEach((function(n){i.splice(t,0,n);n.parent=r;t++;r.addChildWidget(n.widget)})),this._childObjects(i))},t.prototype.sortChildren=function(n){this._childObjects(this._childObjects().stableSort(n))},t.prototype.removeChildren=function(n){for(var t=this.children.length-1;t>=0;t--)this.removeChildAt(t,n,!1);this.save()},t.prototype.removeChildAt=function(n,t,i){if(i===void 0&&(i=!0),n>=0){var r=this._childObjects.splice(n,1)[0];this.removeChildWidget(r.id,t);t||r.dispose();i&&this.save()}},t.prototype.replaceChild=function(n,t){var i=this._childObjects,r;n&&t&&i&&(r=i.indexOf(n),r>=0&&(i.splice(r,1,t),t.parent=this,this.save()))},t.prototype.removeChild=function(n,t,i){if(i===void 0&&(i=!0),n&&this._childObjects)
{var r=this._childObjects.indexOf(n);this.removeChildAt(r,t,i)}},t.prototype.addChildWidget=function(n){this.widget&&n&&this.widget.addChild(n)},t.prototype.removeChildWidget=function(n,t){this.widget&&this.widget.removeChild(n,t)},t.prototype.getChildById=function(n){return this._childObjects?this._childObjects().first(l(n)):null},t.prototype.toJSON=function(n){var t={},i=this.children,r=n?i.filter(n):i;return this.id!==h.startBoardSettingsKey&&r.forEach((function(n){t[n.id]=n.toJSON()})),{id:this.id,locator:this.locator,widgetState:this.widgetState(),errorMessage:this.unrecoverableErrorMessage,children:r.map((function(n){return n.id})),childSettings:t}},t.prototype.loadFromJson=function(n){this.unrecoverableErrorMessage=n.errorMessage},t.prototype.getPartsContainer=function(){return this._partsContainer||(this._partsContainer=y(this,"masterContainer")),this._partsContainer},t.prototype.getBindableContainer=function(){return this._bindableContainer||(this._bindableContainer=y(this,"getViewModel")),
this._bindableContainer},t.prototype.getTemplate=function(){return{key:this.templateKey,locator:this.locator.toJSON(),widgetId:this.id,widgetState:f.toJS(this.widgetState),children:this.children.map((function(n){return n.getTemplate()}))}},t.prototype.getDiagnosticsData=function(){return e.extend(this.toJSON(),{id:this.id,name:this._name,locator:this.locator&&this.locator.toString(),errorMessage:this.unrecoverableErrorMessage,children:(this.children||[]).map((function(n){return n.getDiagnosticsData()}))})},t.prototype.definitionExists=function(n){var t=this.services.finder,i=this.locator;return t.tryLocate(i,{})?0:t.tryLocate(i.getExtensionLocator(),{})&&n?1:2},t.prototype.discardWidgetStateOfUnusedChildren=function(){if(this.widget){var n=this.widget.discardStateOfUnusedChildren();n&&n.stateDiscarded&&c.warning("Unused widget state was discarded for composition '{0}'. \n{1} \nCurrent Children: {2}\nCurrent Widget State: {3}".format(this,n.message,JSON.stringify((this.children||[]).map((function(
n){return""+n}))),JSON.stringify(this.widgetState())))}},t.prototype._markAsComposed=function(){this._composedDeferred.resolve()},t.prototype.createIdentifier=function(){return a(this.getCompositionType(),this.locator)},t})(p);t.Instance=v}));define("MsPortalImpl/Parts/Parts.Error",["require","exports","f","MsPortalImpl/Parts/Parts","MsPortalImpl/Widgets/Widgets.PartError"],(function(n,t,i,r,u){"use strict";var f;return (function(){var n=i.Parts,t=n.PartKind,e=i.ViewModels,f=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return i.container.contentState(3),i.internal.allowUiBlocking(!1),f}return __extends(t,n),t.prototype._bindContent=function(n){var t=new u.ViewModel,i=this._viewModel.content,r;t.title=i.title||t.title;t.subtitle=i.subtitle||t.subtitle;t.reason=i.reason||t.reason;r=i.clickable;t.clickable=typeof r!="undefined"?r:t.clickable;this._lifetime.registerForDispose(this._control=new u.Widget($(n),t))},t})(r.PartImpl);r.registerFactory(t[n.PartKind.Error],r.createPartFactory(
"",{partClass:f}))})(f||(f={})),f}));define("MsPortalImpl/UI/Dashboard/DashboardRepository",["require","exports"],(function(){"use strict";var n;return (function(n){n.ArmDashboardRepository="ArmDashboardRepository";n.PrivateDashboardRepository="PrivateDashboardRepository";n.RecommendedDashboardRepository="RecommendedDashboardRepository";n.SessionDashboardRepository="SessionDashboardRepository"})(n||(n={})),n}));define("MsPortalImpl/UI/Dashboard/ArmDashboardRepository",["require","exports","f","o","MsPortalImpl/UI/Dashboard/DashboardRepository","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function c(n){try{return nt.parseResourceDescriptor(n)}catch(t){return l.error(t,0,"Failed to parse ARM dashboard id '"+n+"'."),null}}function y(n){var e=n.tags&&n.tags[a]||n.name,t=n.properties,u=t&&t.metadata,o=u&&u.model||{},i=t&&t.lenses,f=i&&i["0"]&&i["0"].parts||{};return{title:e,model:o,parts:r.keys(f).map((function(n){return f[n]}))}}function e(
n){var t=n.substr(h.length);return i.ensurePrefix(t,"/")}function p(n){return n.startsWith("/")&&(n=n.substr(1)),""+h+n}function w(n){return i.startsWith(n,h)}function it(n,t){return t.length?n.filter((function(n){if(!w(n.id))return!0;var r=e(n.id),i=c(r);return i?t.indexOf(i.subscription)>-1:!1})):n}function k(n,t){var r={};return r[a]=n,i.extend2(t,r)}var s=i.Base,d=s.Diagnostics,g=s.Promises.cancelOnDispose,o=s.Constants.DefaultCloudName,nt=i.ViewModels.Services.ResourceTypes,tt="Dashboard$DashboardViewModel",l=d.createLog(n),h="arm/",a="hidden-title",v=f.Dashboard.NotFound,b;t.normalizedDashboard=y;t.getArmDashboardId=e;t.buildDashboardId=p;t.filterDashboards=it;b=(function(){function n(n,t,i,r){var u=this;this._lifetime=n;this._extensionManager=t;this._permissionsManager=i;this._compressor=r;this._isDisposed=!1;n.registerForDispose((function(){u._dispose()}))}return n.prototype.getTypeName=function(){return u.ArmDashboardRepository},n.prototype.createDashboard=function(n){var t=this;return this.
_connect().then((function(){var r=t._compressor.compress({id:"",title:"",settings:n.settings}),u={name:i.getUniqueId(),model:r.model,parts:r.parts,subscriptionId:n.extras.subscriptionId,resourceGroupName:n.extras.resourceGroupName,tags:k(n.title)};return t._provider.createDashboard(u,o)})).then((function(n){return t._convertToDashboard(n)}))},n.prototype.readDashboard=function(n){var t=this;return this._connect().then((function(){var i=e(n);return t._provider.readDashboard(i,o)})).then((function(n){return t._convertToDashboard(n)}))},n.prototype.updateDashboard=function(n,t){var i=this,r=e(n);return this._connect().then((function(){return t.title?i._provider.readDashboard(r,o).then((function(n){return n.tags})):Q()})).then((function(n){var u=i._compressor.compress({id:"",title:"",settings:t.settings}),f={model:u.model,parts:u.parts,tags:!t.title?undefined:k(t.title,n)};return i._provider.updateDashboard(r,f,o)})).then((function(n){return i._convertToDashboard(n)}))},n.prototype.deleteDashboard=function(
n){var t=this;return this._connect().then((function(){var i=e(n);return t._provider.deleteDashboard(i,o)}))},n.prototype.readArmDashboards=function(){var n=this;return this._connect().then((function(){return n._provider.readDashboards(o)}))},n.prototype.readDashboards=function(){var n=this;return this._connect().then((function(){return n.readArmDashboards()})).then((function(t){return t.map((function(t){return n._convertToDashboard(t)}))}))},n.prototype.isDashboardWritable=function(n){return this._permissionsManager.hasPermission(e(n),["Microsoft.Portal/dashboards/write"],o)},n.prototype.identifyDashboard=function(n){return w(n)},n.prototype.getDashboardProperties=function(n){var t=n.id,u=n.title,i=e(t),r=c(i)||{subscription:"",resourceGroup:""};return{id:t,title:u,originalId:i,subscription:r.subscription,resourceGroup:r.resourceGroup}},n.prototype.getNotFoundMessage=function(n){var r=n.id,i=n.title,u=e(r),t=c(u);return t?v.armMessageFormat.format(i,t.resourceGroup,t.subscription):v.defaultMessageFormat.
format(i)},n.prototype._dispose=function(){this._isDisposed||(this._isDisposed=!0,this._isConnected=null,i.disposeViewModelProperties(this._viewModel),this._extension&&this._viewModel&&this._extension.releaseViewModel(this._viewModel),this._extension=null,this._viewModel=null)},n.prototype._connect=function(){var n=this;return this._isConnected||(this._isConnected=g(this._lifetime,(function(){return n._extensionManager.getHubsExtension().then((function(t){return n._extension=t,Q(t.getViewModel(tt))})).then((function(t){n._viewModel=t;n._provider=t.content})).catch((function(t){return n._isConnected=null,l.error(t,0,"Failed to connect ARM dashboard repository to its data provider from hubs extension."),Q.reject(t)}))})))},n.prototype._convertToDashboard=function(n){var t=p(n.id);return this._compressor.uncompress(t,y(n))},n})();t.ArmDashboardRepository=b})(e||(e={})),e}));define("MsPortalImpl/UI/Commands/UI.ShellCommands",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/UI/Dashboard/ArmDashboardRepository",
"MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.TileActionBar","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";function ft(n){return y.Widget.getWidget(n.closest(".fxs-tile"),p.Widget)}function wi(n,t){return et||(et=[{size:0,text:k.partSizeMini},{size:1,text:k.partSizeSmall},{size:2,text:k.partSizeNormal},{size:3,text:k.partSizeWide},{size:4,text:k.partSizeTall},{size:10,text:k.partSizeLarge},{size:5,text:k.partSizeHeroWide},{size:6,text:k.partSizeHeroTall},{size:11,text:k.partSizeHero}],et.forEach((function(n){n.icon=it.Mini({customClass:"msportalfx-contextmenu-grid-"+ht.InternalPartSize[n.size].toLowerCase()})}))),et.map((function(
i){return new ot(n,i.text,i.size,i.icon,t)}))}var g,at,vt,yt,pt,ot,et,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci;r.defineProperty(t,"__esModule",{value:!0});var st=i.Base,li=st.Diagnostics.Telemetry,tt=st.Images,it=tt.Shell,ht=i.Parts,ct=i.ViewModels,ai=ct.FileDownload,vi=ct.Controls.FileDownloadButton,yi=i.ViewModels.Dialogs,pi=l.CompositionInstanceCommandContext,nt=i.tryImmediateResolve,rt=i.require,k=s.ShellCommands,d="MsPortalImpl.UI.Commands.",ut=1,lt=tt.Blank();t.CommandNames={BladeDisplayState:d+"BladeDisplayState",CloneDashboard:d+"CloneDashboard",DeleteDashboard:d+"DeleteDashboard",DeleteListItem:d+"DeleteListItem",DownloadDashboard:d+"DownloadDashboard",EnterOrganizeMode:d+"EnterOrganizeMode",ExitOrganizeMode:d+"ExitOrganizeMode",FilterDashboard:d+"FilterDashboard",FullscreenDashboard:d+"FullscreenDashboard",NewDashboard:d+"NewDashboard",OpenBrowseDashboardsPane:d+"OpenBrowseDashboardsPane",PartSize:d+"PartSize",PinBlade:d+"PinBlade",PinListItem:d+"PinListItem",PinToStartboard:
d+"PinToStartboard",ResetLayout:d+"ResetLayout",ResetStartBoard:d+"ResetStartBoard",ShareDashboard:d+"ShareDashboard",UnpinFromStartboard:d+"UnpinFromStartboard",UploadDashboard:d+"UploadDashboard"};g=(function(n){function t(t,i,r,u){var f=n.call(this,t,r,u)||this;return f._services=i,f.isShellCommand=!0,f}return __extends(t,n),t.prototype.bind=function(t){var i=this;t.getFormTarget||(t.getFormTarget=function(){return i._services.getService("PortalFormTarget")});n.prototype.bind.call(this,t)},t.prototype.execute=function(t){n.prototype.execute.call(this,t);li.trace({source:l.getCommandSourceTelemetryName(this._currentContext),action:c.Action.CommandExecuted,name:this.commandName,data:{fromContextMenu:t,desktopMode:this._getDesktopMode()}})},t.prototype.createAction=function(n){var i=this,t=new w.TileActionViewModel;return t.command=this,t.bindCommand=function(){var t=n.widget;t?i.bind(new pi(t.element[0],null,n)):i.enabled(!1)},this._setActionClassName(t),t},t.prototype._getComposition=
function(){return this._currentContext.compositionInstance},t.prototype._getDesktopMode=function(){return this._services?this._services.desktop.mode():null},t.prototype._setActionClassName=function(n){var t=this._getActionClassIdentifier();this._actionClassName="fxs-tile-actionbar-command-"+t;n.className=this._actionClassName},t.prototype._getActionClassIdentifier=function(){throw new Error("Not implemented.");},t})(h.CommandImpl);t.ShellCommand=g;at=(function(n){function t(t,i){var r=n.call(this,t,null,i.text)||this;return r._command=i,r}return __extends(t,n),t.prototype.execute=function(t){this._command.handler().execute();n.prototype.execute.call(this,t)},t})(g);t.ControlCommand=at;vt=(function(n){function i(i,r){var u=n.call(this,i,r,k.unpinFromStartboard,!0)||this;return u.commandName=t.CommandNames.UnpinFromStartboard,u.icon(tt.Discard({isLogo:!0})),u}return __extends(i,n),i.prototype.execute=function(t){var i=ft(f(this._currentContext.target));i&&i.trigger(b.default.fxunpin,null,{tileId:
i.options.id});n.prototype.execute.call(this,t)},i.prototype._getActionClassIdentifier=function(){return"unpinfromstartboard"},i})(g);t.UnpinFromStartboard=vt;yt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r,!0)||this;return u.icon(tt.Ellipsis({isLogo:!0})),u}return __extends(t,n),t.prototype.bind=function(t){var e=this,i,r;n.prototype.bind.call(this,t);i=this._partWidget=ft(f(t.target));r=i.options.commands.filter((function(n){return n.bind(t),n.visible()&&n.enabled()}));this.enabled(r.length>0);u.computed(this._ltm,(function(){var n=i.actionBarWidget.contextMenuWidget.options.visible(),t=i.element.findByClassName(e._actionClassName);t.toggleClass("fxs-tile-actionbar-action-pressed",n)}))},t.prototype.execute=function(t){var e=this._partWidget,r=e.element,u=r.findByClassName(this._actionClassName),i,o,s;if(u.length<=0)throw new Error("Context menu requires an anchor element.");i=f.Event(b.default.fxcontextmenu);this._getDesktopMode()!==ut?(o=u.offset(),i.clientX=o.left,i.clientY=o.
top+u.outerHeight(!1)):(s=r.offset(),i.clientX=s.left+r.outerWidth(!1),i.clientY=s.top-u.outerHeight(!1));r.trigger(i,{commands:e.options.commands,contextMenu:e.actionBarWidget.contextMenuWidget});n.prototype.execute.call(this,t)},t.prototype._getActionClassIdentifier=function(){return"opencontextmenu"},t})(g);t.OpenContextMenu=yt;pt=(function(n){function i(i,r){var u=n.call(this,i,r,k.pinToStartboard,!1)||this;return u.commandName=t.CommandNames.PinToStartboard,u.icon(tt.Pin()),u}return __extends(i,n),i.prototype.bind=function(t){var e,i,r;if(n.prototype.bind.call(this,t),e=!1,this.baseInstance=this._getComposition(),e=this.baseInstance.allInputsSet(),i=ft(f(t.target)),r=!1,i){var h=a.isVariableSize(i.options.size()),s=u.unwrap(i.options.supportedSizes),o=void 0,c=i.element.parentsUntil(".fxs-blade",".fxs-blade-summary-container").length>0;c?r=!1:h?(o=s&&s.first((function(n){return a.isFixedSize(n)})),o!==null&&o>=0&&(r=!0)):r=!0}this.enabled(r&&e)},i.prototype.execute=function(t){var i=this;
nt(rt("MsPortalImpl/UI/UI.Desktop.Actions"),(function(n){return Q(n.pinPartToStartboard(i.baseInstance,i._services))})).finally((function(){n.prototype.execute.call(i,t)}))},i.prototype._getActionClassIdentifier=function(){return"pintostartboard"},i})(g);t.PinToStartboard=pt;ot=(function(n){function i(i,r,u,f,e){var o=n.call(this,i,e,r,!0)||this;return o.commandName=t.CommandNames.PartSize+ht.InternalPartSize[u],o._sizeTarget=u,o.icon(f),o}return __extends(i,n),i.prototype.execute=function(t){var i=ft(f(this._currentContext.target)),r;i&&(r=a.AllSizes[this._sizeTarget],i.element.trigger(b.default.fxsizechange,[i.options.id,r.size.width,r.size.height]),Q.fcall((function(){i.setFocus()})));n.prototype.execute.call(this,t)},i.prototype.bind=function(t){var i=ft(f(t.target)),r=i&&i.options;if(!i||this._sizeTarget===r.size()||a.isVariableSize(r.size())||this._getDesktopMode()!==ut){this.enabled(!1);return}this.enabled(r.supportedSizes().indexOf(this._sizeTarget)!==-1);n.prototype.bind.call(this,t)}
,i})(g);t.PartSizeCommand=ot;t.CreatePartSizeCommandCollection=wi;wt=(function(n){function i(i,r){var u=n.call(this,i,r,k.resetLayout,!0)||this;return u.commandName=t.CommandNames.ResetStartBoard,u.icon(lt),u}return __extends(i,n),i.prototype.execute=function(t){this._services.desktop.startBoard.resetLayout();n.prototype.execute.call(this,t)},i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(this._getDesktopMode()===ut)},i})(g);t.ResetStartBoardCommand=wt;bt=(function(n){function i(i,r,f){var e=n.call(this,i,r,k.enterOrganizeMode,!0)||this;return e.commandName=t.CommandNames.EnterOrganizeMode,e.icon(tt.Edit()),e._expandTileGallery=!!f,u.reactor(e._ltm,(function(){var n=r.desktop.mode()!==ut,t=!r.leftContextPane.opened();e.enabled(n&&t)})),e}return __extends(i,n),i.prototype.execute=function(t){var i=this._getComposition();i&&i.widget?i.widget.element.trigger(b.default.fxenterorganizemode,{trigger:1,expandTileGallery:this._expandTileGallery}):this._services.desktop.mode(
ut);n.prototype.execute.call(this,t)},i})(g);t.EnterOrganizeMode=bt;kt=(function(n){function i(i,r){var u=n.call(this,i,r,k.exitOrganizeMode,!0)||this;return u.commandName=t.CommandNames.ExitOrganizeMode,u.icon(lt),u}return __extends(i,n),i.prototype.execute=function(t){this._services.desktop.portalWidget.trigger(b.default.fxexitorganizemode);n.prototype.execute.call(this,t)},i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(this._getDesktopMode()===ut)},i})(g);t.ExitOrganizeMode=kt;dt=(function(n){function i(i,r){var u=n.call(this,i,r,k.shareDashboard,!0)||this;return u.commandName=t.CommandNames.ShareDashboard,u.icon(it.Share()),u}return __extends(i,n),i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(!this._services.contextPane.opened.peek())},i.prototype.execute=function(t){var r=this,i;n.prototype.execute.call(this,t);i=this._services;nt(rt("MsPortalImpl/Widgets/Widgets.ShareDashboardPane"),(function(n){var u=i.contextPane,t=r._ltm.createChildLifetime(
);u.tryOpen(new n.ShareDashboardPane(t,i)).then((function(n){n?u.contentLifetime.registerForDispose(t):t.dispose()})).catch((function(n){return t.dispose(),Q.reject(n)}))}))},i})(g);t.ShareDashboard=dt;ni=(function(n){function i(i,r){var u=n.call(this,i,r,k.deleteDashboard,!0)||this;return u.commandName=t.CommandNames.DeleteDashboard,u.icon(gt||(gt=it.TrashOutline())),u}return __extends(i,n),i.prototype.execute=function(t){var r=this,i;n.prototype.execute.call(this,t);i=this._services;i.desktop.getDashboardManager().then((function(n){var t=n.isCurrentDashboardShared(),u=i.desktop.startBoard.notFound()?Q(!0):n.isCurrentDashboardWritable();u.then((function(u){Q.all([i.getService("DialogManager"),r._currentContext.getFormTarget()]).spread((function(i,f){var e=new yi.MessageBox(k.deleteDashboard,u?k.deleteDashboardConfirm:k.noPermissionToDeleteDashboard,u?2:1),o;e.confirmationRequired=u&&t;e.confirmationMessage=k.deleteDashboardConfirmation;o=r._currentContext;i.showShellDialog(e,f,o.target).then((function(
t){u&&t===4&&n.deleteCurrentDashboard(1)}))}))}))}))},i})(g);t.DeleteDashboard=ni;ii=(function(n){function i(i,r){var u=n.call(this,i,r,k.newDashboard,!0)||this;return u.commandName=t.CommandNames.NewDashboard,u.icon(ti||(ti=it.Add())),u}return __extends(i,n),i.prototype.execute=function(t){n.prototype.execute.call(this,t);nt(this._services.desktop.getDashboardManager(),(function(n){n.startNewDashboard()}))},i})(g);t.NewDashboard=ii;ui=(function(n){function i(i,r){var u=n.call(this,i,r,k.cloneDashboard,!0)||this;return u.commandName=t.CommandNames.CloneDashboard,u.icon(ri||(ri=tt.Clone())),u}return __extends(i,n),i.prototype.execute=function(t){n.prototype.execute.call(this,t);nt(this._services.desktop.getDashboardManager(),(function(n){n.cloneCurrentDashboard()}))},i})(g);t.CloneDashboard=ui;ei=(function(n){function i(i,r,u){var f=n.call(this,i,r,k.filterDashboard,!0)||this;return f.commandName=t.CommandNames.FilterDashboard,f._startboard=u,f.icon(fi||(fi=it.Filter())),f}return __extends(i,n),i.prototype.
execute=function(t){n.prototype.execute.call(this,t);var i=this._services,r=this._startboard;nt(rt("MsPortalImpl/Widgets/Widgets.FilterPane"),(function(n){var t=n.FilterPane.getSingleton(i.contextPane,r);t.open()}))},i})(g);t.FilterDashboard=ei;oi=(function(n){function i(i,r){var u=n.call(this,i,r,k.fullscreenDashboard,!0)||this;return u.commandName=t.CommandNames.FullscreenDashboard,u.icon(it.Fullscreen()),u}return __extends(i,n),i.prototype.execute=function(t){n.prototype.execute.call(this,t);e.isFullscreen()?e.exitFullscreen():e.requestFullscreen()},i})(g);t.FullscreenDashboard=oi;si=(function(n){function i(i,r){var u=n.call(this,i,r,"",!0)||this;return u.commandName=t.CommandNames.OpenBrowseDashboardsPane,u}return __extends(i,n),i.prototype.execute=function(t){var r=this,i;n.prototype.execute.call(this,t);i=this._services;nt(rt("MsPortalImpl/UI/Dashboard/BrowseDashboardsPane"),(function(n){return nt(i.desktop.getDashboardManager(),(function(t){var u=i.contextPane,f=i.contextPane.getContent(
),e;if(f instanceof n.BrowseDashboardsPane){u.tryOpen(f);return}e=new n.BrowseDashboardsPane(t,{defaultDashboardType:r._dashboardType,dashboardTypeChanged:function(n){return r._dashboardType=n}});u.tryOpen(e)}))}))},i})(g);t.OpenBrowseDashboardsPane=si;hi=(function(n){function r(i,r){var f=n.call(this,i,r,k.uploadDashboard,!0)||this;return f._fileUploaderMap={},f._fileUploadModel={uploadContext:u.observable("")},f.commandName=t.CommandNames.UploadDashboard,f.fileInputOptions(new h.FileInputOptions(".json",1)),f}return __extends(r,n),r.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);this._fileUpload?this._execute(t):nt(rt("MsPortalImpl/Services/Services.FileUpload"),(function(n){i._fileUpload=n;i._execute(t)}))},r.prototype._execute=function(){var f=this,t=this.fileInputOptions().files(),n,r,u;t&&t.length>0&&(n=t[0],r=new this._fileUpload.FileUploader(this._ltm,this._fileUploaderMap,n,this._fileUploadModel),this._fileUploaderMap[n.name]=r,[].push(r.uploadTask),u=new this.
_fileUpload.FileReaderHelper(n),u.readNextChunk().then((function(t){var r=new FileReader;r.onload=function(t){try{var r=o.normalizedDashboard(JSON.parse(t.target.result));f._services.desktop.getDashboardManager().then((function(t){r.title=r.title||n.name.replace(/\.json$/i,"");t.importDashboard(r)}))}catch(u){i.Hubs.Notifications.ClientNotification.publish({title:k.uploadErrorTitle,description:k.uploadErrorDescription,status:i.Hubs.Notifications.NotificationStatus.Error})}};r.readAsText(new Blob([t.content],{type:"application/octet-stream"}))})))},r})(g);t.UploadDashboard=hi;ci=(function(n){function i(i,r){var u=n.call(this,i,r,k.downloadDashboard,!0)||this;return u.commandName=t.CommandNames.DownloadDashboard,u}return __extends(i,n),i.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);nt(rt("MsPortalImpl/Commands/Commands.FileDownloadCommand"),(function(n){i._services.desktop.getDashboardManager().then((function(t){t.getArmDashboardJson().then((function(t){t.location.localeCompareIgnoreCase(
"INSERT LOCATION")&&delete t.id;var f=new ai.Context({targetUri:u.observable("data:,"+encodeURIComponent(JSON.stringify(t))),targetFileName:u.observable(t.tags["hidden-title"]+".json"),addDefaultAuthorizationToken:!1}),r=new vi.ViewModel(i._ltm,{context:u.observable(f),disabled:u.observable(!1)});i._instance=new n.FileDownloadCommand(r.context(),i._services);i._instance.execute(r.context())}))}))}))},i})(g);t.DownloadDashboard=ci}));define("MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer",["require","exports","f","a","MsPortalImpl/Base/Base.SelectableSet2","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Commands/UI.ShellCommands"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function s(n,t,i,u,f){if(h(i),u){var e=c(n,t,f);r.prototype.push.apply(i,e)}}function h(n){n.filter((function(n){return n instanceof e.ShellCommand})).forEach((function(t){n.remove(t);t.dispose()}))}function c(n,t,i){var u=[],s,f;return t.getCompositionType()===o.StartboardPart?
(u.push(new e.UnpinFromStartboard(n,i),new e.EnterOrganizeMode(n,i)),r.prototype.push.apply(u,e.CreatePartSizeCommandCollection(n,i)),u.push(new e.ExitOrganizeMode(n,i))):(s=t.instanceDefinition,f=s&&s.reference,f&&f.extension==="HubsExtension"&&f.partTypeName==="MonitorChartPart"||u.push(new e.PinToStartboard(n,i))),u}function l(n,i){var r,f;return(n instanceof u.SelectableSet2?r=i:n._msPortalFxCreateSelectionAsync?(f=t.Deferred(),n._msPortalFxCreateSelectionAsync(i).then((function(n){f.resolve(n)}),(function(n){f.reject(n)})),r=f.promise()):r=n.createSelection(i),Q.isPromiseAlike(r))?r:t.Deferred().resolve(r).promise()}var o=f.CompositionType,t=i.Helpers;n.composeShellCommands=s;n.createSelection=l})(o||(o={})),o}));define("MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager",["require","exports","f","i","o","ko","$","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(n,t,i,r,u,f,e,o,s){"use strict";function h(n,
r,u){var e=""+t.partIdentityStatePrefix+n.toString(),s;return u&&(e+="-"+u),r&&(s=r.hasOwnProperty(o.PartContainerModelIdProperty)&&[o.PartContainerModelIdProperty],e+="-"+i.toSortedString(f.toJS(r),s)),e}function y(n){var i=n.widget;i&&i.element.trigger(t.fxpartsettingchanged,{part:n})}function p(n){var t;try{t=JSON.parse(JSON.stringify(n))}catch(i){t=n}return t}function nt(n){return n.some((function(n){var t=p(n.propertyValue),r=p(n.propertyOldValue);return!i.deepEquals(t,r)}))}var w;u.defineProperty(t,"__esModule",{value:!0});var b=i.Base,k=b.Diagnostics,c=o.CompositionType,l=s.PropertyBindings,d=window,a=k.createLog(n),v=u.keys(d.fx.environment.trace.partsettings||{}),g=v.length>0;t.partIdentityStatePrefix="[PartIdentityState]-";t.fxpartsettingchanged="fxpartsettingchanged";t.buildIdentitySettingKey=h;w=(function(){function n(){this._trace=!1}return n.prototype.configure=function(n){this._options=n;this._settingsStore=n.part.getCompositionType()===c.StartboardPart?13:2},n.prototype.configureInstanceProperties=
function(n){this._options.instanceProperties=n},n.prototype.initialize=function(){var n=this;this.dispose();this._registerPartIdentityStateChangeHandler();this._registerPartSharedKeyChangeHandler();this._registerPartInstanceChangedHandler();g&&(this._trace=v.some((function(t){return n._options.partViewModelId.toLowerCase().indexOf(t)>=0})))},n.prototype.saveIdentityPartSettings=function(n,t){var f=this._options,e=f.part,o=f.services,s=o.sharedSettings,i=this.getKeyForIdentitySettings(n),u;e.getCompositionType()===c.StartboardPart&&(i=h(e.locator,n));i&&(this._identityState&&(u=r.toSerializableObject(this._identityState.targetModel),this._traceOperationWithSettings("Save identity part settings.",u,i),s.setSetting(t&&13||this._settingsStore,i,u)),y(this._options.part))},n.prototype.clearIdentityPartSettings=function(){var t=this._options;if(t){var i=t.part,r=i.containerModel,n=[this.getKeyForIdentitySettings(r)];i.getCompositionType()===c.StartboardPart&&n.push(h(i.locator,r));n=n.filter((function(
n){return!!n}));n.length>0&&t.services.sharedSettings.deleteSettings({store:this._settingsStore,keys:n})}},n.prototype.getPartSettingsAsync=function(){if(this._options.part.getCompositionType()===c.StartboardPart)return this.getStartboardPartIdentitySettings();var n=this.getIdentityPartSettingsAsync(),t=this.getSharedPartSettingsAsync();return Q.all([n,t]).spread((function(n,t){var i={};return e.extend(!0,i,n),e.extend(!0,i,t),i}))},n.prototype.registerInstanceStateProperty=function(n,t,i){i===void 0&&(i=!0);var r=this._options.part,u=this._getOrCreateInstanceStatePropertyBindings(),f=u.targetModel,e=r.getSettingsModel();this._registerViewModelPropertyChangeHandler(t,e,f,u,(function(){r.save()}),n);i&&r.save()},n.prototype.savePart=function(){var n=this._options;n&&n.part.save()},n.prototype.dispose=function(){var i=this._partInstanceState,n,t;i&&(i.unbind(),this._partInstanceState=null);n=this._identityState;n&&(n.unbind(),this._identityState=null);t=this._sharedKey;t&&(t.unbind(),this._sharedKey=
null)},n.prototype.getKeyForIdentitySettings=function(n){var o=null,t=this._options,r=t.part,s=t.partStateDefinition,u=t.identityInputs,l=r.getInputPropertyBindings(),c=s&&s.inputIdentityProperties,e;return r.allInputsSet()&&c&&c.length>0&&(e="",u&&u.length>0&&(e=i.toSortedString(f.toJS(l.targetModel),u)),o=h(r.locator,n,e)),o},n.prototype._registerPartIdentityStateChangeHandler=function(){var u=this,t=this._options,i=t.part,r=t.partStateDefinition,n=r&&r.inputIdentityProperties;n&&n.length>0&&(this._identityState=new l(i.toString()+"-[PartIdentitySettings]",{}),this._registerViewModelChangeHandler(n,this._identityState,(function(n){var t=nt(n);t&&u.saveIdentityPartSettings(i.containerModel)})))},n.prototype._registerPartSharedKeyChangeHandler=function(){var e=this,t=this._options,o=t.part,u=t.partStateDefinition,h=t.services,n=u&&u.sharedProperties,f,i;n&&n.length>0&&(f=n.map((function(n){return n.property})),i={},this._sharedKey=new l(o.toString()+"-[PartSharedSettings]",i),this._registerViewModelChangeHandler(
f,this._sharedKey,(function(){var t={},u;n.forEach((function(n){var u=s.getModelValue(i,n.property).value;t[n.key]=r.toSerializableObject(u)}));u={store:5,settings:t};e._traceOperationWithSettings("Save shared part settings.",t);h.sharedSettings.setSettings(u)})))},n.prototype._registerPartInstanceChangedHandler=function(){var n=this._options,i,t=n.instanceProperties,r=function(n){return n.some((function(n){return n.propertyName==="content.pollingOptions"}))};t&&t.length>0&&(i=this._getOrCreateInstanceStatePropertyBindings(),this._registerViewModelChangeHandler(t,this._partInstanceState,(function(t){n.part.save();r(t)&&y(n.part)})))},n.prototype._registerViewModelChangeHandler=function(n,t,i){var r=this,u=t.targetModel,f=this._options.part.getSettingsModel();n.forEach((function(n){r._registerViewModelPropertyChangeHandler(n,f,u,t,i)}))},n.prototype._registerViewModelPropertyChangeHandler=function(n,t,i,r,u,e){var o;s.getModelValue(i,n).exists||s.setModelValue(i,n,f.toJS(s.getModelValue(t,n).value));
o=r.addProperty(n).bind(this._options.partViewModelId,t,!1,u,(function(n){a.error("[PartState] Failed to bind changes from viewmodel to part state. Error: "+n)}));e&&e.registerForDispose((function(){r.removeProperty(o)}))},n.prototype.getIdentityPartSettingsAsync=function(){var t=this,i=this._options,r=i.partStateDefinition,u=i.part.containerModel,f=r&&r.inputIdentityProperties,n,o;return(f&&f.length>0)?(n=this.getKeyForIdentitySettings(u),o={store:this._settingsStore,keys:[n]},this._getPartSettingsAsync("Get identity part settings.",o,undefined).then((function(i){if(n===t.getKeyForIdentitySettings(u)){var r=t._identityState;return r&&e.extend(!0,r.targetModel,i),i}}))):Q.resolve(null)},n.prototype.getStartboardPartIdentitySettings=function(){var i=this._options,n=i.part,r=i.partStateDefinition,u=r&&r.inputIdentityProperties,t;return(u&&u.length>0)?(t=!(n.flags&2)?[]:[h(n.previousLocator,n.containerModel)],t=t.concat([this.getKeyForIdentitySettings(n.containerModel),h(n.locator,n.containerModel)]),
this._getPartSettingsAsync("Get identity part settings.",{store:this._settingsStore,keys:t},undefined)):Q.resolve(null)},n.prototype.getSharedPartSettingsAsync=function(){var f=this._options,r=f.partStateDefinition,n=r&&r.sharedProperties,t,i,u;return(n&&n.length>0)?(t=[],i={},n.forEach((function(n){t.push(n.key);i[n.key]=n.property})),u={store:5,keys:t},this._getPartSettingsAsync("Get shared part settings.",u,i)):Q.resolve(null)},n.prototype._traceOperationWithSettings=function(n,t,i){if(this._trace){if(i){var r={};r[i]=t;t=r}a.verbose("[PartSettingsManager] {0} Part: {1}.\nSettings: {2}".format(n,this._options.part.toString(),f.toJSON(t,null,2)))}},n.prototype._traceOperationWithKeys=function(n,t){this._trace&&a.verbose("[PartSettingsManager] {0} Part: {1}.\nKeys: {2}".format(n,this._options.part.toString(),f.toJSON(t,null,2)))},n.prototype._getPartSettingsAsync=function(n,t,i){var f=this,u;return this._traceOperationWithKeys("BEGIN - "+n,t.keys),u=[this._options.services.sharedSettings.
querySettings(t)],Q.all(u).then((function(u){var h,o={};return h=u[0]||{},t.keys.forEach((function(n){var t=h[n],f=r.isSerializedObject(t),u=f?r.fromSerializableObject(t):t;i?h[n]!==undefined&&i[n]&&s.setModelValue(o,i[n],u):e.extend(!0,o,u)})),f._traceOperationWithSettings("END - "+n,o),o}))},n.prototype._getOrCreateInstanceStatePropertyBindings=function(){if(!this._partInstanceState){var n=this._options.part;this._partInstanceState=new l(n.toString()+"-[PartInstanceState]",n.partState)}return this._partInstanceState},n})();t.PartSettingsManager=w}));define("MsPortalImpl/UI/Compositions/UI.Composition.Part",["require","exports","f","i","o","ko","$","FxInternal/Composition/ViewModel","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.SelectableSet2","MsPortalImpl/Base/Telemetry","MsPortalImpl/Base/Base.Timers",
"MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Parts/Parts","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CloudName","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.Security",
"MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Parts/Parts.Error"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt){"use strict";function fi(n){return n&&n.toFriendlyString()}function au(n,t){return t.masterPartId===n.id&&gi(t.masterCommandName)}function yf(n){var i=n.services.desktop,r=i.tryCloseBlade.bind(i),t=n.getPartsContainer();return function(i,u){var e,f,o;switch(i){case 1:case 2:return e=t.detailContainers.filter((function(t){var r=!!(t.flags&1);return au(n,t)&&i===1?!r:r})),e.length===0?!1:!e.some((function(n){return!r(n.id)}));default:return f=t.masterContainer,o=f&&f.bladeDefinition,o&&o.menuBlade&&(t=f),t.returnValue=u,r(t.id,2)}}}function pf(t,r,u){var e=u&&u.children||[],o=e.indexOf(r,1),f;if(o>0&&(f=e[o-1],f.bladeDefinition&&f.bladeDefinition.menuBlade))return{switchItem:function(r){ff(t,i.require("../../../MsPortalImpl.Controls/Controls/Lists/Menu",n)).then((function(n){var i=f.widget.
element.findByClassName("fxc-menu"),t=it.Widget.getWidget(i,n.Widget);t&&t.switchItem(r)}))}}}function ur(n,t){t===void 0&&(t=!0);var r;return n&&(t&&!n.hasOwnProperty(et.PartContainerModelIdProperty)&&(n=f.toJS(n),n[et.PartContainerModelIdProperty]=i.getUniqueId()),r=dt.createObservableModel(n)),r}function ar(n,t){var i;return n&&t?(i={},cu(n,(function(n){i[n]=null}))):i=n,r.toSerializableObject(i)}function vr(n){return r.isSerializedObject(n)?r.fromSerializableObject(n):{}}function vu(n,t,i,r,u){var f=new lr(n,t,null,i);return f.calculateInitialSize(),f.containerModel=ur(r),f.overridesModel=ur(u||{},!1),f}function wf(n,t){var i,r,u;return vt.isFixedSize(t.size())?(u=vt.getGridPixelSize(t.gridWidth(),t.gridHeight()),i=u.height,r=u.width,t.locked()||(i-=30,r-=30)):(i=n.height(),r=n.width()),{height:i,width:r}}function yr(n,t,i,r,u){if(u===void 0&&(u=!0),u){var e="content.size",o=gt(n,e);o.exists&&f.isObservable(o.value)&&yt.setModelValue(n,e,r)}w.requestAnimationFrame((function(){var f=wf(
t,i),u=n&&n.container;u&&(u.width&&u.width(f.width),u.height&&u.height(f.height),u.size({partSize:r,dimensions:f}))}))}function bi(n){var t=n.partDefinition,i=n.adapter,r=t&&t.viewModel?t.viewModel:"N/A",u=i?"AdapterPart. Extension: "+i.extension.name+", ViewModel: "+i.viewModelName+", Wrapped ViewModel: "+r:"ViewModel: "+r;return n+" ("+u+")"}function bf(n){var t=n.partDefinition;return t&&t.partKind===ri.Custom&&t.htmlTemplate&&!(t.htmlTemplate in n.extension.definition.htmlTemplates)}function kf(n,t,i){var r=n.getInputPropertyBindings();(i||[]).forEach((function(i){var u=r.properties.first((function(n){var r=n.compositionBindingDefinition;return n.sourceProperty===i.source.property&&r&&r.source&&r.source.id===t.id}));u||(tr(n,r,[i]),i.source.id=t.id,n.bindings.push(i),n.save())}))}function df(n,t){var i=n.getInputPropertyBindings(),r=n.bindings||[],u=r.filter((function(n){return n.source.scope!==oi.DetailsContainer}));u.length!==r.length&&(i.properties.filter((function(n){var i=n.compositionBindingDefinition;
return i&&i.source&&i.source.id===t.id})).forEach((function(n){i.removeProperty(n)})),n.bindings=u,n.save())}function yu(n){var t=n.adapter,i=t.inputPropertyBindings,r=i.targetModel;tr(n,t.inputPropertyBindings,t.bindings,(function(t){return r[t.targetProperty]=f.observable(),n.bindAgainstOverridesOrContainerModel(t)}))}function gf(n,t,i){var r=!!t;return t&&(t.assetType&&!t.assetIdInputProperty?(kt.error("'assetIdProperty' is required if 'assetType' is defined on part definition. Locator:'"+n.locator+"'."),r=!1):!i&&!!t.editScopeType&&n.bindings&&n.bindings.some((function(n){return n.targetProperty===ai}))&&(r=!1,kt.error("Declaring an 'editScopeType' and an input binding with '"+ai+"' as a target property is not supported. "+("A part cannot be the owner of an edit scope and also receive an edit scope id from an external source. Part: '"+n+"'. Bindings: "+JSON.stringify(n.bindings)+".")))),r}function ne(n,t){var i=[],r=!0;return t&&t.invocationInputArguments&&t.invocationInputArguments.length&&
(r=st.validateDetailsDefinition(t,i)),i.length&&sf.logDetailDefinitionError(i[0],n.toString(),t),r}function te(n,t){var i=[],r=dt.validateInputBindings(n,t,i);return i.length&&kt.error(i[0]+" Part:'"+n+"'."),r}function ie(n){var t=n.adapter,i=t?t.allInputsSet:n.allInputsSet;f.computed(n,(function(){if(i()){var t=pu(n);t&&t.exists&&n.assetId(f.unwrap(t.value))}}))}function pu(n){var i=n.adapter,r=i?i.inputPropertyBindings:n.getInputPropertyBindings(),t=r.properties.first((function(t){return t.targetProperty===n.assetInstanceDefinition.assetIdInputProperty}));return t?gt(t.sourceModel,t.sourceProperty):null}function re(n){var f,i,t,r,u;return n.isComposed&&(i=n.getViewModel(),i&&(t=i.container,t&&(r=t.partTitle&&t.partTitle(),u=t.assetName&&t.assetName(),(r||u)&&(f={partTitle:r,assetName:u})))),f}function wu(n){n&&typeof n=="object"&&cu(n,(function(t,i){cf[t]?delete n[t]:typeof i=="object"&&wu(i)}))}function pr(n){return n&&n._msPortalFx_viewModelApiV2_wrapper}function bu(t){var u=hu[t],i,r;return u||
(i=ni(),u=hu[t]=i.promise(),r=yi[t],r?i.resolve(r):pi(null,t,(function(n){i.resolve(r=yi[t]=n)}),n).catch((function(n){i.reject(n)}))),u}function ue(n){var t=bu(cr);return t.then((function(){return n}))}function wr(){return bu(hr)}function br(){return yi[hr]}function fe(){return yi[cr]}function ee(n){yi[cr]=n}function oe(n){yi[hr]=n}function se(n){return{property:n,modelType:t.inferredReferenceType,scope:oi.CurrentContainer,cardinality:yt.ReferenceCardinality.OneToOne}}function kr(n){return n&&n.modelType===t.inferredReferenceType}function ku(n){return n.isDynamicBinding&&!kr(n.source)}function he(t,i){return pi(t,"./UI.Composition.Selectable2Registrar",i,n)}function du(n){return n&&n.partKind===ri.Frame}function gu(n){var t=n.getPartsContainer(),r,i;return t&&(r=t.getCompositionType(),r===ei.Blade)?t.locator.getExtensionLocator().name:(i=n.locator,i&&i.getExtensionLocator().name)}function ce(n,t){var i=n.locator,r=n.extension,u=i&&i.getExtensionLocator().name,f=r&&r.name;return u!==t?u:f!==
t?f:undefined}function le(n,t){var r={},i;return(n&&t&&(t.forEach((function(n){n.isIdentityInput&&!!n.property&&(r[n.property]=!0)})),n.forEach((function(n){n.isIdentityInput=!!r[n.property]}))),n&&t)?(i=n.slice(0),t.forEach((function(t){var r=t.valuesFrom;r&&r.length&&r[0].referenceType===5&&(n.some((function(n){return n.property===t.property}))||i.push(t))})),i):n||t||[]}var ti,lr;u.defineProperty(t,"__esModule",{value:!0});var fr=b.Locator,ii=b.LocatorType,nf=r.Extension,ci=r.TelemetryContext,dr=ci.ContextType,gr=r.ViewModels.Part,nu=i.Base,tu=nu.Diagnostics,er=tu.Telemetry,tf=i.Extension,rf=tf.SetRequirement,ki=i.Parts,ri=ki.PartKind,ae=i.ViewModels,ei=et.CompositionType,dt=ct.CompositionBinder,oi=yt.ReferenceScope,iu=yt.PropertyBindings,uf=r.Diagnostics,si=p.Action,pi=ot.compositionRequire,ni=i.Helpers.Deferred,ff=i.Base.Promises.cancelOnDispose,ru=i.Errors,uu=ru.CanceledError,di=ru.disposedCanceledError,fu=window,ef=fu.fx,or=ef.environment,eu=or.features,of=c.Asset,gi=i.isNullOrUndefined,
ui=i.startTimer,kt=tu.createLog(n),ou="fxs-part",sf={logDetailDefinitionError:function(n,t,i){kt.error(n+" "+"Part: '{0}'. Details: '{1}'.".format(t,JSON.stringify(i)))}},su=st.PartContainerSelectable_ViewModelPath,hf=[su+".isSelected",su+".isCommandSelected"],li=er,nr=p.Source.Shell,hi=7,wi=9,ai=et.EditScopeIdPropertyName,tr=dt.setupPropertyBindings,vi=fr.forExtension,gt=yt.getModelValue,ir=dt.mapInputBindingDefinitions,rr=dt.createAllInputsSetWatcherConfigExtended,sr=yt.mapSourceModelToTargetModel,cf={isActivated:!0,isSelected:!0,itemsWithChildEdits:!0,selectedValue:!0,activatedItems:!0,selectedItems:!0},hr="./UI.Composition.DynamicPartBinder",cr="./UI.Composition.BladeOpener",yi={},hu={};var lf=eu&&eu.autosettings,af=i.isFeatureEnabled("partdelayloadbyviewport"),vf=0,cu=i.forEachKey,lu=i.disposeViewModelProperties;t.EmptyViewModel=gr.composePartViewModel(i.noop);t.fxpartinputchanged="fxpartinputchanged",(function(n){n[n.OldInputsNotHandled=1]="OldInputsNotHandled";n[n.UnrecoverableError=
2]="UnrecoverableError";n[n.CustomPartWithMissingTemplate=3]="CustomPartWithMissingTemplate";n[n.PartDefinitionNotFound=4]="PartDefinitionNotFound";n[n.IncorrectPartType=5]="IncorrectPartType";n[n.ErrorLocatingPartDefinition=6]="ErrorLocatingPartDefinition";n[n.ErrorAcquiringViewModel=7]="ErrorAcquiringViewModel";n[n.ViewModelMissing=8]="ViewModelMissing";n[n.ErrorLoadingControl=9]="ErrorLoadingControl";n[n.ErrorCreatingWidget=10]="ErrorCreatingWidget";n[n.TransitionedToErrorState=11]="TransitionedToErrorState"})(ti||(ti={}));lr=(function(p){function w(n,i,r,u,e,o){var s=p.call(this,o||"Part",n,i,[],r,u)||this;return s.bindings=[],s.editScopeId=f.observable(),s.invocationThrottleDuration=25,s.allInputsSet=f.observable(!1),s.calledOnInputsSet=f.observable(!1),s.failedOnInputsSet=f.observable(!1),s.assetId=f.observable(),s.triggeringLockedBladeSpinner=f.observable(!1),s._viewStateProperties=[],s._registrationDeferred=ni(),s._disabled=!1,s._restoredFromJson=!1,s._perfData={instanceExtensionLoad:
0,referenceExtensionLoad:0,adapterViewModelLoad:0,partViewModelLoad:0,extenderViewModelLoad:0,checkPermissions:0,prepareViewModel:0,finalizePartCompose:0,allInputBindingsBoundPreprocess:0,allInputBindingsBound:0,srcExtension:"",contentRevealedCalled:!1},s._sequence=vf++,s._rebindCount=0,s._showShellCommands=!0,s._allInputPropertyBindingsBound=ni(),s._onInputsSet=Q.defer(),s._contentRevealed=Q.defer(),s._frameInitialized=Q.defer(),s._frameRevealed=Q.defer(),s._allOnInputsSet=Q.all([s._onInputsSet.promise,s._frameInitialized.promise]),s._allContentRevealed=Q.all([s._contentRevealed.promise,s._frameRevealed.promise]),s._frameBlockingUi=f.observable(!1),s._partShellApiDeferred=Q.defer(),s._updateRebindSequenceNumber(),s._vm=e||t.EmptyViewModel,s.partState={},s.containerModel=null,s.overridesModel=ur({},!1),s._registrationDeferred.catch((function(n){s._allInputPropertyBindingsBound.reject(n)})),s.registerForDispose(s._partSettingsManager=new at.PartSettingsManager),s}return __extends(w,p),w.prototype.
shouldAlertOnClose=function(){var n=this._getContainer(),i,t;return n?(i=f.utils.peekObservable(n.suppressAlert),t=f.utils.peekObservable(n.configureAlert),i)?!1:t?t.showAlert:!!this.widget&&s.gatherFormFields(this.widget.element).some((function(n){var t=n.viewmodel;return t._msPortalFxViewModelValueChangesAreClean&&t.dirty&&t.dirty()})):!1},w.prototype.getAlertMessage=function(){var t=this._getContainer(),n=f.utils.peekObservable(t.configureAlert);return n&&n.showAlert?n.message:""},w.prototype.suppressAlert=function(){var n=this._getContainer();return n?f.utils.peekObservable(n.suppressAlert):!0},w.prototype.getViewModel=function(n,i){var r=t.EmptyViewModel,u=this.adapter,f,e;if(n=n||0,n===0)r=this._vm;else if(n===4)if(f=this._contextMenuViewModels,f)r=f.getViewModel(n,i);else{var s=this._getCommands(),o=et.findCommand(s,i,""+this),h=o&&o.getViewModel();r=h||t.EmptyViewModel}else n===hi?r=u&&u.viewModel:n===wi?(e=u&&u.inputPropertyBindings,r=e&&e.targetModel):kt.error("Invalid model type '"+
n+"' for part '"+this.locator.toString()+"'.");return r},w.prototype.getViewModelAsync=function(n,t){var i=this;return this._registrationDeferred.then((function(){var r,f,u;return n===4?(r=i._contextMenuViewModels,r?r.getViewModelAsync(n,t):(f=i._getCommands(),u=et.findCommand(f,t,""+i),u&&u.getViewModelAsync())):i.getViewModel(n)}))},w.prototype.setViewModel=function(n){this._vm=n||t.EmptyViewModel},w.prototype.setBladeOpener=function(n){this.registerForDispose(this._bladeOpener=n)},w.prototype.getBladeOpener=function(){return this._bladeOpener},u.defineProperty(w.prototype,"isDisabled",{get:function(){return this._disabled},enumerable:!0,configurable:!0}),u.defineProperty(w.prototype,"canClone",{get:function(){var n=this.awaitComposed().state()!=="pending",t=this.getInputPropertyBindings().allBound,i=this.partDefinition.partKind===ri.ResourceSummary;return n&&t&&!i},enumerable:!0,configurable:!0}),u.defineProperty(w.prototype,"eligibleForBinding",{get:function(){return!this.containerModel}
,enumerable:!0,configurable:!0}),u.defineProperty(w.prototype,"templateKey",{get:function(){var n=this.locator.toString(),t=this.containerModel;return t&&(n+="-"+i.toSortedString(f.toJS(t))),n},enumerable:!0,configurable:!0}),u.defineProperty(w.prototype,"journeyPath",{get:function(){return this.getPartsContainer().journeyPath.concat(this.templateKey)},enumerable:!0,configurable:!0}),u.defineProperty(w.prototype,"dirtyAndNotSaving",{get:function(){return this.services.editScopeManager.getStateObservable(this.editScopeId())()===g.EditScopeState.Dirty},enumerable:!0,configurable:!0}),u.defineProperty(w.prototype,"instanceDefinition",{get:function(){return this._partInstanceDefinition},enumerable:!0,configurable:!0}),w.prototype.getCompositionType=function(){return ei.Part},w.prototype.getPartSettingsManager=function(){return this._partSettingsManager},w.prototype.getPerfData=function(){return this._perfData},w.prototype.getSettingsModel=function(){var n=this._settingsModel,t;if(!n&&(t=this.
getViewModel())){var u=o.isV2(t.content),e=this.partDefinition,r=e&&e.partState,s=i.unique((r?(r.inputIdentityProperties||[]).concat((r.sharedProperties||[]).map((function(n){return n.property}))):[]).concat(!u&&this._viewStateProperties||[]));this._settingsModel=n=i.clone(t);n.content={};s.forEach((function(i){if(i.startsWith("content.")){var r=u?f.observable():gt(t,i).value;yt.setModelValue(n,i,r)}}))}return n},w.prototype.dispose=function(n){p.prototype.dispose.call(this,n);this._releaseResources(n);[this._loadedMarker,this._readyMarker,this._revealedMarker,this._onInputsSetResolvedMarker].forEach((function(n){n&&li.cancelTrace(n)}))},w.prototype._setExtension=function(n){this.extension=n;this._partContainer&&this._partContainer.attr("data-extensionname",this.extension?this.extension.name:null)},w.prototype.resourceLTM=function(){return this._resourceLTM||(this._resourceLTM=this.widget.ltm.createChildLifetime())},w.prototype._releaseResources=function(n){var u,f,i,e,r,o;this._resourceLTM&&
(this._resourceLTM.dispose(),this._resourceLTM=null);this._clearLoadingReactor();u=this._inputBindings;u&&(u.unbind(),this._inputBindings=null);f=this._part;f&&(f.dispose(),this._part=null);i=this._vm;e=this.extension;e&&i&&i!==t.EmptyViewModel&&e.releaseViewModel(i);this._releaseAdapter();r=this._extenderVM;o=this._extenderVMExtn;r&&o&&(lu(r),o.releaseViewModel(r));n||this._disposeEditScope();this._journey=null;this._vm=t.EmptyViewModel},w.prototype._clearLoadingReactor=function(){var n=this._loadingReactorLifetime;n&&(n.dispose(),this._loadingReactorLifetime=null)},w.prototype._releaseAdapter=function(){var n=this.adapter,t;n&&(n.inputPropertyBindings.unbind(),lu(n.viewModel),t=n.viewModel,t&&n.extension.releaseViewModel(t),this.adapter=null)},w.prototype._getContainer=function(){return r.shellInterface(this.isDisposed()||!this._vm?{}:this._vm.container)},w.prototype.getInputPropertyBindings=function(){if(!this._inputBindings)this._inputBindings=new iu(bi(this),{},!1);return this._inputBindings}
,w.prototype.getAssetId=function(){var e=this,t=this.assetInstanceDefinition,o=t&&t.assetIdInputProperty;if(!o)return Q.reject();var i=function(n){var t=pu(e);t&&t.exists?n.resolve(f.unwrap(t.value)):n.reject()},n=Q.defer(),r=this.adapter,u=r?r.allInputsSet:this.allInputsSet;return u()?i(n):u.subscribe(this,(function(t){t&&!n.promise.isFulfilled()&&i(n)})),n.promise},w.prototype.toJSON=function(){var n=p.prototype.toJSON.call(this),t,i;return n.assetInstanceDefinition=this.assetInstanceDefinition,n.partState=r.toSerializableObject(this.partState||{}),n.initialSize=this.initialSize,n.bindingsInitialized=this._bindingsInitialized,n.savedContainerState=re(this),n.containerModel=ar(this.containerModel,this.modelContainsSensitiveData),n.overridesModel=ar(this.overridesModel,!1),n.originalPartLocator=this.previousLocator,n.flags=this.flags,t=this.adapter,i=this.bindings,n.adapterBindings=t&&t.bindings,n.bindings=t?i.filter((function(n){return n.source.scope===oi.DetailsContainer})):i,n},w.prototype.
cloneAs=function(n,t){var r=this,o=ni(),i,u=this.widget?this.widget.options:null,s=[this.awaitComposed(),this.getInputPropertyBindings().awaitAllBound],h=this.adapter;return h&&s.push(h.inputPropertyBindings.awaitAllBound),e.when.apply(e,s).done((function(){var l=r.getNonDetailsContainerPropertyBindings(),h={},c,s;l.forEach((function(n){var t=gt(n.targetModel,n.targetProperty).value;yt.setModelValue(h,n.sourceProperty,f.toJS(t))}));c=f.toJS(r.overridesModel);i=n(h,c);i.widgetState(e.extend(!0,{},r.widgetState()));u&&u.size&&(i.initialSize=u.size(),i.initialSize===99&&(i.initialWidth=u.gridWidth(),i.initialHeight=u.gridHeight()));s=r._partSettingsManager;s&&s.saveIdentityPartSettings(i.containerModel,t);o.resolveWith(r,[i])})).fail((function(){o.rejectWith(r)})),o.promise()},w.prototype.clone=function(){var n=this;return this.cloneAs((function(t,i){return vu(n.services,n.locator,null,t,i)}))},w.fromJSON=function(n,t){return et.createCompositionFromJSON(t,(function(){var i=new w(n,fr.fromJSON(t.locator),
t.widgetState,t.id);return i.loadPropertiesFromJson(t),i}),(function(i,r){var u=new w(n,i,null,t.id);return u.unrecoverableErrorMessage=r,u}))},w.prototype.getAssetInstanceMetadataAsync=function(){var n=this,t=ni();return this._registrationDeferred.then((function(){var i;n.isDisabled||n.isDisposed()?t.resolve(i):n.getAssetId().then((function(t){i={id:t,type:n.assetType}})).finally((function(){t.resolve(i)}))}),(function(){t.reject()})),t.promise()},u.defineProperty(w.prototype,"assetType",{get:function(){var n=this.assetInstanceDefinition;return n&&n.assetType},enumerable:!0,configurable:!0}),w.prototype.addWidgetToUI=function(n){var t=this.widget;n.parentElement.addChild(t);t.addChild(this._partContainer)},w.prototype.recompose=function(n){this._compose(n,ni(),!0)},w.prototype._compose=function(n,t,r,u){var f=this,h,s,b,l,v,y,c,p;r===void 0&&(r=!1);var o,w=gu(this),k=fi(this.locator),a=function(n,t){return f._completeTraceWithState(n,t)};u=u||{};h=function(n){return li.startTrace({extension:w,source:
nr,action:n,name:k})};this.calledOnInputsSet.subscribe(this,(function(n){n&&(f._onInputsSetResolvedMarker=h(si.OnInputsSetResolved))}));this._allOnInputsSet.then((function(){var t=f._readyMarker,n;t&&(a(t,f._perfData),f._readyMarker=null);n=f._onInputsSetResolvedMarker;n&&(f.fullReadyTime=a(n,f._perfData),f._onInputsSetResolvedMarker=null)}));this._allContentRevealed.spread((function(n){var t=f._revealedMarker;t&&(f._perfData.contentRevealedCalled=n,a(t,f._perfData),f._revealedMarker=null)}));this._registrationDeferred.then((function(){t.resolve()}),(function(){t.reject()}));this._clearLoadingReactor();this._resourceLTM&&this._resourceLTM.dispose();s=this.widget;s&&r?(this._partContainer=s.element.find("."+ou),o=s.options,b=o.commands.splice(0,o.commands.length),b.forEach(i.disposeDisposable),o.actionBarViewModel.update()):(this._partContainer=e("<div class='"+ou+"'><\/div>"),o=new tt.ViewModel(this.id,this.widgetState()),o.inLockedContext=n.options.locked(),o.size()===undefined&&o.size(this.initialSize),
o.size()===99&&(o.gridWidth(Math.max(1,this.initialWidth)),o.gridHeight(Math.max(1,this.initialHeight))),s=this.widget=tt.createTileWidget(e("<div/>"),o,(function(){return f._getActions()})),this.widgetState(s.saveViewSettings()),this.addWidgetToUI({parentElement:n,doNotSaveSettings:!0}));l=s.element;v=this._resourceLTM=s.ltm.createChildLifetime();n.options.locked()||o.isInBlockingLoadingState(!0);l.data(et.CompositionInstanceDataName,this);v.registerForDispose(l.setEvents([bt.default.fxregistermenu,function(n,t){f._menu=t}]));y=function(){if(f._loadedMarker=h(si.PartLoaded),f._readyMarker=h(si.PartReady),f._revealedMarker=h(si.PartRevealed),f.unrecoverableErrorMessage&&f.unrecoverableErrorMessage.length>0)return f._createErrorPart(f._partContainer[0],ti.UnrecoverableError,f.unrecoverableErrorMessage);f._locateDefinitionAndStartCompose(v,o);f._perfData.srcExtension=ce(f,w);var t=f.createChildLifetime();n.options.locked.subscribeAndRun(t,(function(n){f._toggleShellCommands(t,!n,o.commands)})
)};c=u.delayLoad;af&&(c=c||function(n){return!nt.isElementFullyInViewport(n,0,!0).fullyVisible});p=u.delayLoadPromise;p&&c&&c(l[0])?(this._loadDelayed=!0,Q(p).finally(y)):y()},w.prototype._completeTraceWithState=function(n,t){var r=this,u=function(){return r._menu&&(t=i.extend2(t,r._menu.getTelemetryInfo())),li.completeTrace(n,t)};return this._creationState?ci.usingState(u,this._creationState):u()},w.prototype._locateDefinitionAndStartCompose=function(t,i){var r=this,s=ui(),o,u=function(n,t,i){r._createErrorPart(r._partContainer[0],n,t,i)},l=wr(),e=this.services.finder.locateAsync(this.locator);return this.flags&2&&(e=e.then(null,(function(t){return h.logToExtension(n,r.locator.getExtensionLocator().name,2,"Failed to find redirected part '"+fi(r.locator)+"'.  Failling back to orginal part '"+fi(r.previousLocator)+"'. Error: "+t,{}),li.trace({source:nr,action:si.RedirectFallback,actionModifier:er.ActionModifier.Complete,name:fi(r.locator),data:{to:fi(r.previousLocator),error:t}}),r.flags&=
-3,r.locator=r.previousLocator,r.services.finder.locateAsync(r.locator)}))),e.then((function(n){return r._perfData.instanceExtensionLoad=s(),o=ui(),r._processLocatedDefinitionAsync(n)})).then((function(n){return l.then((function(){return n}))})).then((function(n){var l,e,h,s;if(!t.isDisposed())if(r._perfData.referenceExtensionLoad=o(),n){if(r._isRestoredPartLackingBinding(n))if(r.eligibleForBinding)r._bindingsInitialized=!1,r.bindings=[];else if(!n.canUseOldInputVersions){kt.warning("[Definition Change] Bindings for part '"+r+"' have been changed in the definition in an incompatible way.");l={reason:f.observable(or.isDevelopmentMode?c.PartError.titleSettingsDevMode:c.PartError.titleSettings),clickable:!1};u(ti.OldInputsNotHandled,"Bindings for part have been changed in the definition in an incompatible way. Locator: "+r.locator+".",l);return}if(e=r.adapter,r._restoredFromJson&&r._bindingsInitialized!==!1){var a=e?e.bindings:r.bindings,v=e?e.inputDefinitions:n.inputDefinitions,y=br(),p=y.inferInitialBindingsForInputDefinitions(
r,v),w=p.filter((function(n){return a.every((function(t){return t.targetProperty!==n.targetProperty}))}));[].push.apply(a,w)}else e?e.bindings=r._constructAdaptedBindings():r._setBindings(n),r.assetInstanceDefinition={assetType:n.assetType,assetIdInputProperty:n.assetIdInputProperty},e&&((e.assetType||e.adaptedPart.assetType)&&(r.assetInstanceDefinition.assetType=e.assetType||e.adaptedPart.assetType),e.assetIdInputProperty&&(r.assetInstanceDefinition.assetIdInputProperty=e.assetIdInputProperty)),h=r._partInstanceDefinition,s=h&&h.reference,s&&s.assetType&&(r.assetInstanceDefinition.assetType=s.assetType),r._bindingsInitialized=!0,r.save();if(r.partDefinition=n,bf(r))u(ti.CustomPartWithMissingTemplate,c.UiCompositionPart.missingTemplateMessage);else return r._composeCommandsAndPart(i,r._partContainer)}else u(ti.PartDefinitionNotFound,"Unable to find the definition for the part. Locator: "+r.locator+".")})).then(null,(function(n){t.isDisposed()||u(ti.ErrorLocatingPartDefinition,n)}))},w.prototype.
getInstanceBindings=function(){var n=this._partInstanceDefinition;return n?n.inline?n.inline.bindings:n.reference.bindings:undefined},w.prototype._setBindings=function(n){var r=this.getInstanceBindings(),t=le(r,n.bindings),i;te(this,t)&&(this.bindings=this.bindings.concat(ir(t,this)));this.bindings.length<=0&&this.locator.type===ii.PartType&&(i=br(),this.bindings=i.inferInitialBindingsForInputDefinitions(this,n.inputDefinitions))},w.prototype._constructAdaptedBindings=function(){var n=this.adapter,t;return n.bindings.length<=0&&this.locator.type===ii.PartType?(t=br(),t.inferInitialBindingsForInputDefinitions(this,n.inputDefinitions)):ir(n.adaptedPart.bindings,this)},w.prototype._isRestoredPartLackingBinding=function(n){if(this._restoredFromJson){var t=this.adapter,i=t?this._constructAdaptedBindings():ir(n.bindings||[],this),r=t?t.bindings:this.bindings,u=function(n){return!n.optional&&r.firstIndex((function(t){return t.targetProperty===n.targetProperty}))<0};return!!i.some(u)}return!1},w.
prototype._getActions=function(){var t=this.services,n=[];return n.push(new ut.OpenContextMenu(this,t,c.ContextMenu.ariaLabel).createAction(this)),this.getCompositionType()===ei.StartboardPart&&n.push(new ut.UnpinFromStartboard(this,t).createAction(this)),n},w.prototype.resetLayout=function(){var n=this.initialSize,r=vt.AllSizes[n>=0?n:vt.getDefaultSize().name],t=r.size,i=this.widget;i.element.trigger(bt.default.fxsizechange,[i.options.id,t.width,t.height])},w.prototype.clearIdentitySettings=function(){var n=this._partSettingsManager;n&&n.clearIdentityPartSettings()},w.prototype._processLocatedDefinitionAsync=function(n){var u=this,f=this.services.finder,r=n,t,i;switch(this.locator.type){case ii.PartInstance:case ii.StartboardPartInstance:this._partInstanceDefinition=n;break;case ii.PartType:t=n;t&&t.reference&&(this._partInstanceDefinition={reference:{partTypeName:t.name,bindings:t.bindings,assetType:t.assetType,initialSize:t.initialSize}})}if(i=this._partInstanceDefinition,i){if(i.reference)
{var e=i.reference.extension||this.locator.getExtensionLocator().name,o=vi(e,this.locator.getExtensionLocator().cloudName),s=this._locatorContainingDef=o.withPartType(i.reference.partTypeName);return f.locateAsync(o).then((function(n){return u._setExtension(n),f.locateAsync(s)})).then((function(n){return n&&n.reference?u._processAdapterAsync(n,e,u.locator.getExtensionLocator().cloudName):n}))}r=i.inline}return this.initialSize===99&&(this.initialWidth=r.initialWidth,this.initialHeight=r.initialHeight),this._setExtension(f.locate(this.locator.getExtensionLocator())),ni().resolve(r).promise()},w.prototype._processAdapterAsync=function(n,t,i){var r=this,u=vi(n.reference.extension||t,i),o=u.withPartType(n.reference.partTypeName),e=this.services.finder;return e.locateAsync(u).then((function(t){var u=r+" (AdapterPart. Extension: "+r.extension.name+", ViewModel: "+n.viewModel+")",i;return r.adapter={extension:r.extension,viewModel:null,viewModelName:n.viewModel,viewModelId:u,bindings:r._adapterBindings||
[],inputDefinitions:n.inputDefinitions,adaptedPart:r._partInstanceDefinition.reference,allInputsSet:f.observable(!1),calledOnInputsSet:f.observable(!1),failedOnInputsSet:f.observable(!1),inputPropertyBindings:new iu(u,{},!1),assetType:n.assetType,assetIdInputProperty:n.assetIdInputProperty},r._partInstanceDefinition={name:r._partInstanceDefinition.name,reference:n.reference},i=r.adapter.adaptedPart.assetType,i&&(r._partInstanceDefinition.reference.assetType=i),r._setExtension(t),e.locateAsync(o)})).then((function(i){var u=ni();return i&&i.reference?(kt.error("Error processing the part defintion for part '{0}'. Adapted part definition '{0}:{1}' cannot reference another adapted part definition '{2}:{3}'.".format(r,r.adapter.extension.name,n.reference.partTypeName,i.reference.extension||t,i.reference.partTypeName)),u.reject()):(r._setBindings(i),u.resolve(i)),u.promise()}))},w.prototype.getTitle=function(){var t=this.getViewModel(),n;return t&&(n=t.container,n)?n.partTitle&&n.partTitle()||"":
""},w.prototype._composeCommands=function(n){var t=this,i=rt.getCommandGroupForDefinitionItem(this.services.finder,this.extension.name,this.partDefinition,this.extension.cloudName),r=[],u={viewModelName:this+"-[ContainerModel]",viewModel:this.containerModel};i&&(i.commands.forEach((function(n){t._canPopulateCommand(n)&&r.push(new rt.ExtensionCommandMenuItemImpl(t,t.extension,t,n,t.partDefinition,t.services,u))})),n.splice.apply(n,[0,0].concat(r)))},w.prototype._canPopulateCommand=function(n){var t=this.parent&&this.getPartsContainer();return t?n.details&&t.flags&1?(kt.error("Part '"+this+"' cannot have the open blade command '"+(n.name||n.text)+"', because it is inside the context blade."),!1):!0:!0},w.prototype.disableForAssetDeleted=function(n,t){var u,e,r,f,o;this._disabled=!0;u=this._vm;u&&u.container&&(e=this._getNotFoundMessage(),e(of.deletedTitle));r=this.widget;r&&r.options&&(f=r.options.commands,o=f.splice(0,f.length,new ut.UnpinFromStartboard(this,this.services)),o.forEach(i.disposeDisposable));
this.save();kt.warning("Part '{0}' disabled because asset was deleted. {1}".format(this,t))},w.prototype._composeCommandsAndPart=function(n,t){try{this._composeCommands(n.commands);this._composePart(t,n);this._attachEventHandlers(t)}catch(i){return e.Deferred().reject(i).promise()}},w.prototype._attachEventHandlers=function(n){var t=this,i=function(n,i){t.widgetState(i);t.save();n.stopPropagation()},r=function(i,r){var f=t.widget.options,u=!!ki.InternalPartSize[r];r=u?r:t.widget.options.size();yr(t._vm,n,f,r,u)},u=function(n,i){t._handleRightClick(n,i)},f=function(n,i){i.masterPartId=t.id},e=function(n,i){n.stopPropagation();var r=t.locator.getExtensionLocator();t.services.desktop.pinMultipleParts(i.partReferences,r.name,r.cloudName)};this.resourceLTM().registerForDispose(this.widget.element.setEvents([it.Widget.viewSettingsChanged,i],[bt.default.fxsizechanged,r],[bt.default.fxrightclick,u],[bt.default.fxensurebladevisible,f],[l.fxpinmultipleparts,e]))},w.prototype._toggleShellCommands=
function(n,t,i){lt.composeShellCommands(n,this,i,this._showShellCommands=t,this.services)},w.prototype._getPartContext=function(){var n,t=this.getPartsContainer(),r=!1,u=!1,i;return t&&(i=t.getCompositionType(),i===ei.Blade&&(n=t,r=!0),u=i===ei.Startboard),n=n||{},{id:fi(this.locator),instanceId:this.instanceId,bladeId:fi(n.locator),bladeInstanceId:n.instanceId,onBlade:r,onStartBoard:u,bladeCustomized:!1,loadDelayed:!!this._loadDelayed}},w.prototype._updateRebindSequenceNumber=function(){this.instanceId="Part_"+or.sessionId+"_"+this._sequence+"_"+this._rebindCount++},w.prototype._getPartViewModelAsync=function(n,t,u,e,s,h,c){var l=this,a,v=st.needContainerSelectable(this.partDefinition.details),y=ht.needInternalProperty(this.extension.name,this.partDefinition.details),p=ui(),w=ci.provideContext((function(){l._creationState=ci.getState();var i=l.parent&&l.getPartsContainer(),o=i?i.getCompositionType():ei.Unknown,c=i?o===ei.Startboard?1:2:0,r=i&&i.bladeDefinition,p=r&&r.templateBlade?1:0,
e;return r&&(e=(i.flags&1?1:0)|(r&&r.locked?2:0)),(a=pf(l,i,l._journey))&&(e|=4),l.extension.getPartViewModel(n,{initialState:f.toJS(l.partState),createSelectable:v,createHubsInternalCloudNameProperty:y,partSize:t,partLocation:c,collapsed:u,onInputsSetParameters:s,onViewModelAcquired:h&&function(n){pr(n&&n.content)||h(n)},locator:l.locator,containerType:p,flags:e})}),dr.Part,this._getPartContext());return w.then((function(n){var t=n&&n.content,i=pr(t)&&t.chrome._msPortalFxV2ShellApi&&t.chrome._msPortalFxV2ShellApi();return l._partShellApiDeferred.resolve(i),n}),(function(n){l._partShellApiDeferred.reject(n)})).then((function(n){var s,u,v=n&&n.content,f,y,p,e,t;return pr(v)?(u=i.cloneAndRebindFunctions(n),u.content=o.markAsV2(v.chrome),f=ni(),v.viewModel.fxAwaitAndRun(l).catch((function(n){return f.reject(n)})).then((function(n){return f.resolve(n)})),s=f.then((function(t){var r=i.cloneAndRebindFunctions(n);return r.content=t,h&&h(r),r})),l._setupLoadingReactor(c,n.container.operations)):s=u=n,y=function(
){return l.services.getService("PortalFormTarget")},l.partDefinition.shareVmWithParentBlade&&(p=l.parent,e=p.parent,e.setViewModelForTemplateOrMenuBlade(u),e.setInputsSetPromise(l._allOnInputsSet),y=function(){return Q(e.widget)}),t=n&&r.shellInterface(n.container),t&&(t.closeBlade(yf(l)),t.menu(a),t.openDialog((function(t,i){return l.services.getService("DialogManager").then((function(r){n.internal.dialog(t);var u=i?function(){return l.services.getService("PortalFormTarget")}:y;return u().then((function(n){var u=l.widget.element[0];return typeof i=="string"?u=l.widget.element.find(i)[0]:typeof i=="object"&&(u=wt.unwrapFxElement(i)),r.showShellDialog(t,n,u,l.locator,!1).then((function(n){t.onClosed&&t.onClosed({button:n})})),!0}))}))}))),s})).then((function(n){var r=l.services.finder,t=r.locate(l.locator),u=ui(),i=n&&n.content;return s&&dt.notifyOnInputsSetCalled(e,s,n&&n.onInputsSetPromise),t&&t.reference&&t.reference.extenderViewModel?(l._extenderVMExtn=r.locate(l.locator.getExtensionLocator(),
l.extension.name),l._extenderVMExtn.getViewModel(t.reference.extenderViewModel).then((function(r){return r&&r.content?i&&f.isObservable(i.extenderViewModel)?(l._extenderVM=r,i.extenderViewModel(r.content)):kt.error("Part '"+l+"' defines extender view model '"+t.reference.extenderViewModel+"' but the referenced part is not marked as extensible."):kt.error("Extender view model '"+t.reference.extenderViewModel+"' for part '"+l+"' must be an object."),n})).finally((function(){l._perfData.extenderViewModelLoad=u()}))):n})).finally((function(){l._perfData.partViewModelLoad=p()}))},w.prototype._getAdapterViewModelAsync=function(){var n=this;if(!this.adapter)return ni().resolve(null).promise();yu(this);var t=rr(this._getAdapterAllInputsSetWatcherConfig()),r=dt.loadOnInputsSetParameters(t),i=this.adapter;return r.then((function(r){n._earlyAdapterOnInputsSet=!!r;n._perfData.earlyOnInputsSetAdapter=n._earlyAdapterOnInputsSet;var u=ui();return i.extension.getViewModel(i.viewModelName,{onInputsSetParameters:
r}).then((function(n){return i.viewModel=n,r&&dt.notifyOnInputsSetCalled(t,r,n&&n.onInputsSetPromise),t})).finally((function(){n._perfData.adapterViewModelLoad=u()}))}))},w.prototype._bindAssetNameFromAdapter=function(){var r=this,t=this.adapter,n,i;t&&(n=gt(t.viewModel,"content.assetName"),n.exists)&&(f.isObservable(n.value)?(i=n.value,f.computed(this,(function(){var t=i(),n=r._vm;!gi(t)&&n&&n.container&&yt.setModelValue(n,"container.assetName",t)}))):kt.error("Failed to bind the asset name from the adapter view model for Part '{0}', because the asset name needs to be an observable.".format(t.viewModelId)))},w.prototype._composePart=function(n,t){var r=this,a;if(!this.isDisposed()){var v=this.locator,h=this.partDefinition,b=h.partKind,f=k.getPartFactory(this.extension.name,h,this.extension.definition.htmlTemplates),u,s,y;if(f){h.resizeMode!==1?t.supportedSizes(f.supportedSizes):t.supportedSizes([]);this._inputBindings=null;this.getInputPropertyBindings();var p=this._getAdapterViewModelAsync(
),l=this.services.finder.locate(v),d=l&&l.reference&&l.reference.extenderViewModel,w=this.bindings||[],g=w.some((function(n){return n.source&&n.source.scope===oi.DetailsContainer})),nt=this.adapter&&w.some((function(n){return n.source&&n.source.modelType===hi}));d||g||!this.extension.canUseInputsSetParameters(v)?s=ni().resolve(null).promise():(a=function(){return r.isDisposed()?ni().resolve(null).promise():(r._registerInputPropertyBindings(),u=rr(r._getAllInputsSetWatcherConfig()),dt.loadOnInputsSetParameters(u))},s=nt?p.then(a):a());s=ue(s);this._vmPromise=s.then((function(s){if(r.isDisposed()){r._releaseResources();return}r._earlyOnInputsSet=!!s;r._perfData.earlyOnInputsSetPart=r._earlyOnInputsSet;var h=r.partDefinition,y=h.partKind===ri.ResourceSummary?r._getSummaryPartViewModelState():null,v=r.widget,l=v&&v.options,a=l?l.size():r.initialSize,w=r._getPartViewModelAsync(h.viewModel,a,y,u,s,u&&function(n){return r._setupInvocationProperties(f.viewStateProperties,n)},t);return e.when(w,p).fail(
(function(t){r.isDisposed()||i.Errors.isInstanceOfErrorType(t,i.Errors.CanceledError)||r._createErrorPart(n[0],ti.ErrorAcquiringViewModel,t)})).done((function(i,e){var s=ui();if(r.setViewModel(i),r.isDisposed())r._releaseResources();else if(i){if(!r.isDisabled){r._bindAssetNameFromAdapter();r.resourceLTM().registerForDispose(r.widget.element.setEvents([bt.default.fxportalcontrolloadfailed,function(n,t){r._createErrorPart(r._partContainer[0],ti.ErrorLoadingControl,t)}]));h.partKind===ri.ResourceSummary&&r._autoOpenSettingsFromSummary();var v=l?l.size():r.initialSize,y=v!==a,p=h.partKind===ri.Provisioning;yr(r._vm,n,t,v,y);o.isV2(i.content)||r._setupLoadingReactor(t,i.container.operations);t.userResizable(r.getCompositionType()===ei.StartboardPart&&h.resizeMode===2);y?r.extension.processMessages().finally((function(){r.isDisposed()||r._setupPartWidget(n,f,u,e,a,p,s)})):r._setupPartWidget(n,f,u,e,a,p,s)}}else r._createErrorPart(n[0],ti.ViewModelMissing,c.UiCompositionPart.viewModelRequired)}))})
)}else y="Incorrect part type '{0}'.".format(b),this._createErrorPart(n[0],ti.IncorrectPartType,y)}},w.prototype._setupPartWidget=function(n,t,u,e,o,s,h){var c=this,l=this.widget,y=this.getViewModel(),a;this._perfData.prepareViewModel=h();a=ui();v.setSelectableContext(this,this._vm,this._partContainer);i.tryImmediateResolve(this._createPartWidget(t,y,s),(function(){var o,s,i;if(c.isDisposed())return Q.reject(di);if(o=c.partDefinition,o.shareVmWithParentBlade||f.reactor(c,(function(){var n=c._getNotFoundMessage()();c._part.notFoundMessage(n)})),yr(c._vm,n,l.options,l.options.size(),!1),c.register(t.viewStateProperties,u,e),ie(c),c._ensureAssetAffinity(),c._perfData.finalizePartCompose=a(),o.resizeMode===1){if(s=c.extension&&c.extension.name,s!=="AppInsightsExtension"&&s!=="SamplesExtension")return;i=r.shellInterface(c._vm.container);i.autoSize.subscribe(c,(function(n){if(n){i.autoSize(!1);var r=c.widget,t=r.element,u=t.find(".fxs-part-content"),f=u.find("> div");if(f.length!==1)return;var e=
f[0],o=u[0],s=t.outerWidth()+Math.floor(e.clientWidth-o.clientWidth),h=t.outerHeight()+Math.floor(e.clientHeight-o.clientHeight);t.trigger(bt.default.fxsizechange,[r.options.id,s,h])}}));i.resize.subscribe(c,(function(n){if(n&&n.width&&n.height){var t=vt.getGridPixelSize(n.width,n.height);c.widget.element.trigger(bt.default.fxsizechange,[l.options.id,t.width,t.height])}}))}}),(function(t){c._createErrorPart(n[0],ti.ErrorCreatingWidget,t)}))},w.prototype.register=function(t,i,r){var u=this,e=this.parent&&this.getPartsContainer(),o,s,f;this._removeOutputArgumentValuesFromContainerModel();(this.bindings||[]).forEach((function(n){var t=n.source.modelType;u._hasRebindableInputs||n.source.scope!==oi.CurrentContainer||t!==1&&t!==hi&&t!==wi||(u._hasRebindableInputs=!0)}));this._listenForPartMutation();this.adapter&&!r&&yu(this);i||(this._registerInputPropertyBindings(),this._setupInvocationProperties(t,this._vm));this._partSettingsManager.configureInstanceProperties(this._viewStateProperties);this._partSettingsManager.
initialize();pi(this,"./UI.Composition.SelectableRegistration",(function(n){n.listenForRegistrationChanges(u,u._vm,u)}),n);he(this,(function(n){n.autoRegisterSelectables(u,u._vm,u)}));o=this.getInputPropertyBindings();this._setupBladeRebindingHandlers(e);s=ui();this.save();i||(i=rr(this._getAllInputsSetWatcherConfig()));i.bindableTarget.viewModel=this._vm;this._setContainerInputsChanging=function(n,t){n?dt.turnOnInputsSetSuppressionOn(i):t?dt.turnOnInputsSetSuppressionOff(i,t):dt.turnOnInputsSetSuppressionOff(i)};dt.setupAllInputsSetWatcherFromExtendedConfig(i);this.adapter&&(r||(r=rr(this._getAdapterAllInputsSetWatcherConfig())),r.bindableTarget.viewModel=this.adapter.viewModel,dt.setupAllInputsSetWatcherFromExtendedConfig(r));wr().then((function(n){n.listenForConfigurationChanges(u,r,i)}));f=function(){u._finishCompose(e,o,s)};this.partDefinition.shareVmWithParentBlade?setTimeout(f):this.extension.processMessages().finally(f)},w.prototype._finishCompose=function(n,t,i){var r=this,u,o,f;this.
isDisabled||this.isDisposed()||(n&&n.notifyPartComposed(this),this._registrationDeferred.resolve(),u=[t.awaitAllBound],this.adapter&&u.push(this.adapter.inputPropertyBindings.awaitAllBound),o=i(),f=this._allInputPropertyBindingsBound,e.when.apply(e,u).done((function(){var n=r._perfData;f.resolve();n.allInputBindingsBoundPreprocess=o;n.allInputBindingsBound=i();r._loadedMarker&&(r.compositionTime=r._completeTraceWithState(r._loadedMarker,n),li.trace({source:nr,action:si.PartLoadedNoExtensionDerived,actionModifier:er.ActionModifier.Complete,name:fi(r.locator),duration:r.compositionTime-n.referenceExtensionLoad-n.instanceExtensionLoad,data:n}),r._loadedMarker=null)})).fail((function(){f.reject()})),this.save())},w.prototype._registerInputPropertyBindings=function(){var n=this,i=[],r=[],u=[],t;this._journey=this.services.desktop.getActiveJourney();(this.bindings||[]).forEach((function(n){n.source.scope===oi.DetailsContainer?u.push(n):r.push(n);!n.isIdentityInput||i.push(n.targetProperty)}));this.
_partSettingsManager.configure(this._getPartSettingsManagerConfig(i,this._viewStateProperties));t=this.getInputPropertyBindings();tr(this,t,u);tr(this,t,r,(function(t){return n.adapter?n.adapter?n.bindAdaptedInput(t):void 0:n.bindAgainstOverridesOrContainerModel(t)}));this._setEditScope();this._setupJourneyEditScopeReactor()},w.prototype.bindAdaptedInput=function(n){var t=n.source,i=t&&t.modelType;switch(i){case hi:return{sourceModel:this.adapter.viewModel,sourceModelName:this+"-[Adapter]"};case wi:return{sourceModel:this.adapter.inputPropertyBindings.targetModel,sourceModelName:this+"-[AdapterInputs]"}}},w.prototype.getNonDetailsContainerPropertyBindings=function(n){n===void 0&&(n=!0);var t=this.adapter,i=n&&t?t.inputPropertyBindings:this.getInputPropertyBindings();return i.properties.filter((function(n){var t=n.compositionBindingDefinition,i=t&&t.source&&t.source.scope;return i!==oi.DetailsContainer}))},w.prototype.bindAgainstOverridesOrContainerModel=function(n){var t,r,i,u;if(n.source.
id!==this.id){if(ku(n))return null;if(t=n.source.property,r=this.overridesModel,gt(r,t).exists)return{overridesConstantBindings:!0,sourceModelName:this+"-[OverridesModel]",sourceModel:r};if(i=this.containerModel,i&&gt(i,t).exists)return{sourceModelName:this+"-[ContainerModel]",sourceModel:i};if(kr(n.source))return u={},yt.setModelValue(u,t,undefined),{sourceModelName:this+"-[Inferred]",sourceModel:u}}},w.prototype._setupInvocationProperties=function(n,t){var i=this,r=this.partDefinition,u;(this._vm=t,!this._vm||this.isDisposed()||this.isDisabled)||(this._setViewStateProperties(r.viewStateProperties,n),u=fe(),this.setBladeOpener(u.create(this._getBladeOpenerConfig())),gf(this,this.partDefinition,this._restoredFromJson)&&r.details&&r.details.length&&(r.details.forEach((function(n){ne(i,n)&&i._registerInvocationProperty(n)})),this.resourceLTM().registerForDispose(this.widget.element.setEvents([bt.default.fxopeninnewtab,function(n,t){var r=t.selectable,u=st.getAssociatedDetailDefinition(r||t.
selectableSet,i.getViewModel(),i.partDefinition),f,e;u&&(f=r?r.selectedValue():lt.createSelection(t.selectableSet,t.item),e=Q(f).then((function(n){var t=i._bladeOpener.createBladeModelForSelectedItem(u,n),r=t&&t.locator;return r?a.getBladeDeepLink(r.getExtensionLocator(),r.name,fu.location.href,t.model):null})),i.services.openWindow(e))}]))))},w.prototype.selectOnReady=function(n,t){var i=this;return Q.all([this.awaitComposed(),this._allInputPropertyBindingsBound.promise()]).then((function(){return i._part.selectOnReady(n||function(){return!0},t)}))},w.prototype.getSelectableAsync=function(n){return this.getViewModelAsync().then((function(t){var r=typeof n=="string"?n:st.getSelectablePath(n),i=gt(t,r);return i.exists?f.unwrap(i.value):null}))},w.prototype._getBladeOpenerConfig=function(){var n=this;return{services:this.services,masterModelId:bi(this),masterModel:this.getViewModel(),referenceComposition:this,referenceExtension:this.extension,invocationThrottleDuration:this.invocationThrottleDuration,
isBladeOpenedByMaster:function(t){return au(n,t)},onBladeOpened:function(n){Q(n.awaitComposed()).then((function(){return Q.allSettled(n.children.map((function(n){return n.awaitChildrenOnInputsSetsResolved()})))}))},addOutputBindings:function(t,i){kf(n,t,i)},removeOutputBindings:function(t){df(n,t)},configureBladeDescriptor:function(t){t.masterPartId=n.id;t.bindings&&t.bindings.forEach((function(i){i.source&&i.source.id===n.id&&(t.model[i.targetProperty]=f.toJS(gt(n._vm,i.source.property).value))}))},initialViewModelState:f.toJS(this.partState)}},w.prototype.loadState=function(n){var i=this;this.partDefinition&&n&&this._vm&&this._vm!==t.EmptyViewModel&&this._viewStateProperties.forEach((function(t){var r=gt(n,t);r.exists&&!t.startsWith("internal.")&&yt.setModelValue(i._vm,t,r.value)}))},w.prototype._setupLoadingReactor=function(n,t){var u=this,i,r;this.partDefinition.partKind!==ri.Provisioning&&(this._frameBlockingUi(du(this.partDefinition)),this._loadingReactorLifetime=this.createChildLifetime(
),f.reactor(this._loadingReactorLifetime,(function(){var i=t.inProgress();n.hasOngoingOperation(i&&!n.locked());u.triggeringLockedBladeSpinner(i&&n.locked())})),i=this.getBindableContainer(),r=f.computed(this._loadingReactorLifetime,(function(){return t.blockingUi()||u._frameBlockingUi()})),i&&i.bladeDefinition&&i.bladeDefinition.templateBlade&&(f.reactor(this._loadingReactorLifetime,(function(){i.shieldType&&i.shieldType(t.shieldType())})),f.reactor(this._loadingReactorLifetime,(function(){i.isUiBlocked&&i.isUiBlocked(r())}))),r.subscribe(this._loadingReactorLifetime,(function(i){var f=t.shieldType()===1||n.locked(),r;n.isInBlockingLoadingState(i&&!f);i||(r=n.hasOngoingOperation(),u._contentRevealed.resolve(r))})),r()||(this._contentRevealed.resolve(t.inProgress()),n.isInBlockingLoadingState(!1)))},w.prototype._removeOutputArgumentValuesFromContainerModel=function(){var n=this.partDefinition,t=this.containerModel;t&&n&&n.details&&n.details.forEach((function(n){n.outputArguments&&n.outputArguments.
forEach((function(n){n.valuesFrom&&n.valuesFrom.forEach((function(n){gt(t,n.property).exists&&yt.setModelValue(t,n.property,undefined)}))}))}))},w.prototype._getPartSettingsManagerConfig=function(n,t){return{services:this.services,part:this,instanceProperties:t,partViewModelId:bi(this),partStateDefinition:this.partDefinition&&this.partDefinition.partState,identityInputs:n}},w.prototype._listenForPartMutation=function(){var n=this,r=this.partDefinition,t,u=this._vm.container,i;u.mutate&&!r.shareVmWithParentBlade&&(i=this.createChildLifetime(),u.mutate.subscribe(i,(function(u){var f=n.locator.getExtensionLocator(),e;if(u.partName)t=u.extensionName?vi(u.extensionName,f.cloudName).withPartType(u.partName):f.withPartType(u.partName);else{if(e=r.assetTypeDefinition,!e){kt.error("Mutate function on part {0} was called with an object but the mutating part doesn't have an asset type definition.".format(n.locator.toString()));return}t=vi(f.name,f.cloudName).withPartType(e.partName)}var o=n.getPartsContainer(
),s=o&&o.locator&&o.locator.type===ii.Blade,h={newPartContainerModel:u.containerModel,preventNewPartActivation:u.preventActivation||s,invoker:"mutation"};n.services.desktop.replacePart(n,t,h).fail((function(i){var r="Unable to replace provisioning part '"+n.locator.toString()+"' with the part for the created asset defined by the locator '"+t.toString()+"'\r\n"+i+".";kt.error(r)})).finally((function(){n._disposeEditScope();i.dispose()}))})))},w.prototype._updateForHasPermissions=function(n){var i=this;return this._vmPromise.then((function(){var r=i._vm,u,f;r===t.EmptyViewModel||i.isDisposed()?kt.warning("Part '{0}' has not retrieved view model when checking permissions.".format(i.locator.toString())):(u=r.container,f=i.widget,n?u.unauthorizedMessage(null):(f&&f.options.isInBlockingLoadingState(!1),u.unauthorized(),r.updatePartForUnauthorized()))}))},w.prototype._getAllInputsSetWatcherConfig=function(){var t=this,i=this.widget,f={bindableTarget:{viewModelName:bi(this)},propertyBindings:this.getInputPropertyBindings(
),allInputsSet:this.allInputsSet,calledOnInputsSet:this.calledOnInputsSet,failedOnInputsSet:this.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0,inputsSetCalled:function(n,r){r.finally((function(){t._onInputsSet.resolve();t._contentRevealed.resolve(!1);t._lastRebindOnInputsSetProperties&&(e.isEmptyObject(t._lastRebindOnInputsSetProperties)||et.deepSubset(n,t._lastRebindOnInputsSetProperties))&&i&&i.options.isInBlockingLoadingState(!1)}))},beforeViewModelPropertyUpdate:function(i){if(t.partDefinition.permissions){var u=ni(),f=ui(),e=t.locator.toString();return pt.checkPermissions(t.partDefinition.permissions,rf.All,i,t.partDefinition.assetType,t.extension.name,t.services,t.extension.cloudName,e).then((function(i){t._updateForHasPermissions(i).catch((function(i){h.logToExtension(n,t.widget.element,2,"Part permission check failed. Error: "+r.Diagnostics.getLogFriendlyMessage(i),{})}));u.resolve(i)})).catch((function(n){u.reject(n)})).finally((function(){t._perfData.
checkPermissions=f()})),u.promise()}return ni().resolve(!0).promise()},getInputsMetadata:function(){return wr().then((function(n){var i=n.getConfigurableInputsMetadata(t);return u.keys(i).forEach((function(n){var t=i[n];(t&&t.bindingSources||[]).forEach((function(n){delete n.sourceReference}))})),i}))},getDashboardFilters:function(){var n=t.parent&&t.getPartsContainer();return n&&n.getFilters?n.getFilters():{}}};return this.partDefinition&&this.partDefinition.partState&&this._partSettingsManager&&(f.getStateAsync=function(){var n=Q.defer();return t._partSettingsManager.getPartSettingsAsync().then((function(i){t._part&&t._part.partSettingFailed(!1);n.resolve(i)}),(function(i){var r=new Error("Failed to retrieve part settings for part '"+t+"'.");r.innerError=i;kt.error(r);t._part&&t._part.partSettingFailed(!0);n.reject(r)})),n.promise}),f},w.prototype._getAdapterAllInputsSetWatcherConfig=function(){var n=this.adapter;return{bindableTarget:{viewModelName:n.viewModelId},propertyBindings:n.inputPropertyBindings,
allInputsSet:n.allInputsSet,calledOnInputsSet:n.calledOnInputsSet,failedOnInputsSet:n.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0}},w.prototype.notifyDetailBladesRehydrated=function(n){!this.isComposed||this.isDisabled||this.isDisposed()||this._bladeOpener.notifyDetailBladesOpened(n)},w.prototype.notifyDetailBladeClosed=function(n){var t=this;this.awaitComposed().done((function(){var r=n.masterCommandName,u=t._vm.container,i;t.isDisabled||t.isDisposed()||!gi(r)||t._bladeOpener.notifyDetailBladeClosed(n);i=u&&u.selectable;i&&!gi(r)&&i.isCommandSelected(!1)}))},w.prototype.beforeActivateCommandMenuItems=function(n){n.isControlContextMenu||this._contextMenuViewModels&&(this._contextMenuViewModels.dispose(),this._contextMenuViewModels=null)},w.prototype._handleRightClick=function(t,r){var u=this,e=r&&r.listData&&r.listData.selectableSet,o,s;this.isDisabled||this.isDisposed()||(e instanceof y.SelectableSet2&&e.commandGroupProvider?(o=f.utils.peekObservable(
r.viewModel.data),e.commandGroupProvider(o).then((function(n){var f=i.clone(r,!1,!1);f.viewModel=o;f.commandGroupOwner=n[0].owner;f.commandGroup=n[0].id;u._determineExtensionAndTriggerContextMenu(t,f)}))):(s=y.isSelectableSet2(e)?undefined:e,r.supplyCommands||s&&s._msPortalFxSupplyCommands?pi(this,"./UI.Composition.ContextMenuV2",(function(n){var i={partComposition:u,services:u.services},f=n.OpenContextMenuPipeline.createPipeline(u,i,u);f.startTask({dataItem:r.viewModel,extension:u.extension,contextMenuArgs:r,evt:t})}),n):this._determineExtensionAndTriggerContextMenu(t,r)))},w.prototype._determineExtensionAndTriggerContextMenu=function(t,i){var r=this,e=this.services,u=this.extension,o=u.cloudName,s,f;u.extension.name===nu.Constants.ExtensionNames.Hubs&&(o=i.viewModel.browse_cloudName);s=function(n){var t=Q(e.finder.locateAsync(vi(n.commandGroupOwner,o)));return t.fail((function(){kt.error("Could not find extension '{0}' for commandGroup {1} from part in extension {2}.".format(n.commandGroupOwner,
n.commandGroup,u.name))})),t};f=function(n,u){r._contextMenuViewModels=n.fireContextMenuEvent(r,e,r,u,t,i,r._showShellCommands,r._bladeOpener)};pi(this,"./UI.Composition.ContextMenuContainer.DemandLoad",(function(n){i.commandGroupOwner&&i.commandGroupOwner!==u.name?s(i).then((function(t){f(n,t)})):f(n,u)}),n)},w.prototype.isSelected=function(){var t=f.unwrap(this._vm.container).selectable,n=f.unwrap(t);return n&&f.unwrap(n.isSelected)},w.prototype.awaitComposed=function(){return this._registrationDeferred.promise()},w.prototype.awaitOnInputsSetComplete=function(){return this._allOnInputsSet},w.prototype.awaitContentRevealed=function(){return this._allContentRevealed.spread((function(n){return n}))},w.prototype._createErrorPart=function(n,t,i,r){var e,s,u;if(this.isDisposed())return Q.reject(di);var o=this.locator,a=k.getPartFactory(nf.getWindowId(o.getExtensionLocator()),{partKind:ri.Error}),h=this.extension,c=gr.composePartViewModel((function(){return r=r||{},r.title=f.observable(o&&o.name),r.
subtitle=f.observable(h&&h.name),r})),l=uf.getLogFriendlyMessage(i);return this._traceErrorTelemetry(t,l),kt.error("Error composing part '"+this+"'. Details: "+l,1),e=this._savedContainerState,s=c.container,e&&(s.partTitle(e.partTitle),s.assetName(e.assetName)),this._registrationDeferred.reject(i),u=this.getBindableContainer(),u&&u.bladeDefinition&&u.bladeDefinition.templateBlade&&u.widget.options.loaded(!0),this._createPartWidget(a,c,!0)},w.prototype._createPartWidget=function(n,t,u){var e=this;if(this.isDisposed())return Q.reject(di);var o=this.getBindableContainer(),s=!!(o&&o.bladeDefinition&&o.bladeDefinition.templateBlade),h={size:this.widget.options.size,locator:this.locator,getDebugId:function(){return bi(e)},traceErrorTelemetry:function(n){e._traceErrorTelemetry(ti.TransitionedToErrorState,n)},isV2Part:this.partDefinition&&this.partDefinition.isV2,isVirtualPartForTemplateBlade:s};return u&&this.widget.options.isInBlockingLoadingState(!1),i.tryImmediateResolve(n.createPart(this._partContainer[
0],t,h,this.services),(function(n){var i,u,t,o;if(e.isDisposed())return Q.reject(di);e._part=n;du(e.partDefinition)&&n.awaitContentRevealed?(i=n,i.awaitContentRevealed().then((function(){e._frameRevealed.resolve(!0);e._frameBlockingUi(!1)})),i.awaitInitializationComplete().then((function(){e._frameRevealed.resolve(!1);e._frameInitialized.resolve();e._frameBlockingUi(!1)}))):(e._frameRevealed.resolve(!1),e._frameInitialized.resolve());u=e.partDefinition;n.setupContent({extensionWindowId:e.extension&&r.Extension.getWindowId(e.extension),styleSheets:u&&u.styleSheets});f.computed(e,(function(){var n=e.parent,t=n&&n.widget,i=t&&t.options.locked();e.widget&&e.widget.options.locked(i);e._part&&e._part.lockedUiContext(i)}));t=e.widget;o=t&&t.ltm&&t.element;o&&e.resourceLTM().registerForDispose(o.setEvents([bt.default.fxerrorpartclicked,function(){e.services.desktop.replacePart(e,e.locator,{newPartContainerModel:e.containerModel,newPartOverridesModel:e.overridesModel,doNotSaveSettings:!0})}]))}))},w.prototype.
loadPropertiesFromJson=function(n,t,i){t===void 0&&(t=!1);var f=dt.bindingsFromJSON,u=n.partState;this.assetInstanceDefinition=n.assetInstanceDefinition;this.bindings=i?ir(i,this):f(n.bindings)||[];this.initialSize=n.initialSize;this._bindingsInitialized=n.bindingsInitialized;this._restoredFromJson=!0;this.loadFromJson(n);this._savedContainerState=n.savedContainerState;this.containerModel=vr(n.containerModel);this.overridesModel=vr(n.overridesModel)||{};this.partState=r.isSerializedObject(u)?r.fromSerializableObject(u):u;t&&wu(this.partState);n.originalPartLocator&&(this.previousLocator=fr.fromJSON(n.originalPartLocator));this.flags=n.flags||0;this._adapterBindings=f(n.adapterBindings)},w.prototype.calculateInitialSize=function(){var n,h,a,v,i={},c=this.services.finder,u=this.locator,e=u.type,o,t,r,y,p,l,f,s;e===ii.PartInstance||e===ii.StartboardPartInstance?c.tryLocate(u,i)&&(o=i.value,o&&(t=o.inline,r=o.reference,h=t?t.initialSize:r.initialSize,a=t?t.initialWidth:r.initialWidth,v=t?t.
initialHeight:r.initialHeight,t?n=t:(y=vi(r.extension||u.getExtensionLocator().name,u.getExtensionLocator().cloudName),p=y.withPartType(r.partTypeName),i={},c.tryLocate(p,i)&&(n=i.value)))):e===ii.PartType?(i={},c.tryLocate(u,i)&&(n=i.value)):kt.error("Unable to create Part composition. Invalid locator type: '{0}'".format(e));this._bindingsInitialized=!1;l=k.getPartSizeOrDefault(n);f=l;ki.InternalPartSize[h]?f=h:n&&ki.InternalPartSize[n.initialSize]?f=n.initialSize:n&&(s=k.getPartFactory(this.extension&&this.extension.name,n,{}),f=s&&s.defaultSize!==undefined?s.defaultSize:l);this.initialSize=f;this.initialSize===99&&(this.initialWidth=a||n&&n.initialWidth,this.initialHeight=v||n&&n.initialHeight)},w.prototype.getDiagnosticsData=function(){return e.extend(p.prototype.getDiagnosticsData.call(this),{bindings:dt.mapBindingsToFriendlyObjects(this.bindings)})},w.prototype._getSummaryPartViewModelState=function(){var n=bt.default.fxsummarycollapsed,t=e.Event(n);return this.widget.trigger(n,t),
t.result},w.prototype._autoOpenSettingsFromSummary=function(){var t=this,n;lf==="true"&&(this._restoredFromJson||(n=this.getPartsContainer(),Q.all([n.getPermissionPromise(),this.awaitComposed()]).then((function(){var u=gt(t._vm,"content.hasSettings"),i,r,e;u.exists&&f.unwrap(u.value)&&(i=gt(t._vm,"content.settingsSelectable"),i.exists&&(r=f.unwrap(i.value),e=n.detailContainers,r&&(e||[]).length<=0&&n.canAutoOpenSettings()&&(t.widget.element.trigger(bt.default.fxautosettings,{masterBladeId:n.instanceId,masterPartId:t.instanceId}),r.isSelected(!0))))}))))},w.prototype._getEditScopeIdFromSettings=function(){var n=this._journey,t=n&&n.ambientSettings.getItem(this.journeyPath),i=t&&t.value,r=i&&i.editScope;return r&&r.editScopeId},w.prototype._setupJourneyEditScopeReactor=function(){var n=this.partDefinition,t=this._journey;n&&n.editScopeType&&t&&t.observeEditScopeChanges(this,{editScopeId:this.editScopeId,ownerType:this.locator.type,ownerLocatable:this})},w.prototype._setEditScope=function()
{var f=this.partDefinition,t,n,r,e,u;if(f&&f.editScopeType){if(t=this._getEditScopeIdFromSettings(),n=this.editScopeId,t)n(t);else{n(i.getUniqueId());this.services.editScopeManager.onEditScopeCreated(n())}r=this.getInputPropertyBindings();e=r.properties.some((function(n){return n.targetProperty===ai}));e||(u={},u[ai]=n,r.mapProperty(ai,ai).bind(this+"-[EditScopeId]",u,!0))}},w.prototype._getCommands=function(){if(!this.isComposed||!this.widget)throw new Error("Part '"+this+"' needs to be composed before retrieving its commands.");var n=this.widget;return n.options.commands},w.prototype._setupBladeRebindingHandlers=function(n){var t=this;if(n&&n.onRebind){var i=function(n){var i,r,u,f,e,o;if(t._setContainerInputsChanging(!0),t._updateRebindSequenceNumber(),ci.provideContext((function(){t._creationState=ci.getState()}),dr.Part,t._getPartContext()),i=t.editScopeId()&&t.services.editScopeManager.getStateObservable(t.editScopeId()),r=t.widget,t._onInputsSet.reject(new uu("Part binding canceled due to rebinding for part '"+
t+"'")),t._contentRevealed.reject(new uu("Part reveal canceled due to rebinding for part '"+t+"'")),t._onInputsSet=Q.defer(),t._contentRevealed=Q.defer(),t._allOnInputsSet=Q.all([t._onInputsSet.promise,t._frameInitialized.promise]),t._allContentRevealed=Q.all([t._contentRevealed.promise,t._frameRevealed.promise]),t._hasRebindableInputs&&(u=(t.parent.parent||t.parent).widget,!r||u&&u.options.locked()||r.options.isInBlockingLoadingState(!0),t._lastRebindOnInputsSetProperties=sr(n,t.bindings,1,""+t),t._setupAdaptedInputsReboundReactor()),i&&i()===g.EditScopeState.NotDirty)t.services.editScopeManager.onEditScopeDisposed(t.editScopeId());t.editScopeId(undefined);t._ensureAdapterAtomicityForBindings();t.bindings.forEach((function(n){if(n.source.scope===oi.DetailsContainer){var i=gt(t._vm,n.targetProperty);i.exists&&yt.setModelValue(t._vm,n.targetProperty,undefined)}}));t._vm.container.unauthorizedMessage(null);t.partDefinition.shareVmWithParentBlade?(f=t.parent,e=f.parent,e.setInputsSetPromise(
t._onInputsSet.promise)):(o=t._getNotFoundMessage(),o(null))},r=function(){t.isComposed&&(t._setEditScope(),t.partDefinition.partKind===ri.ResourceSummary&&t._autoOpenSettingsFromSummary())},u=function(){t._setContainerInputsChanging(!1)};n.onRebind(i,r,u);this.registerForDispose((function(){n.offRebind(i,r,u)}))}},w.prototype._ensureAssetAffinity=function(){var u=this,n=this.parent&&this.getPartsContainer(),t=this.assetType,i=n&&n.assetType,r=this._part.inContainerOfSameAsset;if(!n||!i||!t||i!==t||!f.isObservable(n.assetId))return r(!1);f.computed(this,(function(){var t=n.assetId(),i=u.assetId(),f=t&&i&&d.compareAssetId(t,i);r(f)}))},w.prototype._ensureAdapterAtomicityForBindings=function(){var t=this.adapter,n;t&&(n=[],this.bindings.forEach((function(t){var i=t.source;i.modelType===hi&&n.push(i.property)})),n.forEach((function(n){yt.setModelValue(t.viewModel,n,undefined)})))},w.prototype._setupAdaptedInputsReboundReactor=function(){var n=this,t=this.adapter;t&&!t.allOutputsReboundComputed&&(
t.allOutputsReboundComputed=f.computed(this,(function(){var r=n.bindings.filter((function(n){var t=n.source.modelType;return t===hi||t===wi})).every((function(t){var i=n.bindAdaptedInput(t).sourceModel,r=gt(i,t.source.property).value;return f.unwrap(r)!==undefined}));if(r){var i=""+n,u=sr(t.viewModel,n.bindings,hi,i),o=sr(t.inputPropertyBindings.targetModel,n.bindings,wi,i);n._lastRebindOnInputsSetProperties=e.extend(u,o)}})))},w.prototype._disposeEditScope=function(){var t=this.editScopeId(),n;if(t){this.services.editScopeManager.onEditScopeDisposed(t);n=this._journey;n&&n.ambientSettings.removeItem(this.journeyPath)}},w.prototype._setViewStateProperties=function(n,t){var f=this,e=n||[],i=t||[],r,u;i=i.filter((function(n){var t=n.split(".");return t.length>1?(t.pop(),typeof gt(f._vm,t.join(".")).value=="object"):!0}));this._viewStateProperties=e.concatUnique(i);r=this._vm;u=r&&r.container;u&&u.selectable&&(this._viewStateProperties=this._viewStateProperties.concatUnique(hf))},w.prototype._registerInvocationProperty=
function(n){var i=this,r=this._bladeOpener,t,u=st.detailsIsPartContainer(n);u&&(t=f.pureComputed((function(){return!i._vm.container.isSelectable()})));r.registerInvocationProperty(n,t)},w.prototype._getNotFoundMessage=function(){var n=this._vm.container;return n.notFoundMessage},w.prototype._traceErrorTelemetry=function(n,t){li.trace({extension:gu(this),source:nr,action:si.PartErrored,actionModifier:ti[n],name:fi(this.locator),data:{details:t}})},w})(ot.Instance);t.Instance=lr;t.prepareContainerModel=ur;t.getSerializableContainerModel=ar;t.createContainerModel=vr;t.create=vu;t.setBladeOpenerModule=ee;t.setDynamicPartBinderModule=oe;t.inferredReferenceType=-999;t.createOverridesOrContainerModelSourceReference=se;t.isOverridesOrContainerModelSourceReference=kr;t.isDynamicBindingWithNonLocalSource=ku}));define("MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart",["require","exports","f","o","ko","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition",
"MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/Services/Services.EditScopeManagement"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function g(n,t,i,r){r=r||{};var u=new a(n,t,null,r.id);return u.calculateInitialSize(),u.modelContainsSensitiveData=r.modelContainsSensitiveData,u.containerModel=h.prepareContainerModel(i||{}),u.overridesModel=h.prepareContainerModel(r.overridesModel||{}),u.validateBindings(i)||(l.error("Unable to create instance of startboard part '{0}', check log for errors.".format(t.toString())),u.locator.name="##INVALID##"),r.doNotSaveSettings||u.save(),u}var l,a;r.defineProperty(t,"__esModule",{value:!0});var v=f.Locator,y=f.LocatorType,p=i.Base,w=p.Diagnostics,b=i.Parts.PartKind,k=e.CompositionType,d=o.CompositionBinder;t.startboardPartName="StartboardPart";l=w.createLog(n);a=(function(n){function t(t,i,r,f){var e=n.call(
this,t,i,r,f,null,"StartboardPart")||this;return e.dontSetupWidget=!1,e.containerModel={},e._store=4,e._partShellApiDeferred.promise.then((function(n){if(n&&u.isObservable(n.updateFilters)){var t=function(n){var t=e.parent&&e.getPartsContainer();return t&&t.updateFilters(e,n)||Q.reject(new Error("Only Parts located on Dashboards can call 'updateFilters'"))};n.updateFilters(t)}})),e}return __extends(t,n),t.fromJSON=function(n,i,r){return e.createCompositionFromJSON(i,(function(){var u=new t(n,v.fromJSON(i.locator),i.widgetState,i.id);return u.loadPropertiesFromJson(i,!0,r),u._storedEditScopeId=i.editScopeId,u.dontSetupWidget=i.dontSetupWidget,u.defaultMenuItemId=i.defaultMenuItemId,u.containerModel=u.containerModel||{},u.deepLink=i.deepLink,u}),(function(r,u){var f=new t(n,r,null,i.id);return f.unrecoverableErrorMessage=u,f}))},t.prototype.getCompositionType=function(){return k.StartboardPart},t.prototype.register=function(t,i,r){var f=this,u,e;n.prototype.register.call(this,t,i,r);var o,s=this.
deepLink,h=this._part,l=this.services;s&&(u=h.getSelectable(),o={isClickable:u.isClickable,isSelected:u.isSelected,value:u.value,onClick:function(){l.router.route(s)}});h.configure({onStartboard:!0,selectable:o});e=this.editScopeId();e&&this.partDefinition.partKind===b.Provisioning&&l.editScopeManager.getStateObservable(e).subscribe(this,(function(n){var t=n===c.EditScopeState.Dirty||n===c.EditScopeState.DirtyAndSaving;t&&(f.dontSetupWidget=!1,f.addWidgetToUI({parentElement:f.getPartsContainer().widget}))}))},t.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this);return t.editScopeId=this.editScopeId(),t.dontSetupWidget=this.dontSetupWidget,t.defaultMenuItemId=this.defaultMenuItemId,t.deepLink=this.deepLink,t},t.prototype.validateBindings=function(n){var r=this,t,i;return this.bindings&&this.bindings.length>0?(t=this.bindings.filter((function(n){return n.source.id!==r.id})),i=t.map((function(n){return n.source.property})),d.modelHasProperties(""+this,i,n)):!0},t.prototype.matchesLocatorAndModel=
function(n,t,i,r){return!this.locator.equals(t)&&!this._matchesPartReferenceLocator(n,t)?!1:this.defaultMenuItemId!==r?!1:e.deepSubset(this.containerModel,i||{})},t.prototype.addWidgetToUI=function(t){if(!this.dontSetupWidget){var i=this.widget;s.composeShellCommands(this,this,i.options.commands,!0,this.services);n.prototype.addWidgetToUI.call(this,t);t.doNotSaveSettings||this.save()}},t.prototype.save=function(t){this.dontSetupWidget&&n.prototype.save.call(this,t)},t.prototype._forceSave=function(t){n.prototype.save.call(this,t)},t.prototype._getEditScopeIdFromSettings=function(){return this._storedEditScopeId},t.prototype._setupJourneyEditScopeReactor=function(){},t.prototype.getDashboardFiltering=function(){var n=this;return this._partShellApiDeferred.promise.then((function(t){return t&&i.extend2(t,{staticFilters:n.partDefinition.filters||[],partApi:n._partShellApiDeferred.promise})}))},t.prototype.notifyFiltersChanged=function(n){var t=this;this.awaitComposed().then((function(){t._setContainerInputsChanging(
!0);var i=2|(n?4:0);t._setContainerInputsChanging(!1,i)}))},t.prototype._disposeEditScope=function(){var n=this.editScopeId();if(n)this.services.editScopeManager.onEditScopeDisposed(n)},t.prototype._getBladeOpenerConfig=function(){var t=this,i=n.prototype._getBladeOpenerConfig.call(this),r=function(){var n=t.getPartsContainer().detailContainers;return n&&n.length>0&&n[0]};return i.onBladesOpening=function(){t.isDisposed()&&t.dontSetupWidget&&l.error("Cannot open new blades for part '"+t+"', it has already been disposed and removed from the starboard. If this part was created from a Hub action, make sure it doesn't change the target blade after it has been opened.")},i.getCloseOwnedDetailBladesHandler=function(n){var u,f=n&&n.source&&n.source.property,i=r();return i&&i.masterPartId===t.id&&i.masterInvocationProperty===f&&!i.masterCommandName&&(u=function(){var n=t.services.desktop,i=n.getActiveJourney();return i?n.tryDiscardJourney(i.id):n.tryDeactivateJourney()}),u},i.getCloseOtherDetailBladesHandler=
function(n){var u,f=n&&n.source&&n.source.property,i=r();return i&&(i.masterPartId!==t.id||i.masterInvocationProperty!==f)&&(u=function(){var n=t.services.desktop,i=n.getActiveJourney();return i.isStartedWithContextBlade()?n.tryDiscardJourney(i.id):n.tryDeactivateJourney()}),u},i},t.prototype._matchesPartReferenceLocator=function(n,t){var u=!1,f={},r,i,e,o;return this.locator.type===y.StartboardPartInstance&&n.tryLocate(this.locator,f)&&(r=f.value,i=r&&r.reference,i&&(e=i.extension?v.forExtension(i.extension,this.locator.getExtensionLocator().cloudName):this.locator.getExtensionLocator(),o=e.withPartType(i.partTypeName),u=t.equals(o))),u},t})(h.Instance);t.Instance=a;t.create=g}));define("MsPortalImpl/Widgets/Widgets.FlowLayout",["require","exports","f","o","ko","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Compositions/UI.Composition.PartSize",
"MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function vt(n){for(var r,u,f,e=new ut,i,c=!0,o=0;o<n.length;o++){var t=n[o],l=t.position,s=l.row,h=l.col,a=t.rowSpan,v=t.colSpan;if(e.isRectangleFree(h,s,a,v))e.markOccupancy(t);else{for(c=!1,i={misplacedPart:t.id,overlappedParts:[]},r=h;r<h+v;r++)for(u=s;u<s+a;u++)f=e.getItemAt(r,u),f&&i.overlappedParts.indexOf(f.id)===-1&&i.overlappedParts.push(f.id);break}}return{success:c,result:i}}var b,st,ht,v,it;r.defineProperty(t,"__esModule",{value:!0});var ct=i.Base.Diagnostics,rt=i.Widgets.AzureGrid,nt=s.Orientation,ft=ct.createLog(n),y=c.Widget.getId,tt=o.Widget.getWidget,et="fxs-flowlayout",ot="fxs-flowlayout-childcontainer",d="fxs-flowlayout-element",lt="fxs-flowlayout-drop-placeholder",at="<div class='"+ot+"'><\/div>",w=function(n,t,i){return Math.min(25,Math.ceil((n+i)/(t+i)))},p=function(n,t,i){return n*t+(n-1)*i};t.validateGrid=vt;b={};b[38]=
1;b[39]=2;b[40]=3;b[37]=4;st=(function(n){function t(t,i){var r=n.call(this,t)||this;return r.minColumns=u.observable(1),r.minRows=u.observable(1),r.maxColumns=u.observable(999),r.maxRows=u.observable(999),r.columnSize=rt.CellWidth,r.rowSize=rt.CellHeight,r.gutterSize=rt.CellSpacingWidth,r.orientation=nt.Horizontal,r.allowReorder=!1,r.allowOverflow=!1,r.allowGaps=!1,r.resolutionGuides=!1,r.resolutionGuidesOffset={x:0,y:0},r.applyViewSettings(i),r}return __extends(t,n),t.prototype.getViewSettings=function(){return{positions:this.positions}},t.prototype.applyViewSettings=function(n){n&&n.positions&&(this.positions=n.positions,this.positionUpdatedSignal(this.positionUpdatedSignal()+1))},t})(s.ViewModel);t.ViewModel=st;ht=(function(n){function t(t,i){var r=n.call(this,t,i)||this;return r._dropPlaceholder=null,r._childContainer=null,r._engine=new k(i),r._engine.positions=i.positions,t.addClass(et).html(at),i.resolutionGuides&&r._addResolutionGuides(),r._childContainer=r.element.findByClassName(
ot),r._initializeComputed(),r._setContainerSize(),r._relayoutPositions(),r._attachEventHandlers(),r}return __extends(t,n),t.prototype.dispose=function(){var t=this.element;this._childElements.forEach((function(n){n.removeClass(d);u.cleanNode(n[0]);n.remove()}));u.cleanNode(this._childContainer[0]);this._childContainer.remove();t.removeClass(et);n.prototype.dispose.call(this)},r.defineProperty(t.prototype,"_childElements",{get:function(){var t=this._childContainer.children("."+d),n=[];return f.each(t,(function(t,i){n.push(f(i))})),n},enumerable:!0,configurable:!0}),r.defineProperty(t.prototype,"dropPlaceholder",{get:function(){return this._dropPlaceholder},enumerable:!0,configurable:!0}),t.prototype.addChild=function(n){var r=this.options,t,i;if(!n)throw new Error("Cannot add a null child.");t=n.element?n.element:n;t.css("visibility","hidden");this._childContainer.append(t);t.addClass(d);i=this._getChildDimensions(t);try{r.positions=this._engine.append(y(t),i.rowSpan,i.colSpan)}catch(u){ft.
warning("New element could not be appended to the grid. {0}".format(u.toString()));t.removeClass(d);t.remove();return}r.positions=this._engine.positions;this._refreshElementSize(t);this._setContainerSize();this._relayoutPositions();this.element.trigger(s.Widget.layoutUpdatedEventName);t.css("visibility","")},t.prototype.removeChild=function(n,t){var u=this._childElements.firstIndex((function(t){return y(t)===n})),i=this._childElements[u],r;return i?(r=this.options,r.positions=this._engine.remove(n),this.element.trigger(s.Widget.layoutUpdatedEventName),e.hide(i).removeClass(d),t?i.detach():i.remove(),this._setContainerSize(),this._relayoutPositions(),!0):!1},t.prototype.resizeChild=function(n,t,i,r){var u=this.options,o=u.rowSize,h=u.columnSize,f=u.gutterSize,l=this._childElements.first((function(t){return y(t)===n})),a,b;if(l){a=this._engine.positions.first((function(t){return t.id===n}));t=Math.max(t,h);i=Math.max(i,o);var k=w(i,o,f),d=w(t,h,f),v=this._engine.resize(n,d,k,r);u.positions=v;var
e=v.first((function(t){return t.id===n})),g=p(e.rowSpan,o,f),nt=p(e.colSpan,h,f);this._setContainerSize(!0);this._relayoutPositions();r&&((a.rowSpan!==e.rowSpan||a.colSpan!==e.colSpan)&&this.element.trigger(s.Widget.layoutUpdatedEventName),b=tt(l,c.Widget),this._setElementSize(b,l,nt,g))}},t.prototype.moveChild=function(n,t,i,r){var f=y(n),u=this._getChildDimensions(n),e=this._engine.move(f,{col:t,row:i},u.colSpan,u.rowSpan,r);this.options.positions=e;this._setContainerSize(!0);this._relayoutPositions();r&&this.element.trigger(s.Widget.layoutUpdatedEventName)},t.prototype.refreshLayout=function(){this.options.positions=this._engine.positions;this._setContainerSize();this._relayoutPositions();this._refreshSizes()},t.prototype.saveViewSettings=function(){var n=this.options;return n.positions=this._engine.positions,n.getViewSettings()},t.prototype.createDropPlaceholder=function(n,t){this._dropPlaceholder&&this.disposeDropPlaceholder();this._dropPlaceholder=f('<div class="'+lt+'"><\/div>').css(
{width:n,height:t});this._childContainer.append(this._dropPlaceholder)},t.prototype.disposeDropPlaceholder=function(){this._dropPlaceholder&&this._dropPlaceholder.remove();this._dropPlaceholder=null},t.prototype.moveDropPlaceholder=function(n){this._setElementPositioningCss(this.dropPlaceholder,n)},t.prototype.resizeDropPlaceholder=function(n,t){var r=this.options,u=r.rowSize,f=r.columnSize,i=r.gutterSize,e=w(t,u,i),o=w(n,f,i),s=p(e,u,i),h=p(o,f,i);this._dropPlaceholder.css({width:h,height:s})},t.prototype.getDomOrderedChildren=function(){return this._engine.getNaturalDomElementOrder()},t.prototype.discardStateOfUnusedChildren=function(){var n=[],t={stateDiscarded:!1};return this._engine&&(n=n.concat(this._engine.discardUnusedPositions())),n.length&&(t.stateDiscarded=!0,t.message="Removed Positions: "+JSON.stringify(n)),t},t.prototype._initializeComputed=function(){var t=this,n=this.options,i=this.ltm;u.computed(i,(function(){n.minRows();n.maxRows();n.minColumns();n.maxColumns();t._setContainerSize(
)}));n.positionUpdatedSignal.subscribe(i,(function(){t._engine.positions=n.positions}))},t.prototype._getChildDimensions=function(n){var t=this.options,f=tt(n,h.Widget),i=f&&f.options,u=i&&i.size(),e,r,o,s;return l.isFixedSize(u)?(e=l.getSize(u),r=u===99?l.getGridPixelSize(i.gridWidth(),i.gridHeight()):e.size):r=this._getChildAccurateDimensions(n),o=w(r.height,t.rowSize,t.gutterSize),s=w(r.width,t.columnSize,t.gutterSize),{rowSpan:o,colSpan:s}},t.prototype._getChildAccurateDimensions=function(n){if(!n[0])return ft.warning("Attempted to measure a non-existant item in _getChildAccurateDimensions. Assuming 0 as size."),{height:0,width:0};var t=n[0].getBoundingClientRect(),i=Math.round(t.height),r=Math.round(t.width);return{height:i,width:r}},t.prototype._setContainerSize=function(n){var t=this.options,i=this._engine.getMaxOccupiedPositions(n?t.positions:null),r=Math.max(t.minRows(),i.row),u=Math.max(t.minColumns(),i.col),f=p(r,t.rowSize,t.gutterSize),e=p(u,t.columnSize,t.gutterSize);this._childContainer.
css({height:f,width:e})},t.prototype._relayoutPositions=function(){for(var r,n,t,u,i=0;i<this._childElements.length;i++)n=this._childElements[i],r=y(n),t=this.options.positions.first((function(n){return n.id===r})),u=t?t.position:{row:0,col:0},this._setElementPositioningCss(n,u)},t.prototype._setElementPositioningCss=function(n,t){var i=this.options,r=t.col*(i.columnSize+i.gutterSize),u=t.row*(i.rowSize+i.gutterSize),f;f=this._isRtl()?{right:r,top:u}:{left:r,top:u};n.css(f)},t.prototype._refreshSizes=function(){this._childElements.forEach(this._refreshElementSize,this)},t.prototype._refreshElementSize=function(n){var t=this.options,i=tt(n,c.Widget);if(i){var u=y(n),r=t.positions.first((function(n){return n.id===u})),f=p(r.rowSpan,t.rowSize,t.gutterSize),e=p(r.colSpan,t.columnSize,t.gutterSize);this._setElementSize(i,n,e,f)}},t.prototype._setElementSize=function(n,t,i,r){n?n.setSize(i,r):t.css({width:i,height:r})},t.prototype._moveFocusInDirection=function(n){var e=f(document.activeElement).
closest("."+h.widgetClassName),r=y(e),u,t,i;r&&(u=this._engine.getAdjacentElement(r,n),t=this._childElements.first((function(n){return u===y(n)})),t)&&(i=tt(t,h.Widget),i&&i.setFocus())},t.prototype._attachEventHandlers=function(){var t=this,n=this.element,i=function(n,i,r,u,f){t.resizeChild(i,r,u,f===undefined?!0:f);n.stopPropagation()},r=function(n){var r=f(n.target),u,i;r.is("input[type=text], textarea, select")||r.closest(".fxs-contextMenu").length||(u=n.which,i=b[u]||0,i!==0&&(n.preventDefault(),n.stopPropagation(),t._moveFocusInDirection(i)))};n.on(a.default.fxsizechange,i);n.on(a.default.keydown,r);this.ltm.registerForDispose((function(){n.off(a.default.fxsizechange,i);n.off(a.default.keydown,r)}))},t.prototype._addResolutionGuides=function(){var t=this,i='<div class="fxs-flowlayout-resolutionguide fxs-flowlayout-resolutionguide-{0}x{1} fxs-hide-in-normal"><\/div>',n=this.options.resolutionGuidesOffset;[{x:1024,y:768},{x:1366,y:768},{x:1440,y:900},{x:1920,y:1080},{x:3840,y:2160},].forEach(
(function(r){var u=f(i.format(r.x,r.y));(n.x||n.y)&&u.css({top:n.y+"px",left:n.x+"px"});t.element.prepend(u)}))},t})(s.Widget);t.Widget=ht,(function(n){function t(n){return n.position.row}function i(n){return n.position.row+n.rowSpan}function r(n){return n.position.col}function u(n){return n.position.col+n.colSpan}n.top=t;n.bottom=i;n.left=r;n.right=u})(v||(v={}));var ut=(function(){function n(){this._occupancyGrid=[]}return n.prototype.reset=function(n){var t=this;this._occupancyGrid.length=0;n&&n.forEach((function(n){t.markOccupancy(n)}))},n.prototype.isRectangleFree=function(n,t,i,r){for(var u,e=n+r,o=t+i,f=n;f<e;f++)for(u=t;u<o;u++)if(this.isPositionOccupied(f,u))return!1;return!0},n.prototype.isPositionOccupied=function(n,t){return!!this._occupancyGrid[n]&&!!this._occupancyGrid[n][t]},n.prototype.getItemAt=function(n,t){var i=this._occupancyGrid[n];return i?i[t]:null},n.prototype.markOccupancy=function(n,t){for(var r,f=v.top(n),e=v.bottom(n),o=v.left(n),s=v.right(n),u=this._occupancyGrid,
i=o;i<s;i++)for(r=f;r<e;r++)u[i]||(u[i]=[]),u[i][r]||(u[i][r]=null),u[i][r]=t?null:n},n})(),g={},k=(function(){function n(n){this._occupancyGrid=new ut;this._items=[];this._filledPositions={};this._gridOptions=n}return n.prototype.append=function(n,t,i){var r=this._getExistingItem(n),u,f,e;if(this._filledPositions[n]=!0,!!r)return this._items;if(u=this._maxRows(),f=this._maxCols(),!this._gridOptions.allowOverflow&&(t>u||i>f))throw new Error("The element cannot fit in this grid. ElementRowSpan: {0}, ElementColSpan: {1}, GridMaxRowSpan: {2}, GridMaxColSpan: {3}".format(t,i,u,f));if(e=this._findNextAvailablePositionForRectangle(t,i),!e)throw new Error("The element cannot fit in the remaining space available in the grid.");return r={id:n,position:e,rowSpan:t,colSpan:i},this._items.push(r),this._occupancyGrid.markOccupancy(r),this._items},n.prototype.move=function(n,t,i,r,u){var o={id:n,position:t,colSpan:i,rowSpan:r},e,f,s;return this._applyGridConstraints(o),f=new it(this._items,o,this._gridOptions),
e=f.resolved?f.getItems():this._items,u&&(f.resolved&&(this._items.length=0,(s=this._items).push.apply(s,e)),this._occupancyGrid.reset(this._items),this.collapseGaps()),e},n.prototype.resize=function(n,t,i,r){var e=this._getExistingItem(n),o=e.position,y={id:e.id,position:{col:o.col,row:o.row},colSpan:t,rowSpan:i},f=y.position,u,l,s,h,p,c,w;if(this._applyGridConstraints(y),f.row<0||f.col<0)return this._items;var b=Math.max(0,t-e.colSpan),k=Math.max(0,i-e.rowSpan),a=f.col,v=f.row;for(this._gridOptions.allowGaps||(a=Math.min(a,Math.max(0,o.col-b)),v=Math.min(v,Math.max(0,o.row-k))),s=a;s<=f.col;s++){for(h=v;h<=f.row;h++)if((p={id:n,position:{col:s,row:h},colSpan:t,rowSpan:i},c=new it(this._items,p,this._gridOptions),c.resolved)&&((!u||c.shiftCost<u.shiftCost)&&(u=c),u&&u.shiftCost===0))break;if(u&&u.shiftCost===0)break}return l=u?u.getItems():this._items,r&&(u&&(this._items.length=0,(w=this._items).push.apply(w,l)),this._occupancyGrid.reset(this._items),this.collapseGaps()),l},n.prototype.
remove=function(n){var i=this._getExistingItem(n),t;return(this._filledPositions[n]=!1,t=this._items.indexOf(i),t===-1)?this._items:(this._items.splice(t,1),this._occupancyGrid.markOccupancy(i,!0),this.collapseGaps(),this._items)},n.prototype.collapseGaps=function(){if(!this._gridOptions.allowGaps){var n={grid:this,isPositionOccupied:function(n,t){return this.grid._occupancyGrid.isPositionOccupied(n,t)},getMaxPositions:function(){return this.grid.getMaxOccupiedPositions()},getMinSize:function(){return{col:this.grid._minCols(),row:this.grid._minRows()}},getItemAt:function(n,t){return this.grid._occupancyGrid.getItemAt(n,t)},shiftItem:function(n,t){n.position.col-=t}},t={grid:this,isPositionOccupied:function(n,t){return this.grid._occupancyGrid.isPositionOccupied(t,n)},getMaxPositions:function(){var n=this.grid.getMaxOccupiedPositions();return{col:n.row,row:n.col}},getMinSize:function(){return{col:this.grid._minRows(),row:this.grid._minCols()}},getItemAt:function(n,t){return this.grid._occupancyGrid.
getItemAt(t,n)},shiftItem:function(n,t){n.position.row-=t}};this._orientation()===nt.Horizontal?(this._collapseGapsWithGridVisitor(n),this._collapseGapsWithGridVisitor(t)):(this._collapseGapsWithGridVisitor(t),this._collapseGapsWithGridVisitor(n))}},n.prototype.getNaturalDomElementOrder=function(){for(var n,t,u,i=[],f=this.getMaxOccupiedPositions(),r=0;r<f.row;r++)for(n=0;n<f.col;n++)t=this._occupancyGrid.getItemAt(n,r),t&&(u=t.id,i.indexOf(u)===-1&&i.push(u),n+=t.colSpan-1);return i},n.prototype.getAdjacentElement=function(n,t){var i=this._getExistingItem(n),r,u;return i?(r=g[t],u=r?r(this,i):i,u.id):n},r.defineProperty(n.prototype,"positions",{get:function(){return this._items},set:function(n){this._items.length=0;this._items=n?n:[];this._occupancyGrid.reset(this._items)},enumerable:!0,configurable:!0}),n.prototype.discardUnusedPositions=function(){var n=this,t=[];return this._items.slice(0).forEach((function(i){n._filledPositions[i.id]||(t.push(i),n.remove(i.id))})),t},n.prototype._orientation=
function(){return this._gridOptions.orientation},n.prototype._minRows=function(){return this._gridOptions.minRows()},n.prototype._maxRows=function(){return this._gridOptions.maxRows()},n.prototype._minCols=function(){return this._gridOptions.minColumns()},n.prototype._maxCols=function(){return this._gridOptions.maxColumns()},n.prototype.getMaxOccupiedPositions=function(n){for(var e=n||this._items,r=0,u=0,i,f,t=0;t<e.length;t++)i=e[t],f=i.position,r=Math.max(r,f.col+i.colSpan),u=Math.max(u,f.row+i.rowSpan);return{col:r,row:u}},n.prototype._getExistingItem=function(n){return this._items.first((function(t){return t.id===n}))},n.prototype._applyGridConstraints=function(n){var t,i;this._gridOptions.allowOverflow||(i=n.position,t=v.bottom(n)-this._maxRows(),t>0&&(i.row-=t),t=v.right(n)-this._maxCols(),t>0&&(i.col-=t))},n.prototype._findNextAvailablePositionForRectangle=function(n,t){var f=this._maxCols()-t+1,e=this._maxRows()-n+1,i,r,u;if(this._orientation()===nt.Horizontal){for(r=0;r<f;r++)for(
i=0;i<e;i++)if(this._isRectangleFree(r,i,n,t))return{col:r,row:i};if(this._gridOptions.allowOverflow)return u=this.getMaxOccupiedPositions(),{col:0,row:u.row}}else{for(i=0;i<e;i++)for(r=0;r<f;r++)if(this._isRectangleFree(r,i,n,t))return{col:r,row:i};if(this._gridOptions.allowOverflow)return u=this.getMaxOccupiedPositions(),{col:u.col,row:0}}},n.prototype._isRectangleFree=function(n,t,i,r){var u=n+r,f=t+i;return!this._gridOptions.allowOverflow&&(f>this._maxRows()||u>this._maxCols())?!1:this._occupancyGrid.isRectangleFree(n,t,i,r)},n.prototype._collapseGapsWithGridVisitor=function(n){var i=n.getMaxPositions(),r=i.col,a=i.row,u=[],y=!1,p,e,s,t,h,o,c,l;if(!(r<=n.getMinSize().col))for(s=0;s<r;s++){for(e=null,t=0;t<a;t++){if(y=!1,u[t]=this._findGap(t,s,r,n),h=u[t].colSpan,h===0)return;if((!e||h<e)&&(e=h),t>0&&!this._gapsAreContiguous(u[t-1],u[t]))break;y=!0}if(y){for(p={},o=0;o<a;o++)for(c=v.right(u[o]);c<r;c++)l=n.getItemAt(c,o),l&&(p[l.id]=l);f.each(p,(function(t,i){n.shiftItem(i,e)}));this.
_occupancyGrid.reset(this._items);i=n.getMaxPositions();r=i.col;a=i.row}}},n.prototype._gapsAreContiguous=function(n,t){var i=v.left(t),r=v.right(t),u=v.left(n),f=v.right(n);return f>=i&&u<=r},n.prototype._findGap=function(n,t,i,r){for(var u=t,f={id:"",position:{row:n,col:0},rowSpan:1,colSpan:0};u<i;){if(!r.isPositionOccupied(u,n))break;u++}for(f.position.col=u;u<i;){if(r.isPositionOccupied(u,n))break;f.colSpan++;u++}return f},n._scanAdjacentUp=function(n,t){for(var i,f,r=t.position,e=r.col,o=r.row-1,s=r.col+t.colSpan,u=o;u>=0;u--)for(i=e;i<s;i++)if(f=n._occupancyGrid.getItemAt(i,u),f)return f;return t},n._scanAdjacentRight=function(n,t){for(var i,f,r=t.position,e=r.col+t.colSpan,o=r.row,s=n.getMaxOccupiedPositions().col,h=r.row+t.rowSpan,u=e;u<s;u++)for(i=o;i<h;i++)if(f=n._occupancyGrid.getItemAt(u,i),f)return f;return t},n._scanAdjacentDown=function(n,t){for(var i,f,r=t.position,e=r.col,o=r.row+t.rowSpan,s=r.col+t.colSpan,h=n.getMaxOccupiedPositions().row,u=o;u<h;u++)for(i=e;i<s;i++)
if(f=n._occupancyGrid.getItemAt(i,u),f)return f;return t},n._scanAdjacentLeft=function(n,t){for(var i,f,r=t.position,e=r.col-1,o=r.row,s=r.row+t.rowSpan,u=e;u>=0;u--)for(i=o;i<s;i++)if(f=n._occupancyGrid.getItemAt(u,i),f)return f;return t},n})();t.FlowLayoutPositioningEngine=k;g[1]=k._scanAdjacentUp;g[2]=k._scanAdjacentRight;g[3]=k._scanAdjacentDown;g[4]=k._scanAdjacentLeft;it=(function(){function n(n,t,i){var u=this,r;this.shiftCost=0;this.resolved=!1;this._resolvedItems=[];this._occupancyGrid=new ut;this._gridOptions=i;n.forEach((function(n){var i;t.id!==n.id&&(i=f.extend(!0,{},n),u._resolvedItems.push(i),u._occupancyGrid.markOccupancy(i))}));this.resolved=this._resolveConflict(t);r=f.extend(!0,{},t);this._resolvedItems.push(r);this._occupancyGrid.markOccupancy(r)}return n.prototype.getItems=function(){return this._resolvedItems},n.prototype._orientation=function(){return this._gridOptions.orientation},n.prototype._maxRows=function(){return this._gridOptions.maxRows()||999},n.prototype._maxCols=
function(){return this._gridOptions.maxColumns()||999},n.prototype._resolveConflict=function(n){var t=!1;return this._orientation()===nt.Horizontal?(t=this._tryMoveConflictsLeft(n,{})||t,t=this._tryMoveConflictsUp(n,{})||t,t=this._tryMoveConflictsDown(n,{})||t,t=this._tryMoveConflictsRight(n,{})||t):(t=this._tryMoveConflictsUp(n,{})||t,t=this._tryMoveConflictsLeft(n,{})||t,t=this._tryMoveConflictsRight(n,{})||t,t=this._tryMoveConflictsDown(n,{})||t),t},n.prototype._tryMoveConflictsUp=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=v.left(n);u<v.right(n);u++)for(r=v.top(n);r<v.bottom(n);r++)if(i=this._occupancyGrid.getItemAt(u,r),i&&!t[i.id]){if((t[i.id]=!0,r=v.bottom(i),e=v.top(n)-v.bottom(i),f=this._getConflictArea(i,0,e),v.bottom(f)>this._maxRows()||v.top(f)<0)||!this._tryMoveConflictsUp(f,t))return!1;this._moveItem(i,0,e);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsDown=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=v.left(n);u<v.right(n);u++)for(r=v.bottom(n)-1;r>=v.top(n);r--)if(
i=this._occupancyGrid.getItemAt(u,r),i&&!t[i.id]){if((t[i.id]=!0,r=v.top(i),e=v.bottom(n)-v.top(i),f=this._getConflictArea(i,0,e),v.bottom(f)>this._maxRows()||v.top(f)<0)||!this._tryMoveConflictsDown(f,t))return!1;this._moveItem(i,0,e);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsLeft=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=v.top(n);u<v.bottom(n);u++)for(r=v.left(n);r<v.right(n);r++)if(i=this._occupancyGrid.getItemAt(r,u),i&&!t[i.id]){if((t[i.id]=!0,r=v.right(i),e=v.left(n)-v.right(i),f=this._getConflictArea(i,e,0),v.right(f)>this._maxCols()||v.left(f)<0)||!this._tryMoveConflictsLeft(f,t))return!1;this._moveItem(i,e,0);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsRight=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=v.top(n);u<v.bottom(n);u++)for(r=v.right(n)-1;r>=v.left(n);r--)if(i=this._occupancyGrid.getItemAt(r,u),i&&!t[i.id]){if((t[i.id]=!0,r=v.left(i),e=v.right(n)-v.left(i),f=this._getConflictArea(i,e,0),v.right(f)>this._maxCols()||v.left(f)<0)||!this._tryMoveConflictsRight(
f,t))return!1;this._moveItem(i,e,0);t[i.id]=!1}return!0},n.prototype._getConflictArea=function(n,t,i){var u=i<0,f=t<0,r=n.position;return{id:n.id,position:{row:u?r.row+i:r.row,col:f?r.col+t:r.col},rowSpan:n.rowSpan+Math.abs(i),colSpan:n.colSpan+Math.abs(t)}},n.prototype._moveItem=function(n,t,i){this._occupancyGrid.markOccupancy(n,!0);var r=n.position;r.col+=t;r.row+=i;this._occupancyGrid.markOccupancy(n);this.shiftCost+=n.colSpan*n.rowSpan},n})();t.FlowLayoutPositionConflictResolver=it}))