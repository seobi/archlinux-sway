define("MsPortalImpl/Base/JQueryExtensions",["require","exports","f","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f){"use strict";var e;return (function(){function l(t,r,u){var f=i.find(t,(function(t){var i=n(t);return!i.hasClass(s)&&i.is(":tabbable")&&(!u||u(i))}),r?-1:0);return n(f||[])}function e(t){return function(i){var r=this;return[h,c].reduce((function(u,f){if(!(u&&u.length)){var e=n(f,r).toArray();return l(e,t,i)}return u}),null)}}var r=u.findByClassName,o=window,n=jQuery,s="msportalfx-skip-initial-focus",t=n.fn,h="select, button, [tabindex=0], input, textarea",c="a";t.setEvents=function(){for(var n,i,r=[],t=0;t<arguments.length;t++)r[+t]=arguments[t];return n=this,i=function(t){var i=function(){return n[t].apply(n,arguments)};r.forEach((function(n){var u=n[0],t=n[1],r;typeof t=="function"?i(u,t):(r=n[2],r&&i(u,t,r))}))},i("on"),{dispose:function(){n&&(i("off"),n=null)}}};t.findByClassName=function(n){return r(this,n)};t.findFirstTabbable=
e();t.findLastTabbable=e(!0);t.isInScrollView=function(n){var u,t=n?this.closest("."+n):u=this.scrollParent();if(!t.length||!t[0].offsetParent||!t.is(u||this.scrollParent())&&!this.isInScrollView())return!1;var i=t.offset().top,f=i+t.height(),r=this.offset().top,e=r+this.height(),o=r>=i&&r<=f,s=e<=f&&e>=i;return o&&s};t.handleTransitionEndOnce=function(t,i,r){var s=this,u,h=!1,e;this.on(f.default.transitionend,u=function(n){for(var e,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];(e=n&&n.originalEvent,e&&e.propertyName!==t)||h||(h=!0,s.off(f.default.transitionend,u),r.apply(s,[n].concat(o)))});return e=function(){var i=n.Event("transitionend",{originalEvent:{propertyName:t}});u(i)},n.fx.off?e():o.setTimeout(e,i),this};n.enableAnimations=function(t){var i="fxs-transition-off-style-head-marker",f=n("<style/>").addClass(i).append("* {transition: none !important;-webkit-animation-iteration-count: .5 !important;animation-iteration-count: .5 !important;-webkit-animation-duration: 0s !important;animation-duration: 0s !important;-webkit-animation-delay: 0s !important;animation-delay: 0s !important;}"),
u=n("head");n.fx.off=!t;t?r(u,i).remove():r(u,i).length===0&&u.append(f)}})(e||(e={})),e}));define("MsPortalImpl/Extension/Extension.DefinitionValidator",["require","exports","f","a","ko"],(function(n,t,i,r,u){"use strict";function o(n,t){d(n,(function(n,i){i!==undefined&&t(n,i)}))}function g(n){var i=new c,t=i.errors;return n?(o(n,(function(i,r){switch(i){case"name":f("Extension name",r,t);break;case"version":case"hash":case"schemaVersion":case"sdkVersion":case"buildDescription":f(i,r,t);break;case"isPreview":l(i,r,t);break;case"assetTypes":e(i,r,t);break;case"blades":nt(n,r,t);break;case"startBoardParts":ft(r,t);break;case"partsCatalog":yt(r,t);break;case"commandsCatalog":vt(r,t);break;case"commandGroups":lt(r,t);break;case"htmlTemplates":ot(r,t);break;case"styleSheets":st(r,t);break;case"galleryService":ht(r,t);break;case"dashboardProvider":ct(r,t);break;case"requireConfig":break;default:t.push("Unexpected attribute '{0}' on definition.".format(i))}})),i):(t.push("Definition is null or undefined."),
i)}function f(n,t,i){typeof t!="string"&&i.push("{0} is not a valid string.".format(n))}function l(n,t,i){typeof t!="boolean"&&i.push("{0} is not a valid boolean.".format(n))}function e(n,t,i){var u=r.isArray(t);return u||i.push("The '{0}' property is not a valid array.".format(n)),u}function nt(n,t,i){t&&e("blades",t,i)&&t.forEach((function(t,r){a(n,t,r,i)}))}function a(n,t,i,r){var u=t.name;t.inputs&&e("Blade: {0}. Property: blades[{1}].inputs".format(u,i),t.inputs,r);t.optionalInputs&&e("Blade: {0}. Property: blades[{1}].optionalInputs".format(u,i),t.optionalInputs,r);e("Blade: {0}. Property: blades[{1}].lenses".format(u,i),t.lenses,r)&&t.lenses.forEach((function(n,t){var f="Blade: {0}. Lens: {1}. Property: blades[{2}].lenses[{3}].".format(u,n.name,i,t);n.partInstances&&e(f,n.partInstances,r)&&n.partInstances.forEach((function(f,e){var o="Blade: {0}. Lens: {1}. Part: {2}. Property: blades[{3}].lenses[{4}].partInstances[{5}]".format(u,n.name,f.name,i,t,e);y(o,f,r)}))}));t.permissions&&e("Blade: {0}. Property: blades[{1}].permissions".
format(u,i),t.permissions,r)&&t.permissions.forEach((function(n,t){s("Blade: {0}. Property: blades[{1}].permissions[{2}]".format(u,i,t),n,t,r)}));tt(t.toolbar,"Blade: {0}. Property: blades[{1}].toolbar".format(u,i),r);it(t.actionBar,"Blade: {0}. Property: blades[{1}].actionBar".format(u,i),r)}function tt(n,t,i){n&&(n.source?v(n.source,t+".source",i):i.push("Source not specified for toolbar. "+t))}function it(n,t,i){n&&n.source&&v(n.source,t+".source",i)}function v(n,t,i){n.property&&f(t+".property",n.property,i);n.optional&&typeof n.optional!="boolean"&&i.push("The attribute 'optional' should be of type boolean. "+t);n.isIdentityInput&&typeof n.isIdentityInput!="boolean"&&i.push("The attribute 'isIdentityInput' should be of type boolean. "+t);e(t+".valuesFrom",n.valuesFrom,i)&&n.valuesFrom.forEach((function(n,r){rt(t+".valuesFrom[{0}]".format(r),n,i)}))}function rt(n,t,i){switch(t.referenceType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;default:i.push("Unknown reference type '{0}' found for {1}.referenceType.".
format(t.referenceType,n))}f(n+".property",t.property,i);t.part&&f(n+".part",t.part,i)}function ut(n,t,i){switch(t.sourceType){case 0:t.providerKey&&i.push("Asset ID source source type of FromInput with provider key (should be null) found for {0}.sourceType.".format(n));break;case 1:t.providerKey||i.push("Asset ID source source type of FromProvider with missing provider key found for {0}.sourceType.".format(n));f(n+".providerKey",t.providerKey,i);break;case 2:t.providerKey||i.push("Asset ID source source type of FromSourceProvider with missing provider key found for {0}.sourceType.".format(n));f(n+".providerKey",t.providerKey,i);break;default:i.push("Unknown asset ID source source type '{0}' found for {1}.sourceType.".format(t.sourceType,n))}f(n+".property",t.property,i)}function s(n,t,i,r){var u,o;switch(t.permissionType){case 0:u=t;u.extensionName&&f(n+".extensionName",u.extensionName,r);f(n+".assetType",u.assetType,r);u.assetId?ut(n+".assetId",u.assetId,r):r.push("Permission missing assetId found for {0}.assetId.".
format(n));f(n+".action",u.action,r);break;case 1:o=t;switch(o.requirement){case h.All:case h.Any:break;default:r.push("Unknown permission set requirement '{0}' found for {1}.requirement.".format(o.requirement,n))}e(n+".permissions",o.permissions,r)&&o.permissions.forEach((function(t,i){s("{0}.permissions[{1}]".format(n,i),t,i,r)}));break;default:r.push("Unknown permission type '{0}' found for {1}.permissionType.".format(t.permissionType,n))}}function ft(n,t){e("startBoardParts",n,t)&&n.forEach((function(n,i){y("startBoardParts[{0}]".format(i),n,t)}))}function y(n,t,i){t.reference||t.inline?t.reference&&t.inline?i.push("'reference' and 'inline' properties cannot be set at the same time on PartInstanceDefinition. Property: {0}".format(n)):t.reference&&!t.reference.partTypeName?i.push("'partTypeName' property is required on part reference. Property: {0}".format(n)):t.inline&&p(n,t.inline,i):i.push("'reference' or 'inline' property required on PartInstanceDefinition. Property: {0}".format(n))}
function p(n,t,i){t&&(et(n,t.partState,i),t.permissions&&e("{0}.permissions".format(n),t.permissions,i)&&t.permissions.forEach((function(t,r){s("{0}.permissions[{1}]".format(n,r),t,r,i)})))}function et(n,t,i){if(t){var e=t.inputIdentityProperties||[],f=t.sharedProperties||[],o=e.concat(f.map((function(n){return n.property}))),s=f.map((function(n){return n.key})),r=w(o),u=w(s);r&&r.length>0&&i.push("Part view model properties cannot be used in multiple part settings. Duplicated properties: '{0}'. Path: '{1}'.".format(JSON.stringify(r),n));u&&u.length>0&&i.push("Shared key settings cannot be used in multiple part settings. Duplicated keys: '{0}'. Path: '{1}'.".format(JSON.stringify(u),n))}}function w(n){var t={},i=[];return(n||[]).forEach((function(n){!t[n]||i.push(n);t[n]=!0})),i}function ot(n,t){o(n,(function(n,i){typeof i!="string"&&(f("htmlTemplates['{0}'].file".format(n),i.file,t),f("htmlTemplates['{0}'].content".format(n),i.content,t))}))}function st(n,t){r.isArray(n)?n.forEach((function(n,i)
{f("StyleSheet at position {0}".format(i),n,t)})):t.push("Invalid type for 'styleSheets' property on definition.")}function ht(n,t){var i;o(n,(function(n,r){switch(n){case"serviceViewModel":i=r;break;default:t.push("Unexpected properties on 'galleryService' property of definition.")}}));f("galleryService.serviceViewModel",i,t)}function ct(n,t){var i=n.viewModel;i&&typeof i=="string"||t.push("The view model of dashboard provider must be non-empty string.")}function lt(n,t){n&&e("commandGroups",n,t)&&n.mapMany((function(n){return n.commands})).forEach((function(n){n.reference&&at(n,t)}))}function at(n,t){if(n&&n.reference){var i=!1;o(n,(function(n){n!=="name"&&n!=="bindings"&&n!=="reference"&&(i=!0)}));i?t.push("Command reference can only define 'name' and 'bindings' properties. Definition: {0}".format(u.toJSON(n))):n.reference.commandType||t.push("Command reference must specify the 'commandType' property. Definition: {0}".format(u.toJSON(n)))}}function vt(n,t){n&&e("commandsCatalog",n,t)&&n.forEach(
(function(n){var i="Commands in 'commandsCatalog' ";n.name||t.push(i+"must have names.");!n.reference||t.push(i+"cannot specify a 'reference' property.")}))}function yt(n,t){n&&e("partsCatalog",n,t)&&n.forEach((function(n){b(n,t)}))}function pt(n,t){f("name",n.name,t);f("moduleId",n.moduleId,t)}function b(n,t){n.inputDefinitions&&e("PartType: {0}. Property: inputDefinitions".format(n.name),n.inputDefinitions,t);n.reference&&wt(n,t);p("PartType: {0}".format(n.name),n,t)}function wt(n,t){(n.reference.bindings||[]).forEach((function(i){(i.valuesFrom||[]).forEach((function(i){i.referenceType!==7&&i.referenceType!==9&&i.referenceType!==5&&t.push("Adapted Part: {0} can only have Adapter, AdapterInput and Constant bindings for its referenced part.".format(n.name))}))}))}var k=i.Extension,h=k.SetRequirement,d=i.forEachKey,c=(function(){function n(){this.errors=[]}return n.prototype.valid=function(){return!this.errors.length},n})();t.ValidationResult=c;t.validateDefinition=g;t.validateIsString=f;t.validateIsBoolean=
l;t.validateIsArray=e;t.validateBlade=a;t.validateControl=pt;t.validatePartType=b}));define("MsPortalImpl/Extension/Extension.Manifest",["require","exports","f","MsPortalImpl/Extension/Extension.DefinitionValidator"],(function(n,t,i,r){"use strict";var u;return (function(n){function f(n){var t=new r.ValidationResult,i,f;return n?((typeof n.name!="string"||u(n.name)||n.name.indexOf("!")>=0)&&(f="The extension manifest should specify a valid name. This name is obtained from the <Extension> tag in PDL. This name should be a string and cannot be empty or whitespace. It also cannot contain the ! character. The recommended naming convention for an extension name is to follow the pattern {Company}_{BrandOrSuite}_{ProductOrComponent} (e.g. Microsoft_Azure_Insights).",t.errors.push(f)),n.assetTypes&&r.validateIsArray("manifest.assetTypes",n.assetTypes,t.errors)&&n.assetTypes.forEach((function(i){e(i,n.name,t.errors)})),t):(i="Manifest was not specified for the extension. Ensure that you passing a valid manifest to the FxExtension.register/FxExtension.registerAmd call that is used to register your extension with the portal.",
t.errors.push(i),t)}function t(n,t,i,r){n.push(t.format(i,r))}function e(n,r,f){var e=n.name;if(u(e)&&t(f,"The name for the asset type in manifest '{0}' was not specified.",r),n.browseType!==undefined&&typeof n.browseType!="number"&&t(f,"The browse type for the asset type '{0}' in manifest '{1}' was not a number.",e,r),n.browseServiceViewModel&&typeof n.browseServiceViewModel!="string"&&t(f,"The browse service view model for the asset type '{0}' in manifest '{1}' was not a string.",e,r),n.browseLinkUri&&typeof n.browseLinkUri!="string"&&t(f,"The browse link URI for the asset type '{0}' in manifest '{1}' was not a string.",e,r),n.privateBrowse!==undefined&&typeof n.privateBrowse!="boolean"&&t(f,"The private browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",e,r),n.browseRequiresRdfe!==undefined&&typeof n.browseRequiresRdfe!="boolean"&&t(f,"The requires RDFE browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",e,r),n.browseRequirements!==
undefined&&typeof n.browseRequirements!="number"&&t(f,"The browse requirements was present for the asset type '{0}' in manifest '{1}' was not a number.",e,r),n.browseType!==undefined){switch(n.browseType){case 0:n.browseServiceViewModel||t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to use a service view model but there was no service view model.",e,r);break;case 1:n.browseServiceViewModel&&t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's resource type but there was a service view model.",e,r);break;case 2:n.browseServiceViewModel&&t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's blade but there was a service view model.",e,r);break;case 3:n.browseLinkUri||t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to be a service link but there was no link URI.",e,r);break;case 4:n.browseLinkUri||t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to be an instance link but there was no link URI.",
e,r)}n.privateBrowse!==undefined&&n.browseType===undefined&&t(f,"The private browse flag was present for the asset type '{0}' in manifest '{1}' but there was browse type.",e,r);n.browseType!==0&&n.browseServiceViewModel&&t(f,"The asset type '{0}' in manifest '{1}' has a browse service but doesn't have service view model browse type.",e,r);u(n.pluralDisplayName)&&u(n.text)&&t(f,"The pluralDisplayName for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",e,r);i.isNullOrUndefined(n.icon)&&t(f,"The icon for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",e,r)}else n.browseServiceViewModel!==undefined?n.browseType=0:n.privateBrowse!==undefined&&t(f,"The asset type '{0}' in manifest '{1}' has a private blade flag but no browse type.",e,r);n.gridColumnsServiceViewModel&&typeof n.gridColumnsServiceViewModel!="string"&&t(f,"The grid columns service view model for the asset type '{0}' in manifest '{1}' was not a string.",
e,r);n.dynamicBladeServiceViewModel&&typeof n.dynamicBladeServiceViewModel!="string"&&t(f,"The dynamic blade service view model for the asset type '{0}' in manifest '{1}' was not a string.",e,r);n.propertyProviderServiceViewModel&&typeof n.propertyProviderServiceViewModel!="string"&&t(f,"The property provider service view model for the asset type '{0}' in manifest '{1}' was not a string.",e,r)}var u=i.isNullOrWhiteSpace;n.validate=f})(u||(u={})),u}));define("MsPortalImpl/Extension/ViewModelManager",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function e(n,i,r){t[n]={name:n,modulePath:i,factory:r}}function o(n,t,i){r[n]={name:n,modulePath:t,factoryWithState:i}}function s(n,t,i){u[n]={name:name,modulePath:t,factoryWithPrefix:i}}function h(n,e,o){var s=null,h=null,c=i.Helpers.Deferred();return(e in t?(s=t[e].modulePath,h=t[e].factory):e in r&&(s=r[e].modulePath,h=function(n){return r[e].factoryWithState(n,o)}),f(u,(function(t,i){e.startsWith(t)&&(s=i.modulePath,
h=function(t){return i.factoryWithPrefix(t,o,e,n)})})),s)?(i.require(s).then((function(n){c.resolve(h(n))}),(function(n){c.reject(n.message)})),c.promise()):null}var t={},r={},u={},f=i.forEachKey;n.register=e;n.registerWithState=o;n.registerPrefix=s;n.resolve=h})(r||(r={})),r}));define("MsPortalImpl/Extension/Extension",["require","exports","f","i","o","ko","MsPortalImpl/UI/Compositions/UI.Composition.CloudName","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.DefinitionValidator","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Extension/Extension.Manifest","MsPortalFx/Globalization","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Parts/Parts","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Base/JQueryExtensions"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function pr(n,t){if(!lr)return!1;var i=t&&t.supportsWebWorkers&&
t.supportsWebWorkers.toLowerCase()==="true",r=Math.random()<(t&&t.flightWebWorkers||0);return n=n.toLowerCase(),ar==="true"?ci.indexOf(n)!==-1||i||r:!1}function wr(n){return n&&n.formatCulture===ir&&n.displayLanguage===tr}function br(n){return n.replace(/\\/g,"\\\\").replace(/\'/g,"\\'")}function kr(n,t){var i=new ni;return new dt(n,t,i)}function dr(n){return kt[n]||(kt[n]={})}function gr(n){for(var r=oi["*"].slice()||[],u=0,t=n.obsoleteBundlesBitmask;t;t>>=1,u++)t%2&&i.pushUnique(r,oi[u]);return r}function li(n,r){var u=dr(n.name);return u[r]||(u[r]=i.union(r&1&&gr(n),r&2&&i.union(sr,t.patchUris)))}function nu(n,t,i){for(var r=[],u=Q(),f=function(){r.length<t&&(u=u.then((function(){if(r.length<t)return i().then((function(n){r.push(n)})).catch((function(n){nt.error(n,6)}))})))},e=0;e<t;e++)f();return{getItem:function(){return Q.delay(or).then(f),r.pop()},size:function(){return r.length}}}function tu(n,t,i){n.styleSheets&&v.injectStyles(t,{extensionWindowId:i,styleSheets:n.styleSheets.map((function(
n){return{file:"",content:n}}))})}var it=r.Extension,vi=r.TelemetryContext,st=i.Base,yi=st.UriBuilder,ut=MsPortalEarly.ExtensionLoader,et=st.Constants,pi=et.ExtensionNames.Hubs,vt=st.Diagnostics,wi=vt.Telemetry,yt=r.Rpc,bi=i.Hubs.Notifications.NotificationStatus,ti=i.Helpers.Deferred,b,k,lt,kt,dt,ft,gt,ai,ni,at;t.patchUris=[];var g=window,ot=g.fx.getTimestamp,ki=i.isNullOrUndefined,di=$("head"),nt=vt.createLog(n),d=g.fx.environment,gi=d.cdn,nr="FxCdnIndex"+gi.index,tr=l.displayLanguage,ir=l.formatCulture,rr=!!d.trace.extensionmanager,iu=rr?function(n){nt.verbose(n)}:i.noop,ii=st.getVersionFromString,ri=ii(d.sdkVersion),ui=i.getFeatureValue("extloadtimeout"),pt=ui&&parseInt(ui)||9e4,ur=d.relex,fi=a.Shell,fr="data-extensionname",ht="ExtensionManager",wt=3,ct=(wt+1)*2,rt=wi,er=vi,ei=2e4,or=4e3,oi=d.extensionScripts,sr=d.postScripts,si=0,hi=0,hr=ot(),cr=i.forEachKey,bt=i.startTimer,lr=[g.Worker,g.fetch,g.Promise,g.Blob].indexOf(undefined)===-1,ci=(d.features.webworker||"").toLowerCase().split(
","),ar=ci.shift(),vr=i.isFeatureEnabled("maxconcurrentiframe"),yr=document.getElementById("extensionIframes"),tt=ut.ExtensionLoadTracePoints;t.canUseManifest=wr;t.escapeSingleQuote=br;t.initialRetryDelay=pt,(function(n){n[n.NotLoaded=0]="NotLoaded";n[n.FirstResponseReceived=1]="FirstResponseReceived";n[n.ManifestReceived=2]="ManifestReceived";n[n.Initialized=3]="Initialized";n[n.Error=4]="Error"})(t.ExtensionReadyState||(t.ExtensionReadyState={}));b=t.ExtensionReadyState,(function(n){n[n.None=0]="None";n[n.FirstResponseNotReceived=1]="FirstResponseNotReceived";n[n.ManifestNotReceived=2]="ManifestNotReceived";n[n.InvalidExtensionName=3]="InvalidExtensionName";n[n.InvalidManifest=4]="InvalidManifest";n[n.InvalidDefinition=5]="InvalidDefinition";n[n.FailedToInitialize=6]="FailedToInitialize";n[n.TooManyRefreshes=7]="TooManyRefreshes";n[n.TooManyBootGets=8]="TooManyBootGets";n[n.TimedOut=9]="TimedOut";n[n.MaxRetryAttemptsExceeded=10]="MaxRetryAttemptsExceeded";n[n.HomePageTimedOut=11]="HomePageTimedOut";
n[n.Unexpected=12]="Unexpected"})(k||(k={})),(function(n){n[n.Default=0]="Default";n[n.Part=1]="Part"})(t.ViewModelType||(t.ViewModelType={}));lt=t.ViewModelType;t.create=kr;kt={};t.getScriptUris=li;dt=(function(){function n(t,r,u){var e=this,c,l;this.initializedExtension=f.observable();this._readyState=b.NotLoaded;this._errorState=k.None;this._manifests=new i.Map;this._initializedDeferred=Q.defer();this._manifestLoaded=Q.defer();this._perfData={};this._initializeRequired=!1;this._bootGetCount=0;this._scriptErrors=[];this._bladeRedirectMap={};this._performanceData={};this._memoizedRPCEndPoint=i.memoizeQ((function(){var n=e.getWindowId();return Q(it.initializeEndPoint.invoke(e._rpcClient,n,undefined)).then((function(t){i.extend(e._perfData,t);var r=t&&t._msPortalFxDef;return r&&delete e._perfData._msPortalFxDef,r||it.getDefinitionEndPoint.invoke(e._rpcClient,n,undefined)})).then((function(n){var c=e.getManifest("assetTypes"),r=s.validateDefinition(n),t;if(r.valid()){var u=o.preprocessDefinition(
n,c,h.redirects()),l=e._perfData.totalTime=e._loadTimer(),f=new ai(e._rpcClient,e,u,l);tu(u,document,e.getWindowId());e._transitionStateTo(b.Initialized);e._clearExtensionReloadHandle();e._extensionInitializedTraceKey=rt.startTrace({source:ht,action:"ExtensionInitialized",name:e.name});e.initializedExtension(f);e._initializedDeferred.resolve(f)}else return t="The extension definition has validation errors. Errors: {0}".format(JSON.stringify(r.errors)),e._onError(k.InvalidDefinition,t),Q.reject(new i.Errors.Error(t))})).catch((function(n){return e._reloadFrame("message: {0}, stack: {1}".format(n.message,n.stack),k.FailedToInitialize),Q.reject(n)}))}));this._memoizedAcquireWindow=i.memoizeQ((function(){return vr?n.maxConcurrentAcquireWindow(e):e._acquireWindow()}));this._rpcClient=t;this.metadata=r;this._hostingContext=u;this._useWebWorker=pr(r.name,r.features);c=ut.earlyExtensionMap[r.name];c&&(this._loadTimer=bt(),l=c.frame,this._uri=l.src,this._window=new at(l.contentWindow,this.metadata.trustedHost,
function(n){return l.setAttribute("src",n)},c.messagePort),this._transitionStateTo(b.FirstResponseReceived),this._performanceData=c.performanceData)}return u.defineProperty(n.prototype,"cloudName",{get:function(){return this.metadata.cloudName},enumerable:!0,configurable:!0}),n.prototype.getVersion=function(){return this._extVersion},u.defineProperty(n.prototype,"initializeRequired",{get:function(){return this._initializeRequired},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"unloaded",{get:function(){return!this._window},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"name",{get:function(){return this.metadata.name},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"isTestExtension",{get:function(){return!!this.metadata.isTestExtension},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"isTestStamp",{get:function(){return!!this.metadata.isTestStamp},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"readyState",{get:function(
){return this._readyState},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),n.prototype.getBladeRedirect=function(n){return this._bladeRedirectMap[n&&n.toLowerCase()]},n.prototype.getManifest=function(n){return this._manifests.get(n)},n.prototype.setManifest=function(n,t){var r=this,i=t;return i.cloudName=this.cloudName,(i.redirects||[]).forEach((function(n){switch(n.type){case 2:case 3:var t=n.fromBlade;t&&(r._bladeRedirectMap[t.toLowerCase()]=n);break;case 4:case 5:h.addPartRedirect(r.name,n)}})),this._manifests.set(n,i),i},n.prototype._getBootScript=function(n){var i=JSON.stringify(ut.getBootEnvironment(this.effectiveFeatureFlags,n)),t=d.extensionEntryPointText+(";FxImpl.bootInitialize("+i+");");return this._useWebWorker&&(t=d.webWorkerPreambleText+"(window, "+JSON.stringify(t)+");"),t},n.prototype.ensureInitialize=function(){this._initializeRequired=!0},n.prototype.getManifestAsync=function(){return this.
_manifestLoaded.promise},n.prototype.whenInitialized=function(){return this._initializedDeferred.promise},n.prototype.onManifestReceived=function(n){var t=this._validateAndSetManifest(n,!1);t&&(this._initializeRequired?this._initialize():this._rpcClient.gcWindow(this.getWindowId()),this._initializeRequired=!0)},n.prototype._addTracePoint=function(n,t,i){var u=tt[n],f=this._performanceData[u]||0,r=0;switch(t){case 0:r=ot();break;case 1:r=f+1;break;case 2:r=f-1;break;case 3:r=i?1:0;break;case 4:r=i}this._performanceData[u]=r},n.prototype._initialize=function(){var n=this;return this._memoizedRPCEndPoint()},n.prototype.getOrLoadWindow=function(){var n=this;if(!this._window){this._addTracePoint(tt.LoadRequested,0);this._bootGetCount=0;this._retryAttempt=0;var t=this.metadata,i=t.features,f=d.trace.nonsecure||i&&i.nonsecure==="true",r=0,u=ut.createUri(t,this._extVersion);this._uri=u.uri;this.effectiveFeatureFlags=u.effectiveFeatureFlags;this._addTracePoint(tt.ExtensionUriUsed,4,this._uri);this.
_window=this._hostingContext.createExtensionWindow({getWindowId:function(){return it.getWindowId(t)},trustedHost:t.trustedHost,frameUri:this._uri,createIframe:function(){n._addTracePoint(tt.IFrameCreationBegin,0);var t=ut.createIframe(f);return n._addTracePoint(tt.IFrameCreationEnd,0),t},onLoad:function(){return n._readyState=b.NotLoaded,n._errorState=k.None,r++,r>ct?(n._onError(k.TooManyRefreshes,"The iframe for extension '{0}' refreshed/reloaded more than '{1}' times and has been unloaded.".format(n.name,ct)),!1):!0},onError:function(){n._reloadFrame("Extension Index page failed to load timed out in '{0}'ms.".format(ei),k.HomePageTimedOut)}});this._window.onDispose((function(){n._clearExtensionReloadHandle();n._initializedDeferred=Q.defer();n.initializedExtension(void 0);n._memoizedRPCEndPoint.clear();n._memoizedAcquireWindow.clear();rt.trace({source:ht,action:"ExtensionUnloaded",name:n.name,data:{currentState:n._readyState}});n._extensionInitializedTraceKey&&(rt.completeTrace(n._extensionInitializedTraceKey),
n._extensionInitializedTraceKey=null);var t="style[{0}='{1}']".format(fr,n.name);di.remove(t);n._window=null}));this._loadTimer=bt();this._startTime=ot();this._extensionReloadHandle=g.setTimeout((function(){n._addTracePoint(tt.IFrameReloadCount,1);n._reloadFrame()}),pt)}return this._window},n.prototype.noteScriptError=function(n){this._scriptErrors.push(n)},n.prototype._reloadFrame=function(n,t){var r=this,i;if(!this.unloaded&&this._readyState!==b.Initialized){if(!n&&!t){t=k.None;n="Failed to load extension after {1} attempts over {0} secs.";switch(this._readyState){case b.NotLoaded:t=k.FirstResponseNotReceived;n="First response was not received after a time of {0} secs.";break;case b.FirstResponseReceived:t=k.ManifestNotReceived;n="Manifest not received after {0} secs.";break;case b.ManifestReceived:t=k.TimedOut;n="Manifest was received, however failed to initialize the extension after {0} secs."}}this._retryAttempt>=wt&&(t=k.MaxRetryAttemptsExceeded);n=n.format(Math.round(this._loadTimer(
)/1e3),this._retryAttempt+1);this._clearExtensionReloadHandle();this._cleanupFrameForReload();this._retryAttempt<wt?(this._loadTimer=bt(),this._startTime=ot(),i=new yi(this._uri),this._retryAttempt++,i.query.setParameter(d.retryAttemptName,this._retryAttempt),this._window.refresh(i.toString()),this._onExtensionLoadingRetry&&this._onExtensionLoadingRetry(),this._extensionReloadHandle=g.setTimeout((function(){r._reloadFrame()}),pt),nt.warning("Reloading extension '{0}' from '{1}'. Retry attempt: {4}. ErrorState: {2}. Error: {3}.".format(this.name,this.uri,k[t],n,this._retryAttempt))):this._onError(t,n)}},n.prototype._cleanupFrameForReload=function(){this._transitionStateTo(b.NotLoaded);this._useWebWorker=!1;this._window.reloadChannel()},n.prototype.getWindow=function(){return this._window},n.prototype.getTrustedHost=function(){var n=this._window;return n&&n.getTrustedHost()},n.prototype.getWindowId=function(){return it.getWindowId(this)},n.prototype._acquireWindow=function(){return yt.internalClient.
acquireWindow(this.getWindowId(),0),this._manifestLoaded.promise.isPending()||(this._manifestLoaded=Q.defer()),this._manifestLoaded.promise},n.prototype.loadAsync=function(n){var r=this,t,i;return this.unloaded?(n||(n={}),t=n.manifest,t&&this._validateAndSetManifest(t,!0)?this.ensureInitialize():i=this._memoizedAcquireWindow(),this._initializedDeferred.promise):this.whenInitialized()},n.prototype.dispose=function(){this._window&&(this._window.dispose(),this._window=null)},n.prototype.processBootMessage=function(n){var r=!1,t=n.sdkVersion,s=n.extVersion,f,i,e,o,u;if(t&&s){this._addTracePoint(tt.BootGetReceived,0);f=n.bootVersion||1;i=void 0;try{i=ii(t);d.features.checksdkversion&&i.compareTo(ri)===1&&(e="The '{0}' extension at '{1}' was compiled with a newer version of the SDK ('{2}') than the shell ('{3}'). You may see unexpected results.",nt.warning(e.format(this.name,this.uri,i,ri)))}catch(h){nt.error("Invalid version information '{0}' specified by '{1}'.".format(t,this.name),0,h)}this.
_readyState!==b.NotLoaded&&(nt.warning("Unexpected bootget from '{0}' specified by '{1}', unexpected reload.".format(this.name,t)),this._cleanupFrameForReload());this._transitionStateTo(b.FirstResponseReceived);this._bootGetCount++;this._bootGetCount>ct&&this._onError(k.TooManyBootGets,"The iframe '{0}' sent more than '{1}' handshake messages over '{2}' attempts without making progress. it has been unloaded.".format(this.name,ct,this._retryAttempt));o=li(this.metadata,3);u=this._getBootScript(o);f===2?this._window.postMessage({data:u,kind:1},[this._window.getExternalPort()]):this._window.postMessage({signature:d.bootMessageSignature,kind:1,data:{scripts:[{data:u,kind:1}],stopListening:!0}});r=!0}else n.kind===5&&(this._addTracePoint(tt.BootGetPortReceived,0),this._window.postMessage({},[this._window.getExternalPort()]),r=!0);return r},n.prototype._validateAndSetManifest=function(n,t){var l=this,r=!1,e=c.validate(n),o,s,u,h,f;if(e.valid())if(this.name.toLowerCase()!==n.name.toLowerCase(
))o="The extension name defined in the manifest '{0}' (obtained from the <Extension> tag in PDL) does not match the name '{1}' used to identify the extension with the portal. Ensure that the name you specify in the <Extension> tag in PDL matches the one used in the extensions.json file to identify the extension with the portal.",this._onError(k.InvalidExtensionName,o.format(n.name,this.name));else{(this._readyState===b.Error||this._readyState===b.Initialized)&&(s="Extension manifest for '"+this.name+"' received at an incorrect point in time. "+("Current extension state: ExtensionReadyState."+b[this._readyState]+". ")+"This method should be called when the extension state is NotLoaded or FirstResponseReceived or ManifestReceived. "+("Callstack: "+i.getCurrentCallStack()),nt.error(s,5));try{ki(n.isPreview)&&(u=this.metadata.features,n.isPreview=(u&&u.preview||"").toLowerCase()==="true");t||cr(ur.cachedManifestTypes,(function(t){l.setManifest(t,n)}));h=this.setManifest("assetTypes",n);this.
_transitionStateTo(b.ManifestReceived);this._manifestLoaded.resolve(h);r=!0}catch(a){f="_validateAndSetManifest throws";nt.error(new i.Errors.Error({message:f,data:n,innerErrors:a}));this._onError(k.Unexpected,f)}}else e.errors.forEach(nt.error,nt),this._onError(k.InvalidManifest,"The extension manifest has validation errors.");return(r||!t)&&(this._addTracePoint(tt.ManifestReceived,0),this._addTracePoint(tt.InWebWorker,3,this._useWebWorker),this._window?rt.trace({source:ht,action:"ExtensionLoad",name:this.name,data:this._performanceData}):this._transitionStateTo(b.NotLoaded),this._extVersion=n.pageVersion),r},n.prototype._onError=function(n,t){var e=this,f="Failed to initialize extension '{0}' at '{1}'. ErrorState: {2}. Error: {3}.".format(this.name,this.uri,k[n],t),i=r.createError(f,{data:{previousState:this._readyState,hasInitializeTraceKey:this._initializeTraceKey?1:0,successfulExtensionLoads:hi,failedExtensionLoads:si,timeThisFileLoaded:hr,scriptErrors:this._scriptErrors,extVersion:
this._extVersion,timeThisExtensionStartedLoading:this._startTime,timeThisExtensionFailed:ot(),timeToFail:this._loadTimer()}}),u;nt.error(i,1);vt.Upload.flush();this._memoizedRPCEndPoint.clear();this._memoizedAcquireWindow.clear();this._manifestLoaded.reject(i);this._initializedDeferred.reject(i);this._readyState!==b.Error&&(this._transitionStateTo(b.Error,n),u=p.getNotificationManager(),u&&u.addClientNotification({title:fi.extensionError,description:fi.loadingError.format(this.name),status:bi.Error,timestamp:new Date,cloudName:et.DefaultCloudName}));this._addTracePoint(tt.ErrorCount,1);this.dispose()},n.prototype._transitionStateTo=function(n,t){var i=this;this._readyState=n;n===b.ManifestReceived?this._initializeRequired&&(this._initializeTraceKey=rt.startTrace({source:ht,action:"InitializeExtensions",name:this.name,data:{fxcdn:nr}})):n===b.Initialized?this._initializeTraceKey&&(this._perfData.extVersion=this._extVersion,rt.completeTrace(this._initializeTraceKey,this._perfData),this._initializeTraceKey=
null,hi++):n===b.Error&&(si++,this._initializeTraceKey&&(rt.cancelTrace(this._initializeTraceKey,{errorState:t}),this._initializeTraceKey=null));t&&(this._errorState=t)},n.prototype._clearExtensionReloadHandle=function(){this._extensionReloadHandle&&(g.clearTimeout(this._extensionReloadHandle),this._extensionReloadHandle=null)},n.maxConcurrentAcquireWindow=r.QConcurrent(2,2e3,(function(n){return n._acquireWindow()})),n})();t.ExtensionImpl=dt;ft=et.BladeNames.Hubs.ResourceMenuBlade;gt={};gt[pi]=[{partName:ft+"$"+ft,locator:h.resourceMenu.withLens(ft).withPartInstance(ft),getPartDefinition:function(n){return n.getBladeDefinition(ft).then((function(n){return n.lenses[0].partInstances[0].inline}))}}];ai=(function(){function n(n,t,i,u){var o=this,s,h;this.outstandingObjectCount=f.observable(0);this.metadataCount=f.observable(0);this._proxiedObjects=[];this._pools={};this._bladeDefMap={};this._partDefMap={};this._controlDefMap={};this._rpcClient=n;s=this._lifetime=new r.TriggerableLifetimeManager;
s.registerForDispose(this._extension=t);this.cloudName=t.cloudName;h=this.name=t.name;this.definition=i;this.loadTime=u;(gt[h]||[]).forEach((function(n){o._pools[n.locator.toString()]=nu(s,5,(function(){return n.getPartDefinition(o).then((function(t){var i=t.details;return Q(o.getPartViewModel(n.partName,{initialState:{},createSelectable:y.needContainerSelectable(i),createHubsInternalCloudNameProperty:e.needInternalProperty(h,i),partSize:t.initialSize,partLocation:2,collapsed:null,containerType:0}))}))}))}))}return u.defineProperty(n.prototype,"extension",{get:function(){return this._extension},enumerable:!0,configurable:!0}),n.prototype.canUseInputsSetParameters=function(n){var t=this._pools[n.toString()];return!t||!t.size()},n.prototype.getBladeRedirect=function(n){return this._extension.getBladeRedirect(n)},n.prototype.getWindow=function(){return this._extension.getWindow()},n.prototype.processMessages=function(){return it.pingEndPoint.invoke(this._rpcClient,this._extension.getWindowId(),
undefined)},n.prototype.dispose=function(){this._lifetime.dispose()},n.prototype.getManifest=function(n){return this._extension.getManifest(n)},n.prototype.getBladeDefinition=function(n){var f=this,r=this.definition,t=n.toLowerCase(),u=r.bladeMap[t],i;return u?Q(u):(i=this._bladeDefMap,i[t]||(i[t]=Q(it.getBladeDefinitionEndPoint.invoke(this._rpcClient,this._extension.getWindowId(),n)).then((function(n){return o.processBlade(r,f.getManifest("assetTypes"),n,h.redirects())})).then((function(n){var t=[];if(s.validateBlade(r,n,null,t),t.length)throw new Error("Invalid blade definition. Errors: "+t.join("\n"));return n})).finally((function(){delete i[t]}))))},n.prototype.getPartDefinition=function(n){var f=this,r=this.definition,t=n.toLowerCase(),u=r.partTypeMap[t],i;return u?Q(u):(i=this._partDefMap,i[t]||(i[t]=Q(it.getPartDefinitionEndPoint.invoke(this._rpcClient,this._extension.getWindowId(),n)).then((function(n){return o.processPart(r,f.getManifest("assetTypes"),n,h.redirects())})).then((function(
n){var t=[];if(s.validatePartType(n,t),t.length)throw new Error("Invalid part type definition. Errors: "+t.join("\n"));return n})).finally((function(){delete i[t]}))))},n.prototype.getControlDefinition=function(n){var i=this,t=this._controlDefMap;return t[n]||(t[n]=Q(it.getControlDefinitionEndPoint.invoke(this._rpcClient,this._extension.getWindowId(),n)).then((function(n){return o.processControl(i.definition,i.getManifest("assetTypes"),n)})).then((function(n){var t=[];if(s.validateControl(n,t),t.length)throw new Error("Invalid control definition. Errors: "+t.join("\n"));return n})).catch((function(i){return delete t[n],Q.reject(i)})))},n.prototype.getViewModel=function(n,t){return this._getViewModel(lt.Default,n,t)},n.prototype.getPartViewModel=function(n,t){var f,r,u;return t&&t.locator&&(f=this._pools[t.locator.toString()])&&!t.onInputsSetParameters&&!i.keysLength(t.initialState)&&(r=f.getItem(),r)?(u=t&&t.onViewModelAcquired,u&&u(r),ti().resolve(r).promise()):this._getViewModel(lt.Part,n,t)}
,n.prototype._getViewModel=function(n,t,i){var o=this,u,r,e;return(i=i||{},u=w.resolve(this,t,i.initialState,i.createSelectable),u)?u.then((function(n){if(i.onViewModelAcquired)i.onViewModelAcquired(n);return typeof i.partSize=="number"&&n&&n.content&&f.isObservable(n.content.size)&&n.content.size(i.partSize),i.onInputsSetParameters&&n&&n.updatePartInputValues&&(n.onInputsSetPromise=Q().then((function(){return n.updatePartInputValues(i.onInputsSetParameters.inputs,i.onInputsSetParameters.settings,i.onInputsSetParameters.traceOptions)}))),n})):(r=ti(),e=n===lt.Part?et.ViewModelTypes.PartViewModel:et.ViewModelTypes.ViewModel,it.getViewModelsDefinition.acquireObject(this._rpcClient,this._extension.getWindowId(),{type:e,containerType:i.containerType||0,name:t,initialState:i.initialState,createSelectable:i.createSelectable,createHubsInternalCloudNameProperty:i.createHubsInternalCloudNameProperty,telemetryContext:er.getState(),partSize:i.partSize,partLocation:i.partLocation,onInputsSetParameters:
i.onInputsSetParameters,collapsed:i.collapsed,flags:i.flags},i.onViewModelAcquired&&function(n){return i.onViewModelAcquired(n&&n.getValue())}).then((function(n){return o._proxiedObjects.push(n),n.getValue()})).then((function(n){r.resolve(n)}),(function(n){r.reject(n)})),r.promise())},n.prototype.releaseViewModel=function(n){i.disposeDisposable(n);var t=i.findIndex(this._proxiedObjects,(function(t){return t.getValue()===n}));t!==-1&&this._proxiedObjects.splice(t,1)[0].dispose()},n.prototype.isPreview=function(){return this.getManifest("assetTypes").isPreview},n})();ni=(function(){function n(){}return n.prototype.createExtensionWindow=function(n){var t=(n.createIframe||ut.createIframe)(),u=g.setTimeout(n.onError,ei),r,i;t.addEventListener("load",(function(t){g.clearTimeout(u);n.onLoad(t.originalEvent)}));t.addEventListener("error",(function(n){var t=n.originalEvent;nt.error(t.error,3,{message:t.message,filename:t.filename,colno:t.colno,lineno:t.lineno})}));t.setAttribute("src",n.frameUri);r=t.contentWindow;
i=new at(r,n.trustedHost||"*",function(n){t.setAttribute("src",n)});i.onDispose((function(){g.setTimeout((function(){try{yr.removeChild(t)}catch(n){}}),1e3)}));return i},n})();t.BrowserHostingContext=ni;at=(function(n){function t(t,i,r,u){var f=this;n.call(this,t);this._resettingChannel=!1;this._trustedHost=(i||"*").toLowerCase();this.refresh=r;this._resetChannel();u&&this._rpcChannel.swapPort(u);this.onDispose((function(){f._resettingChannel||f._resetChannel()}))}return __extends(t,n),t.prototype.postMessage=function(n,t){this.getValue().postMessage(n,this._trustedHost,t)},t.prototype.getTrustedHost=function(){return this._trustedHost},t.prototype.getChannel=function(){return this._rpcChannel},t.prototype.getExternalPort=function(){return this._externalPort},t.prototype.reloadChannel=function(){var n=new MessageChannel;this._rpcChannel.swapPort(n.port1);this._externalPort=n.port2},t.prototype._resetChannel=function(){var n=this;this._resettingChannel=!0;var t=this._rpcChannel,i=new MessageChannel,
r=this._rpcChannel=new yt.RpcChannel(i.port1);this._externalPort=i.port2;t&&t.dispose();this._resettingChannel=!1;this._rpcChannel.onDispose((function(){r===n._rpcChannel&&n.dispose()}))},t})(yt.DisposableValue);t.ExtensionWindow=at}));define("MsPortalImpl/Extension/ExtensionManager",["require","exports","f","i","o","$","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u,f,e,o,s){"use strict";function w(n){return u.keys(n||{}).filter((function(t){var i=n[t];return i&&!!i.manifest})).length}function et(n,t,i){p.Log.writeEntry2(2,n,t,i)}function ot(){return new d.ExtensionManagerImpl({createExtension:e.create})}var a=r.Extension,c=i.Base,g=c.Constants.ExtensionNames.Hubs,p=c.Diagnostics,nt=p.Telemetry,v=r.Rpc,l=window,b=l.fx,tt=b.early,h=p.createLog(n),it=n.normalize(undefined),rt=b.environment,k=nt.trace,ut=i.startTimer,ft="###BOOT###",y,d;(function(n){function r(n,i){var r={};return n&&(r["x-ms-effective-locale"]=
n),Q(c.Net2.ajax({uri:t.getUri(n,i),performRetry:!0,type:"GET",dataType:"json",contentType:"application/json",headers:r}))}function u(r){var u;return u=r==="assetTypes"?i=i||Q(t.promise).catch((function(n){return h.warning(n,6),null})).then((function(t){return w(t)?t:n.getManifestsAjax(undefined,r)})):n.getManifestsAjax(undefined,r),u.then((function(n){return n||{}})).catch((function(n){return h.error(n,7),{}}))}var t=tt.manifestCache,i;n.getManifestsAjax=r;n.getManifests=u})(y=t.Relex||(t.Relex={}));t.create=ot,(function(n){function t(n,t,i){return n.count=i.count-t.count,n.chars=i.chars-t.chars,n}var e=(function(){function n(n){var t=this;this.initializedExtensions=[];this._messageHandlers=[];this._isRpcStarted=!1;this._callbacksMap=new i.Map;this._callbacks=f.Callbacks();this._unloadCallbacks=f.Callbacks();this._allManifestsLoaded=Q.defer();this._manifestLoadStarted=Q.defer();this._ltm=new r.TriggerableLifetimeManager;this.manifestLoadComplete=!1;this._manifestsMap={};this._initializedExtensionMap=
{};this._createExtension=n.createExtension;n.skipRegisterManifest||a.registerManifestDefinition.register(v.client,null,(function(n,i){t._getExtensionByWindowId(i.srcWindowId).onManifestReceived(n)}));this._addExtensionBootReceiver();this.getHubsExtension=function(){return t.getExtensionByName(g,a.getHubsCloudName())}}return n.prototype.getExtension=function(n,t){return this._getExtensionByDescriptor({cloudName:t,name:n})},n.prototype.getManifestByName=function(n,t){var u=this,i=this._manifestsMap,r=JSON.stringify([].slice.call(arguments));return i[r]||(i[r]=this._manifestLoadStarted.promise.then((function(){return u.getExtension(n,t).getManifestAsync()})).catch((function(n){return delete i[r],Q.reject(n)})))},n.prototype.getExtensionByName=function(n,t,i){var f=this,r,u;return i=i||{},r=this._initializedExtensionMap,u=JSON.stringify([].slice.call(arguments)),r[u]||(r[u]=this._manifestLoadStarted.promise.then((function(){var i=f._getExtensionByDescriptor({cloudName:t,name:n});if(!i)throw new Error(
"extension {0}, in cloud {1} was not found".format(n,t));return i})).then((function(t){t.unloaded&&!i.onlyIfLoaded&&t.loadAsync();t.ensureInitialize();var e=t.whenInitialized();return i.timeout>0&&(e=Q(e).timeout(i.timeout,"Timed out waiting for extension '{0}' to load.".format(n))),e.then((function(){var n=f._getLoadedExtensionByWindowId(t.getWindowId()),i;return n&&(i=f._ltm.createChildLifetime(),n.extension.initializedExtension.subscribe(i,(function(n){n||(delete r[u],i.dispose())}))),n}))})).catch((function(n){return delete r[u],Q.reject(n)})))},n.prototype.initialize=function(n){var t=this,r,h,u,l;this._extensionsMap={};var p=this._createExtension,f={},b=i.isFeatureEnabled("extensionredirect")?n.extensions.filter((function(n){return!(f[n.name]=n.redirectTo)})):n.extensions,d=function(n){var r=n&&i.remove(t.initializedExtensions,n).length;r&&t._unloadCallbacks.fire(n);n&&(t.initializedExtensions.push(n),t._callbacks.fire(n))},e=b.map((function(n){var i=p(v.internalClient,n),r=i.getWindowId().toLowerCase(
);if(t._getExtensionByWindowId(r))throw new Error("Extension with window ID '"+r+"' has already been registered.");return i.initializedExtension.subscribeAndRun(t._ltm,d),t._extensionsMap[r]=i}));return o.redirects(f),this.startRpc(),r=this._getExtensionByWindowId(a.getHubsWindowId()),r&&r.loadAsync().then((function(){v.internalClient.acquireWindow(r.getWindowId())})),h=ut(),n.useCachedManifests?(u=y.getManifests("assetTypes"),this._callbacksMap.has("assetTypes")||this._callbacksMap.set("assetTypes",{initialPromise:u,callbacks:new c.Callbacks})):u=Q({}),u.then((function(n){k({source:"ExtensionManager",action:"CachedManifestCount",actionModifier:s.ActionModifier.Default,data:w(n),duration:h()});e.forEach((function(t){var i=n[t.name];t.isTestExtension||t.isTestStamp?t.loadAsync():t.loadAsync(i)}))})),l=e.map((function(n){var i=n.getManifestAsync();return i.then((function(n){t._callbacksMap.has("assetTypes")&&t._callbacksMap.get("assetTypes").callbacks.fire(n)})),i})),this._manifestLoadStarted.resolve(
),Q.any([Q.allSettled(l),Q.delay(6e4)]).then((function(){t._allManifestsLoaded.resolve();t.manifestLoadComplete=!0}))},n.prototype.startRpc=function(){var n=this;this._isRpcStarted||(this._isRpcStarted=!0,v.start({originId:"fx",loadChannelFunction:function(t){var i=n._getExtensionByWindowId(t);if(!i)throw new Error("Failed to load extension '{0}'.".format(t));return i.getOrLoadWindow().getChannel()}}))},n.prototype.unloadExtension=function(n){n.dispose()},n.prototype.on=function(n,t){var u=this,f,i,r;return this._callbacksMap.has(n)||(f=void 0,f=rt.relex.cachedManifestTypes[n]?y.getManifests(n).then((function(t){k({source:"ExtensionManager",action:"CachedManifestTypeCount",actionModifier:n,data:w(t)});var i=u.getExtensions().map((function(i){var e=i.isTestExtension||i.isTestStamp?null:t[i.name],r=e&&e.manifest,f;if(r)i.setManifest(n,r),u._callbacksMap.get(n).callbacks.fire(r);else return i.loadAsync(),f=i.getManifestAsync(),f.then((function(t){u._callbacksMap.get(n).callbacks.fire(t)})),f.timeout(
2e3)})).filter((function(n){return!!n}));return Q.allSettled(i)})):this._allManifestsLoaded.promise,this._callbacksMap.set(n,{initialPromise:f,callbacks:new c.Callbacks})),i=this._callbacksMap.get(n),t&&(r=function(n){try{t(n)||i.callbacks.remove(r)}catch(u){h.error(u,11)}},i.callbacks.add(r),this.getExtensions().forEach((function(t){var i=t.getManifest(n);i&&r(i)}))),i.initialPromise},n.prototype.onLoad=function(n){var i=this,r=this.initializedExtensions.slice(0),t=function(r){try{n(r)||i._callbacks.remove(t)}catch(u){h.error("onLoad event callback has thrown an exception.",2,u)}};this._callbacks.add(t);r.forEach((function(t){n(t)}))},n.prototype.onUnload=function(n){var i=this,t=function(r){try{n(r)||i._unloadCallbacks.remove(t)}catch(u){h.error("onUnload event callback has thrown an exception.",3,u)}};this._unloadCallbacks.add(t)},n.prototype.refreshManifests=function(n){return y.getManifestsAjax(n)},n.prototype.dispose=function(){this._ltm.dispose();this._messageHandlers&&(this._messageHandlers.
forEach((function(n){l.removeEventListener("message",n)})),this._messageHandlers=[])},n.prototype._getExtensionByWindowId=function(n){var t=this._extensionsMap;return t&&t[n.toLowerCase()]},n.prototype._getExtensionByDescriptor=function(n){return this._getExtensionByWindowId(a.getWindowId(n))},n.prototype._getLoadedExtensionByWindowId=function(n){return this.initializedExtensions.first((function(t){return t.extension.getWindowId()===n}))},n.prototype._getExtensionByWindow=function(n){return this.getExtensions().first((function(t){var i=t.getWindow();return!!i&&i.getValue()===n}))},n.prototype.getExtensions=function(){var n=this;return u.keys(this._extensionsMap||{}).map((function(t){return n._extensionsMap[t]}))},n.prototype._addExtensionBootReceiver=function(){var n=this,t=function(t){var r=n._getExtensionByWindow(t.source),u=t.data||{},i=u.data||u,s=i.signature||u.signature,f,e,o;if(s===ft&&u.kind!==3){if(t.source===l.window){h.error("Portal Load Error: Error loading script",i.kind,JSON.stringify(
i));return}if(!r){f=n.getExtensions().map((function(n){return n.name}));e=l.location.origin;h.error("Received a boot message from '"+t.origin+"' which is not associated to an extension("+f+"). ShellOrigin: ("+e+")",9,JSON.stringify(i));return}if(o=r.processBootMessage(i),!o){var c="{0} Origin: {1}".format(JSON.stringify(u),t.origin),a=r&&"/"+r.getWindowId(),v=it+a;et(v,c,10);r.noteScriptError({kind:2,error:i});return}}};l.addEventListener("message",t,!1);this._messageHandlers.push(t)},n.prototype.getMessageTelemetry=function(n){var i=this._m;return n&&i?{sent:t({startOffBy:n.sent.startOffBy,stopOffBy:i.sent.startOffBy},n.sent,i.sent),recv:t({},n.recv,i.recv)}:i},n})();n.ExtensionManagerImpl=e})(d=t.Internal||(t.Internal={}))}));define("MsPortalImpl/Svg/Startup/Ellipsis.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><circle cx='14.4' cy='7.6' r='1.6'/><circle cx='8' cy='7.6' r='1.6'/><circle cx='1.6' cy='7.6' r='1.6'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/Search.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M21.8.6c1.5.4 2.8 1 4.1 1.7 1.2.8 2.4 1.7 3.4 2.7 1 1.1 1.9 2.2 2.7 3.5.7 1.3 1.3 2.6 1.7 4.1.4 1.5.6 3 .6 4.6 0 2-.3 4-1 5.8s-1.7 3.6-3 5.1l19.1 19.2c.3.3.5.7.5 1.1 0 .4-.2.8-.5 1.1-.3.3-.7.5-1.1.5-.4 0-.8-.2-1.1-.5l-19-19.1c-1.6 1.3-3.3 2.3-5.1 3-1.9.7-3.8 1-5.8 1-1.6 0-3.1-.2-4.6-.6-1.5-.4-2.8-1-4.1-1.7-1.3-.7-2.4-1.6-3.5-2.7-1-1.1-1.9-2.2-2.7-3.5-.7-1.3-1.3-2.6-1.7-4.1-.4-1.5-.6-3-.6-4.6 0-1.6.2-3.1.6-4.6.4-1.5 1-2.8 1.7-4.1C3.1 7.3 4 6.1 5 5c1-1 2.2-1.9 3.5-2.7C9.8 1.6 11.1 1 12.6.6c1.5-.4 3-.6 4.6-.6s3.1.2 4.6.6zm.9 29.5c1.7-.7 3.2-1.7 4.5-3s2.3-2.8 3-4.5c.7-1.7 1.1-3.5 1.1-5.5 0-1.9-.4-3.8-1.1-5.5-.7-1.7-1.7-3.2-3-4.5s-2.8-2.3-4.5-3C21 3.4 19.2 3 17.2 3s-3.8.4-5.5 1.1C10 5 8.5 6 7.3 7.3S5 10 4.2 11.7c-.7 1.7-1.1 3.5-1.1 5.5 0 1.9.4 3.8 1.1 5.5.7 1.7 1.7 3.2 3 4.5s2.8 2.3 4.5 3c1.7.7 3.5 1.1 5.5 1.1s3.7-.4 5.5-1.2z'/><\/g><\/svg>"}})
);define("_generated/Less/MsPortalImpl.Controls/Controls/SimpleButton.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxc-simplebutton{display:inline-block;-webkit-user-select:none;min-width:80px;text-align:center;line-height:22px;position:relative}.fxs-button-icon{display:inline-block;height:12px;width:12px}.fxs-button-icon-left{margin-right:5px}.fxs-button-icon-right{margin-left:5px}.fxs-button-spinner{height:10px;width:10px;display:inline-block;position:absolute;right:8px}.fxs-button-text-hide{display:none}")}));define("MsPortalImpl.Controls/Controls/SimpleButton",["require","exports","f","o","ko","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl.Controls/Controls/Base/OptionsBase","_generated/Less/MsPortalImpl.Controls/Controls/SimpleButton.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var h=i.disposeDisposable,t="fxc-simplebutton",s="fxs-button-text",c="<span>"+i.encodeAttribute(
e.Button.validating)+"<\/span><div class='fxs-button-spinner' data-bind='image: MsPortalFx.Base.Images.Loading.Spinner()'><\/div>",l='<div class=\'fxs-button fxt-button\' role=\'button\' data-bind=\'visible: data.visible, css: { "fxs-button-disabled": $disabled, "fxs-portal-button-primary": data.primary, "fxs-button-default": !ko.unwrap(data.primary), "fxs-inner-dotted-border": !ko.unwrap($disabled) }, attr: { tabindex: $tabIndex, "aria-disabled": $disabled, title: data.text }\'><!-- ko if: data.icon() && data.icon().position === 0 --><div class=\'fxs-button-icon fxs-button-icon-left\' data-bind=\'image: MsPortalFx.Base.Images.CustomImageWithOptions(data.icon().image, {customClass: "fxs-escapeShadow"})\'><\/div><!-- /ko -->'+("<span class="+s+" data-bind='text: data.text'><\/span>")+"<!-- ko if: data.icon() && data.icon().position === 1 --><div class='fxs-button-icon fxs-button-icon-right' data-bind='image: MsPortalFx.Base.Images.CustomImageWithOptions(data.icon().image, {customClass: \"fxs-escapeShadow\"})'><\/div><!-- /ko --><!-- ko if: data.loading -->"+
("<div class=fxs-button-validating>"+c+"<\/div>")+"<!-- /ko --><\/div>",a=(function(n){function i(i,r,u){n.call(this,i,r,u);this._events=[];this.element.addClass(t).html(l);var f=this.element.findByClassName("fxs-button");this.options.ariaLabel.subscribeAndRun(this.ltm,(function(n){f.attr("aria-label",n?n:null)}));this.options.loading.subscribeAndRun(this.ltm,(function(n){f.findByClassName(s).toggleClass("fxs-button-text-hide",n)}));this._attachEvents();this._bindDescendants()}return __extends(i,n),r.defineProperty(i.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._detachEvents(),this._cleanElement(t),n.prototype.dispose.call(this))},i.prototype._attachEvents=function(){var n=this,t,i;this._detachEvents();t=function(n){return u.isObservable(n)?n():n};i=function(i){i.stopPropagation();i.preventDefault();!t(n.$disabled)&&n.options.onClick&&t(n.options.onClick)(
)};this._events.push(this.element.setEvents([f.default.click,i],[f.default.keypress,function(n){(n.keyCode===13||n.keyCode===32)&&i(n)}]))},i.prototype._detachEvents=function(){h(this._events);this._events=[]},i})(o.Widget);n.Widget=a})(s||(s={})),s}));define("MsPortalImpl/Svg/Startup/Close.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14 3.3L12.7 2 8 6.7 3.3 2 2 3.3 6.7 8 2 12.7 3.3 14 8 9.3l4.7 4.7 1.3-1.3L9.3 8z'/><\/g><\/svg>"}}));define("MsPortalImpl/Services/Services.Settings",["require","exports","f","i","o","ko","FxHubs/HubsSettingsSchema","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Storage"],(function(n,t,i,r,u,f,e,o,s){"use strict";function et(n){return function(t){this[t]=n}}function yt(){return i.map(l,i.identity)}function pt(n){return a[
n+1e3]}function wt(n){return l[n]}function bt(n){var t={manager:new p.InMemorySettingsManagerImpl,stores:[8,9,13,]};return p.createUserSettingsManager(new p.UserSettingsManagerImpl(n),[t])}function kt(n,t){if(!t||!t.length)return Q({});var i=t.map(n.queryStore,n);return Q.all(i).then((function(n){var i={};return n.forEach((function(n,r){i[t[r]]=n})),i}))}var c=i.Base,rt=c.Constants,ut=c.Diagnostics,w=i.Hubs.Notifications.NotificationStatus,k=c.Net2,ft=i.tryImmediateResolve,ot=window,d=ot.fx,h=o.Services.Settings,b=d.environment,g=i.isFeatureEnabled,st=g("inmemorysettings"),ht=b.version,ct=c.getVersionFromString(ht),v=b.settingsBaseUri+"{0}"+b.settingsUriQuery,nt=v.format("/Update"),tt=v.format("/Select"),lt=v.format("/Clear"),at=v.format("/ClearAll"),y=ut.createLog(n),it=d.early,vt=it&&it.preloadSettings,l,a,p;ct.revision=0;l={General:0,Blade:1,Part:2,LensState:3,Startboard:4,SharedPart:5,HubsExtension:6,CrossTenant:7,JourneySession:8,EditScopeSession:9,Favorites:10,DashboardInventory:11,FileUpload:
12};a=[];i.forEachKey(l,(function(n,t){a[t]=n})),(function(){for(var t,i,n=0;n<100;n++)t="Dashboard"+n,i=n+1e3,l[t]=i,a[i]=t})();t.getAllStoreIds=yt;t.getDashboardStoreName=pt;t.getDashboardStoreId=wt;t.createUserSettingsManager=bt;t.queryStores=kt,(function(n){function bt(n,t,i){return new it(new d(new p(b.createWithWriteDeleteBufferTimeout(n,i),t)))}function l(n){var t=a[n];if(!t)throw new Error("Invalid store: "+n);return t}function ot(n,t){var r={},u;return i.forEachKey(t||{},(function(t,i){var f=l(t);r[f]=i;n&&delete n[f];u=r})),u}function ht(n){var i={},t;return n.keys.forEach(et(null),i),t={},t[n.store]=i,t}function kt(n,t){var u=i.merge(n,t),r={settingsToSet:{},settingsToDelete:{}};return r=u.reduce((function(n,t){return v(n.settingsToSet,n.settingsToDelete,t.settingsToSet),v(n.settingsToDelete,n.settingsToSet,t.settingsToDelete),n}),r),[r]}function v(n,t,r){r&&i.forEachKey(r,(function(u){var f=parseInt(u),o=r[f],e;n&&(n[f]||(n[f]={}),ct(o,n[f]));t&&(e=t[f],e&&(yt(o,e),i.isEmpty(e)&&delete
t[f]))}))}function ct(n,t){i.forEachKey(n,(function(n,i){t[n]=i}))}function yt(n,t){i.forEachKey(n,(function(n){delete t[n]}))}function dt(n,t,i){var r={};return r[t]=i,{store:n,settings:r}}function ut(n){return JSON.parse(JSON.stringify(n))}var e,o,t,pt,p,wt,b,d,it;n.createUserSettingsManager=bt;n.getSettingStoreName=l;n.convertSettingQueryToDictionary=ht;n.updateDictionary=v;n.updateSettingsDictionary=ct;n.sanitizeSettingsDictionary=yt;e=(function(){function n(){this._eventsTriggered=f.observableArray()}return u.defineProperty(n.prototype,"eventsTriggered",{get:function(){return this._eventsTriggered},enumerable:!0,configurable:!0}),n.prototype._fireEvent=function(n,t,i){var r={status:i,title:n,description:t,timestamp:new Date,cloudName:rt.DefaultCloudName};this.eventsTriggered.push(r)},n.prototype._fireError=function(n){this._fireEvent(h.useInMemorySettings,n||h.settingsCallFailed,w.Error)},n})();n.SettingsManagerVeryBase=e;t=(function(n){function t(t){n.call(this);o?this._baseManager=t||o:
(this._baseManager=undefined,this._eventsTriggered=undefined)}return __extends(t,n),u.defineProperty(t.prototype,"eventsTriggered",{get:function(){var n=this._baseManager;return n&&n.eventsTriggered||this._eventsTriggered},enumerable:!0,configurable:!0}),t.prototype.flushSettings=function(){var n=this._baseManager;return Q(n&&n.flushSettings())},t.prototype.dispose=function(){this._baseManager&&(this._baseManager.dispose(),this._baseManager=null)},t.prototype.setSettings=function(n){var t=this._baseManager;t&&t.setSettings(n)},t.prototype.deleteSettings=function(n,t){var i=this._baseManager;i&&i.deleteSettings(n,t)},t.prototype.queryStore=function(n){var t=this._baseManager;return Q(t&&t.queryStore(n))},t.prototype.clearSettings=function(){var n=this._baseManager;return Q(n&&n.clearSettings())},t})(e);n.SettingsManagerBase=t;o=new t;pt=(function(n){function t(){n.apply(this,arguments);this._maps={}}return __extends(t,n),t.prototype.setSettings=function(n){var t=n.settings,r;t&&(r=this._getMap(
n.store),i.forEachKey(t,(function(n,t){r.set(n,JSON.stringify(t))})))},t.prototype.queryStore=function(n){var i=this._getMap(n),t={};return i.forEach((function(n,i){t[i]=JSON.parse(n)})),Q(t)},t.prototype.deleteSettings=function(n){if(n.keys){var t=this._getMap(n.store);n.keys.forEach((function(n){t.delete(n)}))}},t.prototype.clearSettings=function(){return Q(this._maps={})},t.prototype._getMap=function(n){return this._maps[n]=this._maps[n]||new i.Map},t})(t);n.InMemorySettingsManagerImpl=pt;p=(function(n){function t(t,i){n.call(this,t);this._initialize(i)}return __extends(t,n),t.prototype.queryStore=function(n){return this._getManager(n).queryStore(n)},t.prototype.deleteSettings=function(n){this._getManager(n.store).deleteSettings(n)},t.prototype.setSettings=function(n,t){this._getManager(n.store).setSettings(n,t)},t.prototype.clearSettings=function(){return Q.all(this._managers.map((function(n){return n.clearSettings()})))},t.prototype._initialize=function(n){var t=this;this._managersDictionary=
{};this._managers=[this._baseManager];n&&n.forEach((function(n){t._managers.push(n.manager);n.stores.forEach((function(i){t._managersDictionary[i]=n.manager}))}))},t.prototype._getManager=function(n){return this._managersDictionary[n]||this._baseManager},t})(t);n.RoutingSettingsManager=p;wt=(function(n){function t(t,r){var u=this,f;r===void 0&&(r=vt);n.call(this);this._ajaxState=0;this._memoizedQueryStore=i.memoizeQ((function(n){var t=i.startTimer();return u._ajax(tt,[n]).then((function(i){u._setAjaxState(1);var f=i&&i.content&&i.content[n]||{},r=t();return r>5e3&&y.warning("Request to store '"+n+"' took more than 5s to complete.\n                                                    Request time: "+r+"ms.\n                                                    Response size: "+(i&&i.jqXHR&&i.jqXHR.responseText.length)),f})).catch((function(n){return u._setAjaxState(2,n,"queryStore(duration:"+t()+")"),u._fireEvent(h.useInMemorySettings,h.querySettingsCallFailed,w.Error),Q({})}))}));this._storageService=
t;r&&(f={},i.forEachKey(r,(function(n,t){f[n]=i.tryImmediateResolve(Q(t),(function(n){return u._setAjaxState(1),n}),(function(t){return i.Helpers.isXMLHttpRequestLike(t)&&k.isRetryable(t)||y.error(new i.Errors.Error({message:"Early Failed to preload store '"+n+"'.",innerErrors:t}),1),u._memoizedQueryStore(n)}))})),this._preloadStores=f)}return __extends(t,n),t.prototype._ajax=function(n,t){var u=this;return!t&&(n===nt||n===tt)?Q.reject(r.createError("Invalid setting ajax call uri: "+n+", data: "+i.getObjectDescriptor(t))):Q(k.ajaxExtended({uri:n,headers:{"x-ms-user-settings-session":this._storageService.getValue(s.ComponentName.UserSettingsService,"x-ms-user-settings-session",1)||""},type:"POST",dataType:"json",data:t&&JSON.stringify(t),contentType:"application/json;charset=utf-8",performRetry:!0})).then((function(n){return u._storageService.setValue(s.ComponentName.UserSettingsService,"x-ms-user-settings-session",n.jqXHR.getResponseHeader("x-ms-user-settings-session"),1),n})).catchError(i.Errors.
AjaxError,(function(r){return r.jqXHR.status===400&&y.error("Setting _ajax 400 occurred. uri: "+n+", data: "+i.getObjectDescriptor(t,!0)+"."),Q.reject(r)}))},t.prototype._setAjaxState=function(n,t,r){n>this._ajaxState&&(this._ajaxState=n,n===2&&y.error(new i.Errors.Error({message:r+" Setting is transitioned into HasFailRequests state. All further querystore/updatesetting will be in-memory mode.",innerErrors:t})))},t.prototype.queryStore=function(n){var i=l(n),t,r;return this._ajaxState>=2?Q({}):(t=this._preloadStores,r=t&&t[i],r||this._memoizedQueryStore(i))},t.prototype.clearSettings=function(){var t=this,n=this._preloadStores,r;return n&&u.keys(n).forEach((function(t){delete n[t]})),this._memoizedQueryStore.clear(),r=i.startTimer(),this._ajax(g("clearallusersettings")?at:lt).catch((function(n){t._setAjaxState(2,n,"clearSetting(duration:"+r()+"):");t._fireError(h.clearSettingsCallFailed)}))},t.prototype.updateSettings=function(n){var f=this,r,t,u;return this._ajaxState===1&&(r=this._preloadStores,
t={save:ot(r,n.settingsToSet),remove:ot(r,n.settingsToDelete)},t.save||t.remove)?(u=i.startTimer(),this._ajax(nt,t).catch((function(n){return f._setAjaxState(2,n,"updateSettings(duration:"+u()+"):"),Q.reject(n)}))):Q()},t})(e);n.UserSettingsManagerImpl=wt;b=(function(n){function t(t,i,r,u){var f=this;n.call(this,null);this._primitiveSettingsManager=t;this._sequencer=i(kt,(function(n){return f._executeMethod(n[0])}),r,!0,{optionalDataInterval:u})}return __extends(t,n),t.createWithWriteDeleteBufferTimeout=function(n,i,r){var u=i!==undefined?i:5e3,f=r!==undefined?r:3e5;return new t(n,function(n,t,i,r,u){return new c.Debouncer(n,t,i,r,u)},u,f)},t.prototype.queryStore=function(n){return this._primitiveSettingsManager.queryStore(n)},t.prototype.setSettings=function(n,t){if(!i.isEmpty(n.settings)){var r={};r[n.store]=n.settings;this._sequencer.execute([{settingsToSet:r,settingsToDelete:{}}],t===1)}},t.prototype.deleteSettings=function(n,t){n.keys&&n.keys.length&&this._sequencer.execute([{settingsToDelete:
ht(n),settingsToSet:{}}],t===1)},u.defineProperty(t.prototype,"eventsTriggered",{get:function(){return this._primitiveSettingsManager.eventsTriggered},enumerable:!0,configurable:!0}),t.prototype.flushSettings=function(){return this._sequencer.flush()},t.prototype.clearSettings=function(){var t=this,n=Q.defer();return this.flushSettings().finally((function(){t._primitiveSettingsManager.clearSettings().finally((function(){n.resolve()}))})),n.promise},t.prototype.dispose=function(){this.flushSettings();n.prototype.dispose.call(this)},t.prototype._executeMethod=function(n){return this._primitiveSettingsManager.updateSettings(n)},t})(t);n.SequencingSettingsManager=b;d=(function(n){function t(t){var r=this;n.call(this,t);this._cache={};this._activeUpdatePromises=new i.Map;this._uniqueId=1;this._memoizedQueryPromises=i.memoizeQ((function(n){var t=r._verifySettings()?r._baseManager.queryStore(n):Q({});return i.tryImmediateResolve(t,(function(t){return r._updateCaches(n,t)}))}))}return __extends(t,n),t.prototype.
queryStore=function(n){return this._memoizedQueryPromises(n)},t.prototype.setSettings=function(n,t,i){this._execute(this._setSettingsInternal,n,t,i)},t.prototype._setSettingsInternal=function(n,t,i,r){var f=this,e=this._writeSettingsToCache(n,!0),u=function(){f._baseManager.setSettings(e,t)};r?(u(),this._resolveSetPromise(i)):this._executeIfBaseManagerCallIsAllowed(u,i)},t.prototype._resolveSetPromise=function(n){var t=this._activeUpdatePromises.get(n);t&&(t.resolve(),this._activeUpdatePromises.delete(n))},t.prototype._execute=function(n,t,i,r){var o=this,e=this._uniqueId++,u,f;this._activeUpdatePromises.set(e,Q.defer());t&&(u=t.store,f=function(){n.call(o,t,i,e,r)},this._cache[u]?f():ft(this.queryStore(u),f))},t.prototype.deleteSettings=function(n,t){this._execute(this._deleteSettingsInternal,n,t)},t.prototype._deleteSettingsInternal=function(n,t,i){var r=this;this._deleteSettingsFromCache(n);this._executeIfBaseManagerCallIsAllowed((function(){r._baseManager.deleteSettings(n,t)}),i)},t.
prototype.clearSettings=function(){var n=this,t=Q.defer();return this.flushSettings().finally((function(){return Q(n._baseManager.clearSettings()).finally((function(){n._cache={};n._memoizedQueryPromises.clear();t.resolve()}))})),t.promise},t.prototype.flushSettings=function(){var t=this,n=[];return this._activeUpdatePromises.forEach((function(t){return n.push(t)})),Q.all(n).then((function(){return t._baseManager.flushSettings()}))},t.prototype._updateCaches=function(n,t){return this._writeSettingsToCache({store:n,settings:t}),this._cache[n]},t.prototype._verifySettings=function(){var n=this._baseManager===o;return st||n?(this._fireEvent(h.useInMemorySettings,n?h.noBaseManager:h.inMemorySettingsMode,w.Warning),!1):!0},t.prototype._executeIfBaseManagerCallIsAllowed=function(n,t){n();this._resolveSetPromise(t)},t.prototype._deleteSettingsFromCache=function(n){var t=this._cache[n.store];n.keys&&t&&n.keys.forEach((function(n){delete t[n]}))},t.prototype._writeSettingsToCache=function(n,t){if(n){var r=
this._cache[n.store]||(this._cache[n.store]={}),u={};return n.settings&&i.forEachKey(n.settings,(function(n,i){t&&(r[n]===i||JSON.stringify(r[n])===JSON.stringify(i))||(r[n]=u[n]=i)})),{store:n.store,settings:u}}return null},t})(t);n.CachingSettingsManagerImpl=d;it=(function(n){function t(t){n.call(this,t)}return __extends(t,n),t.prototype.queryStore=function(n,t){return i.tryImmediateResolve(this._baseManager.queryStore(n),(function(n){return t?n:ut(n)}))},t.prototype.querySettings=function(n){return n.keys&&n.keys.length>0?this.queryStore(n.store,!0).then((function(t){var i={},r;return t&&(r=n.keys.filter((function(n){return n in t})),r.forEach((function(n){i[n]=t[n]}))),ut(i)})):this.queryStore(n.store)},t.prototype.querySetting=function(n,t){return this.querySettings({store:n,keys:[t]}).then((function(n){if(n){var i=n[t];return i===undefined?null:i}return null}))},t.prototype.setSettings=function(n,t){this._baseManager.setSettings(ut(n),t)},t.prototype.setSetting=function(n,t,i,r){this.setSettings(
dt(n,t,i),r)},t})(t);n.ExtendedSettingsManager=it})(p=t.Internal||(t.Internal={}))}));define("MsPortalImpl/Svg/Library/Feedback.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 15 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M13.903 2.152a2.626 2.626 0 0 0-.936-.651c-1.62-.674-3.959.165-5.425 2.246C5.289 1.028 2.594.517 1.094 2.152c-2.997 3.264.756 7.552 3.717 9.987 1.167.96 2.211 1.632 2.67 1.84V14l.016-.008s.016.007.022.008v-.021c1.62-.735 10.561-7.277 6.384-11.827z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Library/LaunchCurrent.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 15 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8.883.942v1.586h3.118L6.314 8.214a.792.792 0 1 0 1.121 1.122l5.545-5.545v2.833h1.586V.942H8.883z'/><path d='M12.01 6.064a.316.316 0 0 0-.344.068l-.946.946a.316.316 0 0 0-.092.223v3.746c0 .601-.489 1.09-1.09 1.09H3.272c-.601 0-1.09-.489-1.09-1.09V6.07c0-.601.489-1.09 1.09-1.09h4.762a.315.315 0 0 0 .223-.092l.946-.946a.316.316 0 0 0-.223-.539H3.272A2.67 2.67 0 0 0 .605 6.07v4.977a2.67 2.67 0 0 0 2.667 2.667h6.266a2.67 2.67 0 0 0 2.667-2.667V6.355a.319.319 0 0 0-.195-.291z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Library/Person.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M35.859 10.269c0 5.671-4.638 10.269-10.359 10.269S15.142 15.94 15.142 10.269 19.779 0 25.5 0c5.721 0 10.359 4.598 10.359 10.269m-2.785 13.789L25.5 34.578l-7.574-10.52H7.001V50H44V24.058z' class='msportalfx-svg-c15'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Library/Signout.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 15 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M12.133 3.033a.995.995 0 1 0-1.408 1.408 4.543 4.543 0 0 1 1.336 3.225 4.544 4.544 0 0 1-1.336 3.225A4.547 4.547 0 0 1 7.5 12.227a4.54 4.54 0 0 1-3.224-1.336A4.544 4.544 0 0 1 2.94 7.666a4.543 4.543 0 0 1 1.336-3.225.995.995 0 1 0-1.408-1.408 6.537 6.537 0 0 0-1.92 4.633 6.535 6.535 0 0 0 1.92 4.633A6.537 6.537 0 0 0 7.5 14.218h.004a6.53 6.53 0 0 0 4.628-1.919 6.534 6.534 0 0 0 1.919-4.633 6.534 6.534 0 0 0-1.918-4.633zM7.5 8.662c.55 0 .996-.446.996-.996V1.655a.996.996 0 0 0-1.992 0v6.011c0 .55.446.996.996.996z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/AllServices.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M19.432 22.112h27.119v6.307H19.432zm0 13.875h27.119v6.307H19.432zm0-27.75h27.119v6.307H19.432z' class='msportalfx-svg-c04'/><circle opacity='.6' cx='6.818' cy='39.152' r='3.784' class='msportalfx-svg-c15'/><circle opacity='.6' cx='6.818' cy='11.907' r='3.784' class='msportalfx-svg-c15'/><circle cx='6.818' cy='25.53' r='3.784' class='msportalfx-svg-c16'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/CaretUp.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M1 8.1l.7.8L6 4.6l4.3 4.3.7-.8-5-5z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/Console.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M22.988 42.926h25v3.5h-25zM2.412 8.075L4.887 5.6l17.677 17.677-2.475 2.475z'/><path d='M2.578 38.777L20.256 21.1l2.475 2.474L5.053 41.252z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/DoubleChevron.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 8 8.4' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><g data-name='Layer 1'><path d='M4 3.7l-4 4 .7.7L4 5l3.3 3.4.7-.7-4-4z'/><path d='M4 0L0 4l.7.7L4 1.4l3.3 3.3L8 4 4 0z'/><\/g><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Error.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 9 9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><circle cx='4.5' cy='4.5' r='4.5' class='msportalfx-svg-c22'/><circle cx='4.5' cy='6.438' r='.697' class='msportalfx-svg-c01'/><path d='M4.604 2.186h-.729l.186 3.232h.878l.186-3.232z' class='msportalfx-svg-c01'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/Hamburger.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M0 3h18v1H0zm0 5h18v1H0zm0 5h18v1H0z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Help.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 22 22' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M11 0C4.93 0 0 4.93 0 11s4.93 11 11 11 11-4.93 11-11S17.07 0 11 0zm0 20.43c-5.2 0-9.43-4.23-9.43-9.43S5.8 1.57 11 1.57 20.43 5.8 20.43 11 16.2 20.43 11 20.43zm3.14-11.79c0 1.13-.52 2.18-1.46 2.96-.58.48-.89 1.1-.89 1.75v.79h-1.57v-.79c0-1.13.52-2.18 1.46-2.96.58-.48.89-1.1.89-1.75 0-.87-.7-1.57-1.57-1.57-.95 0-1.85.46-2.54 1.29l-1.21-1C8.24 6.16 9.57 5.5 11 5.5c1.73 0 3.14 1.41 3.14 3.14zm-2.35 7.86c0 .43-.35.79-.79.79s-.79-.35-.79-.79.35-.79.79-.79.79.36.79.79z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/Hyperlink.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M4.992 9.819l8.018-7.991v4.005H14V0H8.167v1h4.038L4.232 8.987l.76.833z'/><path d='M12.993 13.03H1.01V1.028h4.823V0H0v14h14V8.167h-1.007v4.863z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Notifications.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 22 22' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path opacity='.9' d='M18.86 17.29V7.86C18.86 3.52 15.33 0 11 0S3.14 3.52 3.14 7.86v9.43H1.57v1.57h6.29C7.86 20.59 9.27 22 11 22s3.14-1.41 3.14-3.14h6.29v-1.57h-1.57zm-14.15 0V7.86c0-3.47 2.82-6.29 6.29-6.29s6.29 2.82 6.29 6.29v9.43H4.71zM11 20.43c-.87 0-1.57-.7-1.57-1.57h3.14c0 .86-.7 1.57-1.57 1.57z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/Plus.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8 18h2v-8h8V8h-8V0H8v8H0v2h8z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Settings.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 22 22' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M19.2 10.6v.8l2.8 1.7-1.7 4.1-3.2-.7-.5.5.7 3.2-4.2 1.8-1.7-2.8h-.8L8.9 22l-4.1-1.7.7-3.2-.5-.5-3.2.7L0 13.1l2.8-1.7v-.8L0 8.9l1.7-4.1 3.2.7.5-.5-.7-3.3L8.9 0l1.7 2.8h.8L13.1 0l4.1 1.7-.7 3.2.5.5 3.2-.7L22 8.9l-2.8 1.7zM17.9 12v-2l2.6-1.6-.9-2.2-2.9.7c-.2-.3-.5-.5-.7-.8-.2-.2-.5-.5-.8-.7l.7-2.9-2.2-.9L12 4.1h-2L8.4 1.5l-2.3.9.7 2.9c-.3.3-.5.5-.7.8-.3.2-.5.4-.7.7l-3-.7-.9 2.3L4.1 10v2l-2.6 1.6.9 2.2 2.9-.7c.2.3.5.5.7.8.2.2.5.5.8.7l-.7 2.9 2.2.9 1.6-2.6h2l1.6 2.6 2.2-.9-.7-2.9c.3-.2.5-.5.8-.7.2-.2.5-.5.7-.8l2.9.7.9-2.2-2.4-1.6zM11 6.9c.6 0 1.1.1 1.6.3s.9.5 1.3.9.7.8.9 1.3.3 1 .3 1.6-.1 1.1-.3 1.6-.5.9-.9 1.3-.8.7-1.3.9-1 .3-1.6.3-1.1-.1-1.6-.4-.9-.5-1.3-.9-.7-.8-.9-1.3-.3-1-.3-1.6.1-1 .4-1.5.5-.9.9-1.3.8-.7 1.3-.9.9-.3 1.5-.3zm0 7c.4 0 .8-.1 1.1-.2.3-.1.6-.4.9-.6.3-.3.5-.6.6-.9.1-.3.2-.7.2-1.1s-.1-.8-.2-1.1c-.1-.5-.3-.8-.6-1-.3-.3-.6-.5-.9-.6-.3-.1-.7-.2-1.1-.2s-.8.1-1.1.2c-.4.1-.7.3-.9.6-.3.2-.5.5-.6.9-.1.3-.2.7-.2 1.1s.1.8.2 1.1c.1.4.3.7.6.9.3.3.6.5.9.6.3.2.7.3 1.1.3z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/SmileyHappy.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 32 32' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M16 0C7.16 0 0 7.16 0 16s7.16 16 16 16 16-7.16 16-16S24.84 0 16 0zm0 30C8.28 30 2 23.72 2 16S8.28 2 16 2s14 6.28 14 14-6.28 14-14 14zm6-16c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-12 0c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm14.93 6.47C23.29 23.74 19.91 26 16 26s-7.29-2.26-8.93-5.53l1.79-.89C10.17 22.19 12.87 24 16 24s5.83-1.81 7.15-4.43l1.78.9z'/><\/g><\/svg>"}}));define("MsPortalImpl/Svg/Startup/Star.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M6 .3l1.5 4.3 4.5.1-3.6 2.7 1.3 4.3L6 9.1l-3.7 2.6 1.3-4.3L0 4.7l4.5-.1z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Base/Base.KnockoutExtensions",["require","exports","ko","$","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u){"use strict";var f;return (function(){i.bindingHandlers.commands={update:function(n,t){var e=r(n),f=t(),o,s;if(f&&f.group){e.on(u.default.fxcontextmenurequest,o=function(n){var o,t;o=i.unwrap(f.viewModel);t=r.Event(u.default.fxrightclick);t.clientX=n.clientX;t.clientY=n.clientY;e.trigger(t,{commandGroup:f.group,viewModel:o,entityType:2});n.preventDefault();n.stopPropagation()});i.utils.domNodeDisposal.addDisposeCallback(n,s=function(){e.off(u.default.fxcontextmenurequest,o)})}}}})(f||(f={})),f}));define("MsPortalImpl/Controls/ControlBindings",["require","exports","ko"],(function(n,t,i){"use strict";var r;return (function(){function n(n,i){t[n]=i}function f(n,t){var r=i.unwrap(n()),f;if(r){if(f=t[r.controlType],!f)throw new Error("Unsupported ControlType in formControl binding handler: "+r.controlType+".");return u[f]}}function e(n,t,i,r,u,e){var s=f(t,e),
o;if(s)return o=$(n),o.attr("data-formelement",o.attr("data-bind")),s.init(n,t,i,r,u)}function o(n,t,i,r,u,e){if(n){var o=f(t,e);if(o)return o.update(n,t,i,r,u)}}var u=i.bindingHandlers,t={},r;n(127,"pcAccordion");n(20,"pcArtifactLinks");n(106,"pcAsyncFileUpload");n(16,"pcAttachment");n(38,"pcButton");n(63,"pcChart");n(7,"pcCheckBoxField");n(75,"pcConsole");n(40,"pcCopyableLabel");n(83,"pcCreatorAndSelector");n(85,"pcCreatorAndSelectorV2");n(23,"pcCustomHtmlField");n(91,"pcCustomValueSlider");n(111,"pcCustomRangeSlider");n(25,"pcDatePickerField");n(26,"pcDateTimePickerField");n(27,"pcDateTimeRangePickerField");n(92,"pcDayPickerField");n(76,"pcDeleteAssetConfirmation");n(33,"pcDiffEditor");n(32,"pcDockedBalloon");n(65,"pcDonut");n(3,"pcDropDownField");n(99,"pcDurationPickerField");n(15,"pcSection");n(37,"pcEditor");n(120,"pcEssentials");n(82,"pcFileDownloadButton");n(28,"pcFileUpload");n(81,"pcFileUploadWidget");n(12,"pcFilterComboField");n(55,"pcGallery");n(67,"pcGraph");n(103,"pcGrid2");
n(125,"pcEditableGrid");n(130,"pcArrayGrid");n(98,"pcGroupDropDownField");n(77,"pcHeroBanner");n(19,"pcHistory");n(84,"pcHotSpot");n(108,"pcIFrame");n(113,"pcIFrame2");n(78,"pcInfoBox");n(121,"pcIntuneAppFileUpload");n(118,"pcLegend");n(88,"pcHotSpot");n(87,"pcInfoBox");n(104,"pcList2");n(58,"pcLogStream");n(68,"pcMap");n(109,"pcMediaPlayer");n(115,"pcMenu");n(69,"pcMetrics");n(122,"pcMonitorChart");n(126,"pcMonitorChartV2");n(13,"pcMultiLineTextField");n(8,"pcMultiselectDropDownField");n(79,"pcNotice");n(10,"pcNumericTextBoxField");n(29,"pcOAuthButtonField");n(4,"pcOptionsGroupField");n(70,"pcPairedTimeline");n(94,"pcPairedTimelineBadges");n(5,"pcPasswordField");n(39,"pcCheckBox");n(42,"pcDropDown");n(43,"pcFilterCombo");n(54,"pcGrid");n(56,"pcListView");n(110,"pcMarkdown");n(45,"pcMultiLineTextBox");n(46,"pcMultiselectDropDown");n(47,"pcNumericTextBox");n(48,"pcOptionPicker");n(49,"pcPassword");n(50,"pcRangeSlider");n(52,"pcSlider");n(53,"pcTextBox");n(57,"pcTreeView");n(112,"pcPartPinner");
n(80,"pcPicker");n(128,"pcPill");n(129,"pcPillCollection");n(123,"pcPillList");n(89,"pcPreviewTag");n(71,"pcProgressBar");n(31,"pcQueryBuilder");n(72,"pcQuotaGauge");n(9,"pcRangeSliderField");n(93,"pcSearchBox");n(114,"pcResourceFilter");n(1,"pcFormSection");n(11,"pcSelectorField");n(60,"pcSettings");n(100,"pcSimpleButton");n(97,"pcChart");n(61,"pcSingleSetting");n(73,"pcSingleValueGauge");n(6,"pcSliderField");n(95,"pcSpecComparisonTable");n(21,"pcSplitter");n(17,"pcStringListField");n(124,"pcResourceDropDown");n(101,"pcTextBlock");n(2,"pcTextField");n(24,"pcTimePickerField");n(30,"pcTokenComboBox");n(62,"pcToolbar");n(105,"pcTree2");n(22,"pcTriStateCheckBox");n(116,"pcVideo");n(107,"pcWizard");n(119,"pcHeatMap");n(201,"pcFileShareDropDown");r={};[127,20,16,7,83,85,23,91,111,25,26,27,92,3,99,15,120,201,81,12,98,124,19,108,113,110,13,8,10,29,4,5,128,129,123,89,9,1,11,6,21,17,2,112,24,30,22].forEach((function(n){return r[n]=t[n]}));u.pcControl={init:function(n,i,r,u,f){return e(n,i,r,u,f,t)}
,update:function(n,i,r,u,f){return o(n,i,r,u,f,t)}};u.formElement={init:function(n,t,i,u,f){return e(n,t,i,u,f,r)},update:function(n,t,i,u,f){return o(n,t,i,u,f,r)}}})(r||(r={})),r}));define("MsPortalImpl/Controls/ControlBindings.Async",["require","exports","ko","MsPortalImpl/Widgets/Widgets.Common"],(function(n,t,i,r){"use strict";var u;return (function(n){function o(n,t,i,r){e.push({name:t,moduleId:n+i,initOptions:r})}function t(n,t,i){o("MsPortalImpl.Controls/",n,t,i)}function u(n,t,i){o("MsPortalImpl/Controls/",n,t,i)}function s(t){n.portalControlBindings.forEach((function(n){i.bindingHandlers[n.name]=r.getAsyncBindingHandler(n.moduleId,n.initOptions,t)}))}var e=[],f={controlsDescendantBindings:!1};t("pcAccordion","Controls/Accordion");t("pcButton","Controls/Forms/Button",f);t("pcChart","Controls/Visualization/Chart");t("pcCheckBoxField","Fields/CheckBoxField");t("pcConsole","Controls/Console");t("pcCopyableLabel","Controls/Forms/CopyableLabel");t("pcCreatorAndSelector","Fields/CreatorAndSelectorField");
t("pcCreatorAndSelectorV2","Fields/CreatorAndSelectorFieldV2");t("pcCustomHtmlField","Fields/CustomHtmlField");t("pcCustomValueSlider","Fields/CustomValueSliderField");t("pcCustomRangeSlider","Fields/CustomRangeSlider");t("pcDatePickerField","Fields/DatePickerField");t("pcDateTimePickerField","Fields/DateTimePickerField");t("pcDateTimeRangePickerField","Fields/DateTimeRangePickerField");t("pcDayPickerField","Fields/DayPickerField");t("pcDiffEditor","Controls/Documents/DiffEditor");t("pcDockedBalloon","Controls/DockedBalloon");t("pcDonut","Controls/Visualization/Donut");t("pcDropDownField","Fields/DropDownField");t("pcDurationPickerField","Fields/DurationPickerField");t("pcEditor","Controls/Documents/Editor");t("pcFileUpload","Controls/Forms/FileUpload");t("pcFilterComboField","Fields/FilterComboField");t("pcFormSection","Fields/SectionField",f);t("pcGallery","Controls/Lists/List1/Gallery");t("pcGraph","Controls/Visualization/Graph");t("pcGrid","Controls/Lists/Grid1/Grid1");t("pcGrid2",
"Controls/Lists/Grid2/GridB");t("pcEditableGrid","Controls/Lists/Grid2/Grid2.EditableGrid.ctl");t("pcArrayGrid","Controls/Lists/Grid2/Grid2.ArrayGrid.ctl");t("pcHeatMap","Controls/HeatMap");t("pcIFrame","Controls/IFrame");t("pcIFrame2","Controls/IFrameV2");t("pcLegend","Controls/Visualization/Legend");t("pcListView","Controls/Lists/List1/ListView");t("pcLogStream","Controls/LogStream");t("pcMap","Controls/Visualization/Map");t("pcMediaPlayer","Controls/AzureMediaPlayer");t("pcMenu","Controls/Lists/Menu");t("pcMetrics","Controls/Visualization/Metrics");t("pcMonitorChart","Controls/Visualization/MonitorChart/MonitorChart");t("pcMonitorChartV2","Controls/Visualization/MonitorChartV2/MonitorChartV2");t("pcMultiLineTextField","Fields/MultiLineTextField");t("pcMultiselectDropDownField","Fields/MultiselectDropDownField");t("pcNumericTextBoxField","Fields/NumericTextBoxField");t("pcOAuthButtonField","Fields/OAuthButtonField");t("pcOptionsGroupField","Fields/OptionsGroupField");t("pcPairedTimeline",
"Controls/Visualization/PairedTimeline");t("pcPairedTimelineBadges","Controls/Visualization/PairedTimelineBadges");t("pcPartPinner","Controls/PartPinner");t("pcPasswordField","Fields/PasswordField");t("pcPreviewTag","Controls/PreviewTag");t("pcProgressBar","Controls/Visualization/ProgressBar");t("pcQueryBuilder","Controls/Data/QueryBuilder");t("pcQuotaGauge","Controls/Visualization/QuotaGauge");t("pcRangeSliderField","Fields/RangeSliderField");t("pcSearchBox","Controls/SearchBox");t("pcResourceFilter","Controls/ResourceFilter");t("pcSection","Fields/Section");t("pcSelectorField","Fields/SelectorField");t("pcSettings","Controls/Settings");t("pcSimpleButton","Controls/SimpleButton");t("pcSingleSetting","Controls/SingleSetting");t("pcSingleValueGauge","Controls/Visualization/SingleValueGauge");t("pcSliderField","Fields/SliderField");t("pcSpecComparisonTable","Controls/SpecComparisonTable");t("pcSplitter","Fields/Splitter",f);t("pcStringListField","Fields/StringListField");t("pcTextBlock",
"Controls/TextBlock");t("pcTextBox","Controls/Forms/TextBox");t("pcTextField","Fields/TextField");t("pcTimePickerField","Fields/TimePickerField");t("pcToolbar","Controls/Toolbars/Toolbar");t("pcTreeView","Controls/Lists/Tree1/TreeView");t("pcTriStateCheckBox","Fields/TriStateCheckBox");t("pcMarkdown","Controls/Markdown");t("pcVideo","Controls/Video");u("pcAsyncFileUpload","Forms/AsyncFileUpload");u("pcDeleteAssetConfirmation","Controls.DeleteAssetConfirmation");u("pcEssentials","Controls.Essentials");u("pcFileDownloadButton","Controls.FileDownloadButton");u("pcFileUploadWidget","Forms/Controls.FileUpload");u("pcGroupDropDownField","Forms/GroupDropDown");u("pcResourceDropDown","Forms/ResourceDropDown");u("pcHeroBanner","Controls.HeroBanner");u("pcHotSpot","Controls.HotSpot",f);u("pcInfoBox","Controls.InfoBox");u("pcNotice","Controls.Notice");u("pcPicker","Controls.Picker");u("pcPickerV3","Controls.PickerV3");u("pcPill","Controls.Pill");u("pcPillCollection","Controls.PillCollection");u("pcPillList",
"Controls.PillList");u("pcTokenComboBox","Forms/Controls.TokenComboBox");u("pcWizard","Controls.Wizard");u("pcIntuneAppFileUpload","Forms/IntuneAppFileUpload");u("pcFileShareDropDown","Storage/FileShareDropDown");n.portalControlBindings=e;n.initialize=s})(u||(u={})),u}));define("MsPortalImpl/Services/Services.PortalIdleState",["require","exports"],(function(){"use strict";var n;return (function(n){function r(){return new t.PortalIdleStateServiceImpl(window,i)}var t,i;(function(n){var t=(function(){function n(n,t){var i=this;this._win=n;this._defaultPollMS=t;this._state=0;this._handleId=1;this._iteration=0;this._actions=[];this._win.addEventListener("blur",this._blurFunc=function(){i._blurStartTime=new Date;i._state=1;i._processCallbacks(i._defaultPollMS)});this._win.addEventListener("focus",this._focusFunc=function(){i._blurStartTime=null;i.signalBusy()})}return n.prototype.dispose=function(){var n=this._win;return n?(this._win=null,n.removeEventListener("blur",this._blurFunc),n.removeEventListener(
"focus",this._focusFunc),this._state=0,!0):!1},n.prototype.addCallbacks=function(n){var t=this._handleId++;return this._actions.push({key:t,value:n}),t},n.prototype.removeCallbacks=function(n){var t=this._actions,i=t.firstIndex((function(t){return n===t.key}));return i!==-1?(t.splice(i,1),!0):!1},n.prototype.signalBusy=function(){this._state===1&&(this._state=2,this._processCallbacks(5e3))},n.prototype.signalIdle=function(){this._blurStartTime||(this._blurStartTime=new Date);this._state=1;this._processCallbacks(0)},n.prototype._processCallbacks=function(n){var t=this,i;this._win&&(i=this._timeoutHandle,i&&this._win.clearTimeout(i),this._timeoutHandle=this._win.setTimeout((function(){t._timeoutHandle=null;try{t._processIteration()}finally{t._state!==0&&t._processCallbacks(t._defaultPollMS)}}),n))},n.prototype._processIteration=function(){var i=this,t,n;switch(this._state){case 2:this._state=0;t=function(n){n.onBusy(new Date)};break;case 1:this._state=1;t=function(n){n.onIdle(new Date,i._blurStartTime)}
;break;default:case 0:return}var r=function(n){var r=i._actions[n];r&&t(r.value)},u=this._actions.length,f=this._iteration%u;for(this._iteration++,n=f;n<u;n++)r(n);for(n=0;n<f;n++)r(n)},n})();n.PortalIdleStateServiceImpl=t})(t=n.Internal||(n.Internal={}));i=9e5;n.createInstance=r})(n||(n={})),n}));define("_generated/Less/MsPortalImpl/Widgets/CopyField.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-copyfield{display:none;position:absolute;width:24px;top:0;right:0}.fxs-copyfield .fxc-copyablelabel{padding:0}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox{display:none}.fxs-copyfield-container .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-textbox{display:block}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{padding:0;border:0;margin:0;height:auto;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button{padding:0;margin:0;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button:hover{background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button .fxc-copyablelabel-copyimage{padding:2px 6px 6px 2px}.fxs-copyfield-container .fxs-copyfield-wrapper{position:absolute;top:0;right:0;width:24px;height:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxc-copyablelabel{padding-right:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield-wrapper{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-copybutton{margin-right:-24px}.fxs-part-resourcesummary .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{font-size:13px}")})
);define("MsPortalImpl/Base/Base.KnockoutExtensions.Copy",["require","exports","f","i","ko","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/CopyField.css"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function a(n,t,r,e){var l="fxs-copyfield",a="fxs-copyfield-copied",s=$(t),o=$('<div class="'+l+'-wrapper" data-bind="stopBindings: true"><\/div>'),v=$('<div data-bind="pcCopyableLabel: $data" class="'+l+'"><\/div>'),h;v.appendTo(o);o.appendTo(s);h=new c.Forms.CopyableLabel.ViewModel(n,e);h.disabled(!0);u.reactor(n,(function(){var n=u.unwrap(r);h.value(n);s.toggleClass("fxs-copyfield-container",!i.isNullOrWhiteSpace(n))}));u.applyBindingsToDescendants(h,o[0]);n.registerForDispose([s.setEvents([f.default.fxcopybuttonclick,function(){s.addClass(a)}],[f.default.mouseleave,function(){s.removeClass(a)}]),function(){o&&(u.utils.cleanDescendantNodes(o),o.remove())}])}function e(n,t,i){function h(){e&&(e.dispose(),e=null);r&&(clearTimeout(r),r=null)}var c=$(n),
e,r,s={};s[f.default.mouseenter]=function(){r||(r=setTimeout((function(){h();a(e=new o,n,t(),i)}),l))};s[f.default.mouseleave]=h;c.on(s);u.utils.domNodeDisposal.addDisposeCallback(n,(function(){h();c.off(s)}))}var o=r.TriggerableLifetimeManager,s=i.Base,h=s.Diagnostics,c=i.ViewModels.Controls,v=h.createLog(n),l=100;t.initializeCopyBinding=e;u.bindingHandlers.copy={init:e}})(e||(e={})),e}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",["require","exports","f","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Hubs/UI.NotificationManager"],(function(n,t,i,r,u,f){"use strict";var s=i.Azure.ResourceManager,a=i.Base,v=a.Diagnostics,y=i.Services.Gallery,h=y.Constants,o=u.Gallery.Notifications,e=v.createLog(n),c=h.GalleryParametersKey,l=i.clone,p=r.observable,w=(function(){function n(n){this.status=p();this._cloudName=n}return n.prototype.execute=function(t){var f;if("data"in t&&"options"in t){if(f=t.data,c in f.outputParameters){var i=f.outputParameters[c],r=t.options[
h.GalleryOptionsKey],u=r&&r.launchingContext||{},a=this._getGalleryItemId(r.galleryItem);if(a||(e.warning("Null GalleryItemId."),a=i.deploymentName),u=l(u,!0),u.oldCreateApi=!0,u.galleryItemId=u.galleryItemId||a,this._validateOptions(i,r,f)){var y=l(f.outputParameters[i.selectedTemplateId],!0),p=n._findPropInObject(i.selectedTemplateId,r.deploymentTemplateFileUris),w={subscriptionId:i.subscriptionId,deploymentName:i.deploymentName||r.deploymentName,resourceGroupName:i.resourceGroupName,resourceGroupLocation:i.resourceGroupLocation,resourceProviders:JSON.parse(i.resourceProviders||null),parameters:y,templateLinkUri:!i.templateJson&&p||undefined,templateJson:i.templateJson,deploymentMode:1,launchingContext:u,cloudName:this._cloudName},v=new Date;return s.Deployments.deployTemplate(w).then((function(n){if(n===void 0&&(n={}),n.deploymentStatusCode===s.DeploymentStatusCode.Success){var i=(n.deployment||{}).properties||{},t=new Date(i.timestamp&&i.timestamp.valueOf()||n.timestamp&&n.timestamp.
valueOf());return t&&t.getTime()<=v.getTime()&&(t=new Date(v.getTime()+1)),{correlationId:i.correlationId||n.correlationId,timestamp:t}}return Q.reject()}))}return this._notify(o.createArgumentsValidationFailedMessage),Q.reject()}return this._notify(o.createOptionsNotSpecifiedMessage),e.error("Create options are not specified in the output parameters."),Q.reject()}return this._notify(o.createCommandMissingArgumentsMessage),e.error("The data or the options needed by the deployment command are not specified."),Q.reject()},n.prototype._validateOptions=function(t,i,r){var u="CsmCommand was rejected because ";if(t){if(!t.templateJson&&!t.selectedTemplateId)return e.error(u+"neither templateJson nor selectedTemplateId were specified."),!1;if(t.templateJson)try{JSON.parse(t.templateJson)}catch(f){return e.error(u+"templateJson was malformed."),!1}if(!t.subscriptionId)return e.error(u+"subscriptionId not specified."),!1;if(!t.resourceGroupName)return e.error(u+"resourceGroupName not specified."),
!1;if(!t.resourceGroupLocation)return e.error(u+"resourceGroupLocation not specified."),!1;if(i){if("subscriptionId"in i&&i.subscriptionId!==t.subscriptionId)return e.error(u+"subscriptionId was changed in the create process."),!1;if("resourceGroupName"in i&&i.resourceGroupName!==t.resourceGroupName)return e.error(u+"resourceGroupName was changed in the create process."),!1;if("resourceGroupLocation"in i&&i.resourceGroupLocation!==t.resourceGroupLocation)return e.error(u+"resourceGroupLocation was changed in the create process."),!1}}else return e.error(u+"galleryParameters not specified."),!1;if(i){if(i.deploymentTemplateFileUris){if(!t.templateJson&&!n._findPropInObject(t.selectedTemplateId,i.deploymentTemplateFileUris))return e.error(u+"templateJson wasn't defined and selectedTemplateId isn't defined in the deploymentTemplateFileUris."),!1}else return e.error(u+"deploymentTemplateFileUris not specified."),!1;if(!("deploymentName"in i))return e.error(u+"deploymentName not specified."),
!1}else return e.error(u+"configurationOptions not specified."),!1;return r?!0:(e.error(u+"create outputs not specified."),!1)},n._findPropInObject=function(n,t){n=n.toLowerCase();for(var i in t)if(t.hasOwnProperty(i)&&n===(i+"").toLowerCase())return t[i];return null},n.prototype._notify=function(n){var t={title:o.createResourceFailedLabel,description:n,status:i.Hubs.Notifications.NotificationStatus.Error};f.getNotificationManager().addClientNotification(t)},n.prototype._getGalleryItemId=function(n){var t=n&&n.id,r=(n||{}).launchingContext,i;return t=r&&r.galleryItemId||t,t&&(i=t.split("."),i.length>1&&(t="{0}.{1}".format(i[0],i[1]))),t},n.prototype._deployTemplate=function(n){var t=new Date;return s.deployTemplate(n).then((function(n){var i=n&&n.timestamp&&new Date(n.timestamp.valueOf());return i&&i.getTime()<=t.getTime()&&(i=new Date(t.getTime()+1)),{correlationId:n.correlationId,timestamp:i}}))},n})();t.CsmCommand=w}));define("MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector",
["require","exports","f","i","ko","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s){"use strict";function k(){return h||(h=i.require("MsPortalImpl/UI/Hubs/UI.CreateManager")),h}function d(n,t){u.bindingHandlers.fxParameterCollector={init:function(){return{controlsDescendantBindings:!1}},update:function(i,r,f,e,o){var s=u.unwrap(r()),h=o.$data.cloudName||u.observable();s&&new c($(i),s,n,t,h)}}}var v=f.Locator,y=r.Extension.CloudName,p=i.Base.Constants.ExtensionNames.Hubs,w=i.Base.Diagnostics,b=w.createLog(n),l=s.Part.Provisioning,h,a=(function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t})(o.ViewModel),c;t.ViewModel=a;c=(function(n){function t(t,r,f,o,s){var h,c,w;n.call(this,t,r||new a);h=r.privatePcPrBI;h.triggerProvisioningInStartboardPart.subscribe(this.ltm,(function(n){var t;if(n){var r=h.provisioningPartExtensionName(
),u=h.provisioningPartName(),e=v.forExtension(r,s.peek()).withPartType(u);r===p&&(n=i.clone(n,!0),y.addToModel(s.peek(),n));f.addPartToStartBoard({originPartLocator:e,model:n,modelContainsSensitiveData:!0,initialSize:2});t=f.getActiveJourney();t&&h.forceDiscardJourney()&&f.forceDiscardJourney(t.id)}}));c=function(){var n=new e.CsmCommand(s.peek());h.provisioningCommand(n)};h.triggerProvisioningCommand.subscribe(this.ltm,c);h.triggerProvisioningCommand.peek()&&u.ignoreDependencies(c);h.provisioningAttempted.subscribe(this.ltm,(function(n){if(n){var t=f.getActiveJourney();t&&h.forceDiscardJourney()&&f.forceDiscardJourney(t.id)}}));w=function(n){n&&(n.galleryParameters?k().then((function(t){return t.processResourceGroupChange(o,n.galleryParameters,n.configurationOptions,n.deploymentResponse,s.peek()).then((function(){h.provisioningCompleted({succeeded:!0})}),(function(n){h.provisioningCompleted({succeeded:!1,statusUnavailable:n===l.deploymentStatusUnavailable,pollingFailed:n===l.pollingFailed,errorMessage:
n})}))})):b.error("galleryParameters should be specified in the provisioningStarted object."))};h.provisioningStarted.subscribe(this.ltm,(function(n){w(n)}));w(h.provisioningStarted())}return __extends(t,n),t})(o.Widget);t.Widget=c;t.initialize=d}));define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding",["require","exports","f","o","a","ko","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(){function h(n,t){var i=f.unwrap(n()),r=l(i,t);return function(){return r}}function l(n,t){var f;if(n&&typeof n=="object")return f={},r.getOwnPropertyNames(n).forEach((function(r){i.isSerializableProperty(r)&&(e.isAllowedCssClassName(r)?f[r]=n[r]:r&&t.push(r))})),f;var o=String(n||""),s=o.split(" "),h=u.prototype.map.call(s,(function(n){return n=String(n||""),e.isAllowedCssClassName(n)?n:(n&&t.push(n),"")}));return h.join(" ")}function a(t,i){var r=t.getAttribute("data-bind")||"None",u=c.format(String(
t.tagName),r,i.join(", "));o.logToExtension(n,t,2,u,{})}var c="Sanitization error found in 'sanitizedCss' binding\nTag name: {0}; Binding attribute: \"{1}\"\nDisallowed class name(s): {2}",s=f.bindingHandlers,t=s.css;s.sanitizedCss={init:function(n,i,r,u,f){if(t.init){var e=h(i,[]);return t.init(n,e,r,u,f)}return null},update:function(n,i,r,u,f){var e=[],o=h(i,e);return e.length&&a(n,e),t.update(n,o,r,u,f)}}})(s||(s={})),s}));define("MsPortalImpl/Base/ClaimsIdentity",["require","exports","f","i","a","MsPortalImpl/Services/Services.Storage"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function e(n){var t=Q.defer(),i=new FileReader,u="data:image/jpeg;base64,";return i.onload=function(n){for(var i=n.target.result,r="",e=new Uint8Array(i),f=0;f<e.byteLength;f++)r+=String.fromCharCode(e[f]);try{atob(r);i=u+r}catch(o){if(o.code===5)i=u+btoa(r);else{t.reject(o);return}}t.resolve(i)},i.onerror=function(){t.reject(r.createError("Error reading thumbnail photo. Error:"+i.error))},i.
readAsArrayBuffer(n),t.promise}function o(n,t,i,r){var o=t,s,h;return n&&(s=f.ComponentName.Avatar,h=0,o=!r&&i.getValue(s,n,h),!o)?Q(u.ajax({uri:n,type:"GET",dataType:"binary",responseType:"arraybuffer",isBackgroundTask:!0,performRetry:!0,setAuthorizationHeader:{resourceName:"graph"}})).then((function(n){return e(n)})).catch((function(n){var i=n.jqXHR&&n.jqXHR.status;return i===404||i===403?t:Q.reject(n)})).then((function(t){return i.setValue(s,n,t,h),t})):Q(o)}var t=i.Base,u=t.Net2;n.getAvatarImage=o})(e||(e={})),e}));define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(t){function v(n){return h.test(n)}var e=i.Base,u=e.Diagnostics.createLog(n),o=/^[a-zA-Z][\w]*$/,s=i.isFeatureEnabled,h,f,c,l,a;t.canModifyExtensions=s("canmodifyextensions");h=/^(https?:)?\/\/localhost(\:\d+)?(\/|$)/;f=function(n,t){return(n&&n.toLowerCase())===(t&&t.toLowerCase())};t.isLocalhostUri=v;t.canAddGalleryPackages=s(
"canaddgallerypackages");c=(function(){function n(){}return n.prototype.isValid=function(){if(typeof this.name!="string")return u.error("Invalid extension name",1,this),!1;if(typeof this.uri!="string"||!this.uri)return u.error("Invalid extension uri",1,this),!1;if(!o.test(this.name))return u.error("Invalid extension name '{0}'. Expected pattern '{1}'".format(this.name,o),8),!1;return!0},n.prototype.isEqual=function(n){var t=n;return r.Extension.isEqualDescriptor(this,t)},n.prototype.updateWith=function(n){var t=n;this.name=t.name;this.uri=t.uri;this.obsoleteBundlesBitmask=t.obsoleteBundlesBitmask;this.features=t.features;this.trustedHost=t.trustedHost;this.startBoardParts=t.startBoardParts;this.isTestExtension=t.isTestExtension},n.prototype.markAsTestExtension=function(){this.isTestExtension=!0},n.prototype.logUsageWarning=function(){u.warning("Extension '{0}' is running untrusted code from '{1}'".format(this.name,this.uri),7,this)},n.prototype.normalizeCloudName=function(){r.Extension.
multiCloudEnabled&&(this.cloudName=this.cloudName||e.Constants.DefaultCloudName);this.trustedHost=this.trustedHost||"*"},n.create=function(t){var r=i.extend(new n,t);return r.normalizeCloudName(),r},n})();t.ExtensionMetadataExt=c;l=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n||{uri:""};return f(this.uri||"",t.uri)},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){u.warning("Untrusted gallery package '{0}' is running".format(this.uri),7,this)},n.create=function(t){var i=new n;return i.uri=t.uri,i},n})();t.GalleryPackageExt=l;a=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n;return f(this.uri,t&&t.uri)},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){u.warning("Untrusted patch '{0}' is running".format(this.uri),7,this)},n})();t.PatchExt=a})(u||(u={})),u}));define("MsPortalImpl/Services/Services.AssetManagement",
["require","exports","f","i","$","MsPortalImpl/Services/Services.AssetTypes"],(function(n,t,i,r,u,f){"use strict";function y(n){return new s(n,c.client)}var e=i.Base,c=r.Rpc,o=i.ViewModels.Services.ResourceTypes,h=e.Constants.ResourceTypes,l=e.Constants.ExtensionNames.Hubs,a=e.Diagnostics,v=a.createLog(n),s;t.createAssetManager=y;s=(function(){function n(n,t){var s=this,e;this._assetDeletedCallbacks=u.Callbacks();e=function(t,i,u){var c,e,a,y,p;u.reason=u.reason||"Received asset deletion notification from the extension '"+t+"'";c=s.handleAssetDeleted.bind(s);u.extensionName===l&&(i.cloudName=u.cloudName);e=u.assetId;a=u.assetType;a===r.AssetManager.resourceAssetType?(y=i.cloudName,p=void 0,p=o.isSubscriptionId(e)?h.Subscriptions:o.isResourceGroupId(e)?h.ResourceGroups:o.buildResourceTypeFromResourceId(e),p&&n.mapResourceIdToAssetId(e,y).then((function(n){c({cloudName:y,name:n.extensionName},n.assetType,n.assetId,u.reason)})).catch((function(n){var t=n&&n.message||"";t.indexOf(f.failedToFindAssetTypePrefix)!==
0&&v.warning(n)}))):c(i,a,e,u.reason)};t&&(r.AssetManager.notifyAssetDeletedDefinition.register(t,null,(function(n,t){var f=i.makeArray(n),u=t.srcWindowId,o=r.Extension.getDescriptor(u);f.forEach((function(n){e(u,o,n)}))})),r.AssetManager.hubsNotifyAssetDeletedDefinition.register(t,[r.Extension.getHubsWindowId()],(function(n,t){var r=i.makeArray(n),u=t.srcWindowId;r.forEach((function(n){e(u,{cloudName:n.cloudName,name:n.extensionName},n)}))})))}return n.prototype.onAssetDeleted=function(n){this._assetDeletedCallbacks.add(n)},n.prototype.markAssetDeleted=function(n,t,i,r){this.handleAssetDeleted(n,t,i,r)},n.prototype.handleAssetDeleted=function(n,t,i,r){this._assetDeletedCallbacks.fire(n,t,i,r)},n})();t.AssetManagerImpl=s}));define("MsPortalImpl/Services/Services.Permissions",["require","exports","f","i","FxHubs/Permissions"],(function(n,t,i,r,u){"use strict";var f;return (function(t){function w(n,t){return new l(n,t)}function b(n,t,i){return s.hasPermissionsToHubs.invoke(f.client,e,{entityId:n,requestedActions:
t,providedActions:null,cloudName:i})}function k(n,t){return s.getPermissionsToHubs.invoke(f.client,e,{entityId:n,cloudName:t})}function d(n){return s.isCoAdminEndpoint.invoke(f.client,e,{cloudName:n})}var a=r,o=a.Extension,h=i.Base,v=h.Diagnostics,f=r.Rpc,y=i.ViewModels.Services.ResourceTypes,c=u.PermissionChecker,s=u.Rpc,e=o.getHubsWindowId(),p=v.createLog(n),l;t.Internal={};t.createPermissionsManager=w;l=(function(){function n(n,t){var r=this,i;this._extensionManager=n;this._assetTypeService=t;i=u.createCachedPermissionsGetter(k);this._cachedPermissionsGetter=i;this._getPermissionsCallback=i.getPermissions.bind(i);o.hasPermissionsToShell.register(f.client,null,(function(n,t){var i=t.srcWindowId;return i!==e&&i!==h.Constants.Shell&&(n.cloudName&&p.warning("{0} should not pass cloud name".format(i)),n.cloudName=o.getDescriptor(t.srcWindowId).cloudName),r.hasPermission(n.entityId,n.requestedActions,n.cloudName)}))}return n.prototype.isCoAdmin=function(n){return d(n)},n.prototype.hasPermission=
function(n,i,r){return t.Internal.hasPermissionOverride?t.Internal.hasPermissionOverride(n,i):c.isRDFEAction(i)?b(n,i,r):y.isResourceManagerId(n,!0)?c.hasPermission(n,i,null,r,this._getPermissionsCallback):Q("The entity ID for hasPermission must be a resource ID, a subscription ID or a resource group ID")},n.prototype.getCachedPermissions=function(n){return this._cachedPermissionsGetter.getCachedPermissions(n)},n})()})(f||(f={})),f}));define("MsPortalImpl/UI/Commands/UI.CommandManager",["require","exports","f","i","ko","$","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(t){function w(n){return new c(n)}function l(n){var r,i,t;if((p?n.metaKey:n.ctrlKey)||(r=v.getSelection(),r.rangeCount&&!r.getRangeAt(0).collapsed)||(i=f(n.target),i.filter("input,textarea").length)||i.add(f(n.target).parents("a")).filter("a[href]:not([href='#']):not([href=''])").
length)return!0;n.preventDefault();n.stopPropagation();t=f.Event(h.default.fxcontextmenurequest);t.pageX=n.pageX;t.pageY=n.pageY;t.clientX=n.clientX;t.clientY=n.clientY;i.trigger(t)}var a=r.TriggerableLifetimeManager,v=window,y="<div class='fxs-commands-contextMenu'><\/div>",p=navigator.platform.indexOf("Mac")!==-1,c;t.createCommandManager=w;t.onContextMenu=l;c=(function(){function t(n){this._previouslyFocusedElement=u.observable();this._ltm=new a;this._body=f("body");this._desktop=n;this._initializeContextMenu()}return t.prototype.dispose=function(){this.stopListeningForEvents();this._ltm.dispose()},t.prototype.startListeningForEvents=function(){var u=this,n=this._body;n.on(h.default.fxcontextmenu,this._fxMenuEventHandler=function(n,t){u._showContextMenu(n,t)}).on(h.default.contextmenu,this._browserMenuEventHandler=function(n){l(n)});var t=this._contextMenuElement,i=this._desktop.portalWidget,r=i&&i.element;return r?r.append(t):n.append(t),this},t.prototype.stopListeningForEvents=function(
){var n=this._body;this._fxMenuEventHandler&&(n.off(h.default.fxcontextmenu,this._fxMenuEventHandler),this._fxMenuEventHandler=null);this._browserMenuEventHandler&&(n.off(h.default.contextmenu,this._browserMenuEventHandler),this._browserMenuEventHandler=null);this._contextMenu.hide();this._contextMenuElement.detach()},t.prototype.getFormTarget=function(){var t=this;return this._formTargetPromise||(this._formTargetPromise=i.require("../UI.PortalFormTarget",n).then((function(n){return new n.PortalFormTarget(t._desktop,t._ltm,t._previouslyFocusedElement)}))),this._formTargetPromise},t.prototype._initializeContextMenu=function(){this._contextMenuElement=f(y);this._contextMenu=new s.Widget(this._contextMenuElement);this._contextMenu.hide()},t.prototype._showContextMenu=function(n,t){var y=this,h=t.contextMenu?t.contextMenu:this._contextMenu,v=h.options.menuItems,r,u,p,c=n.clientX,l=n.clientY,a,i,s;if(t.commands&&t.commands.length!==0){if(t.srcElement){for(a=t.srcElement,i=a,f(a).hasClass("fxs-tile")&&
(i=f(a).find(".fxs-part")[0]);i&&typeof i.focus!="function";)i=f(i).closest("[tabindex]")[0];this._previouslyFocusedElement(i)}p=t.formTarget&&t.formTarget.length>0?function(){return Q(e.getBladeContentWidget(t.formTarget))}:function(){return y.getFormTarget()};h.hide();v.splice(0,v().length);do u=u?u.parentNode:n.target,r=f(u).data(o.CompositionInstanceDataName);while(!r&&u.parentNode);(o.isContextMenuContainer(r)&&r.beforeActivateCommandMenuItems(t),t.commands.forEach((function(t){y._shouldShowCommand(t)&&(t.activate(),t.bind(new e.CompositionInstanceCommandContext(n.target,p,r)),v.push(t))})),h.options.hasVisibleCommands())&&(c||l||(s=n.target.getClientRects()[0],c=s&&s.left||c,l=s&&s.bottom||l),h.show(c,l,t&&t.forceLeft))}},t.prototype._shouldShowCommand=function(n){return this._desktop.mode()!==1||!this._isExtensionCommand(n)},t.prototype._isExtensionCommand=function(n){return!!n._extension},t})();t.PortalCommandManager=c})(c||(c={})),c}));define("MsPortalImpl/UI/Hubs/UI.BrowseManager",
["require","exports","f","i","ko"],(function(n,t,i,r,u){"use strict";function v(n,t){var i=n.toLocaleLowerCase(),r=t.toLocaleLowerCase();return i===r?0:i<r?-1:1}function ut(n,t,i,r){return new y(n,t,i,r)}var e=i.Base,o=e.Constants,p=o.ResourceTypes.ResourceGroups,w=e.Diagnostics,s=i.ViewModels.Services,b=s.Browse,k=s.GridColumns,h=i.getUniqueId,d=window.fx.environment,f=w.createLog(n),g=p.toLowerCase(),c=i.forEachKey,nt=4,tt=1,l=3,a=0,it=i.isFeatureEnabled("supportthirdpartyresources"),rt=r.getErrorMap({badCriteria:""}),y;t.compareAssetTypeForSort=v;t.createBrowseManager=ut;y=(function(){function n(n,t,f,e){var h=this,s,o;if(this._browsePackages={},this._registeredResourceProviders=u.observableArray(["*"]),this._haveRdfeAccess=!1,this._callbacks={},this._isCoAdmin=!1,this._extensionManager=n,this._assetTypeService=t,this._permissionsService=f,s=this._ltm=new r.TriggerableLifetimeManager,o=function(){h._executeCallbacks()},this._registeredResourceProviders.subscribe(s,o),this._haveRdfeAccess=
e(),e.subscribe(s,(function(n){h._haveRdfeAccess=n;o()})),i.isFeatureEnabled("loadassetsasync"))n.on("assetTypes",(function(){return o(),t.assetTypes.subscribe(s,o),!0}));else n.on("assetTypes").then((function(){o();t.assetTypes.subscribe(s,o)}));s.registerForDispose((function(){c(h._browsePackages,(function(n,t){t.cancel();t.dispose()}));h._browsePackages=null}))}return n.prototype._executeCallbacks=function(){var n=this._callbacks;n&&c(n,(function(n,t){t()}))},n.prototype._assetTypeSupportsCriteria=function(n,t){return n.extension===t.assetOwner&&n.assetTypeManifest.name===t.assetType&&r.Extension.isEqualCloudName(n.cloudName,t.cloudName)},n.prototype._releaseViewModel=function(n,t){i.disposeViewModelProperties(t);n.releaseViewModel(t)},n.prototype._assetTypeMeetsRequirements=function(n){var r,c,v,u,f,e,o,s,h,y;if(!n)return!1;var t=n.browseType,p=n.browseRequirements&1,w=!p||this._isCoAdmin;if(t===undefined||!w)return!1;r=this._haveRdfeAccess;c=!n.browseRequiresRdfe||r;switch(t){case l:case nt:if(
v=n.browseLinkUri||"",u=function(n){return n+="Portal",v.indexOf("{"+n+"}")>=0&&(i.getFeatureValue(n)==="false"||!d.links[n])},u("classic")||u("account"))return!1;case a:case tt:if(!c)return!1}return(f=n.resourceType,!f)?!0:(e=f.resourceTypeName,o=e.toLowerCase(),o===g)?!0:!it&&!r&&!o.startsWith("microsoft.")?!1:(s=e.split("/"),s.length<2)?!1:t===l?!0:(h=this._registeredResourceProviders,h().some((function(n){return n.toLowerCase()==="*"})))?!0:(y=s[0].toLowerCase(),h().some((function(n){return n.toLowerCase()===y})))},n.prototype.dispose=function(){var n=this._ltm;n&&(n.dispose(),this._ltm=null)},n.prototype.initialize=function(){this._extensionManager.getHubsExtension()},n.prototype.registerAssetTypesUpdateCallback=function(n){var t=h();return this._callbacks[t]=n,t},n.prototype.unregisterAssetTypesUpdateCallback=function(n){var t=this._callbacks;t[n]&&delete t[n]},n.prototype.addRegisteredResourceProvider=function(n){this._registeredResourceProviders.push(n)},n.prototype.initiateBrowse=
function(n){var t=this,u;return n||rt.badCriteria(),u=new b.ResultsViewModel(n,[]),i.require("MsPortalImpl/UI/Hubs/UI.BrowseManagerDelayed").then((function(i){var c="All browse operations returned.",l="browse-"+h(),e=new i.BrowsePackage(u,t),p=e.ltm;t._browsePackages[l]=e;var o=0,s=0,v=!1,y=[];return t._assetTypeService.assetTypes().forEach((function(i){var l,h;if(!e.canceled&&t._assetTypeSupportsCriteria(i,n)&&(l=i.assetTypeManifest,l.browseType===a)){var u=function(){++s;v&&s===o&&(f.verbose(c),e.allOperationsReturned())},w=l.browseServiceViewModel,b=r.Extension.getWindowId({name:i.extension,cloudName:i.cloudName})+"."+l.name+"."+w;f.verbose("Browse provider "+b+" using optimized browse.");h="browse operation from "+b+" browse provider";y.push(t._extensionManager.getExtensionByName(i.extension,i.cloudName).then((function(r){return Q(r.getViewModel(w)).then((function(o){var s=o.content,c,a,l;s?(c=!1,p.registerForDispose((function(){c=!0;t._releaseViewModel(r,o)})),c?(f.verbose("The "+h+" was already disposed."),
u()):(a=function(n,t){e.canceled||(f.verbose("Got "+h+"."),e.addOperation(i,n,t));u()},l=void 0,typeof s.onInputsSet=="function"&&(l=s.onInputsSet({criteria:n})),Q(l||!0).then((function(){a(b,s)})).catch((function(n){f.verbose("The "+h+" rejected the load promise: "+n);u()})))):(f.verbose("$Failed to get the "+h+"."),u())})).catch((function(n){f.verbose("Failed to get browse operation "+w+": "+n+".");u()}))})).catch((function(n){f.error("Failed to get extension for browse operation "+w+": "+n);u()})));f.verbose("Getting "+h+".");++o}})),v=!0,s===o&&(f.verbose(c),e.allOperationsReturned()),Q.all(y).then((function(){return l}))}))},n.prototype.getViewModelForBrowse=function(n){var t=this._browsePackages;return n in t?t[n].viewModel:null},n.prototype.releaseBrowse=function(n){var t=this._browsePackages,i;n in t&&(i=t[n],i.cancel(),i.dispose(),delete t[n])},n.prototype.getFilteredAssetTypes=function(){var n=this,t,r;return this._isCoAdminPromise||(this._isCoAdminPromise=Q(this._permissionsService.isCoAdmin(
o.DefaultCloudName)).then((function(t){n._isCoAdmin!==t&&(n._isCoAdmin=t,n._executeCallbacks())}))),t=[],r=[],this._assetTypeService.assetTypes().forEach((function(i){var r=i.assetTypeManifest;n._assetTypeMeetsRequirements(r)&&(r.privateBrowse||t.push(i))})),t.length&&i.stableSort(t,(function(n,t){return v(n.compositeDisplayName.service,t.compositeDisplayName.service)})).forEach((function(n){r.push(n)})),r},n.prototype.getGridColumnsPromiseForAssetType=function(n,t){var r=this,i=n.assetTypeManifest.gridColumnsServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension,n.cloudName)).then((function(n){return Q(n.getViewModel(i)).then((function(i){var e=!1,u,f;return(t.registerForDispose((function(){e=!0;r._releaseViewModel(n,i)})),!e)?(u=i.content,f=void 0,typeof u.onInputsSet=="function"&&(f=u.onInputsSet({usage:k.Usage.Default})),f)?f.then((function(){return u})):u:Q.reject("The grid columns service view model was already disposed.")}))})):Q.reject("The asset type does not have a grid columns service view model.")}
,n.prototype.getDynamicBladePromiseForAssetType=function(n,t){var r=this,i=n.assetTypeManifest.dynamicBladeServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension,n.cloudName)).then((function(n){return Q(n.getViewModel(i)).then((function(i){var u=!1;return(t.registerForDispose((function(){u=!0;r._releaseViewModel(n,i)})),!u)?i.content:Q.reject("The dynamic blade service view model was already disposed.")}))})):Q.reject("The asset type does not have a dynamic blade service view model.")},n})()}));define("MsPortalImpl/UI/UI.ContextPane",["require","exports","o","ko","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function e(n){return new t(n)}n.create=e;var t=(function(){function n(n){var o=this,i,t,e;this._widget=n;i=this._viewModel=n.options;t=this._containerLifetime=n.ltm;this._contentLifetime=t.createChildLifetime();this.collapsed=i.collapsed;e={dismissFn:function(
){o.close()},logName:"contextPane"};r.reactor(t,(function(){i.opened()?u.register(e):u.unregister(e)}));t.registerForDispose(n.element.setEvents([f.default.fxcontextpaneclosing,function(n){n.stopPropagation();o.close()}]))}return i.defineProperty(n.prototype,"opened",{get:function(){return this._viewModel.opened},enumerable:!0,configurable:!0}),n.prototype.hasContent=function(n){return this._contentProvider===n},n.prototype.getContent=function(){return this._contentProvider},i.defineProperty(n.prototype,"contentLifetime",{get:function(){return this._contentLifetime},enumerable:!0,configurable:!0}),n.prototype.tryOpen=function(n){var r=this,t,i;return this._contentProvider===n?(this._widget.setFocus(),Q(!0)):(t=this._tryRemoveContent(),t)?(this._contentProvider=n,this._previouslyFocusedElement=document.activeElement,i=this._viewModel,i.opened(!0),i.loading(!0),n.onAddingContent(this._widget).finally((function(){i.loading(!1)})).then((function(){return r._widget.setFocus(),t}))):Q(t)},n.prototype.
close=function(n){var t=!0,i;return n?this._clearContent():t=this._tryRemoveContent(),t&&(i=this._viewModel,i.opened(!1),i.loading(!1),this._restoreFocus()),t},n.prototype._clearContent=function(){var t=this._contentProvider,n;t&&t.onRemovingContent(this._widget);this._contentProvider=null;n=this._contentLifetime;n&&(n.dispose(),this._contentLifetime=this._containerLifetime.createChildLifetime())},n.prototype._tryRemoveContent=function(){var n=this._contentProvider,t;return n?(t=!n.canRemoveContent||n.canRemoveContent(),t&&this._clearContent(),t):!0},n.prototype._restoreFocus=function(){var n=this._previouslyFocusedElement;n&&n.focus()},n})();n.ContextPaneImpl=t})(e||(e={})),e}));define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter",["require","exports","f","o"],(function(n,t,i,r){"use strict";var u;return (function(n){var t={pending:"pending"},u=(function(){function n(n,t){this.deferred=i.Helpers.Deferred();this.targetId=n;this.isSource=t}return n})(),f=(function(){function n(
n){this._awaitableCompositions=[];this.resolvedCompositions=[];this._trackResolvedCompositions=n}return n.prototype.await=function(n,i){var f=this,r=new u(n&&n.toString(),i),e=this.resolvedCompositions.firstIndex((function(n){return i(n)}));if(e>=0)r.deferred.resolve(this.resolvedCompositions[e]);else if(this._awaitableCompositions.push(r),n)n.onDispose((function(){var n;r.deferred.state()===t.pending&&(r.deferred.reject(),n=f._awaitableCompositions.indexOf(r),n>=0&&f._awaitableCompositions.splice(n,1))}));return r.deferred.promise()},n.prototype.resolve=function(n){var r=this,t,i;if(this._trackResolvedCompositions){this.resolvedCompositions.push(n);n.onDispose((function(){var t=r.resolvedCompositions.indexOf(n);t>=0&&r.resolvedCompositions.splice(t,1)}))}for(t=this._awaitableCompositions.length-1;t>=0;t--)i=this._awaitableCompositions[t],i.isSource(n)&&(i.deferred.resolve(n),this._awaitableCompositions.splice(t,1))},r.defineProperty(n.prototype,"waitingCompositions",{get:function(){return this.
_awaitableCompositions.map((function(n){return n.targetId}))},enumerable:!0,configurable:!0}),n})();n.CompositionAwaiter=f})(u||(u={})),u}));define("MsPortalImpl/UI/Compositions/UI.Composition.DashboardFiltersManager",["require","exports","f","i","o","a","ko","Fx/Composition/DashboardFilters","MsPortalImpl/Base/Languages","MsPortalFx/Globalization","MsPortalImpl.Controls/Controls/ResourceFilterHelper","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function g(n,t){var r,i,u;if(!t)return!1;r=!1;switch(n){case 0:i=t;r=i.absolute&&!!i.absolute.fromDate&&!!i.absolute.toDate||i.relative&&typeof i.relative.duration=="number"&&typeof i.relative.timeUnit=="number";break;case 1:case 2:case 3:case 5:case 4:u=t;r=typeof u.operator=="number"&&(u.values||[]).length>0}return r}function dt(n,t){var r=JSON.parse(t||"{}"),i,u,f;return n===0&&(i=r.absolute,i&&(u=i.fromDate,f=i.toDate,i.fromDate=new Date(u),i.
toDate=new Date(f))),r}function ot(n){var r=n&&n.selectedDisplayLanguage||"",u=n&&n.selectableDisplayLanguages||[],t=i.find(u,(function(n){return n.locale&&n.locale.localeCompareIgnoreCase(r)===0}));return t&&t.specificCulture||"en-us"}function nt(n,t,i){if(!t)return"";switch(n){case 0:var r=i,u=r.format;switch(u){case 1:return a.Filtering.Edit.TimeRange.localTime;case 0:return a.Filtering.Edit.TimeRange.utcTime;default:return a.Filtering.Intrinsics.timeRange}case 1:case 2:case 3:case 5:case 4:return t.displayText;default:return b.error("Unknown filter kind: "+n),""}}function st(n){var i=n&&n.absolute,r=n&&n.relative,t;if(i)return a.Filtering.TimeRange.absolute.format(d.create(d.shortDatePattern).format(new Date(i.fromDate)).toString(),d.create(d.shortDatePattern).format(new Date(i.toDate)).toString());t=r.duration;switch(r.timeUnit){case 0:return a.Filtering.TimeRange.Relative.minutes.format(t);case 1:return t===1?a.Filtering.TimeRange.Relative.hour.format(t):a.Filtering.TimeRange.Relative.
hours.format(t);case 2:return t===1?a.Filtering.TimeRange.Relative.day.format(t):a.Filtering.TimeRange.Relative.days.format(t);default:b.error("Unknown Time unit: "+r.timeUnit)}}function k(n){var t=n.kind;return t&&w[t]&&w[t].filterId||n.filterId}function tt(n){var t=n&&i.find(w,(function(t){return t&&t.filterId===n}));return t&&t.kind}function ht(n){var t=n.filterKind;return w[t]?w[t].filterId:n.filterId}function ct(n){var t=tt(n);return typeof t=="number"&&w[t]}function lt(n){return n.map((function(n){return n.text})).join(", ")}function v(n,t,i){var u="Invalid filter value: "+JSON.stringify(n)+"; filter id: "+t+"; part: "+i.locator.toString(),r;if(r)throw r;else b.error(u)}var at=i.Base,vt=o.TimeRangeFilter,yt=o.ResourceTypeFilter,pt=i.ViewModels.Services.ResourceTypes.parseResourceGroupDescriptor,wt=i.ViewModels.Services.ResourceTypes.buildResourceGroupIdFromDescriptor,bt=r.Rpc,kt=at.Diagnostics,b=kt.createLog(n),d=h.DateTimeFormat,y=i.Base.Constants.DefaultCloudName,w=(function(){var n=
[{kind:0,filterId:o.TimeRangeFilter.filterId,displayText:a.Filtering.Intrinsics.timeRange},{kind:2,filterId:o.SubscriptionFilter.filterId,displayText:a.Filtering.Intrinsics.subscription},{kind:3,filterId:o.LocationFilter.filterId,displayText:a.Filtering.Intrinsics.location},{kind:5,filterId:o.ResourceGroupFilter.filterId,displayText:a.Filtering.Intrinsics.resourceGroup},{kind:4,filterId:yt.filterId,displayText:a.Filtering.Intrinsics.resourceType},];return n.reduce((function(n,t){return n[t.kind]=t,n}),[])})(),gt={relative:{duration:24,timeUnit:1},format:0,granularity:0},ni=(function(){function n(n){var t=this,f;this._filtersLocale=e.observable();this._children=e.observableArray([]);this._allFilterDefinitions=e.observableArray([]);this._addableFiltersDefinitions=e.observableArray([]);this._appliedFilters=e.observableArray();this._hasMoreFilters=e.observable(!0);this._queryingParts=e.observable(!1);this._hasLoaded=e.observable(!1);this._currentSessionLocale=ot(s.currentLocaleContext);this._staticFilters=
e.observableArray([]);this._dynamicFilters=e.observableArray([]);this._equalityFilterRuntimes=[];this._notifyStartboardSettingsChanged=i.throttle((function(){t._parent.widget&&t._parent.widget.trigger("fxstartboardsettingchanged")}),1e3);this._checkAppliedFiltersAreValid=i.debounce((function(){var i=t._allFilterDefinitions.peek(),n=t._appliedFilters.peek().filter((function(n){return!!n&&n.kind()===0})).first(),r=i.filter((function(n){return!!n&&n.kind===0})).first(),u;!n&&r&&(u={id:e.observable(null),kind:e.observable(null),kindLifetime:t._dashboardLifetime.createChildLifetime(),model:e.observable(null),isApplicable:e.observable(!0),filterIdDisplayText:"",operator:0,filterValueDisplayText:"",warningMessage:e.observable()},t.filtersWidgetViewModel.updateTimeRangeFilter(u,gt,!0));n&&n.isApplicable(!!r);t._hasLoaded()&&t._appliedFilters.peek().forEach((function(n){if(n.kind()!==0){var t=i.some((function(t){return k(t)===n.id()}));n.isApplicable(t)}}))}),200);this._getDynamicFilterDefinitions=i.memoizeQ(
(function(n){return t._getDynamicFilters(n)}));this._getDynamicFilters=i.debounce((function(n){return t._getDashboardFilteringAPIs(n).then((function(n){var i=Q.all(n.mapMany((function(n){return n&&n.getDynamicFilterDefinitions?[n.getDynamicFilterDefinitions()]:[]}))),t={};return i.then((function(n){n.forEach((function(n){n.forEach((function(n){var i=n,r=i&&i.definition&&k(i.definition);r&&(t[r]=i)}))}))})),u.keys(t).map((function(n){var i=t[n],r=ct(n)||i.definition;return{definition:r,logTelemetry:i.logTelemetry}}))}))}));this._getStaticFilterDefinitions=i.memoizeQ((function(n){return t._getStaticFilters(n)}));this._getStaticFilters=i.debounce((function(n){return t._getDashboardFilteringAPIs(n).then((function(n){var t=n.reduce((function(n,t){var r=t&&t.staticFilters&&t.staticFilters.map(ht);return r&&i.pushUnique(n,r,null,!0),n}),[]);return Q.all(n.mapMany((function(n){return n&&n.getFilterDefinitions?[n.getFilterDefinitions()]:[]}))).then((function(n){return t.mapMany((function(t){var r=ct(t);return r||n.some(
(function(n){return!!(r=i.find(n,(function(n){return n&&k(n)===t})))})),r?[r]:[]}))}))}))}));this._parent=n;this._children(n.children.map((function(n){return n})));this._initializeFiltersWidgetsViewModel();e.reactor(n,[this._staticFilters,this._dynamicFilters,this._appliedFilters],(function(n,i){t._allFilterDefinitions(n.concat(i.map((function(n){return n.definition}))));t._updateState()}));e.reactor(n,this._hasLoaded,(function(){return t._updateState()}));this._children.subscribeArrayBulkChanges(this._parent,(function(){t._hasLoaded(!1);t._getStaticFilterDefinitions(t._children.peek()).then((function(n){t._staticFilters(n)}))}));n.subscribeChildren((function(){t._children(t._parent.children.map((function(n){return n})))}));f={getAllSubscriptions:function(n){return Q(r.Azure.getAllSubscriptions(bt.client,n))},getSelectedSubscriptions:l.getSelectedSubscriptions,selectedSubsUpdateTriggered:l.selectedSubsUpdateTriggered};this._equalityFilterRuntimes[1]=new it;this._equalityFilterRuntimes[2]=new rt(f);this._equalityFilterRuntimes[
3]=new ut({getLocations:c.getLocations});this._equalityFilterRuntimes[5]=new ft(f);this._equalityFilterRuntimes[4]=new et(this._parent.services.assetTypeService)}return n.prototype.getFilters=function(){var n=this;return e.ignoreDependencies((function(){return n._appliedFilters().reduce((function(t,i){var r=i.id(),u=i.model(),f=i.kind(),e=typeof r=="string"&&g(f,u);return e&&(t[r]=n._denormalizeFilterModel(f,u)),t}),{})}))},n.prototype.updateFilters=function(n,t){var r=this,u=[],f=[],o=this._appliedFilters;return t.forEach((function(t){var s=t.filterId,l=i.find(o.peek(),(function(n){return n.id()===s})),v=i.find(r._allFilterDefinitions.peek(),(function(n){return n.filterId===s})),h=tt(s)||1,c=r._normalizeFilterModel(h,t.filterModel),a;l?l.model(c):(a=n.getDashboardFiltering().then((function(i){return r._getValueText(s,h,t.filterModel,n,i).then((function(n){o.push({id:e.observable(t.filterId),kind:e.observable(h),kindLifetime:r._dashboardLifetime.createChildLifetime(),model:e.observable(c),isApplicable:
e.observable(!0),filterIdDisplayText:nt(h,v,c),operator:r._getOperator(c),filterValueDisplayText:n,warningMessage:e.observable()})}))})),f.push(a));u.push(s)})),Q.all(f).then((function(){return r._notifyFiltersChanged(u,n)}))},n.prototype.loadDashboard=function(n){var i=this,r,t,f,o;this.dispose();r=this._dashboardLifetime=this._parent.createChildLifetime();this._filtersLocale(n&&n.filterlocale||this._currentSessionLocale);t=n&&n.filters||{};f=u.keys(t).map((function(n){var u=t[n],f=u.kind,o=dt(f,u.model),s;if(g(f,o))return s={id:e.observable(n),kind:e.observable(f),kindLifetime:r.createChildLifetime(),model:e.observable(o),isApplicable:e.observable(!0),filterIdDisplayText:u.displaycache.name,filterValueDisplayText:u.displaycache.value,operator:i._getOperator(o),warningMessage:e.observable()},i._activateFilter(s),s})).filter((function(n){return!!n}));(o=this._appliedFilters).push.apply(o,f)},n.prototype.cleanupState=function(){this._dashboardLifetime&&(this._dashboardLifetime.dispose(),this._dashboardLifetime=
null);this._getDynamicFilterDefinitions.clear();this._getStaticFilterDefinitions.clear();this._appliedFilters([]);this._staticFilters([]);this._dynamicFilters([]);this._allFilterDefinitions([]);this._addableFiltersDefinitions([]);this._filtersLocale("");this._hasLoaded(!1);this._queryingParts(!1)},n.prototype.setFilters=function(n){var i=this,t;this._dashboardLifetime||(this._dashboardLifetime=this._parent.createChildLifetime());t=u.keys(n).map((function(t){var r=n[t];return{id:e.observable(t),kind:e.observable(r.filterKind),kindLifetime:i._dashboardLifetime.createChildLifetime(),model:e.observable(r.filterModel),isApplicable:e.observable(!0),filterIdDisplayText:"",filterValueDisplayText:"",operator:0,warningMessage:e.observable()}}));this._appliedFilters(t)},n.prototype.toJSON=function(){var n={filterlocale:ot(s.currentLocaleContext),filters:{}},t=this._appliedFilters.peek();return t.forEach((function(t){n.filters[t.id()]={model:JSON.stringify(t.model()),kind:t.kind(),displaycache:{name:
t.filterIdDisplayText,value:t.filterValueDisplayText}}})),n},n.prototype._initializeFiltersWidgetsViewModel=function(){var n=this;this.filtersWidgetViewModel={sourceChanged:e.observable(!0),filterRequestInProgress:this._queryingParts,canAddFilter:this._hasMoreFilters,filters:this._appliedFilters,addableFilterDefinitions:this._addableFiltersDefinitions,updateEqualityFilter:function(t,i,r,u){var f={operator:r,values:u.map((function(n){return n.value}))},e=lt(u);n._updateFilter(t,i,f,e)},updateTimeRangeFilter:function(t,i,r){r===void 0&&(r=!1);n._updateFilter(t,vt.filterId,i,st(i),r)},removeFilter:function(t){var i=n._appliedFilters,r=i().firstIndex((function(n){return n.id()===t})),u;r>=0&&(u=i()[r],u.kindLifetime.dispose(),i.splice(r,1),n._notifyFiltersChanged([t]))},updateAllFilterDefinitions:function(t){if(t===void 0&&(t=!1),!t&&n._hasLoaded()||n._queryingParts())return Q();n._queryingParts(!0);var i=n._children.peek();return Q.all([n._getStaticFilterDefinitions(i),n._getDynamicFilterDefinitions(
i)]).spread((function(t,i){n._staticFilters(t);n._dynamicFilters(i)})).catch((function(n){b.error(n)})).finally((function(){n._hasLoaded(!0);n._queryingParts(!1)}))},getFilterValues:function(t,u){function o(n){return i.find(n,(function(n){return k(n)===t}))}var e=new r.TriggerableLifetimeManager,h=n._children.peek(),c=tt(t)||1,s=[],l=h.map((function(n){return n.getDashboardFiltering().then((function(t){var i=t&&t.getFilterDefinitions&&t.getFilterDefinitions(),r=t&&t.getDynamicFilterDefinitions&&t.getDynamicFilterDefinitions();return i&&e.registerForDispose(i.hold()),r&&e.registerForDispose(r.hold()),Q.all([i||Q([]),r||Q([])]).spread((function(i,r){var u=f.isArray(i)&&o(i)||f.isArray(r)&&o(r.map((function(n){return n.definition})));u&&s.push({part:n,partDashboardFiltering:t,filterDefinition:u})}))}))}));return Q.allSettled(l).then((function(){return n._getFilterValues(t,c,s,u||"")})).finally((function(){return e.dispose()}))},getFilterDefinition:function(t){return n._allFilterDefinitions.peek().filter((function(
n){return n.filterId===t})).first()}}},n.prototype._updateFilter=function(n,t,r,u,f){var h,o,e,s;(f===void 0&&(f=!1),h=i.find(this._allFilterDefinitions.peek(),(function(n){return t===n.filterId})),o=h.kind,g(o,r))&&(e=i.find(this._appliedFilters.peek(),(function(t){return t.id()===n.id()})),s=!1,e?(e.id()!==t&&(e.kind(o),e.id(t),e.kindLifetime.dispose(),e.kindLifetime=this._dashboardLifetime.createChildLifetime(),this._activateFilter(e),s=!0),JSON.stringify(e.model())!==JSON.stringify(r)&&(e.model(r),e.filterIdDisplayText=nt(o,h,r),e.operator=this._getOperator(r),e.filterValueDisplayText=u,s=!0)):(n.id(t),n.kind(o),n.model(r),n.filterIdDisplayText=nt(o,h,r),n.operator=this._getOperator(r),n.filterValueDisplayText=u,n.kindLifetime=this._dashboardLifetime.createChildLifetime(),this._activateFilter(n),s=!0,n.kind()===0?this._appliedFilters.unshift(n):this._appliedFilters.push(n)),s&&this._notifyFiltersChanged([t],null,f))},n.prototype._getOperator=function(n){return n&&n.operator||0},n.prototype.
_updateState=function(){var n=this._appliedFilters.peek();this._addableFiltersDefinitions(this._allFilterDefinitions.peek().filter((function(t){var i=n.some((function(n){return!!t&&n.id()===t.filterId}));return!i})));this._hasMoreFilters(!this._hasLoaded()||!!this._addableFiltersDefinitions().length);this._checkAppliedFiltersAreValid()},n.prototype._notifyFiltersChanged=function(n,t,i){var u=this,r;return i===void 0&&(i=!1),r=this._children.peek(),this._updateState(),Q.all(r.map((function(n){return n.getDashboardFiltering()}))).then((function(i){var u=[],f=[];return i.forEach((function(t,i){var r;t&&(t.staticFilters||[]).some((function(t){return n.indexOf(ht(t))>=0}))&&(r=!0);u[i]=r;f[i]=!r&&t&&t.getDynamicFilterDefinitions?t.getDynamicFilterDefinitions():Q([])})),Q.all(f).then((function(t){t.forEach((function(t,i){t.some((function(t){var i=t,r=i&&i.definition&&k(i.definition);return r&&n.indexOf(r)>=0}))&&(u[i]=!0)}))})).then((function(){u.forEach((function(n,i){if(n){var u=r[i];u.notifyFiltersChanged(u===
t)}}))}))})).finally((function(){i||u._notifyStartboardSettingsChanged()}))},n.prototype._getDashboardFilteringAPIs=function(n){var t=this;return Q.all(n.map((function(n){return i.Base.Promises.cancelOnDispose(t._dashboardLifetime,Q(n.awaitComposed))}))).catchError(i.Errors.CanceledError,(function(){})).then((function(){return Q.all(n.map((function(n){return n.getDashboardFiltering()})))}))},n.prototype.dispose=function(){this.cleanupState()},n.prototype._getValueText=function(n,t,i,r,u){if(t===0)return Q(st(i));var f=this._equalityFilterRuntimes[t],e=f&&f.createFilterValueViewModels(i,n,r,u)||Q([]).thenReject(new Error("Unknown filter kind: "+t));return e.then(lt)},n.prototype._getFilterValues=function(n,t,i,r){var u=this._equalityFilterRuntimes[t];return u&&u.getFilterValues(n,i,r)||Q([]).thenReject(new Error("Unknown filter kind: "+t))},n.prototype._denormalizeFilterModel=function(n,t){return n===0?t:this._equalityFilterRuntimes[n].denormalizeFilterModel(t)},n.prototype._normalizeFilterModel=function(
n,t){return n===0?t:this._equalityFilterRuntimes[n].normalizeFilterModel(t)},n.prototype._activateFilter=function(n){var i=n.kind,r=n.kindLifetime,t=i();t!==0&&this._equalityFilterRuntimes[t].activateFilter(r,n)},n})(),p,it,rt,ut,ft,et;t.DashboardFiltersManager=ni;p=(function(){function n(){}return n.prototype.getFilterValues=function(n,t,i){var r=this,u=[],f=[],e=t.map((function(t){var e=t.part,o=t.partDashboardFiltering,s=t.filterDefinition;return Q(r._getFilterValues(s,i)).then((function(t){var s=(t||[]).filter((function(t){var i=r._isValidFilterValue(t);return i||v(t,n,e),i})),i=s.map((function(n){return r._normalizeFilterValue(n)})).filter((function(n){return!u.some((function(t){return r._equalNormalizedFilterValues(n,t)}))}));return u.push.apply(u,i),r._createFilterValueViewModels(i,n,e,o).then((function(n){f.push.apply(f,n)}))}))}));return Q.allSettled(e).then((function(){var n=f;return i&&(n=n.filter((function(n){return n.text.indexOf(i)>=0}))),n.sort((function(n,t){return n.text.localeCompare(t.text)})
)}))},n.prototype.createFilterValueViewModels=function(n,t,i,r){var u=this.normalizeFilterModel(n).values;return this._createFilterValueViewModels(u,t,i,r)},n.prototype.activateFilter=function(){},n})();t.EqualityFilterRuntimeBase=p;it=(function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return n},t.prototype.denormalizeFilterModel=function(n){return n},t.prototype._getFilterValues=function(n,t){return Q(n.getFilterValues(t))},t.prototype._isValidFilterValue=function(n){return n&&typeof n=="string"||!!n.valueId},t.prototype._normalizeFilterValue=function(n){return n},t.prototype._equalNormalizedFilterValues=function(n,t){return typeof n=="string"?n===t:n.valueId===t.valueId},t.prototype._createFilterValueViewModels=function(n,t,r,u){var f=n.filter((function(n){return n&&n.valueId})),e={},o=f.length?Q(u.getLocalizedFilterValues(t,f.map((function(n){return n.valueId})))).then((function(n){return f.reduce((function(u,f){var o=f.valueId,
e=i.find(n||[],(function(n){return n.valueId===o}));return e&&e.value?u[o]=e.value:v(f,t,r),u}),{})})):Q({});return o.then((function(){return n.map((function(n){var i,u=0;return typeof n=="string"?i=n:n.valueId&&(i=e[n.valueId]),i||(v(n,t,r),i=n.valueId,u=3),{text:i,value:n,state:u}}))}))},t})(p);t.EqualityFilterRuntime=it;rt=(function(n){function t(t){n.call(this);this._subscriptions=t}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return{operator:n.operator,values:n.subscriptionIds}},t.prototype.denormalizeFilterModel=function(n){return{operator:n.operator,subscriptionIds:n.values}},t.prototype.activateFilter=function(n,t){var i=this;e.reactor(n,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(function(){Q(i._subscriptions.getSelectedSubscriptions(y)).then((function(n){var i=t.model(),r=i&&i.values||[],u=r.some((function(t){return!n.some((function(n){return n.subscriptionId.toLowerCase()===t.toLowerCase()}))}));t.warningMessage(u?a.Filtering.Subscription.subscriptionFilterUsingExcludedSubscriptions:
null)}))}))},t.prototype._getFilterValues=function(n){return Q(n.getSubscriptionIds())},t.prototype._isValidFilterValue=function(n){return n&&typeof n=="string"},t.prototype._normalizeFilterValue=function(n){return n.toLowerCase()},t.prototype._equalNormalizedFilterValues=function(n,t){return n===t},t.prototype._createFilterValueViewModels=function(n,t,r){var u=this._subscriptions.getAllSubscriptions(y),f=Q(this._subscriptions.getSelectedSubscriptions(y));return Q.all([u,f]).spread((function(u,f){return n.map((function(n){var e,o,s,h;return n=n.toLowerCase(),e=i.find(u,(function(t){return t.subscriptionId.toLowerCase()===n.toLowerCase()})),e?(o=e.uniqueDisplayName,h=f.some((function(t){return t.subscriptionId.toLowerCase()===n.toLowerCase()})),s=h?0:1):(v(n,t,r),o=n,s=3),{text:o,value:n,state:s}}))}))},t})(p);t.SubscriptionFilterRuntime=rt;ut=(function(n){function t(t){n.call(this);this._locations=t}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return{operator:n.operator,values:
n.locations}},t.prototype.denormalizeFilterModel=function(n){return{operator:n.operator,locations:n.values}},t.prototype._getFilterValues=function(n,t){return Q(n.getLocations(t))},t.prototype._isValidFilterValue=function(n){return n&&typeof n=="string"||!!n.name||!!n.valueId},t.prototype._normalizeFilterValue=function(n){return n},t.prototype._equalNormalizedFilterValues=function(n,t){return typeof n=="string"?typeof t=="string"&&n===t:n.name&&n.name===t.name||n.valueId&&n.valueId===t.valueId},t.prototype._createFilterValueViewModels=function(n,t,r,u){var f=n.filter((function(n){return n&&n.valueId})),e=f.length?Q(u.getLocalizedFilterValues(t,f.map((function(n){return n.valueId})))).then((function(n){return f.reduce((function(u,f){var o=f.valueId,e=i.find(n||[],(function(n){return n.valueId===o}));return e&&e.value?u[o]=e.value:v(f,t,r),u}),{})})):Q({}),o=n.some((function(n){return n&&!!n.name}))?this._locations.getLocations(y):Q([]);return Q.all([o,e]).spread((function(u,f){return n.map((function(
n){var e,o=0,s;return typeof n=="string"?e=n:n.name?(s=i.find(u,(function(t){return t.name===n.name})),s?e=s.displayName:(v(n,t,r),e=n.name,o=3)):n.valueId&&(e=f[n.valueId],e||(v(n,t,r),e=n.valueId,o=3)),{text:e,value:n,state:o}}))}))},t})(p);t.LocationFilterRuntime=ut;ft=(function(n){function t(t){n.call(this);this._subscriptions=t}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return{operator:n.operator,values:n.resourceGroupIds}},t.prototype.denormalizeFilterModel=function(n){return{operator:n.operator,resourceGroupIds:n.values}},t.prototype.activateFilter=function(n,t){var i=this;e.reactor(n,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(function(){Q(i._subscriptions.getSelectedSubscriptions(y)).then((function(n){var r=t.model(),u=r&&r.values||[],f=u.some((function(t){var r=i._parseResourceGroupId(t),u=r.subscription;return!n.some((function(n){return n.subscriptionId.toLowerCase()===u.toLowerCase()}))}));t.warningMessage(f?a.Filtering.ResourceGroup.resourceGroupFilterUsingExcludedSubscriptions:
null)}))}))},t.prototype._getFilterValues=function(n){return Q(n.getResourceGroupIds())},t.prototype._isValidFilterValue=function(n){return n&&typeof n=="string"},t.prototype._normalizeFilterValue=function(n){return this._normalizeResourceGroupId(n)||n},t.prototype._equalNormalizedFilterValues=function(n,t){return n===t},t.prototype._createFilterValueViewModels=function(n){var t=this,r=this._subscriptions.getAllSubscriptions(y),u=Q(this._subscriptions.getSelectedSubscriptions(y));return Q.all([r,u]).spread((function(r,u){var f=n.map((function(n){return t._parseResourceGroupId(n)}));return n.map((function(n,e){var o=f[e],s,h,v,y;if(o){var c=o.resourceGroup,p=f.some((function(n){return n&&n!==o&&n.resourceGroup===c})),l=o.subscription.toLowerCase();p?(v=i.find(r,(function(n){return n.subscriptionId.toLowerCase()===l})),s=a.duplicateResourceGroupFilterValue.format(c,v?v.uniqueDisplayName:l)):s=c;y=u.some((function(n){return n.subscriptionId.toLowerCase()===l}));h=y?0:1}else s=n,h=3;return{text:s,value:
t._normalizeResourceGroupId(n),state:h}}))}))},t.prototype._normalizeResourceGroupId=function(n){var t=this._parseResourceGroupId(n);return t&&wt({subscription:t.subscription.toLowerCase(),resourceGroup:t.resourceGroup})},t.prototype._parseResourceGroupId=function(n){var t,i;try{return pt(n)}catch(u){t=u}if(t&&(b.error("Invalid resource group id '"+JSON.stringify(n)+"', inner exception: "+r.Diagnostics.getLogFriendlyMessage(t)),i=void 0,i))throw i;},t})(p);t.ResourceGroupFilterRuntime=ft;et=(function(n){function t(t){n.call(this);this._assetTypeService=t}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return{operator:n.operator,values:n.resourceTypes}},t.prototype.denormalizeFilterModel=function(n){return{operator:n.operator,resourceTypes:n.values}},t.prototype._getFilterValues=function(n){return Q(n.getResourceTypes())},t.prototype._isValidFilterValue=function(n){return n&&typeof n.resourceType=="string"&&!n.resourceKind||typeof n.resourceKind=="string"},t.prototype._normalizeFilterValue=
function(n){var i=n.resourceType,t=n.resourceKind;return{resourceType:i.toLowerCase(),resourceKind:t&&t.toLowerCase()}},t.prototype._equalNormalizedFilterValues=function(n,t){return n.resourceType===t.resourceType&&(n.resourceKind?n.resourceKind===t.resourceKind:!t.resourceKind)},t.prototype._createFilterValueViewModels=function(n,t,r){var u=r.extension.cloudName;return this._assetTypeService.getResourceTypeAssetTypeInformation(n.map((function(n){return n.resourceType})),u).then((function(u){return n.map((function(n){var f,h,c=n.resourceType,e=n.resourceKind,o=i.find(u,(function(n){return n.resourceType.toLowerCase()===c.toLowerCase()})),s;return o&&(e?(s=i.find(o.kinds||[],(function(n){return n.name.toLowerCase()===e.toLowerCase()})),s&&(f=s.pluralDisplayName)):f=o.compositeDisplayName.plural),f||(v(n,t,r),f=e||c,h=3),{text:f,value:n,state:h}}))}))},t})(p);t.ResourceTypeFilterRuntime=et}));define("MsPortalImpl/Svg/Startup/Download.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M9.6 7.2L14 3v3.4L8 12 2 6.5V3l4.4 4.2V0h3.2zM2 13h11.9v3H2z'/><\/g><\/svg>"}})
);define("MsPortalImpl/Svg/Startup/Upload.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M6.4 8.8L2 13V9.6L8 4l6 5.5V13L9.6 8.8V16H6.4zM2.1 0H14v3H2.1z'/><\/g><\/svg>"}}));define("_generated/Templates/WidgetsStartboard",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-startboard-loadanimation"> <div class="fxs-splashscreen-loader-container fxs-loading5dots-container"> <div><\/div><div><\/div><div><\/div><div><\/div><div><\/div> <\/div> <\/div> <div class="fxs-startboard-header"> <div class="fxs-startboard-header-item fxs-startboard-title fxs-startboard-title-next fxs-portal-border" id="startboard-title"><\/div> <div class="fxs-startboard-header-item fxs-startboard-dropdown"><\/div> <input type="text" class="fxs-startboard-header-item fxs-startboard-title-edit fxs-hide-in-normal" maxlength="200"> <div class="fxs-startboard-header-item fxs-startboard-migration" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-migrate"><\/button> <\/div> <div class="fxs-startboard-header-item fxs-startboard-actions" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-new"><\/button> <div class="fxs-startboard-button fxs-startboard-button-upload" tabindex="-1"><\/div> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-download" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-edit" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-share" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-fullscreen" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-clone" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-delete" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-filter" tabindex="-1"><\/button> <\/div> <\/div> <div class="fxs-startboard-filter" data-bind="stopBindings: true"><\/div> <div class="fxs-startboard-layout"><\/div> <div class="fxs-startboard-message-container"><\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.StartBoard",["require","exports","f","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Svg/Startup/Add.svg","MsPortalImpl/Svg/Startup/CaretDown.svg","MsPortalImpl/Svg/Startup/Clone.svg","MsPortalImpl/Svg/Startup/Customize.svg","MsPortalImpl/Svg/Startup/Download.svg","MsPortalImpl/Svg/Startup/Filter.svg","MsPortalImpl/Svg/Startup/Fullscreen.svg","MsPortalImpl/Svg/Startup/Share.svg","MsPortalImpl/Svg/Startup/TrashOutline.svg","MsPortalImpl/Svg/Startup/Upload.svg","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Widgets/Widgets.LayoutBase","_generated/Templates/WidgetsStartboard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Interactions/Interactions.KeyboardNavigation",
"MsPortalImpl/Base/Base.Timers","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st){"use strict";var si=i.Base,dt=si.Diagnostics,gt=dt.Telemetry,ni=g.Source,ti=g.Action,hi=window,ci=dt.createLog(n),ht=e.Dashboard,ei,oi;t.widgetClass="fxs-startboard";t.headerButtonClass="fxs-startboard-button";var ii="fxs-theme-context-start",ri="fxs-startboard-title-edit",ct="fxs-startboard-button-text",lt="fxs-startboard-button-icon",ui="fxs-startboard-button-filter",vt="fxs-startboard-button-browse",yt="fxs-startboard-header-normal",pt="fxs-startboard-header-migration",at="fxs-startboard-dropdown-item",wt="fxs-startboard-dropdown-dashboard",bt="."+wt+", ."+vt,kt=hi.fx.environment,li=kt.features.filterdashboard==="true",fi="aria-label";t.fxstartboardtitlechanged="fxstartboardtitlechanged";t.fxmigratestartboard="fxmigratestartboard";ei=(function(n){function t(t,i,u,f){n.call(this,t);this.commands=[];this.filterButtonText=
r.observable("");this.title=r.observable(e.NavBar.home);this.dashboardList=r.observableArray();this.loading=r.observable(!1);this.notFound=r.observable(!1);this.isShared=r.observable(!1);this.notFoundMessage=r.observable("");this.subscriptionsInfo=r.observable("");this.locked(!1);var o=this.flowLayoutOptions=new tt.ViewModel("fxs-flowlayout-instanceid");o.allowReorder=!0;o.allowOverflow=!0;o.allowGaps=!0;o.resolutionGuides=!0;o.resolutionGuidesOffset.y=-88;o.orientation=it.Orientation.Horizontal;o.minColumns(4);o.minRows(4);o.maxRows(4);o.locked(!1);this.headerMode=r.observable(0);this.filtersWidgetViewModel=f;this.applyViewSettings(i)}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{layoutSettings:this.flowLayoutOptions.getViewSettings()}}},t.prototype.applyViewSettings=function(n){n&&n.NormalState&&n.NormalState.layoutSettings&&this.flowLayoutOptions.applyViewSettings(n.NormalState.layoutSettings)},t})(ut.ViewModel);t.ViewModel=ei;oi=(function(g){function dt(
u,f){var c=this,s,h;g.call(this,u,f);this._layout=null;s=this.ltm;this._isSharedToArm=f.isShared;u.addClass(ii).addClass(t.widgetClass).html(rt());r.reactor(s,(function(){var n=f.title();u.findByClassName("fxs-startboard-title").text(n);u.findByClassName(ri).val(n)}));r.reactor(s,(function(){var t=f.headerMode(),n=u.findByClassName("fxs-startboard-header");switch(t){case 1:n.addClass(yt).removeClass(pt);break;case 2:n.removeClass(yt).addClass(pt);break;case 0:default:n.removeClass(yt).removeClass(pt)}}));r.reactor(s,(function(){var n=f.notFound();u.toggleClass("fxs-startboard-notfound",n)}));r.reactor(s,(function(){var n=f.loading();u.toggleClass("fxs-startboard-loading",n)}));r.reactor(s,(function(){var n=f.title();document.title=e.Portal.windowTitleFormat.format(n,kt.branding.title)}));this._layout=new tt.Widget(u.findByClassName("fxs-startboard-layout"),f.flowLayoutOptions);this._initializeCommands(s,u);h=u.findByClassName("fxs-startboard-message-container");h.html('<div class="fxs-startboard-message-title">'+
i.encodeHtml(ht.NotFound.title)+'<\/div><div class="fxs-startboard-message-body" data-bind="text: data.notFoundMessage"><\/div>');r.applyBindings({data:f},h[0]);this._attachEventHandlers(u);s.registerForDispose([o.setup(u,r.observableArray(f.commands)),new ot.KeyboardNavigation(u.find(".fxs-startboard-actions"),12,"> .fxs-startboard-button:not(.fxs-startboard-button-upload), .fxs-startboard-button-upload input[type=file]")]);i.isFeatureEnabled("dashboardfilters")&&f.filtersWidgetViewModel&&i.require("./Widgets.DashboardFilters",n).then((function(n){c._dashboardFiltersWidget=new n.Widget(c.element,f.filtersWidgetViewModel)}))}return __extends(dt,g),dt.prototype.dispose=function(){this._layout.dispose();this._cleanElement(t.widgetClass,ii);g.prototype.dispose.call(this)},dt.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");this._layout.addChild(n)},dt.prototype.removeChild=function(n){return this._layout.removeChild(n)},dt.prototype.moveChild=function(n,t,i,r){this.
_layout.moveChild(n,t,i,r)},dt.prototype.setFocus=function(){var n,t,r;i.isFeatureEnabled("skipautofocus")||(n=void 0,this._$lastFocused&&u.contains(this.element[0],this._$lastFocused[0])&&s.isVisible(this._$lastFocused)&&(this._$lastFocused.focus(),n=!0),n||(t=this._layout.element.findFirstTabbable(),t.length===1?t.focus():(r=this._selectorMenu,r&&r.setFocus())))},dt.prototype.saveViewSettings=function(){return this.options.getViewSettings()},dt.prototype.discardStateOfUnusedChildren=function(){return ci.assert(!!this._layout,"FlowLayout not defined."),this._layout?this._layout.discardStateOfUnusedChildren():{stateDiscarded:!1}},dt.prototype.getDomOrderedChildren=function(){return this._layout.getDomOrderedChildren()},dt.prototype._attachEventHandlers=function(n){var i=this;this.ltm.registerForDispose(n.setEvents([it.Widget.layoutUpdatedEventName,function(t){n.trigger(ut.Widget.viewSettingsChanged,i.saveViewSettings());t.stopPropagation()}],[et.default.focusout,function(n){i._$lastFocused=
u(n.target)}],[et.default.change,".fxs-startboard-fileUpload-overlay",function(n){n.stopPropagation();var t=u.extend(!0,{},n.target.files);i._handleUploadItemClick(t);n.currentTarget.value=null}],[et.default.focus,".fxs-startboard-fileUpload-overlay",function(n){n.stopPropagation();u(n.target).closest("."+t.headerButtonClass).addClass("fxs-startboard-item-focused")}],[et.default.blur,".fxs-startboard-fileUpload-overlay",function(n){n.stopPropagation();u(n.target).closest("."+t.headerButtonClass).removeClass("fxs-startboard-item-focused")}]))},dt.prototype._initializeCommands=function(n,o){var ii=this,yt="aria-disabled",bi=ht.create,ki=ht.delete,di=e.ShellCommands.downloadDashboard,ei=e.ShellCommands.uploadDashboard,gi=ht.edit,nr=ht.filter,tr=this._isSharedToArm?ht.unshare:ht.share,oi=ht.fullscreen,ir=ht.clone,g=this.options,pt=function(n,t){n.attr("title",t).findByClassName(ct).html(t)},rr="<div class='"+lt+"'><\/div>"+("<div class='"+ct+"'><\/div>"),ur="<div class='"+lt+"'><\/div>"+("<div class='"+
ct+'\' id="uploadlabel" aria-hidden="true"><\/div>')+'<input type="file" class="fxs-startboard-fileUpload-overlay" accept=".json" tabindex=\'-1\' role="menuitem" aria-labelledby="uploadlabel"/>',tt=function(n,t,i,r,f,e){f===void 0&&(f=!1);var h=o.findByClassName(n).html(t===ei?ur:rr);pt(h,t);h.findByClassName(lt).html(ft.getSvgReferenceOrFallBackToData(i,{palette:99}));e=e||function(){r.execute(!1)};h.on(et.default.click,(function(n){n.stopPropagation();u(n.currentTarget).attr(yt)!=="true"&&e(n);ii.trigger(et.default.fxdashboardactivity)}));return h.data("commandVM",r),f&&s.hide(h),h},si=tt("fxs-startboard-button-edit",gi,v,g.addPartsCommand,!1,(function(){gt.trace({source:ni.Dashboard,action:ti.CustomizeModeEntered});gt.trace({source:ni.Dashboard,action:ti.DashboardEditCommandClicked});g.addPartsCommand.execute(!1)})),ut,rt,it,hi,ci,ai,vi,dt;r.computed(n,(function(){var n=g.addPartsCommand,t=n&&n.enabled();t?si.removeAttr(yt):si.attr(yt,"true")}));li||o.findByClassName(ui).remove();ut=o.findByClassName(
ri);ut.attr(fi,ht.titleLabel);ut.on(et.default.change,(function(){g.title(ut.val());o.trigger(t.fxstartboardtitlechanged)}));rt=new nt.ViewModel('<div class="fxs-startboard-title" data-bind="text: data.title, attr: { title: data.title }"><\/div>'+('<div class="'+lt+'">'+ft.getSvgReferenceOrFallBackToData(l,{palette:99})+"<\/div>"),"<div class='fx-dropmenu-dropdown'>"+('<ul class="fxs-dropmenu-list-system" role="menu" aria-label="'+i.encodeAttribute(ht.recentMenuLabel)+'">')+"<!-- ko ifnot: data.dashboardList -->"+("<li class='"+at+'\' role="menuitem" tabindex="0">')+'<div class="fxs-tile-progress-transparent"><div><\/div><div><\/div><div><\/div><div><\/div><div><\/div><\/div><\/li><!-- /ko --><!-- ko if: data.dashboardList --><!-- ko ifnot: data.dashboardList().length -->'+("<li class='"+at+'\' role="menuitem" tabindex="0">')+("<div class='fxs-dropmenu-list-content'>"+i.encodeHtml(ht.emptynext)+"<\/div>")+"<\/li><!-- /ko --><!-- ko foreach: data.dashboardList -->"+("<li class='"+at+" "+wt+
' fxs-portal-hover msportalfx-tooltip-overflow\' role="menuitem" data-bind="attr: { \'aria-label\': $parent.func.altText(title, id) }, event: { click: $parent.func.clickHandler, keydown: $parent.func.clickHandler }">')+'<div class=\'fxs-dropmenu-list-content fxs-startboard-item-container\'><div class="fxs-startboard-item-icon"><!-- ko if: id.indexOf("private") === -1 -->'+ft.getSvgReferenceOrFallBackToData(b)+"<!-- /ko --><\/div><div class=\"fxs-startboard-item-title\" data-bind='text: title'><\/div><\/div><\/li><!-- /ko --><!-- /ko -->"+('<li class="'+at+' fxs-startboard-dropdown-browseall fxs-portal-hover" role="menuitem">')+'<div class="fxs-startboard-dropdown-subscriptions" data-bind="text: data.subscriptionsInfo"><\/div>'+('<a tabindex=\'-1\' href="#" class="'+vt+' fxs-portal-text-primary">'+i.encodeHtml(ht.browseAll)+"<\/a>")+"<\/li><\/ul><\/div>",bt);it=o.findByClassName("fxs-startboard-dropdown");rt.alignMenu=0;hi=this._selectorMenu=new nt.Widget(it,rt);rt.isMenuOpen.subscribe(
n,(function(n){n&&g.refreshDashboardList&&(g.dashboardList(undefined),g.refreshDashboardList((function(n){g.dashboardList(n);it.find(".fxs-dropmenu-button")[0]===document.activeElement&&st.requestAnimationFrame((function(){it.find(bt).filter(":tabbable").focus()}))})))}));g.dashboardList.subscribeAndRun(n,(function(){ot.resetTabbableItem(it,bt,"."+wt)}));r.reactor(this.ltm,(function(){it.find(".fxs-dropmenu-button").attr(fi,ht.switcherLabel.format(g.title()))}));ci=function(n,t){if(t.type===et.default.keydown&&!((t.keyCode===13||t.keyCode===32)&&h.getModifierKeys(t)===0))return!0;t.preventDefault();t.stopPropagation();o.findByClassName("fxs-startboard-title-next").text(n.title);g.switchDashboard&&g.switchDashboard(n).then((function(){var n=Math.min(Math.max(it.outerWidth()+50,400),560);it.find(".fxs-dropmenu-content").css({minWidth:n})}));rt.close()};r.applyBindings({data:g,func:{clickHandler:ci,altText:function(n,t){return n+" "+(t.indexOf("private")===-1?ht.sharedStatusLabel:"")}}},hi.element[0]);
tt("fxs-startboard-button-new",bi,c,g.newCommand);g.filterButtonText(nr);ai=tt(ui,g.filterButtonText(),p,g.filterCommand);g.filterButtonText.subscribe(n,(function(n){ai.findByClassName(ct).html(n)}));tt("fxs-startboard-button-clone",ir,a,g.cloneCommand);vi=tt("fxs-startboard-button-share",tr,b,g.shareCommand,kt.chrome.hideDashboardShare);r.reactor(n,this._isSharedToArm,(function(n){var t=n?ht.unshare:ht.share;pt(vi,t)}));tt("fxs-startboard-button-delete",ki,k,g.deleteCommand);var fr=tt("fxs-startboard-button-fullscreen",oi,w,g.fullscreenCommand),yi=function(){var n=f.isFullscreen(),t=n?ht.exitFullscreen:oi;u(document.body).toggleClass("fxs-portal-fullscreen",n);pt(fr,t)},pi=u(document),wi=f.fullscreen;pi.on(wi,yi);n.registerForDispose([function(){pi.off(wi,yi)},it.setEvents([et.default.click,function(){return ii.trigger(et.default.fxdashboardactivity)}])]);tt("fxs-startboard-button-migrate",ht.migrate,a,null,!1,(function(){o.trigger(t.fxmigratestartboard)}));dt=i.isFeatureEnabled("dashboardupanddown");
tt("fxs-startboard-button-upload",ei,d,g.uploadCommand,!dt,i.noop);tt("fxs-startboard-button-download",di,y,g.downloadCommand,!dt);o.findByClassName(vt).click((function(n){n.preventDefault();g.browseCommand.execute(!1)}))},dt.prototype._handleUploadItemClick=function(n){var t=this.options.uploadCommand.fileInputOptions;t&&t()&&t().files(n);this.trigger("itemSelected",null,{item:this.options.uploadCommand.execute(!1)})},dt})(ut.Widget);t.Widget=oi}));define("MsPortalImpl/UI/Compositions/UI.Composition.StartBoard",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter","MsPortalImpl/UI/Compositions/UI.Composition.DashboardFiltersManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager",
"MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){"use strict";function rt(n){return n!==o.desktopSettingsKey&&n!==o.startBoardSettingsKey&&!i.startsWith(n,y.partIdentityStatePrefix)}function ct(n){var t=new nt(n);return t.save(),t}function lt(n,t,i){var f=r.keys(t).filter(rt).map((function(i){return w.Instance.fromJSON(n,t[i])})),u=new nt(n,f,i.widgetState);return u.logChildren(),u.loadFromJson(i),u}function at(n,t){var i=[],r=new b.EnterOrganizeMode(n,t,!0);return r.text(e.Dashboard.edit),i.push(new b.ResetStartBoardCommand(n,t),r,new b.ExitOrganizeMode(n,t)),i}var ut=i.Base,tt=ut.Diagnostics,ft=tt.Telemetry,et=i.Parts,ot=c.CompositionType,st=p.ReferenceScope,it=tt.createLog(n),ht=c.getIdMatchFunc,
nt;t.fxstartboardsettingchanged="fxstartboardsettingchanged";t.isStartboardPartKey=rt;nt=(function(n){function e(t,r,f){n.call(this,"Startboard",t,null,r,f,o.startBoardSettingsKey);this._partAwaiter=new a.CompositionAwaiter(!0);this._containerAwaiter=new a.CompositionAwaiter;this.masterContainer=null;this.detailContainers=[];this.notFound=u.observable(!1);this._store=4;i.isFeatureEnabled("dashboardfilters")&&this.registerForDispose(this.dashboardFiltersManager=new v.DashboardFiltersManager(this))}return __extends(e,n),e.prototype.getCompositionType=function(){return ot.Startboard},e.prototype.setGetDashboard=function(n){if(this._getDashboard)throw new Error("GetDashboard can only be set once by DashboardManager");this._getDashboard=n},e.prototype.removeGetDashboard=function(){this._getDashboard=null},e.prototype.getDashboard=function(){var n=this._getDashboard;return n?n():null},e.prototype.onDetailContainersChanged=function(){},e.prototype.getDeepLink=function(){return Q("")},e.fromJSON=
function(n,t,i){return c.createCompositionFromJSON(i,(function(){return lt(n,t,i)}),(function(t,i){var r=new e(n);return r.unrecoverableErrorMessage=i,r}))},e.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this),r=this._getDashboard?this._getDashboard():null,f;return r&&(t.dashboardId=r.id,t.dashboardTitle=r.title,f=r.model,t.dashboardModel=f?{model:u.toJS(f.model),metadata:i.clone(f.metadata,!0)}:undefined),delete t.children,t},r.defineProperty(e.prototype,"eligibleForBinding",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.getInputPropertyBindings=function(){throw new Error("Unreachable code");},e.prototype.getViewModel=function(n){var r,t;if(n=i.isNullOrUndefined(n)?8:n,n===8){if(t=this._getDashboard&&this._getDashboard().model,!t)throw new Error("There is no current Dashboard.");r=t.model}return r||{}},e.prototype.getViewModelAsync=function(n){return f.Deferred().resolve(this.getViewModel(n)).promise()},e.prototype.getCompatibleSourceReferences=function(
n){var u=this._getDashboard&&this._getDashboard().model,t=u&&u.metadata,i,f;return t&&(i=n.type,i)?(f=r.keys(t).filter((function(n){var r=t[n];return r===i})),f.map((function(n){return{property:n,modelType:8,scope:st.CurrentContainer,cardinality:p.ReferenceCardinality.OneToOne}}))):null},e.prototype.logChildren=function(){this.children.forEach((function(n){var t=n&&n.widgetState(),i=t&&t.NormalState?et.InternalPartSize[t.NormalState.size]:"";ft.trace({extension:n.locator.getExtensionLocator().name,source:s.Source.StartBoardPart,action:s.Action.StartBoardPartLoaded,name:n.locator.toFriendlyString(),data:i})}))},e.prototype.getFilters=function(){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFilters()},e.prototype.updateFilters=function(n,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.updateFilters(n,t)||Q()},e.prototype.setFilters=function(n){return this.dashboardFiltersManager&&this.dashboardFiltersManager.setFilters(n)},e.prototype._compose=function(
n,r){var s=this,f=new k.ViewModel(this.id,this.widgetState(),this,this.dashboardFiltersManager&&this.dashboardFiltersManager.filtersWidgetViewModel),o=this.services,e=this.createChildLifetime();u.utils.arrayPushAll(f.commands,at(e,this.services));var p=f.addPartsCommand=i.find(f.commands,(function(n){return n.commandName===b.CommandNames.EnterOrganizeMode})),w=f.newCommand=new b.NewDashboard(e,o),nt=f.cloneCommand=new b.CloneDashboard(e,o),tt=f.filterCommand=new b.FilterDashboard(e,o,this),rt=f.fullscreenCommand=new b.FullscreenDashboard(e,o),ut=f.deleteCommand=new b.DeleteDashboard(e,o),ft=f.shareCommand=new b.ShareDashboard(e,o),et=f.browseCommand=new b.OpenBrowseDashboardsPane(e,o),ot=f.uploadCommand=new b.UploadDashboard(e,o),st=f.downloadCommand=new b.DownloadDashboard(e,o),a=this._getDashboard?this._getDashboard().title:null;a&&f.title(a);var v=this.widget=new k.Widget(n.getStartBoardArea(),f),l=v.element,y=function(n,t){n.bind(new h.CompositionInstanceCommandContext(l.findByClassName(
t)[0],null,s))};y(p,k.widgetClass+"-title");[[w,"new"],[nt,"clone"],[tt,"filter"],[rt,"fullscreen"],[ut,"delete"],[ft,"share"],[et,"browse"],[ot,"upload"],[st,"download"],].forEach((function(n){var t=n[0],i=n[1];y(t,k.headerButtonClass+"-"+i)}));l.data(c.CompositionInstanceDataName,this);v.ltm.registerForDispose([e,l.setEvents([d.Widget.viewSettingsChanged,function(n,i){n.stopPropagation();s.widgetState(i);l.trigger(t.fxstartboardsettingchanged)}],[g.default.fxunpin,function(n,t){var i=s.children.first(ht(t.tileId));i&&(it.warning("Part '{0}' is about to be removed due to user unpin operation.".format(i)),s.services.desktop.removeTile(i.id));setTimeout((function(){var n=s.widget;n&&n.setFocus()}),50)}])]);r.resolve()},e.prototype.matchesLocatorAndModel=function(){return!1},e.prototype.resetLayout=function(){this.services.desktop.resetStartBoard()},e.prototype.dispose=function(){it.warning("UI.Composition.Startboard.dispose() has been called.");n.prototype.dispose.call(this,!0)},r.defineProperty(
e.prototype,"journeyPath",{get:function(){return[]},enumerable:!0,configurable:!0}),e.prototype.getComposedParts=function(){return this._partAwaiter.resolvedCompositions},e.prototype.awaitComposedPart=function(n,t){return this._partAwaiter.await(n,t)},e.prototype.notifyPartComposed=function(n){this._partAwaiter.resolve(n)},e.prototype.awaitContainer=function(n,t){return this._containerAwaiter.await(n,t)},e.prototype.notifyContainer=function(n){this._containerAwaiter.resolve(n)},e.prototype.onInvocationStarted=function(){},e.prototype.getDiagnosticsData=function(){return f.extend(n.prototype.getDiagnosticsData.call(this),{detailBlades:this.detailContainers.map((function(n){return n+""}))})},e})(l.Instance);t.Instance=nt;t.create=ct}));define("MsPortalImpl/UI/Dashboard/DashboardClient",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function u(n){return new t(new r(n))}var r=(function(){function n(n){this._extensionManager=n}return n.prototype.connect=function(
n,t,r,u){var f,e;return this._extensionManager.getExtensionByName(n,t).then((function(n){return f=n,Q(f.getViewModel(r(f)))})).then((function(n){return e=n,Q(u(n.content))})).finally((function(){i.disposeViewModelProperties(e);f&&e&&f.releaseViewModel(e)}))},n})(),t;n.ViewModelConnectorImpl=r;n.create=u;t=(function(){function n(n){this._connector=n}return n.prototype.getDashboard=function(n,t,i){return this._connector.connect(t,i,(function(n){return n.definition.dashboardProvider.viewModel}),(function(t){return t.getDashboard(n)}))},n})();n.DashboardClientImpl=t})(r||(r={})),r}));define("MsPortalImpl/UI/Dashboard/DashboardCompressor",["require","exports","f","i","o","ko","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager",
"MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Widgets/Widgets.FlowLayout"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function et(n,t){var y=t[k],p=y.widgetState,d=p.NormalState.layoutSettings.positions,r=d.first((function(t){return t.id===n})),v,u;if(!r)return w.warning("Cannot compress part '"+n+"', because it does not have position in startboard."),null;var i=t[n],g=i.adapterBindings||i.bindings,s=f.toJS(it(i.containerModel)),nt=f.toJS(it(i.overridesModel)),l=(g||[]).map((function(n){var t=n.source,f=t&&t.property,e=n.targetProperty,r=t&&t.modelType,u,i,l,a;if(c.isDynamicBindingWithNonLocalSource(n))if(r===8)u={name:e,binding:f};else return w.error("For binding for property '{0}', encountered unsupported reference type '{1}'.".format(e,o.referenceTypeMap[r]||r)),null;else i=void 0,l=h.getModelValue(nt,f),l.exists?i=tt(l.value):r===5?i=t.constantValue:(a=h.getModelValue(s,f),a.exists&&(i=tt(a.value))),u=
{name:e,value:i};return!n.optional||(u.isOptional=!0),u}));if(l.firstIndex((function(n){return!n}))>=0)return null;v=s[o.PartContainerModelIdProperty];u={};u[o.PartContainerModelIdProperty]=v;var rt=e.Locator.fromJSON(i.locator),ut=a.buildIdentitySettingKey(rt,u),ft=t[ut]||undefined,et=st(i.locator),ot=ct(i.partState),ht=at(i.assetInstanceDefinition);return{position:{x:r.position.col,y:r.position.row,colSpan:b(r.colSpan),rowSpan:b(r.rowSpan)},metadata:{inputs:l,type:et,settings:ft,isAdapter:i.adapterBindings?!0:undefined,viewState:ot,asset:ht,defaultMenuItemId:i.defaultMenuItemId}}}function ot(n,t,i,u){var h=n.metadata,p=ht(h.type),nt=lt(h.viewState),tt=vt(h.asset),w=v.getDefaultSize().name,it={NormalState:{size:w}},c={},k;c[o.PartContainerModelIdProperty]=f.observable(t);var b=e.Locator.fromJSON(p),rt=s.createIdentifier(ut.StartboardPart,b,i),l={locator:p,partState:nt,assetInstanceDefinition:tt,initialSize:w,widgetState:it,id:rt,bindingsInitialized:!0,dontSetupWidget:!1,defaultMenuItemId:
h.defaultMenuItemId,childSettings:{},children:[],containerModel:r.toSerializableObject(c),overridesModel:undefined,editScopeId:undefined,bindings:undefined,adapterBindings:undefined,errorMessage:undefined,originalPartLocator:undefined},y=[];return h.inputs.forEach((function(n){var r=n.name,t,i=n.binding,u;i?t={property:i,modelType:8,cardinality:d.OneToOne,scope:g.CurrentContainer}:(u=n.value,t={property:r,constantValue:u,modelType:5,cardinality:d.OneToOne,scope:g.CurrentContainer});y.push({source:t,targetProperty:r,optional:!!n.isOptional,isDynamicBinding:i?!0:undefined})})),h.isAdapter?l.adapterBindings=y:l.bindings=y,h.settings&&(k=a.buildIdentitySettingKey(b,c),u(k,h.settings)),l}function st(n){var r=encodeURIComponent,f=[],t=n,i,u,o;do i=r(e.LocatorType[t.type]),u=t.cloudName?r(t.cloudName):undefined,u&&(i=i+"["+u+"]"),o=[i,r(t.name)],f.unshift(o.join("/")),t=t.parent;while(t);return f.join("/")}function ht(n){var i=decodeURIComponent,u=[],r=[],t;return n.split("/").forEach((function(
n,t){r.push(n);t%2==1&&(u.push(r),r=[])})),u.forEach((function(n){var s=i(n.pop()),r=n.pop(),f,o=r.match(/\[(.*?)\]/),u;o&&(r=r.substring(0,r.lastIndexOf(o[0])),f=i(o[1]));r=i(r);u={name:s,type:e.LocatorType[r]};f&&(u.cloudName=f);t&&(u.parent=t);t=u})),t}function ct(n){n=r.isSerializedObject(n)?r.fromSerializableObject(n):n;var f=u.keys(n).filter((function(n){return n!=="container"&&n!=="internal"})),t={};return i.shallowCopyFromObject(t,n,f),nt(t)?undefined:t}function lt(n){return r.toSerializableObject(n||{})}function at(n){return nt(n)?undefined:{idInputName:n.assetIdInputProperty,type:n.assetType}}function vt(n){return n?{assetIdInputProperty:n.idInputName,assetType:n.type}:{}}function yt(n){if(!n)return undefined;var t=n.model,r=n.metadata,i={};return u.keys(t).forEach((function(n){i[n]={value:t[n],type:r[n]}})),i}function pt(n){if(!n)return undefined;var t={},i={};return u.keys(n).forEach((function(r){var u=n[r];t[r]=u.value;i[r]=u.type})),{model:t,metadata:i}}var rt=i.Base.Diagnostics,d=
h.ReferenceCardinality,g=h.ReferenceScope,ut=o.CompositionType,nt=i.isEmpty,tt=f.unwrap,w=rt.createLog(n),b=function(n){return Math.min(Math.max(n,1),25)},it=c.createContainerModel,k=y.startBoardSettingsKey,ft=(function(){function n(){}return n.prototype.compress=function(n){var t=n.settings,i=n.title,r=t[k],f=yt(r.dashboardModel),e=u.keys(t).filter((function(n){return l.isStartboardPartKey(n)})).map((function(n){return et(n,t)})).filter((function(n){return!!n}));return{title:i,model:f,parts:e}},n.prototype.uncompress=function(n,t,r,u){var f={},e=[],h;t.parts.forEach((function(n,t){var c=r?r(t):i.getUniqueId(),l=u?u(t):undefined,s=ot(n,c,l,(function(n,t){f[n]=t})),o,h;f[s.id]=s;o=n.position;h={id:s.id,colSpan:b(o.colSpan),rowSpan:b(o.rowSpan),position:{col:o.x,row:o.y}};e.push(h)}));try{var o=p.validateGrid(e),c=o.success,s=o.result;c||(h=s.overlappedParts.join(", "),w.warning("Part '"+s.misplacedPart+"' is misplaced and overlaps with '"+h+"'."))}catch(l){w.error(l,1)}var a={NormalState:{layoutSettings:
{positions:e}}},v=pt(t.model),y={id:k,childSettings:{},locator:null,errorMessage:undefined,widgetState:a,dashboardId:n,dashboardTitle:t.title,dashboardModel:v};return f[k]=y,{id:n,title:t.title,settings:f}},n})();t.DashboardCompressor=ft}));define("MsPortalImpl/UI/Dashboard/PrivateDashboardRepository",["require","exports","f","o","MsPortalImpl/UI/Dashboard/DashboardRepository","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Settings.Schema"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function a(n){var i=r.keys(n);if(i.length>=100)throw new Error("There are no more dashboard stores available.");for(var f=i.map((function(t){return n[t].storeName})),u=0,t=w(u);f.indexOf(t)>-1;)t=w(++u);return t}function b(n,t){for(var u=t||p,o=r.keys(n).map((function(t){return n[t].title.toLowerCase()})),s=function(n){return o.indexOf(n.toLowerCase())>=0},f=function(n){return n<=1?u:u+" ("+n+")"},e=1,i=f(e);s(i);)i=f(++e);
return i}function k(n,t,i,r){var u=r.settings[o.startBoardSettingsKey];u.dashboardId=i;n.setSetting(h(t),i,r);n.setSetting(s,i,{storeName:t,id:r.id,title:r.title});n.flushSettings()}function d(){var n=i.getUniqueId();return""+v+n}function g(n,t){return n[t]&&n[t].storeName}function nt(n){return!!h(n)}function tt(n){return n.queryStore(s).then((function(n){return n||{}}))}var rt=i.Base,ut=rt.Diagnostics,c=f.Dashboard,ft=ut.createLog(n),v="private/",l="recentDashboards",y=10,s=11,p=c.defaultTitle,w=e.getDashboardStoreName,h=e.getDashboardStoreId,et=i.forEachKey,it;t.buildNextStoreName=a;t.createDashboardTitle=b;it=(function(){function n(n){this._settingsManager=n}return n.prototype.getTypeName=function(){return u.PrivateDashboardRepository},n.prototype.createDashboard=function(n){var r=this,t=n.extras&&n.extras.id||d(),i={id:t,title:n.title,settings:n.settings};return this._getDashboards().then((function(n){return k(r._settingsManager,a(n),t,i),i}))},n.prototype.readDashboard=function(n){var t=
this;return this._getDashboards().then((function(i){var r=g(i,n);if(r)return t._settingsManager.querySetting(h(r),n)}))},n.prototype.updateDashboard=function(n,t){var r=this;return this.readDashboard(n).then((function(u){if(u){var f={};return i.shallowCopyFromObject(f,u),i.shallowCopyFromObject(f,t),r._getDashboards().then((function(t){var i=g(t,n)||a(t);return k(r._settingsManager,i,n,f),f}))}return r.createDashboard({title:t.title,settings:t.settings,extras:{id:n}})}))},n.prototype.deleteDashboard=function(n){var t=this._settingsManager;return tt(t).then((function(i){var f=i[n],u,e,o;u=f?f.storeName:r.keys(i).filter(nt).first((function(t){return(i[t]||{}).id===n}));u&&t.deleteSettings({store:h(u),keys:[n]});e=u&&i[u]&&i[u].id===n;o=e?[u,n]:[n];t.deleteSettings({store:s,keys:o});t.flushSettings()}))},n.prototype.readDashboards=function(){return this._getDashboards().then((function(n){return r.keys(n).map((function(t){return n[t]}))}))},n.prototype.identifyDashboard=function(n){return i.startsWith(n,
v)},n.prototype.isDashboardWritable=function(){return Q(!0)},n.prototype.getNotFoundMessage=function(n){return c.NotFound.privateMessageFormat.format(n.title)},n.prototype.canCreateNewDashboard=function(){return this._getDashboards().then((function(n){return r.keys(n).length<100}))},n.prototype.cloneDashboard=function(n,t){return this.createDashboard({settings:n,title:c.cloneTitleFormat.format(t)})},n.prototype.getRecentDashboards=function(){return this._settingsManager.querySetting(s,l).then((function(n){var t=(n||[]).slice(0,y).filter((function(n){return!!n.id}));return i.unique(t,(function(n,t){return n.id.toLowerCase()===t.id.toLowerCase()}))}))},n.prototype.addToRecent=function(n){var t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase()===n.id.toLowerCase()}));return u===0?r:(u>0&&r.splice(u,1),r.unshift({id:n.id,title:n.title}),r=r.slice(0,y),t._settingsManager.setSetting(s,l,r),r)}))},n.prototype.removeFromRecent=function(n){var
t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase()===n.toLowerCase()}));return u>=0&&(r.splice(u,1),t._settingsManager.setSetting(s,l,r)),r}))},n.prototype.createDefaultDashboard=function(n){var t;return t=n?Q(n):this._getDashboards().then((function(n){return b(n)})).catch((function(n){return ft.error(n,0,"Failed to generate a dashboard title with index."),p})),t.then((function(n){var t=d();return{id:t,title:n}}))},n.prototype._getDashboards=function(){var n=this;return tt(this._settingsManager).then((function(t){var i={};return et(t,(function(t,r){if(r){var u;n.identifyDashboard(t)?(u=r,i[u.id]=u):nt(t)&&(u=r,i[u.id]||(i[u.id]=u))}})),i}))},n})();t.PrivateDashboardRepository=it})(s||(s={})),s}));define("MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository",["require","exports","f","i","MsPortalImpl/UI/Dashboard/DashboardRepository","FxHubs/CloudNameCommon"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function e(n){var
i=n.substr(t.length),u=f.getCloudNameFromId(i),r;return i=f.removeCloudNameFromId(i),r=i.split("/"),{cloudName:u,dashboardParam:r.slice(1).join("/"),extensionName:r[0]}}var t="recommended/",o;n.parseDashboardId=e;o=(function(){function n(n,t){this._dashboardClient=n;this._compressor=t}return n.prototype.createDashboard=function(){return r.QReject("Cannot create a recommended dashboard")},n.prototype.readDashboard=function(n){var i=this,t=e(n);return this._dashboardClient.getDashboard(t.dashboardParam,t.extensionName,t.cloudName).then((function(t){return i._compressor.uncompress(n,t)}))},n.prototype.updateDashboard=function(){return r.QReject("Cannot update a recommended dashboard")},n.prototype.deleteDashboard=function(){return Q()},n.prototype.readDashboards=function(){return Q([])},n.prototype.getTypeName=function(){return u.RecommendedDashboardRepository},n.prototype.identifyDashboard=function(n){return i.startsWith(n,t)},n.prototype.isDashboardWritable=function(){return Q(!1)},n})();n.
RecommendedDashboardRepository=o})(e||(e={})),e}));define("_generated/Templates/WidgetsAvatarMenu",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-dropdown"> <ul class="fxs-avatarmenu-list-system" role="presentation"> <li class="fxs-portal-hover" role="presentation"> <a href="" class="fxs-avatarmenu-signout" role="menuitem" data-bind=\'attr: { title: text.signOutLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: text.signOutLabel"><\/div> <div class="fxs-dropmenu-image fxs-fill-error" data-bind="image: data.icons.signout"><\/div> <\/a> <\/li> <\/ul> <div class="fxs-avatarmenu-scrollviewer"> <div class="fxs-avatarmenu-list-system"> <ul role="presentation"> <li class="fxs-portal-hover" data-bind="visible: changePasswordLink" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-changepassword" role="menuitem" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: changePasswordLink, title: text.changePasswordLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: text.changePasswordLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.launchCurrent"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: !!data.links.accessDetails" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-myaccess" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.accessDetails, title: data.text.myAccessLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.myAccessLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.person"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: !!data.links.giveFeedback" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-feedback" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.giveFeedback, title: data.text.feedbackLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.feedbackLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.feedback"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: data.links.accountPortal" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-billing" role="menuitem" href="" rel="noopener noreferrer"> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.billingLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="visible: data.links.accountPortal && data.links.accountPortal.startsWith(\'#\')"><\/div> <\/a> <\/li> <\/ul> <\/div> <div class="fxs-avatarmenu-list-tenant fxs-portal-border fxs-dropmenu-line-separator" data-bind="visible: listOfTenants().length" role="presentation"> <!-- ko if: listOfTenants().length --> <div class="fxs-avatarmenu-dropdown-title" id="avatarMenuTenantListId" data-bind="text: text.tenant" role="presentation"><\/div> <ul data-bind="foreach: listOfTenants" aria-labelledby="avatarMenuTenantListId" role="group"> <li class="fxs-portal-hover" role="presentation"> <a tabindex="-1" role="menuitemradio" data-bind="css: { \'fxs-avatarmenu-current-tenant fxs-portal-selected fxs-portal-activated\': $index() === 0 }, attr: { href: $index() === 0 ? \'#\' : \'\', \'aria-checked\': $index() === 0 }"> <div class="fxs-avatarmenu-tenant-name fxs-portal-text" data-bind="text: displayName, attr: { title: displayName }"><\/div> <div data-bind="text: domainName, attr: { title: domainName }" class="fxs-avatarmenu-tenant-uri"><\/div> <\/a> <\/li> <\/ul> <!-- /ko --> <\/div> <\/div> <\/div>'}
}));define("_generated/Templates/WidgetsAvatarMenuButton",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-header fxs-trim-hover" data-bind="attr: { title: tooltip }"> <div class="fxs-avatarmenu-tenant-container"> <div class="fxs-avatarmenu-username" data-bind="text: displayName"><\/div> <div class="fxs-avatarmenu-tenant" data-bind="text: currentTenantDisplayName"><\/div> <\/div> <img class="fxs-avatarmenu-tenant-image" data-bind="attr: { src: avatarUri }" alt=""/> <\/div>'}}));define("MsPortalImpl/Widgets/Widgets.AvatarMenu",["require","exports","f","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Telemetry","_generated/Templates/WidgetsAvatarMenu","_generated/Templates/WidgetsAvatarMenuButton","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Svg/Library/Feedback.svg","MsPortalImpl/Svg/Library/LaunchCurrent.svg","MsPortalImpl/Svg/Library/Person.svg",
"MsPortalImpl/Svg/Library/Signout.svg","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function w(n){return(n||"").toLowerCase()}function k(n,t,i){var r=n.element.findByClassName(t);if(i)r.on(b,i);return r}function kt(n){var t=n.userIdentity(),i=t&&(t.displayName||dt(t));return i||n.text.defaultDisplayName}function dt(n){var t=n.firstName||"",i=n.lastName||"";return!t&&!i?"":it.test(t)&&it.test(i)?"":f.AvatarMenu.displayNameFormat.format(t,i)}function gt(n,t){return t().first((function(t){return n().tenantId===t.id}))}function ni(n,t){return r.pureComputed((function(){var u=n(),r=u&&w(u.tenantId),i=t();return i.length===1&&i[0]&&w(i[0].id)===r?[]:i.sort((function(n,t){var e=w(n.id),f,i,u;return e===r?-1:(f=w(t.id),f===r)?1:(i=n.displayName,u=t.displayName,i<u?-1:i>u?1:0)}))}))}var rt=i.Base,ut=rt.Images,pt=window,wt=MsPortalImpl.Resources.Images.getAvatarMenu().defaultAvatarSmall,d=e.Source.TopBar,g=e.Action,nt=rt.Diagnostics.
Telemetry.trace,ft="fxs-avatarmenu",et="fxs-avatarmenu-list-tenant",tt="fxs-avatarmenu-signout",ot="fxs-avatarmenu-billing",st="fxs-avatarmenu-feedback",ht="fxs-avatarmenu-myaccess",ct="signOut",lt="switchedTenant",at="showDiagnostics",b=l.default.click,vt="a[role=menuitem], a[role=menuitemradio]",bt=(function(n){function t(){n.apply(this,arguments);this.dropMenu=new c.ViewModel(s(),o(),vt);this.userIdentity=r.observable();this.userInfo=r.observable();this.hideTenant=r.observable();this.listOfTenants=r.observableArray();this.showDiagnostics=null;this.openMenu=null;this.signOut=null;this.signedOut=null;this.switchTenant=null;this.switchedTenant=null;this.text=f.AvatarMenu;this.links=pt.fx.environment.links;this.icons={feedback:a,signout:ut.CustomImageWithOptions(p,{isLogo:!0}),person:ut.CustomImageWithOptions(y,{palette:99}),launchCurrent:v};this.avatarImage=r.observable();this.showDiagnosticsDelay=3e3}return __extends(t,n),t})(h.ViewModel),it,yt;t.ViewModel=bt;it=/^(f(irst)?|l(ast)?)\s?name$/i;
yt=(function(n){function t(t,i){var a=this,h,u;n.call(this,t,i);this._lastTouchMillis=0;var e=this.element,o=this.ltm,s=i.dropMenu;e.addClass(ft);h=r.pureComputed((function(){return kt(i)}));u=r.pureComputed((function(){var n=i.userInfo();return i.hideTenant()||!n?"":n.uniqueDirectoryName}));s.buttonClass="fxs-menu-account";r.computed(o,(function(){var n=f.AvatarMenu.label+" "+i.text.userLabel.format(h());u()&&(n=f.AvatarMenu.label+" "+i.text.userWithTenantLabel.format(u()));s.buttonLabel(n)}));this._dropMenuWidget=new c.Widget(e,s);var y=r.pureComputed((function(){var n=i.userIdentity(),r,f,e,o;if(!n)return"";var u=i.text.Tooltip,s=u.tenant,t=[];return(n.firstName||n.lastName)&&t.push(u.name.format(n.firstName||"",n.lastName||"")),n.displayName&&t.push(u.email.format(n.displayName)),r=gt(i.userIdentity,i.listOfTenants),r&&!i.hideTenant()&&(t.push(s.format(r.displayName,r.id)),f=r.domainName||"",e=n.tenantDomain,t.push(e&&w(f)!==w(e)?s.format(f,e):u.domain.format(f))),o=t.join("\n"),a._dropMenuWidget.
options.buttonTooltip(o),o})),l=r.observable(wt),v=r.observable();r.reactor(o,(function(){var n=i.userIdentity(),t;n&&(v(n.changePasswordUri),n.isAnonymous||(l(n.defaultAvatarUri),t=i.avatarImage(),t&&t.then((function(n){l(n)}))))}));r.applyBindingsToDescendants({data:i,func:this,displayName:h,listOfTenants:ni(i.userIdentity,i.listOfTenants),text:i.text,currentTenantDisplayName:u,tooltip:y,avatarUri:l,changePasswordLink:v},e[0]);r.reactor(o,i.dropMenu.isMenuOpen,(function(n){n&&a._reactToMenuOpen()}));this._attachEventHandlers()}return __extends(t,n),t.prototype.dispose=function(){this._dropMenuWidget.dispose();this._cleanElement(ft);n.prototype.dispose.call(this)},t.prototype._signOut=function(n){(nt({source:d,action:g.AvatarMenuSignOut}),this.trigger(ct,u.Event(ct),{completed:!!n}))&&this.trigger("signedOut")},t.prototype._switchTenant=function(n){var t=this.options.userIdentity();if(w(n.id)!==(t&&w(t.tenantId))){if(nt({source:d,action:g.AvatarMenuSwitchTenant}),!this.trigger("switchTenant"))
return;this.trigger(lt,u.Event(lt),{tenant:n})}},t.prototype._attachEventHandlers=function(){var n=this,t=this.element,i=this.options,o=i.links,r,f,s,h,e;h=function(){n._lastTouchMillis=Date.now()};s=function(t){if(n._lastTouchMillis){var r=Math.abs(Date.now()-n._lastTouchMillis);n._lastTouchMillis=0;r>i.showDiagnosticsDelay&&(n.trigger(at,u.Event(at)),t.preventDefault())}};r=function(n){i.openAccountPortal();o.accountPortal.startsWith("#")&&n.preventDefault()};f=function(n){i.giveFeedback();o.giveFeedback.startsWith("#")&&n.preventDefault()};e=k(this,"fxs-avatarmenu-header");e.on([l.default.touchstart,l.default.mousedown].join(" "),h);e.on([l.default.touchend,l.default.mouseup].join(" "),s);k(this,ot,r);k(this,st,f);this.ltm.registerForDispose((function(){t.off(b,tt,n._signOutHandler);t.off(b,ot,r);t.off(b,st,f);t.off(b,et,n._tenantHandler);t.off(b,ht,n._myAccessHandler)}))},t.prototype._reactToMenuOpen=function(){var n=this,t=this.options,i;if(this.element.find(vt).attr("tabindex","-1"),
i=k(this,tt),i.attr("tabindex","0").focus(),nt({source:d,action:g.AvatarMenuOpen}),this._signOutHandler||k(this,tt,this._signOutHandler=function(t){n._signOut(!1);t.preventDefault()}),!this._tenantHandler)k(this,et).on(b,"a",this._tenantHandler=function(t){t.preventDefault();n._switchTenant(r.dataFor(t.target))});this._myAccessHandler||k(this,ht,this._myAccessHandler=function(n){t.links.accessDetails.startsWith("#")&&n.preventDefault();t.showMyAccessBlade()})},t})(h.Widget);t.Widget=yt}));define("_generated/Templates/WidgetsTopBar",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-topbar-exit-customize"> <div class="fxs-topbar-exit-customize-message" data-bind="text: data.text.exitCustomizeText"><\/div> <button type="button" class="fxs-topbar-exit-customize-button fxs-button fxs-portal-button-primary" data-bind="text: data.text.exitCustomizeButton"><\/button> <\/div> <div class="fxs-topbar-content fxs-hide-in-customize" role="banner" aria-labelledby="bannerlabel"> <div class="fxs-topbar-internal fxs-bg-warning" data-bind="visible:data.showPreview, text: data.text.internalText"><\/div> <a href="#" id="bannerlabel" class="fxs-topbar-home fxs-trim-text-primary fxs-trim-hover" data-bind="text: data.productName, attr: { title: data.dashboardTooltip }"><\/a> <div class="fxs-topbar-placeholder"><\/div> <!-- ko if: data.inDevMode --> <a class="fxs-topbar-exitdevmode fxs-trim-hover fxs-bg-warning" href="#" role="button" data-bind="text: data.text.exitDevModeLinkText, click: func._exitDevMode"><\/a> <!-- /ko --> <!-- ko if: data.canReportBug --> <a href="#" class="fxs-topbar-reportbug fxs-trim-hover fxs-bg-warning" role="button" data-bind="text: data.text.reportBug, click: func._reportBug, attr: { title: data.text.reportBugTitle, \'aria-label\': data.text.reportBug }"><\/a> <!-- /ko --> <div class="fxs-topbar-search" data-bind="stopBindings: true" role="presentation"><\/div> <div class="fxs-topbar-notifications fxs-trim-hover"> <a href="#" class="fxs-trim-svg fxs-topbar-button" role="button" data-bind="image: data.icons.notifications, attr: { title: data.text.notifications, \'aria-label\': data.text.notifications }"><\/a> <div class=\'fxs-notificationspane-progressbar fxs-display-none\'><div><\/div><\/div> <\/div> <div class="fxs-topbar-toast" role="presentation"><\/div> <a href="#" role="button" class="fxs-topbar-console fxs-topbar-button fxs-trim-hover fxs-trim-svg" data-bind="attr: { title: data.text.console }, image: data.icons.console"><\/a> <a href="#" class="fxs-topbar-settings fxs-menu-settings fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.settings }, image: data.icons.settings"><\/a> <!-- ko if: data.showFeedbackButton --> <a href="#" class="fxs-topbar-feedback fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.feedback }, image: data.icons.feedback"><\/a> <!-- /ko --> <a href="#" class="fxs-topbar-helpmenu fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.help }, image: data.icons.help"><\/a> <a href="#" class="fxs-topbar-peekmode fxs-topbar-button fxs-trim-hover fxs-trim-svg fxs-display-none" role="button" data-bind="attr: { title: data.text.peek }, image: peekModeIcon"><\/a> <!-- ko if: data.directoryPaneEnabled --> <a href="#" class="fxs-topbar-directory fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.directory }, image: data.icons.directory"><\/a> <!-- /ko --> <div class="fxs-topbar-avatarmenu" data-bind="stopBindings: true"><\/div> <\/div> <div class="fxs-topbar-dashboard"> <div class="fxs-topbar-dashboard-message" data-bind="text: data.dashboardMessage"><\/div> <button type="button" class="fxs-button fxs-topbar-dashboard-done-customize" data-bind="text: data.text.exitCustomizeButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-view" data-bind="text: data.text.viewDashboardButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-save" data-bind="text: data.dashboardSaveButtonText"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-discard" data-bind="text: data.text.discardDashboardButton"><\/button> <\/div> <div class="fxs-loading5dots-container fxs-blade-progress-translucent" data-bind="visible: loading"> <div><\/div> <div><\/div> <div><\/div> <div><\/div> <div><\/div> <\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.TopBar",["require","exports","f","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.AvatarMenu","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsTopBar","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Svg/Startup/Settings.svg","MsPortalImpl/Svg/Startup/Console.svg","MsPortalImpl/Svg/Startup/Star.svg","MsPortalImpl/Svg/Startup/SmileyHappy.svg","MsPortalImpl/Svg/Startup/Help.svg","MsPortalImpl/Svg/Startup/Notifications.svg","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";var nt=i.Base,k=nt.Images,tt=e.findByClassName,it=window.fx.environment,d=it.features,rt="fxs-topbar",ut="fxs-topbar-notifications",ft="fxs-topbar-dashboard-done-customize",et="fxs-topbar-console",g=l.default.fxexitorganizemode,ot,st;t.fxfinishdashboardedit="fxfinishdashboardedit";ot=(function(n)
{function t(){n.apply(this,arguments);this.avatarMenu=new s.ViewModel;this.directoryPaneEnabled=i.isFeatureEnabled("directorypane");this.productName=it.branding.productName;this.showPreview=r.observable(i.isNullOrUndefined(d.internalonly)||d.internalonly==="true");this.text=f.TopBar;this.dashboardTooltip=f.KeyboardShortcuts.GoTo.dashboard;this.canReportBug=r.observable(!1);this.reportBug=u.noop;this.showFeedbackButton=d.feedback==="true";this.inDevMode=r.observable(!1);this.exitDevMode=u.noop;this.icons={settings:k.CustomImageWithOptions(a,{isLogo:!0}),help:k.CustomImageWithOptions(w,{isLogo:!0}),console:k.CustomImageWithOptions(v,{isLogo:!0}),notifications:k.CustomImageWithOptions(b,{isLogo:!0}),feedback:k.CustomImageWithOptions(p,{isLogo:!0}),directory:k.CustomImageWithOptions(y,{isLogo:!0})};this.dashboardMessage=r.observable("");this.dashboardSaveButtonText=r.observable("");this.dashboardChanged=r.observable(!1);this.dashboardWritable=r.observable(!1);this.dashboardVisible=r.observable(
!1);this.isInOrganizeMode=r.observable(!1);this.peekMode=r.observable(!1)}return __extends(t,n),t})(h.ViewModel);t.ViewModel=ot;st=(function(n){function f(t,f,o){var a=this,h,v,y;if(n.call(this,t,f),this._loadingIdList=r.observableArray([]),h=this.ltm,t.addClass(rt).attr("role","presentation").html(c()),h.registerForDispose(new s.Widget(t.findByClassName("fxs-topbar-avatarmenu"),this.options.avatarMenu)),r.reactor(h,(function(){t.toggleClass("fxs-topbar-devmode",!!f.inDevMode()).toggleClass("fxs-bg-warning",!!f.inDevMode())})),r.reactor(h,(function(){var t=f.dashboardWritable(),n=f.text;f.dashboardSaveButtonText(t?n.saveDashboardButton:n.saveDashboardCopyButton);f.dashboardMessage(t?n.saveMessage:n.saveCopyMessage)})),r.reactor(h,(function(){u(".fxs-portal-main").add(t).toggleClass("fxs-topbar-dashboard-changed",!!f.dashboardChanged());t.toggleClass("fxs-topbar-dashboard-visible",!!f.dashboardVisible());e.toggle(tt(t,ft),!!f.isInOrganizeMode());var i="fxs-portal-button-primary",r="fxs-button-default",
n=tt(t,"fxs-topbar-dashboard").findByClassName("fxs-button").filter(e.getUnhideSelector());n&&n.length&&(n.slice(1).removeClass(i).addClass(r),n.first().removeClass(r).addClass(i))})),v=r.observable(),this._bindDescendants({loading:r.computed(this.ltm,(function(){return a._loadingIdList().length>0})),peekModeIcon:v}),this._attachEventHandlers(t),i.isFeatureEnabled("azureconsole")){y=i.memoizeQ((function(){var n;return i.require("MsPortalImpl/Widgets/Widgets.Console").then((function(t){return n=t})).then((function(){return a.options.getConsoleViewModel()})).then((function(i){return i.isVisible.subscribeAndRun(h,(function(n){t.findByClassName(et).attr("aria-expanded",n)})),new n.Widget(o,i)}))}));t.findByClassName(et).css("display","flex").attr({"aria-controls":o.attr("id"),"aria-expanded":"false"}).on(l.default.click,(function(n){n.preventDefault();n.stopPropagation();y().then((function(n){return n.toggle()}))}))}t.findByClassName("fxs-topbar-feedback").on(l.default.click,(function(n){n.preventDefault();
f.feedbackButtonClick&&f.feedbackButtonClick()}));t.findByClassName("fxs-topbar-directory").on(l.default.click,(function(n){n.preventDefault();f.directoryButtonClick&&f.directoryButtonClick()}));t.findByClassName("fxs-topbar-helpmenu").on(l.default.click,(function(n){n.preventDefault();f.helpButtonClick&&f.helpButtonClick()}));t.findByClassName(ut).on(l.default.click,(function(){f.notificationButtonClick&&f.notificationButtonClick()}));!i.isFeatureEnabled("reservehozscroll")&&i.isFeatureEnabled("peekblades")&&(e.unhide(t.findByClassName("fxs-topbar-peekmode").on(l.default.click,(function(n){a.trigger(l.default.fxpeekmode);n.preventDefault()}))),this.options.peekMode.subscribeAndRun(h,(function(n){v((n?k.Shell.ExitPeekMode:k.Shell.PeekMode)({isLogo:!0}))})))}return __extends(f,n),f.prototype.loadingHint=function(n,t){t?this._loadingIdList.push(n):this._loadingIdList(this._loadingIdList().filter((function(t){return t!==n})))},f.prototype.dispose=function(){this._cleanElement(rt);n.prototype.dispose.call(
this)},f.prototype._reportBug=function(n,t){t.preventDefault();n.data.reportBug()},f.prototype._exitDevMode=function(n,t){t.preventDefault();n.data.exitDevMode()},f.prototype._attachEventHandlers=function(n){function r(t,i){n.trigger(t,i&&{action:i}||undefined)}function i(t,i){n.on(l.default.click,t,i)}function u(n,t){nt.Diagnostics.Telemetry.trace({source:o.Source.TopBar,action:n,data:t})}function f(n,t,i){return function(f){f.preventDefault();t&&u(t,i);r(n)}}var e=this.options;i(".fxs-topbar-exit-customize-button, ."+ft,f(g,o.Action.CustomizeModeExited,{dashboardChanged:!!e.dashboardChanged(),onDashboard:!!e.dashboardVisible()}));i(".fxs-topbar-home",f(l.default.fxhomebuttonclick,o.Action.HomeButtonClicked));i("."+ut,(function(n){n.preventDefault()}));i(".fxs-topbar-settings",f(l.default.fxsettingsbuttonclick));i(".fxs-topbar-dashboard-save",(function(){var n=e.dashboardWritable(),i=n?1:2,f=n?o.Action.DashboardPublish:o.Action.DashboardSaveACopy;u(f);r(t.fxfinishdashboardedit,i);i===1&&
r(g)}));i(".fxs-topbar-dashboard-discard",(function(){u(o.Action.DashboardDiscard);r(t.fxfinishdashboardedit,3);r(g)}));i(".fxs-topbar-dashboard-view",(function(){u(o.Action.DashboardView);r(l.default.fxhomebuttonclick)}))},f})(h.Widget);t.Widget=st}));define("MsPortalImpl/UI/Dashboard/DashboardManager",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.Router","MsPortalImpl/UI/Dashboard/ArmDashboardRepository","MsPortalImpl/UI/Dashboard/DashboardCompressor","MsPortalImpl/UI/Dashboard/DashboardRepository","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Dashboard/PrivateDashboardRepository","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Part",
"MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/Dashboard/DashboardClient","MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.TopBar"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st){"use strict";function wi(n){var r=n||{},u=r.model,f=r.metadata;return{model:i.extend2(t.defaultDashboardModelJson.model,u),metadata:i.extend2(t.defaultDashboardModelJson.metadata,f)}}function lt(n,t,i){return new ui(n,t||new Error,i)}function ar(n){var t=n.services,e=new nr(t.settings),o=new ei(t),i=new h.DashboardCompressor,r=new oi(e,n.services.desktop.portalWidget.getTopBarWidget(),n.lifetime,o,i,n.services.storageService),c=new s.ArmDashboardRepository(n.lifetime,t.extensionManager,
t.permissionsManager,i),u,f;return r.addRepository(c),u=rt.create(t.extensionManager),f=new ut.RecommendedDashboardRepository(u,i),r.addRepository(f),r}function bi(n){return n.id.toLowerCase().replace(/\/\/+/g,"/")}function bt(n,t){return bi(n)===bi(t)}function fi(n){return Q(n)}function gt(n,t){return nt.buildIdentitySettingKey(n,t)}function ni(n){return yt.start({source:li.Dashboard,action:n,actionModifier:rr.Start})}function ki(n,t,i,r){var u=i.id;return Q.allSettled(r.children.map((function(n){return Q(n.awaitComposed()).then((function(){return n.awaitOnInputsSetComplete()})).then((function(){return n}),(function(){return n}))}))).then((function(i){yt.completeTrace(n,{success:!0,dashboardId:u,parts:i.map((function(n){var t=n.value;return{name:t.locator.toFriendlyString(),visible:et.isElementFullyInViewport(t.widget.element[0]).fullyVisible}})),interactionSource:t})}))}function di(n){var t=n&&n.widgetState||{};return t.NormalState&&t.NormalState.layoutSettings||{}}function vr(n){var t={},r=n[wt],
e=di(r),o=[];return u.keys(n).filter((function(n){return tt.isStartboardPartKey(n)})).forEach((function(r){var u=n[r],a=l.Locator.fromJSON(u.locator),v=ai(u.containerModel),nt=gt(a,v),w=f.toJS(v),y,s,p,b,d,h,c;w[ii]=i.getUniqueId();y=ri(w);u.containerModel=g.getSerializableContainerModel(y,!1);s=k.createIdentifier(ci.StartboardPart,a);u.id=s;t[s]=u;p=n[nt];p&&(b=gt(a,y),t[b]=p);u.flags&2&&(d=l.Locator.fromJSON(u.originalPartLocator),h=gt(d,v),n[h]&&(t[h]=n[h]));c=(e.positions||[]).first((function(n){return n.id===r}));c&&(c.id=s,o.push(c))})),e.positions=o,t[wt]=r,JSON.parse(JSON.stringify(t))}function yr(n){var r=n&&n.relative,f=n&&n.absolute,t="",i,u;if(r){i=r.duration;u=r.timeUnit;switch(u){case 3:i===1&&(t=kt.pastWeek);break;case 1:i===1?t=kt.pastHour:i===24&&(t=kt.past24Hours)}}else f&&(t=kt.custom);return t}function pr(n){var t=n&&n.model&&n.model.model;return t&&t.timeRange}function at(n,t){n&&o.updateDashboardUri(n.id,t)}function ht(n,t){n._startboard.widget.options.loading(t)}var si=
i.Base,hi=si.Diagnostics,gi=i.Hubs.Notifications.NotificationStatus,nr=v.PrivateDashboardRepository,ci=b.CompositionType,tr=i.Composition.Configuration,ir=d.CompositionBinder,yt=hi.Telemetry,li=w.Source,ti=w.Action,rr=yt.ActionModifier,ur=i.ViewModels,fr=ur.Services.ResourceTypes,er=window,pt=er.fx,ct=hi.createLog(n),wt=p.startBoardSettingsKey,or=10,ii=b.PartContainerModelIdProperty,sr=nt.partIdentityStatePrefix,vt=a.Dashboard,kt=a.Filter.Option,hr=a.NavBar.home,dt=si.Constants.DefaultCloudName,ri=ir.createObservableModel,ai=g.createContainerModel,cr=fr.compareResourceId,vi="create",yi="clone",lr="import",pi="unpublish",ui,ei,oi;t.defaultDashboardModelJson={model:{timeRange:{relative:{duration:24,timeUnit:1}}},metadata:{timeRange:tr.TimeRangeValueType}};t.backfillDashboardModel=wi;ui=(function(n){function t(t,i,r){n.call(this,{code:t,data:r||{},message:i.message,stack:i.stack,innerErrors:i})}return __extends(t,n),t.TypeName="MsPortalImpl.UI.DashBoardError",t})(i.Errors.Error);t.create=ar;
t.isSameDashboard=bt;t.startTrace=ni;ei=(function(){function n(n){this._desktopManager=n.desktop;this._settingsManager=n.settings;this._notificationManager=n.notificationManager}return n.prototype.collectDashboardSettings=function(n){var h=this,u={},f=n.toJSON(),o=n.dashboardFiltersManager&&n.dashboardFiltersManager.toJSON(),t=n.children.filter((function(n){return!n.dontSetupWidget&&!n.isDisposed()})),s=n.widget.getDomOrderedChildren(),r;return t.length!==s.length&&ct.error("There should be the same number of composed parts to save ("+t.length+") as the number of positioned elements in the layout ("+s.length+"). The settings will be incorrect."),r=[],s.forEach((function(n){var u=i.remove(t,(function(t){return t.id===n}));if(u.length!==1){ct.error("There should be a composed part with ID '"+n+"' yet none was found. The saved content will be incorrect. The settings will be incorrect.");return}r.push(h.getPartSettings(u[0]))})),t.length>0&&t.forEach((function(n){ct.error("Part '"+n.id+"' should have a position defined in the layout, yet none was found. The settings will be incorrect.");
r.push(h.getPartSettings(n))})),Q.allSettled(r).then((function(n){return n.forEach((function(n){e.extend(u,n.value)})),o&&(f.dashboardModel.model.filterlocale=o.filterlocale,f.dashboardModel.model.filters=o.filters),u[wt]=f,JSON.parse(JSON.stringify(u))}))},n.prototype.getPartSettings=function(n){var t=this;return Q(n.awaitComposed()).then((function(){var o;if(n.isDisposed())return{};var s={},r=n.toJSON(),u=n.containerModel;return u[ii]||(o=f.toJS(ai(r.containerModel)),o[ii]=i.getUniqueId(),u=ri(o),r.containerModel=g.getSerializableContainerModel(u,!1)),s[r.id]=r,t.getPartIdentitySettings(n,u).then((function(n){return e.extend(s,n)}))})).catch((function(t){return ct.error(t,8,"part: '"+n.id+"'."),{}}))},n.prototype.getPartIdentitySettings=function(n,t){var r=n.partDefinition,i;return!r||!r.partState?Q({}):(i=gt(n.locator,t),n.getPartSettingsManager().getStartboardPartIdentitySettings().then((function(n){if(!n)return{};var t={};return t[i]=n,t})).catch((function(t){return ct.error(t,9,"Failed to get part '"+
n.id+"' identify settings for key '"+i+"'."),{}})))},n.prototype.clearStartboard=function(n,t){var i=this._desktopManager;n.children.filter((function(n){return!n.dontSetupWidget})).forEach((function(n){return i.removeTile(n.id,{force:!0,skipSave:t})}))},n.prototype.renderStartboard=function(n,t,r){var o=r.delayRendering,f=u.keys(t),h=function(n,t){var r={};return i.shallowCopyFromObject(r,n,t),r},c=f.filter((function(n){return i.startsWith(n,sr)})),s,e;return this._settingsManager.setSettings({store:13,settings:h(t,c)}),s=t[wt],n.widget.options.applyViewSettings(s.widgetState),f=f.filter((function(n){return tt.isStartboardPartKey(n)})),e=[],f.forEach((function(i){var u=t[i],r,f,o;try{r=l.Locator.fromJSON(u.locator)}catch(s){ct.error("Error derialization locator for part setting.\r\nError:'"+s+"'\r\nKey:'"+i+"'\r\nJSON:'"+u+"'")}r&&(f=r.getExtensionLocator(),(r.type===l.LocatorType.PartType||r.type===l.LocatorType.PartInstance&&r.parent&&r.parent.type===l.LocatorType.Lens&&r.parent.parent&&r.parent.
parent.type===l.LocatorType.Blade)&&(o=n.services.extensionManager.getManifestByName(f.name,f.cloudName).then((function(){var o=r.type===l.LocatorType.PartType?l.Locator.forPartTypeRedirect(f.name,r.name):l.Locator.forPartInstanceRedirect(f.name,r.name,r.parent.parent.name,r.parent.name),t={},i,e;n.services.finder.tryLocate(o,t)&&(i=t.value,f=i.toExtension?l.Locator.forExtension(i.toExtension,f.cloudName):f,e=f.withPartType(t.value.toPart),u.originalPartLocator=u.locator,u.flags||(u.flags=0),u.flags|=2,u.locator=e.toJSON(),yt.trace({source:li.Dashboard,action:ti.Redirect,name:r.toFriendlyString(),data:{to:e.toFriendlyString()}}))})).catch((function(n){ct.error("Error locating or applying part redirect.\r\nError:'"+n+"'\r\nKey:'"+i+"'\r\nJSON:'"+u+"'")})),e.push(o)))})),Q.all(e).then((function(){var i=[];f.forEach((function(u){var o=t[u],f=it.Instance.fromJSON(n.services,o),e=f.locator.getExtensionLocator(),s=n.services.extensionManager.getExtension(e.name,e.cloudName);(s||!r.isDefault)&&i.push(
f)}));i.length&&(n.addChildren(i),o||i.forEach((function(t){t.compose(n.widget);t.save()})));o||(n.discardWidgetStateOfUnusedChildren(),n.save())}))},n.prototype.readDashboardsOfMaxCount=function(n,t,i,r){n=n.slice();i=i.slice();var u=[],e=i.map((function(n){return n.id.toLowerCase()})),f=function(){var i=n.shift();return i.readDashboards().then((function(n){return r(n,i.getTypeName()),n.filter((function(n){return e.indexOf(n.id.toLowerCase())<0})).slice(0,t-u.length)})).catch((function(n){var t=i.getTypeName();return ct.error(n,10,"Failed to read dashboards from '"+t+"' repository."),[]})).then((function(i){return u.push.apply(u,i),u.length>=t||!n.length?Q():f()}))};return f().then((function(){return u}))},n.prototype.enterOrganizeMode=function(n){var t=this._desktopManager;t.mode(1);n&&t.portalWidget.options.sideBar.isCollapsed(!n)},n.prototype.isStartboardReady=function(){return this._desktopManager.startBoardPartsLoaded()},n.prototype.getStartboardReadyPromise=function(){return this._desktopManager.
getStartboardPartsLoadedPromise()},n.prototype.popNotification=function(n,t,i){i===void 0&&(i=gi.Error);this._notificationManager.addClientNotification({title:n,description:t,cloudName:dt,status:i,timestamp:new Date})},n})();t.DashboardHelperImpl=ei;oi=(function(){function n(n,t,r,u,e,o){var s=this;this.currentDashboardId=f.observable("");this._notifyDashboardChanged=i.throttle((function(){if(!s._startboard.notFound()){var n=s._privateRepo.identifyDashboard(s._curDashboard.id);n?s.saveCurrentDashboard():s._topbarWidget.options.dashboardChanged(!0)}}));this._privateRepo=n;this._topbarWidget=t;this._lifetime=r;this._helper=u;this._compressor=e;this._storage=o;this._otherRepos=[];this._isStartboardChanging=!1;this._isMigrated=!1;this._armDashboardCache=[];this._isStartboardShared=f.observable(!1)}return n.prototype.resetLayout=function(n){var t=this._helper,i=s.normalizedDashboard(pt.environment.defaultDashboard||{}),r=this._compressor.uncompress(vt.defaultTitle,i);return t.clearStartboard(n),
t.renderStartboard(n,r.settings,{delayRendering:!1,isDefault:!0,isCurrentDashboardShared:this.isCurrentDashboardShared()})},n.prototype.isCurrentDashboardShared=function(){var n=this._curDashboard&&this._findOwningRepo(this._curDashboard.id);return n&&n.getTypeName()===c.ArmDashboardRepository},n.prototype.isCurrentDashboardWritable=function(){return this._isWritable(this._curDashboard.id)},n.prototype.getCurrentDashboardProperties=function(){var n=this._curDashboard,t=this._findOwningRepo(n.id);return t&&t.getDashboardProperties?t.getDashboardProperties(n):{id:n.id,title:n.title}},n.prototype.initialize=function(n,t,r,u,f){var e=this,h,s;return this._startboard=n,this._registerEventHandlers(this._lifetime),h=i.isFeatureEnabled("addsessiondashboardrepository")?i.require("MsPortalImpl/UI/Dashboard/SessionDashboardRepository").then((function(n){var t=new n.SessionDashboardRepository(e._storage);e.addRepository(t)})):Q(),s=h.then((function(){return t?(e._isMigrated=!0,e._initDashboard(t,f)):
e._migrateStartboard().then((function(){return f.dashboardMigration=pt.getTimestamp(),r?e.switchDashboard({id:r,title:r},"DeepLinkAfterMigration"):Q()}))})).then((function(){f.dashboardInitialized=pt.getTimestamp();(o.isDashboardRoute()||o.isDashboardUri()&&!t)&&at(e._curDashboard,!0)})).catch((function(n){e._handleError(n,"initializeDashboard")})).finally((function(){ki(u,"PortalLoad",e._curDashboard,e._startboard).then((function(){f.dashboardRevealed=pt.getTimestamp()}))})),s.finally((function(){e._preloading()})),s},n.prototype.addRepository=function(n){this._otherRepos.push(n)},n.prototype.readDashboardsForType=function(n){return this._getRepositoryByType(n).readDashboards()},n.prototype.startNewDashboard=function(){var n=this;return this._privateRepo.canCreateNewDashboard().then((function(n){if(n)return Q();throw lt(6,null,{action:vi});})).then((function(){return ht(n,!0),n._addToRecent(n._curDashboard)})).then((function(){return n._privateRepo.createDefaultDashboard()})).then((function(t){return n._setCurDashboard(
t,!0),at(t),n._isStartboardChanging=!0,n._helper.clearStartboard(n._startboard),n._isStartboardChanging=!1,n._startboard.save(),n._saveDashboard(n._curDashboard)})).then((function(){n._helper.enterOrganizeMode(!0)})).catch((function(t){n._handleError(t,"startNewDashboard")})).finally((function(){ht(n,!1)}))},n.prototype.importDashboard=function(n){var t=this;return this._privateRepo.canCreateNewDashboard().then((function(n){if(!n)throw lt(6,null,{action:yi});t._isStartboardChanging=!0;ht(t,!0)})).then((function(){return Q.all([t._addToRecent(t._curDashboard),t._privateRepo._getDashboards()])})).then((function(r){var f=r[1],e=i.getUniqueId(),u=t._compressor.uncompress("private/"+e,n);return t._privateRepo.createDashboard({settings:u.settings,title:v.createDashboardTitle(f,u.title)})})).then((function(n){return at(n),t._loadDashboard(n,!1,!0)})).catch((function(n){t._handleError(n,"importDashboard")})).finally((function(){t._isStartboardChanging=!1;ht(t,!1)}))},n.prototype.getArmDashboardJson=function(){var
n=this;return this._collectDashboardSettings(!0,!0).then((function(t){var i=n._compressor.compress({id:"",title:t[wt].dashboardTitle,settings:t}),r={};return i.parts.forEach((function(n,t){r[t]=n})),{properties:{lenses:{"0":{order:0,parts:r}}},id:t[wt].dashboardId,name:"",type:"Microsoft.Portal/dashboards",location:"",tags:{"hidden-title":i.title}}})).then((function(t){var i=s.getArmDashboardId(t.id),r=n._otherRepos[0];return r.readArmDashboards().then((function(n){return n.filter((function(n){return cr(n.id,i)})).first()})).then((function(i){var r=n._isStartboardShared();return t.location=r&&i?i.location:"INSERT LOCATION",t.name=r&&i?i.name:t.tags["hidden-title"],t}))}))},n.prototype.saveCurrentDashboard=function(){var n=this;return this._saveDashboard(this._curDashboard).catch((function(t){n._handleError(t,"saveCurrentDashboard")}))},n.prototype.cloneCurrentDashboard=function(n){var t=this;return n===void 0&&(n=!0),this._privateRepo.canCreateNewDashboard().then((function(n){if(n)return Q();throw lt(
6,null,{action:lr});})).then((function(){return t._isStartboardChanging=!0,ht(t,!0),t._collectDashboardSettings(n,!0)})).then((function(n){return t._addToRecent(t._curDashboard).then((function(){return n}))})).then((function(n){return t._privateRepo.cloneDashboard(n,t._curDashboard.title)})).then((function(n){return at(n),t._loadDashboard(n,!1,!0)})).then((function(){t._helper.enterOrganizeMode()})).catch((function(n){t._handleError(n,"cloneCurrentDashboard")})).finally((function(){t._isStartboardChanging=!1;ht(t,!1)}))},n.prototype.deleteCurrentDashboard=function(n){var t=this,i="deleteCurrentDashboard";return this._isStartboardChanging=!0,ht(this,!0),this._readNextDashboards(1).then((function(n){if(n.length<=0)throw lt(2);return n[0]})).then((function(r){return t._deleteDashboard(t._curDashboard,n).catch((function(n){return t._handleError(n,i)})).then((function(){return r}))})).then((function(n){return at(n,!0),t._loadDashboard(n)})).catch((function(n){t._handleError(n,i)})).finally((function(){t._isStartboardChanging=
!1;ht(t,!1)}))},n.prototype.restoreCurrentDashboard=function(){var n=this;return this._isStartboardChanging=!0,ht(this,!0),this._loadDashboard(this._curDashboard).catch((function(t){n._handleError(t,"restoreCurrentDashboard")})).finally((function(){n._isStartboardChanging=!1;ht(n,!1)}))},n.prototype.switchDashboard=function(n,t){var i=this,r=bt(this._curDashboard,n),u;return(at(n,r),r)?Q():(u=ni("DashboardRevealed"),ht(this,!0),Q(this._switchDashboard(n,!1)).finally((function(){ht(i,!1);ki(u,t,i._curDashboard,i._startboard)})))},n.prototype.populateQuickDashboards=function(n){var t=this;return this._readNextDashboards(or,(function(i){i=t._curDashboard.id?[t._curDashboard].concat(i):i;n(i)}))},n.prototype.shareCurrentDashboard=function(n,t,i){var r=this,u=this._curDashboard;return ht(this,!0),this.shareCurrentDashboardToArm(n,t,i).then((function(n){return at(n,!0),r._switchDashboard(n,!0)})).then((function(){return r._deleteDashboard(u,2)})).finally((function(){ht(r,!1)}))},n.prototype.unshareCurrentDashboard=
function(){var n=this,i="unshareCurrentDashboard",t=this._curDashboard;return this._privateRepo.canCreateNewDashboard().then((function(t){if(t)return Q();var r=lt(6,null,{action:pi});n._handleError(r,i);throw r;})).then((function(){return ht(n,!0),n._shareCurrentDashboard(c.PrivateDashboardRepository,t.title)})).then((function(t){return at(t,!0),n._switchDashboard(t)})).then((function(){return n._deleteDashboard(t,3)})).finally((function(){ht(n,!1)}))},n.prototype.shareCurrentDashboardToArm=function(n,t,i){var r=this,u=ni(ti.DashboardPublishNew);return this._shareCurrentDashboard(c.ArmDashboardRepository,n,{subscriptionId:t,resourceGroupName:i}).then((function(n){return yt.completeTrace(u,{success:!0,dashboardId:n.id}),n})).catch((function(f){yt.completeTrace(u,{success:!1});var e=lt(7,f,{dashboardId:r._curDashboard.id,dashboardTitle:n,subscriptionId:t,resourceGroupName:i});r._handleError(e,"shareCurrentDashboardToArm");throw e;}))},n.prototype.shareCurrentDashboardToSession=function(n){var t=this;return this.
_shareCurrentDashboard(c.SessionDashboardRepository,n).catch((function(i){var r=lt(7,i,{dashboardId:t._curDashboard.id,dashboardTitle:n});t._handleError(r,"shareCurrentDashboardToSession");throw r;}))},n.prototype._registerEventHandlers=function(n){var t=this,e=this._startboard,c=this._topbarWidget.element,s=this._topbarWidget.options,o=e.widget,l=o.element;e.setGetDashboard((function(){return i.clone(t._curDashboard)}));f.reactor(n,(function(){var n,i,r;t.currentDashboardId();n=pr(t._curDashboard);i=yr(n&&n());i&&(r=vt.filterButtonTextFormat.format(i),o.options.filterButtonText(r))}));var a=function(n){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&!t._isStartboardChanging&&t._notifyDashboardChanged()},v=function(n){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&!t._isStartboardChanging&&t._notifyDashboardChanged()},h=function(n,i){var r,u,f;n.stopPropagation();r=i.part;r.getCompositionType()===ci.StartboardPart&&(u=r.getViewModel(),u&&!u.container.operations.
inProgress.peek()&&(f=t._privateRepo.identifyDashboard(t._curDashboard.id),(s.dashboardVisible()||f)&&t._notifyDashboardChanged()))},p=function(n){n.stopPropagation();var i=o.options;i.title().length===0&&(e.services.desktop.mode(1),i.title(vt.untitled));t._notifyDashboardChanged()},w=function(n,i){if(n.stopPropagation(),s.dashboardChanged(!1),!e.notFound())switch(i.action){case 1:t.saveCurrentDashboard();break;case 2:t.cloneCurrentDashboard(!1);break;case 3:t.restoreCurrentDashboard()}},k=function(n){n.stopPropagation();t._migrateStartboard()},u=o.options;u.refreshDashboardList=function(n){return t.populateQuickDashboards(n)};u.updateDashboardUri=at;u.switchDashboard=function(n){return t.switchDashboard(n,"RecentList")};u.title.subscribe(n,(function(n){t._curDashboard.title=n}));e.notFound.subscribe(n,(function(n){u.notFound(n)}));u.isShared(this.isCurrentDashboardShared());this._isStartboardShared.subscribe(n,u.isShared,(function(n){u.isShared(n)}));y.selectedSubsUpdateTriggered.subscribe(
n,(function(){var n=r.Azure.getAllSubscriptions(r.Rpc.client,dt),t=y.getSelectedSubscriptions(dt);Q.all([n,t]).spread((function(n,t){var i=n.length,r=t.length;u.subscriptionsInfo(r>=i?vt.browseForAllSubs.format(i):vt.browseForSelectedSubs.format(r,i))}))})).callback(null);n.registerForDispose([function(){e.removeGetDashboard()},l.setEvents([tt.fxstartboardsettingchanged,a],[b.fxreplacedpartcomposing,v],[nt.fxpartsettingchanged,h],[g.fxpartinputchanged,h],[ot.fxstartboardtitlechanged,p],[ot.fxmigratestartboard,k]),c.setEvents([st.fxfinishdashboardedit,w])])},n.prototype._setCurDashboard=function(n,t,i){var r,u,f,e;i===void 0&&(i=!1);n=n||{id:"",title:hr};n&&(u=n.settings,f=u&&u[wt],r=f&&f.dashboardModel);r=wi(r);e={model:ri(r.model),metadata:r.metadata};this._curDashboard={id:n.id,title:n.title,isWritable:t,model:e};this._startboard.widget.options.title(n.title);this._topbarWidget.options.dashboardWritable(t);this.currentDashboardId(n.id);this._startboard.notFound(i);this._isStartboardShared(
this.isCurrentDashboardShared());this._startboard.dashboardFiltersManager&&this._startboard.dashboardFiltersManager.loadDashboard(r&&r.model)},n.prototype._switchDashboard=function(n,t){var i=this;return this._isStartboardChanging=!0,this._addToRecent(this._curDashboard).then((function(){return i._loadDashboard(n,!1,t)})).catch((function(n){i._handleError(n,"switchDashboard")})).finally((function(){i._isStartboardChanging=!1}))},n.prototype._findOwningRepo=function(n){var t=[this._privateRepo];return t.concat(this._otherRepos).first((function(t){return t.identifyDashboard(n)}))},n.prototype._getRepositoryByType=function(n){var t=[this._privateRepo];return t.concat(this._otherRepos).first((function(t){return t.getTypeName()===n}))},n.prototype._readDashboard=function(n){var i=this,t=n.id;return fi(this._findOwningRepo(t)).then((function(n){return n.readDashboard(t)})).then((function(n){if(!n)throw new Error("It succeeded in reading dashboard '"+t+"'. But the result is "+n+".");return n})).catch((function(
r){throw lt(1,r,{dashboardId:t,dashboardTitle:n.title,initDashboardIdFromStore:i.initDashboardIdFromStore});}))},n.prototype._collectDashboardSettings=function(n,t){var r=this,u=n?this._readDashboard(this._curDashboard):Q(null);return Q(u).catch(i.noop).then((function(n){return n?n.settings:r._helper.collectDashboardSettings(r._startboard)})).then((function(n){return t?vr(n):n}))},n.prototype._saveDashboard=function(n){var u=this,t=n.id,r=n.title,f=i.getCurrentCallStack(!0);return this._collectDashboardSettings().then((function(n){return fi(u._findOwningRepo(t)).then((function(i){var e=n&&n.Startboard,u=di(e),o=u.positions&&u.positions.length;return o||ct.warning("Saving empty dashboard.",0,f),i.updateDashboard(t,{settings:n,title:r})}))})).catch((function(t){throw lt(5,t,{dashboardId:n.id,dashboardTitle:r});}))},n.prototype._deleteDashboard=function(n,t){var e=this,r=n.id,f,u;return i.remove(this._armDashboardCache,(function(n){return n.id.toLowerCase()===r.toLowerCase()})),f=ni(ti.DashboardDelete),
u=!0,this._removeFromRecent(r).then((function(){var n=e._findOwningRepo(r);return n.deleteDashboard(r)})).catch((function(t){u=!1;throw lt(4,t,{dashboardId:r,dashboardTitle:n.title});})).finally((function(){yt.completeTrace(f,{success:u,dashboardId:r,reason:t})}))},n.prototype._readNextDashboards=function(n,t){var r=this;t||(t=i.noop);var u=function(t,i){return t=i?s.filterDashboards(t,i):t,t.filter((function(n){return!bt(n,r._curDashboard)})).slice(0,n)},f=y.getSelectedSubscriptions(dt).catch((function(){return[]})),e=this._privateRepo.getRecentDashboards().catch((function(){return[]}));return Q.all([f,e]).spread((function(f,e){var o=f.map((function(n){return n.subscriptionId}));return(e=u(e,o),e.length>=n)?(t(e),Q(e)):r._privateRepo.readDashboards().catch((function(){return[]})).then((function(f){var s=i.union(e,f,bt);return(s=u(s),s.length>=n)?(t(s),s):(s=i.union(s,r._armDashboardCache,bt),s=u(s,o),t(s),s.length>=n)?s:r._helper.readDashboardsOfMaxCount(r._otherRepos,n-s.length,s,(function(n,f){f===c.ArmDashboardRepository&&
(r._armDashboardCache=n);s=i.union(s,n,bt);s=u(s);t(s)})).then((function(){return s}))}))}))},n.prototype._preloading=function(){var n=this;return this.readDashboardsForType(c.ArmDashboardRepository).then((function(t){n._armDashboardCache=t}))},n.prototype._isWritable=function(n){return fi(this._findOwningRepo(n)).then((function(t){return t.isDashboardWritable(n)})).catch((function(){return!0}))},n.prototype._addToRecent=function(n){return this._startboard.notFound()?Q():this._privateRepo.addToRecent(n).catch(e.noop)},n.prototype._removeFromRecent=function(n){return this._privateRepo.removeFromRecent(n).catch(e.noop)},n.prototype._loadDashboard=function(n,t,i,r){var u=this,f=n.id,o=i?Q(n):this._readDashboard(n),e=this._helper;return r=r||{},Q.all([this._removeFromRecent(f).then((function(){r.dashboardRemoveFromRecent=pt.getTimestamp()})),this._isWritable(f).then((function(n){return r.dashboardIsWritable=pt.getTimestamp(),n})),Q(o).then((function(n){return r.dashboardRead=pt.getTimestamp(),n}))]).spread(
(function(n,i,r){return u._setCurDashboard(r,i),e.clearStartboard(u._startboard),e.renderStartboard(u._startboard,r.settings,{delayRendering:t,isCurrentDashboardShared:u.isCurrentDashboardShared()})})).catch((function(t){u._setCurDashboard(n,!0,!0);u._startboard.notFound()||u._startboard.save();throw t;}))},n.prototype._migrateStartboard=function(){var n=this,t=this._startboard.widget.options,i=a.NavBar.home;return this._helper.getStartboardReadyPromise().then((function(){return n._privateRepo.createDefaultDashboard(i)})).then((function(t){return n._setCurDashboard(null,!0),n._startboard.save(),n._saveDashboard(t).then((function(){return t}))})).then((function(i){t.headerMode(1);n._setCurDashboard(i,!0);n._startboard.save();n._isMigrated=!0})).catch((function(n){throw lt(3,n);}))},n.prototype._initDashboard=function(n,t){var i=this,r=this._startboard.widget.options;return r.headerMode(1),this._loadDashboard(n,!0,!1,t).then((function(){i._startboard.logChildren()}))},n.prototype._shareCurrentDashboard=
function(n,t,i){var r=this._getRepositoryByType(n);return this._collectDashboardSettings(!0,!0).then((function(n){return r.createDashboard({title:t,settings:n,extras:i})}))},n.prototype._handleError=function(n,t){var o=this,e=this._startboard.widget.options,r=this._helper,u=vt.Notification.errorTitle,i=vt.Error,f=function(n,i){ct.error(n,n.code,t+": "+i)},s=function(n){var u=n.data,i=u.dashboardId,f=u.dashboardTitle;ct.warning(n,n.code,t+": Failed to find dashboard '"+i);var r=o._findOwningRepo(i),s={id:i,title:f},h=r&&r.getNotFoundMessage?r.getNotFoundMessage(s):vt.NotFound.defaultMessageFormat.format(f);e.notFoundMessage(h)},h=function(){r.popNotification(u,i.cannotDelete)},c=function(n){f(n,"Failed to migrate startboard.");e.headerMode(2)},l=function(n){var t=n.data;f(n,"Failed to delete dashboard '"+t.dashboardId+"'");r.popNotification(u,i.failToDeleteFormat.format(t.dashboardTitle,n.message))},a=function(n){var t=n.data;f(n,"Failed to save dashboard '"+t.dashboardId+"'.");r.popNotification(
u,i.failToSaveFormat.format(t.dashboardTitle))},v=function(n){var f=n.data.action,t="";switch(f){case vi:t=i.cannotCreate;break;case yi:t=i.cannotClone;break;case pi:t=i.cannotUnpublish}r.popNotification(u,t)},y=function(n){var t=n.data,e=t.dashboardId,o=t.dashboardTitle,s=t.resourceGroupName,h=t.subscriptionId;f(n,"Failed to publish dashboard '"+e+"'");r.popNotification(u,i.failToPublishFormat.format(o,s,h,n.message))},p=function(){ct.error(n,0,t);r.popNotification(u,i.unknown)};if(n instanceof ui)switch(n.code){case 1:s(n);break;case 2:h();break;case 3:c(n);break;case 4:l(n);break;case 5:a(n);break;case 6:v(n);break;case 7:y(n)}else p()},n})();t.DashboardManagerImpl=oi}));define("MsPortalImpl/UI/UI.DesktopManagerView",["require","exports","f","i","o","ko","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(t){function v(
n,t){s.isTraceEnabled&&w.verbose("[DesktopManager] {0}\n  {1}\n  Model: {2}.".format(n,t.toString(),f.toJSON(t.getInputsOnlyViewModel())))}function b(n,t){return new c(n,t)}var y=r.Extension,l=i.Base.Diagnostics,p=l.Telemetry,a=window,w=l.createLog(n),c;t.showConfirmDialog=a.confirm.bind(a);c=(function(){function n(n,t){var i=this;this._portalWidget=n;this._panoramaWidget=n.getPanorama();this._contextPane=t;this._portalWidget.element.on(h.default.fxautosettings,(function(n,t){i._autoOpenedBy=t}))}return u.defineProperty(n.prototype,"portalWidget",{get:function(){return this._portalWidget},enumerable:!0,configurable:!0}),n.prototype.composeJourney=function(n){n&&n.compose(this._panoramaWidget)},n.prototype.composeStartBoard=function(n){n&&n.compose(this._panoramaWidget)},n.prototype.addPartToStartBoard=function(n){n.compose(this._panoramaWidget.getStartBoardWidget())},n.prototype.addBlade=function(n,t){var f,r,u;return(v("Adding blade to desktop.",n),f=n.parent,r=f.blades,p.trace({action:"JourneyLength",
source:o.Source.Desktop,data:{count:r.length,blades:r.map((function(n){var t=n.locator;return{bladeName:t.name,extension:y.getWindowId(t.getExtensionLocator())}}))}}),n.flags&1)?this._contextPane.tryOpen(n).then(i.noop):(this._autoOpenedBy&&(u=n.masterContainer,u&&u.instanceId===this._autoOpenedBy.masterBladeId&&(t||(t={}),t.autoOpenedByBlade=this._autoOpenedBy.masterBladeId,t.autoOpenedByPart=this._autoOpenedBy.masterPartId),this._autoOpenedBy=null),n.compose(this._panoramaWidget.getJourneyWidget(),t),Q())},n.prototype.removeBlade=function(n){v("Removing blade from desktop.",n);var t=this._contextPane;t.hasContent(n)?t.close(!0):this._panoramaWidget.removeChild(n.id)},n.prototype.removeAllBlades=function(n){var t=this._panoramaWidget.getJourneyWidget();t&&t.removeChildren(n);var i=this._contextPane,r=i.getContent(),u=r&&r.locator;u&&u.type===e.LocatorType.Blade&&i.close(!0)},n.prototype.showConfirmDialog=function(n){return!!t.showConfirmDialog(n)},n})();t.DesktopManagerViewImpl=c;t.create=
b})(c||(c={})),c}));define("MsPortalImpl/UI/UI.DesktopManagerImpl",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.Router","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/Dashboard/DashboardManager","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt){"use strict";function ti(
n,t,i,r){return ct.startTrace({source:n,action:t,name:i,assetType:r})}function ii(){return wt("MsPortalImpl/UI/UI.Desktop.Actions")}function lr(n,t){var i=tt.create(n,t.contextPane);return new ui(i,t)}function ar(n,t){var i=[],r={},u=rr[p.CompositionType.StartboardPart];return er(n,(function(n,t){var f=k.isStartboardPartKey(n),e=ni(n,u+"-"+kt)||ni(n,u+"-"+dt);!f||e?r[n]=t:i.push(n)})),i.length&&t.deleteSettings({store:4,keys:i}),r}function vr(n){var t=n[a.startBoardSettingsKey]||{},i=t.dashboardId;return!i?null:{id:i,title:t.dashboardTitle||l.NavBar.home}}function yi(n,t){if(!t)return n;if(n){var i=t.toLowerCase(),r=(n.id||"").toLowerCase()===i;return r?n:{id:i,title:i}}return null}function ri(n,t,i){n.removeChild(t,!1,!i&&!t.dontSetupWidget)}function pi(n){return n&&n.locator&&n.locator.toFriendlyString()}function yr(t){var r=di.composePartViewModel,u=it.registerWithState,f=n.normalize("./UI.BladeLauncher"),i;u("Shell$BladeLauncherViewModel",f,(function(n,t){return r((function(i){return new
n.BladeLauncher(i,t)}),{initialState:t,createSelectable:!0,logArea:f})}));i=n.normalize("./UI.AssetBladeLauncher");u("Shell$AssetBladeLauncherViewModel",i,(function(n,u){return r((function(i){return new n.AssetBladeLauncher(i,u,t)}),{initialState:u,createSelectable:!0,logArea:i})}))}function pr(n,t,i,r){var u,f="Unable to replace part '"+(n&&n.toString())+"', ";return n&&t?n.isDisposed()?u=f+"it has already been disposed.":n.getPartsContainer()?n.widget&&n.parent&&n.parent.widget||(u=f+"the part or its parent have not been composed."):u=f+"it is not a child of a PartsContainerComposition.":u="Replace part requires a part and a new locator.",u&&r&&r(u),!!u==!1}var wi=c.Locator,lt=c.LocatorType,at=r.Extension,bi=at.CloudName,ki=r.TriggerableLifetimeManager,di=r.ViewModels.Part,ot=i,fi=ot.Base,gi=fi.Constants,nr=gi.ExtensionNames,bt=nr.Hubs,ei=fi.Diagnostics,tr=ei.Telemetry,ir=ot.Parts,rr=p.CompositionType,et=nt.DesktopManagerEvents,st=ot.Helpers,ur=c.DefinitionFinderImpl,oi=i.deepEquals,si=i.getUniqueId,
ht=i.tryImmediateResolve,kt="AssetBladeLauncher",dt="BladeLauncher",hi=window,ut=ei.createLog(n),vt=y.Source.Desktop,yt=y.Action,pt=l.Desktop,ft={noActiveJourney:"Desktop has no active journey.",noBladeInJourney:"Blade '{0}' does not exist in the current journey.",noTileInDesktop:"Tile with id '{0}' was not found on the desktop."},gt=a.desktopSettingsKey,ct=tr,ci=8,fr=4,er=ot.forEachKey,ni=ot.startsWith,wt=ot.require,li=wi.forExtension,or=et.journeyDeactivated,sr=et.journeyDiscarded,ai=et.journeyCreated,hr=et.settingsLoaded,cr="./Compositions/UI.Composition.Journey",vi="./Compositions/UI.Composition.Blade",ui;t.organizeModeModules={dragDrop:"MsPortalImpl/UI/UI.DragDropCompositionManager"};t.createDesktopManager=lr;t.resolveInitialDashboard=yi;ui=(function(){function r(n,t){this._previousActiveJourney="";this._startboardPartsLoadedDeferred=Q.defer();this._loadedStartBoardPartIds={};this._mode=f.observable(0);this._lifetime=new ki;this._hubsCloudName=at.getHubsCloudName();this._dashboardMgrDeferred=
Q.defer();this.activeJourney=f.observable(null);this.commandsEnabled=f.observable(!0);this._loadingJourneyGuid=null;this._view=n;this._services=t;this._initDeferred=st.Deferred();this._sharedSettings=t.settings;this._portalServices=t;yr(this._services.assetTypeService)}return r.prototype.startBoardPartsLoaded=function(){return Q.isFulfilled(this.getStartboardPartsLoadedPromise())},r.prototype.getStartboardPartsLoadedPromise=function(){return this._startboardPartsLoadedDeferred.promise},u.defineProperty(r.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),u.defineProperty(r.prototype,"isJourneyLoading",{get:function(){return this._loadingJourneyGuid!==null},enumerable:!0,configurable:!0}),r.prototype.initialize=function(n,i,r){var u=this;this._setupOrganizeModeComponents(t.organizeModeModules);this._extensionsMetadata=n;this._services.assetManager.onAssetDeleted((function(n,t,i,r){ii().then((function(f){f.handleAssetDeleted(u,n,t,i,r)}))}));var o=g.startTrace(
"DashboardRevealed"),e=s.getDashboardIdFromUri(),f=this._dashboardMgr=g.create({services:this._services,lifetime:this._lifetime});return i.then((function(n){r.startboardSettingsLoaded=hi.fx.getTimestamp();var t,h=n&&n[ci]||{},i=n&&n[fr]||{},s=vr(i);return(r.dayZero=!i[gt])?(u._startBoard=k.create(u._createCompositionServices()),u._view.composeStartBoard(u._startBoard),u._populateStartBoardFromManifests().then((function(){u._startboardPartsLoadedDeferred.resolve()})),u._initDeferred.resolve()):(t=yi(s,e),u.load(h,i,t&&t.id)),f.initDashboardIdFromStore=s?s.id:"",f.initialize(u._startBoard,t,e,o,r).finally((function(){r.dashboardManagerInitialized=hi.fx.getTimestamp();u._dashboardMgrDeferred.resolve(f);u._initDeferred.resolve()}))})),Q(this._initDeferred.promise())},r.prototype.resetStartBoard=function(n){var t=this,i;return i=n?Q(6):this._services.getService("DialogManager").then((function(n){return n.showModalDialog({title:l.Startboard.resetConfirmationTitle,description:l.Startboard.resetConfirmationText,
buttons:4})})),i.then((function(n){var r,i;if(n===6){for(r=t.startBoard.children,i=r.length-1;i>=0;i--)t.removeTile(r[i].id,{force:!0});return t._populateStartBoardFromManifests()}}))},r.prototype._populateStartBoardFromManifests=function(){var n=this;return this._dashboardMgr.resetLayout(this._startBoard).then((function(){n.save();var t=n._services.extensionManager.getExtensions().map((function(t){var r=n._extensionsMetadata.first((function(n){return at.isEqualDescriptor(n,t)})),i=r.startBoardParts;if(r.isTestExtension||i&&i.length)return t.getManifestAsync().then((function(t){n._addStartBoardPartsFromManifest(t,i);n.save()}))})).filter((function(n){return!!n}));return Q.allSettled(t)}))},r.prototype._getExtensionEmailAddress=function(n){var t=this._extensionsMetadata.first((function(t){return t.name===n}));return t&&t.feedbackEmail},r.prototype.getCurrentBladeInfo=function(){var n=this._getBreadCrumb(),i=this._getExtensionEmailAddress(bt),r=n[n.length-1],t=r&&r.extensionName||"",u=t?this._getExtensionEmailAddress(
t):i;return{extensionName:t,feedbackTo:u,feedbackCC:i,breadcrumb:n.map((function(n){return n.title})).join(" > ")}},r.prototype._getBreadCrumb=function(){var t=this.getActiveJourney(),n;return t?(n=t.children,!n||!n.length)?[]:n.map((function(n){return{title:n.isDefaultTitle()?n.id:n.title(),extensionName:n.locator.getExtensionLocator().name,id:n.id}})):[]},r.prototype.createJourney=function(t,i,r){var u=this,s=this._startBoard.children.first((function(n){return n.id===t})),o;return s?(o=st.Deferred(),r||(r=si(),this._loadingJourneyGuid=r,this._createNewJourneyPromise=o.promise()),o.promise().finally((function(){u._loadingJourneyGuid===r&&(u._loadingJourneyGuid=null,u._createNewJourneyPromise=null)})),ht(Q(s.awaitComposed()),(function(){if(u.tryDeactivateJourney(r)){e(u).trigger(et.journeyCreating,i);var t=u._createCompositionServices(),f=ti(vt,yt.JourneyOpened,pi(s));ht(wt(cr,n),(function(r){return u.setActiveJourney(r.create(t,s)),ht(wt(vi,n),(function(n){var r=n.create(t,i,u._startBoard),s=u._activeJourney;
s.addChild(r);u._view.composeJourney(s);u._startBoard.detailContainers=[r];u._view.addBlade(r,{assetType:i.originAssetType,focus:!0}).catch((function(n){ut.error(n)}));u._triggerActiveJourneyChanged();u.save();o.resolve(s);e(u).trigger(ai);ct.completeTrace(f);Q.nextTick((function(){u.save()}))}))})).catch((function(n){o.reject(n)}))}else o.reject("tryDeactivateJourney returned false")})),o.promise()):(ut.error(ft.noTileInDesktop.format(t)),ut.verbose(f.toJSON(this.getDiagnosticsData(),null,2)),st.Deferred().reject())},r.prototype.createJourneyForBlade=function(n,t){return this._createJourneyWithHiddenPart(bt,dt,n,t,dt,this._hubsCloudName,n.cloudName,n.defaultMenuItemId)},r.prototype.createJourneyForAsset=function(n,t,i){return this._createJourneyWithHiddenPart(bt,kt,{extensionName:n.extension,assetType:n.assetType,assetId:i},t,kt,this._hubsCloudName,n.cloudName,n.defaultMenuItemId,n.assetType)},r.prototype._createJourneyWithHiddenPart=function(n,t,r,u,f,o,s,h,c){var l=this,v,y,a,p;return this._loadingJourneyGuid!==
u?Q():(v=ti(vt,yt.JourneyOpened,f,c),bi.addToModel(s,r),y=li(n,o).withPartType(t),a=this.addPartToStartBoard({originPartLocator:y,model:r,defaultMenuItemId:h,reuseExistingPart:!1,dontSetupWidget:!0}),p=a.isComposed&&a.isSelected()&&this._activeJourney&&this._activeJourney.originTile===a?Q():a.selectOnReady((function(){return l._loadingJourneyGuid!==u?!1:!a.isSelected()&&l.tryDeactivateJourney(u)}),{timeoutInMilliseconds:9e4}).then((function(n){n&&(l.save(),e(l).trigger(ai),ct.completeTrace(v))})),i.tryImmediateFinally(p,(function(){l._loadingJourneyGuid===u&&(l._loadingJourneyGuid=null)})))},r.prototype.openSingleBlade=function(n,t){return this._openBlade(n,t,(function(n,i){return i===0&&n.locator.equals(t.locator)}))},r.prototype.openMultipleBlades=function(n,t){var u=this,i=st.Deferred(),r;return t&&t.length!==0?(r=t.map((function(t){return u._openBlade(n,t,(function(n){return n.locator.equals(t.locator)&&t.model&&n.getViewModel()&&p.deepSubset(n.getViewModel(),t.model)}))})),e.when.apply(e,r).done(
(function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];i.resolve(t)})).fail((function(){i.reject()}))):i.resolve([]),i.promise()},r.prototype.confirmBladesCanClose=function(n){var t=this,o=(n||[]).first((function(n){return!t.canCloseBlade(n)})),f,r,u,e;return o?(f=this.activeJourney(),r=[],n.forEach((function(n){r.push(t._findFirstItem(f.children,n,ft.noBladeInJourney.format(n)))})),u=[],i.pushUnique(u,i.mapMany(r,(function(n){return t._getAlertMessageRecursive(n)}))),e=u.join("\n"),this._view.showConfirmDialog(e||pt.confirmEditScopeDiscard)):!0},r.prototype.forceCloseBlade=function(n,t,i){var u,r,f,e;if(!this._activeJourney)throw new Error(ft.noActiveJourney);u=this._findFirstItemIndex(this._activeJourney.children,n,ft.noBladeInJourney.format(n));r=this._activeJourney.children[u];this._startBoard.detailContainers.length===1&&this._startBoard.detailContainers[0].id===r.id?this.forceDiscardJourney(this._activeJourney.id,t):(r.masterContainer&&(f=r.masterContainer.detailContainers,
e=f.indexOf(r),e>=0&&(f.splice(e,1),i&&i.openBlade||r.masterContainer.onDetailContainersChanged())),this._closeBladeRecursive(r,u,t));this._triggerActiveJourneyChanged();this.save()},r.prototype.tryCloseBlade=function(n,t){var i=this.confirmBladesCanClose([n]);return i&&this.forceCloseBlade(n,t),i},r.prototype.closeChildBlades=function(n){var i=this.discardEditsOfBlade(n,{includeSelf:!1,includeDescendants:!0}),t;if(i.successful)for(t=n.detailContainers.length-1;t>=0;t--)this.forceCloseBlade(n.detailContainers[t].id,1);return i},r.prototype.discardEditsOfPart=function(n,t){var r=n.getPartsContainer();return this._discardEditsOfContainer(r,t.force,(function(u){var s=u.path,l=n.journeyPath,e=r.journeyPath,h=oi(s,l),c=!1,f,o;if(!h&&s.length>e.length){f=void 0;try{f=i.parseSortedString(u.path[e.length])}catch(a){ut.error("Failed to parse journey path segment for blade '{0)'. Path: '{1}'. Error: '{2}'.".format(r.toString(),JSON.stringify(e),a.message))}c=f&&f.master&&f.master.part===n.id}return o=
u.value,o&&o.editScope&&(t.includeSelf&&h||t.includeDescendants&&c)}))},r.prototype.discardEditsOfBlade=function(n,t){return this._discardEditsOfContainer(n,t.force,(function(i){var r=i.value,u=i.path,f=n.journeyPath,e=oi(u,f),o=!e&&(r.type===lt.Blade||u.length>=f.length+2);return r&&r.editScope&&(t.includeSelf&&e||t.includeDescendants&&o)}))},r.prototype._discardEditsOfContainer=function(n,t,i){var o=this,u=[],s=n,h=n instanceof k.Instance||s.isInitialized,r={confirmationRequired:!1,successful:!1},e=this._activeJourney,f;if(!e)throw new Error(ft.noActiveJourney);return f=e.ambientSettings,h&&(u=f.getItemsInPath(n.journeyPath).filter(i)),r.confirmationRequired=!t&&u.filter((function(n){var t=n.value.editScope;return t.dirty&&!t.saving})).length>0,(!r.confirmationRequired||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(r.successful=!0,u.forEach((function(n){f.removeItem(n.path);o._services.editScopeManager.onEditScopeDisposed(n.value.editScope.editScopeId)}))),r},r.prototype.canCloseBlade=
function(n){var t=this._activeJourney,r,i;return t?(r=this._findFirstItem(t.children,n,ft.noBladeInJourney.format(n)),i=function(n){if(n.shouldAlertOnClose()||n.isInitialized&&!n.children.some((function(n){return n.children.some((function(n){return n.suppressAlert()}))}))&&t.ambientSettings.getItemsInPath(n.journeyPath).some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving})))return!0;var r=n.detailContainers;return!r||r.length===0?!1:(r||[]).some((function(n){return i(n)}))},!i(r)):!0},r.prototype.addPartToStartBoard=function(n){var i,t,r,u,f;if(!n){ut.error("options should be specified for adding a part to the startboard.");return}if(!n.originPartLocator){ut.error("options.originPartLocator should be specified for adding a part to the startboard.");return}return i=this._createCompositionServices(),r=n.model,n.reuseExistingPart!==!1&&(t=this._startBoard.children.first((function(t){return t.matchesLocatorAndModel(i.finder,n.originPartLocator,r,n.defaultMenuItemId)}))),t||
(t=d.create(i,n.originPartLocator,r,{modelContainsSensitiveData:n.modelContainsSensitiveData}),t.dontSetupWidget=!!n.dontSetupWidget,u=n.defaultMenuItemId,u&&(t.defaultMenuItemId=u),ir.InternalPartSize[n.initialSize]&&(t.initialSize=n.initialSize,n.initialSize===99&&(t.initialHeight=n.initialHeight,t.initialWidth=n.initialWidth)),f=t.id,this._isStartBoardPartLoaded(f)||(this._isStartBoardPartLoaded(f,!0),this._startBoard.addChild(t,undefined,!t.dontSetupWidget),this._view.addPartToStartBoard(t),t.save(),this.save())),t},r.prototype.pinMultipleParts=function(n,t,i,r){var u=this,f=this._createCompositionServices();return ii().then((function(e){return e.pinMultipleParts(u,f.finder,n,t,i,r)}))},r.prototype.removeTile=function(n,t){var e=this._startBoard,i=e.children.first((function(t){return t.id===n})),r,u;if(i){r=void 0;u=this._activeJourney;u&&u.originTile===i&&(r=u.id);var f=i.editScopeId()&&this._services.editScopeManager.getStateObservable(i.editScopeId()),s=!f||f()===v.EditScopeState.NotDirty||
f()===v.EditScopeState.DirtyAndSaving,h=!r||this._canDiscardJourney(r),o=t&&t.force||s&&h;(o||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(r&&this.forceDiscardJourney(r),i.clearIdentitySettings(),ri(e,i,t&&t.skipSave),o||i.dontSetupWidget||ut.warning("Part '{0}' is removed from the start board.".format(i)),this.save())}},r.prototype.replacePart=function(n,t,i){var o=this,f=n&&n.id,r,s=this._createCompositionServices(),u=st.Deferred(),h=!0,c,l,e;return i=i||{},pr(n,t,i.newPartContainerModel,(function(n){l=n}))?(n instanceof d.Instance?(r=d.create(s,t,i.newPartContainerModel,{id:f,doNotSaveSettings:i.doNotSaveSettings,overridesModel:i.newPartOverridesModel}),e=n,r.dontSetupWidget=e.dontSetupWidget,h=!e.dontSetupWidget):r=b.create(s,t,f,i.newPartContainerModel,i.newPartOverridesModel),r.previousLocator=n.previousLocator||n.locator,r.flags|=4,c=n.getPartsContainer(),n.dispose(!0),n.parent.replaceChild(n,r),r instanceof d.Instance&&this._activeJourney&&this._activeJourney.originTile===
n?this.tryDiscardJourney(this._activeJourney.id):c.getPartsContainer().detailContainers.slice(0).reverse().forEach((function(n){n.masterPartId===f&&o.tryCloseBlade(n.id,1)})),r.widgetState(n.widgetState()),r.save(),h?(r.widget=n.widget,r.recompose(n.parent.widget)):r.compose(n.parent.widget),r.widget.element.trigger(p.fxreplacedpartcomposing,{part:r}),r.awaitComposed().then((function(){!i.preventNewPartActivation&&r.partDefinition.details&&r.partDefinition.details.length>0?r.selectOnReady((function(){return!o._activeJourney}),{timeoutInMilliseconds:15e3}).then((function(){u.resolve(r)})).catch((function(n){u.reject(n&&n.message||"part.selectOnReady failed")})):u.resolve(r)}),(function(){u.reject("Unable to compose the mutated part.")}))):u.reject(l),u.promise()},u.defineProperty(r.prototype,"portalWidget",{get:function(){return this._view.portalWidget},enumerable:!0,configurable:!0}),r.prototype.getDashboardManager=function(){return this._dashboardMgrDeferred.promise},r.prototype.getSettingCollections=
function(){var i={},r={},n=this._activeJourney,t=[];return i[gt]=JSON.parse(JSON.stringify(this)),t.push({store:4,settings:i}),n&&n.children&&(r[n.id]=JSON.parse(JSON.stringify(n)),t.push({store:ci,settings:r})),t},r.prototype.dispose=function(){this._lifetime&&(this._lifetime.dispose(),this._lifetime=null)},r.prototype.save=function(){var n=this;this._initDeferred.promise().finally((function(){n.getSettingCollections().forEach((function(t){n._services.settings.setSettings(t)}))}))},r.prototype.load=function(n,t,i){var r=this,o=this._createCompositionServices(),u=t[gt],f=!1,s,h;u&&u.startBoardId&&t[u.startBoardId]?(s=t[u.startBoardId],f=!!i,f&&(t=ar(t,this._sharedSettings)),this._startBoard=k.Instance.fromJSON(o,t,s)):(ut.error("Unable to load StartBoard state from user settings, setting does not exist. Creating a default StartBoard."),this._startBoard=k.create(o));this._removeOrphanedStartboardParts();this._view.composeStartBoard(this._startBoard);f||this._initDeferred.resolve();h=this._view.
portalWidget.element;h.one(rt.default.fxshowstartboard,(function(){var n=r._startBoard.children.slice();n.forEach((function(n){r._displayPartOnStartBoardIfAvailable(n)}));r._startBoard.discardWidgetStateOfUnusedChildren();r._startboardPartsLoadedDeferred.resolve()}));e(this).trigger(hr)},r.prototype._removeOrphanedStartboardParts=function(){var n=this.startBoard;n.children.slice(0).forEach((function(t){t.dontSetupWidget&&ri(n,t)}))},u.defineProperty(r.prototype,"startBoard",{get:function(){return this._startBoard},enumerable:!0,configurable:!0}),r.prototype.getActiveJourney=function(){return this._activeJourney},r.prototype.setActiveJourney=function(n){this.activeJourney(n);this._activeJourney=n;this.portalWidget.hasActiveJourney=!!n;n&&o.isFullscreen()&&o.exitFullscreen()},r.prototype.generateLoadingJourneyGuid=function(){return this._loadingJourneyGuid=si(),this._loadingJourneyGuid},r.prototype.tryDeactivateJourney=function(n){var t=this._activeJourney,r,i,u;if(t){if(!this.confirmBladesCanClose(
t.children.map((function(n){return n.id}))))return!1;for(r=t.children.filter((function(n){return!n.isRestorable()})),i=r.length-1;i>=0;i--)this.forceCloseBlade(r[i].id);u=ti(vt,yt.JourneyDeactivated,pi(t.originTile));t.save();this._closeActiveJourney(!0);this.save();e(this).trigger(or);ct.completeTrace(u)}else this._startBoard&&(this._startBoard.detailContainers=[]);return this._loadingJourneyGuid=n||null,!0},r.prototype.tryDiscardJourney=function(n){var t=!1;return(this._canDiscardJourney(n)||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(this.forceDiscardJourney(n),t=!0),t},r.prototype._triggerActiveJourneyChanged=function(){var n=this._activeJourney,t=n?JSON.stringify(n):"";this._previousActiveJourney!==t&&(e(this).trigger(et.activeJourneyChanged),this._previousActiveJourney=t)},r.prototype._canDiscardJourney=function(n){var t=this._activeJourney&&this._activeJourney.id===n&&this._activeJourney,i=t&&t.ambientSettings.getObservable().peek().some((function(n){var i=n.value,t=i&&
i.editScope;return t&&t.dirty&&!t.saving&&t.disposeOnJourneyDiscard}));return!t||!i},r.prototype.forceDiscardJourney=function(n,t){var i=!1;this._deleteJourneySettings(n);this._activeJourney&&this._activeJourney.id===n&&(this._closeActiveJourney(!1,t),i=!0);i&&(this._triggerActiveJourneyChanged(),this.save(),e(this).trigger(sr))},r.prototype._deleteJourneySettings=function(n){this._sharedSettings.deleteSettings({store:8,keys:[n]})},r.prototype.toJSON=function(){return{startBoardId:this._startBoard?this._startBoard.id:null}},r.prototype._addStartBoardPartsFromManifest=function(n,t){var r=this,i=n.startBoardParts,u=li(n.name,n.cloudName);t||(t=i.map((function(n){return n.name})));i&&i.length&&t.forEach((function(n){var t=i.first((function(t){return t.name===n})),f;t&&(f=u.withStartboardPartInstance(t.name),r.addPartToStartBoard({originPartLocator:f,initialSize:t.initialSize}))}))},r.prototype._createCompositionServices=function(n){return n?i.extend2(this._services,{finder:n,desktop:this,sharedSettings:
this._sharedSettings}):this._thisCompositionServices||(this._thisCompositionServices=i.extend2(this._services,{finder:new ur(this._services.extensionManager),desktop:this,sharedSettings:this._sharedSettings}))},r.prototype._findPartContainer=function(n){var t,i=this._startBoard;if(i&&i.id===n)t=i;else if(this._activeJourney)t=this._findFirstItem(this._activeJourney.children,n,ft.noBladeInJourney.format(n));else throw new Error(ft.noActiveJourney);return t},r.prototype._openBlade=function(t,i,r){var s=this,o=this._findPartContainer(t),v=o instanceof k.Instance,h=st.Deferred(),u,c,y=this._createCompositionServices(),l,a;return o?((o.detailContainers||[]).forEach((function(n,t){n.locator.equals(i.locator)&&n.masterPartId===i.masterPartId&&n.masterInvocationProperty===i.masterInvocationProperty&&r(n,t)&&(u=n,h.resolve(u))})),u?(a=u.containerWidget,a&&a.setFocus(),nt.isTraceEnabled&&ut.verbose("[DesktopManager] Found a previously opened detail blade."+"\n  Existing blade: {0}. Model: {1}.".format(
u.toString(),f.toJSON(u.getInputsOnlyViewModel()))+"\n  Requested Descriptor: {0}.".format(f.toJSON(i)))):(e(this).trigger(et.bladeOpening,{masterContainerId:t,bladeDescriptor:i}),l=function(){v&&o.detailContainers.length===0?s.createJourney(i.masterPartId,i).finally((function(n){n&&n.children&&n.children.length>0?h.resolve(n.children[0]):h.reject()})):ht(wt(vi,n),(function(n){return ht(Q(),(function(){u=n.create(y,i,o);o.detailContainers.unshift(u);o.onDetailContainersChanged();c=v?0:1+s._findFirstItemIndex(s._activeJourney.children,o.id,ft.noBladeInJourney.format(o.id));s._activeJourney.addChild(u,c);s._view.addBlade(u,{assetType:i.originAssetType,index:c,focus:!0}).catch((function(n){ut.error(n)}));s._triggerActiveJourneyChanged();s.save();h.resolve(u)}))})).catch((function(n){h.reject(n)}))},this._createNewJourneyPromise?this._createNewJourneyPromise.always((function(){l()})):l())):h.reject(),h.promise()},r.prototype._closeBladeRecursive=function(n,t,i,r){this._removeBladesFromUIRecursive(n);this.
_disposeBladesRecursive(n,t,r);r||(n.parent.save(),e(this).trigger(et.bladeClosed,{id:n.id,reason:i}))},r.prototype._getAlertMessageRecursive=function(n){var t=function(n){var t=n.detailContainers,r;return t&&t.length!==0?(r=i.mapMany(t,(function(n){return n.getAlertOnCloseMessages()})),i.union(n.getAlertOnCloseMessages(),r)):n.getAlertOnCloseMessages()};return t(n)},r.prototype._removeBladesFromUIRecursive=function(n){for(var i=n.detailContainers,t=i.length-1;t>=0;t--)this._removeBladesFromUIRecursive(i[t]);this._view.removeBlade(n)},r.prototype._disposeBladesRecursive=function(n,t,i){var u=this,r=n.parent.children.indexOf(n,t);i?n.dispose(!0):n.parent.removeChildAt(r,undefined);n.detailContainers.forEach((function(n){u._disposeBladesRecursive(n,r,i)}))},r.prototype._closeActiveJourney=function(n,t){var u=this,i=this._activeJourney,r;this.setActiveJourney(null);this._startBoard.detailContainers=[];i&&(i.children.slice(0).forEach((function(i){i.isDisposed()||u._closeBladeRecursive(i,0,t,n)})
),r=i.originTile,r&&r.dontSetupWidget&&!n&&this.removeTile(r.id),i.dispose(n));this._view.removeAllBlades((function(n){ut.error("DesktopManager: Found un-tracked blade '{0}' in view after closing active journey. It will be forcefully removed.".format(n))}))},r.prototype._findFirstItem=function(n,t,i){var r=this._findFirstItemIndex(n,t,i);return n[r]},r.prototype._findFirstItemIndex=function(n,t,i){var r=n.firstIndex((function(n){return n.id===t}));if(r===-1){ut.verbose(f.toJSON(this.getDiagnosticsData(),null,2));throw new Error(i);}return r},r.prototype.pinPartComposition=function(n){this._startBoard.addChild(n);this._view.addPartToStartBoard(n);ct.trace({source:vt,action:yt.DashboardPinPart,data:"Part pinned to dashboard: "+(n.extension&&n.extension.name)+"_"+n.id});n.save();this.save()},r.prototype._isStartBoardPartLoaded=function(n,t){return typeof t=="boolean"?this._loadedStartBoardPartIds[n]=t:!!this._loadedStartBoardPartIds[n]},r.prototype._displayPartOnStartBoardIfAvailable=function(
n){var r=this;if(!this._isStartBoardPartLoaded(n.id)){this._isStartBoardPartLoaded(n.id,!0);var t=n.locator,i=t.getExtensionLocator(),u=function(t,i){if(ut.warning(t.format(n)),i){var u=r._startBoard;ri(u,n);u.removeChildWidget(n.id)}},f=function(t,i){var f=!1;return t===0?(i||r._view.addPartToStartBoard(n),f=!0):t===1&&(u("[Definition Change] Part '{0}' is not working because it no longer exists in pre-loaded extension definition"),f=!0),f},e=function(i,f){(i.startBoardParts||[]).some((function(n){return n.name===t.name}))?f||r._view.addPartToStartBoard(n):u("[Definition Change] Part '{0}' is not working because it no longer exists in force-loaded extension definition.")};this._extensionsMetadata.some((function(n){return at.isEqualDescriptor(n,i)}))?f(n.definitionExists(),n.isComposed||n.dontSetupWidget)||(this._view.addPartToStartBoard(n),t.type===lt.StartboardPartInstance?this._services.extensionManager.getManifestByName(i.name,i.cloudName).then((function(n){e(n,!0)})):this._services.extensionManager.
getExtensionByName(i.name,i.cloudName).then((function(n){var r=h.PinPrefix,u=t.name,f,i;if(ni(u,r))return f=u.substr(r.length),n.getBladeDefinition(f);for(i=t;i;i=i.parent)if(i.type===lt.Blade)return n.getBladeDefinition(i.name);if(t.type===lt.PartType)return n.getPartDefinition(t.name)})).then((function(){f(n.definitionExists(!0),!0)}))):u("[Definition Change] Part '{0}' will be removed because the extension it belongs to is no longer known by the portal.",!0)}},r.prototype.getDiagnosticsData=function(){var n=this._startBoard,t=this._activeJourney;return{startboard:n&&n.getDiagnosticsData(),activeJourney:t&&t.getDiagnosticsData()}},r.prototype.getAssetDiagnosticsData=function(){var n=this._activeJourney;return n?ii().then((function(t){return t.dumpCompositionAssets(n)})):Q.resolve("No journey")},r.prototype._setupOrganizeModeComponents=function(n){var t=this,i=this._lifetime,r=i.createChildLifetime();this.mode.subscribe(r,(function(u){u===1&&ot.require(n.dragDrop).then((function(n){n.create(i,
t,t.portalWidget.element);r.dispose()}))}))},r})();t.DesktopManagerImpl=ui}));define("MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop",["require","exports","f","o","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){function gt(n){var r=n.target,i=$(r);c&&c.htmlTarget!==r||(c={htmlTarget:r,elementObject:i,width:i.outerWidth(!1),height:i.outerHeight(!1)},v=w=t=ut(i.closest(a),o.Widget),b=i.clone(),b.find("iframe").remove(),b.css({position:"fixed",pointerEvents:"none",top:n.pageY,left:n.pageX,marginTop:it.top=-n.offsetY,marginLeft:it.left=-n.offsetX}),i.parent().append($("<div/>").append(b)),i.css("opacity",0),nt=l=rt({left:n.pageX,top:n.pageY}),f.register(ct,!0))}function lt(n){var e;if(c){k.off(h.default.dragover+a+
" "+h.default.drop+a+" "+h.default.dragleave+a);var i=c.elementObject,u=i.attr("dragdrop.revert")==="true",r={left:n.pageX,top:n.pageY};f.unregister(ct);u&&i.attr("dragdrop.revert","false");et();u?yt():vt(n.target,r);b.parent().remove();e=i.css("opacity",1).closest(".fxs-tile").css("transition","none");p.setTimeout((function(){return e.css("transition","")}),0);t?t===w?ri($(n.target),r):ui($(n.target),r):ii();wt()}}function at(){c&&c.elementObject.attr("dragdrop.revert","true").trigger(h.default.mouseup)}function ni(n,i){var r;(vt(n.target,i),t)&&(r=rt(i),r.col!==l.col||r.row!==l.row)&&(et(),l=r,(v!==t||t.dropPlaceholder===null)&&(v&&v.disposeDropPlaceholder(),t.createDropPlaceholder(c.width,c.height),v=t),t.moveDropPlaceholder(r),d=p.setTimeout((function(){d=null;t.moveChild(c.elementObject,l.col,l.row,!1)}),dt))}function et(){d&&(p.clearTimeout(d),d=null)}function vt(n,i){var r=ti(n,i);t&&t!==r&&yt();t=r}function yt(){t&&(et(),t.refreshLayout())}function pt(n){return{left:n.left+it.left,
top:n.top+it.top}}function ti(n,t){var i=pt(t),r=n.parentElement||k.context,u=r.scrollTop,f=r.scrollLeft,e=i.left-f+Math.floor(tt*y.GridSpacingWidth),s=i.top-u+Math.floor(tt*y.GridSpacingHeight),h=$(document.elementFromPoint(e,s)),c=h.closest(a);return ut(c,o.Widget)}function rt(n){var i=t.element,r=i.offset(),u=pt(n),f=u.left-r.left+i.scrollLeft(),e=u.top-r.top+i.scrollTop(),o=Math.floor((f+tt*y.GridSpacingWidth)/y.GridSpacingWidth),s=Math.floor((e+tt*y.GridSpacingHeight)/y.GridSpacingHeight);return{col:o,row:s}}function ii(){w.moveChild(c.elementObject,nt.col,nt.row,!0)}function ri(n,t){l=rt(t);w.moveChild(c.elementObject,l.col,l.row,!0)}function ui(n,i){t.refreshLayout();l=rt(i);var r=s.Widget.getId,u=r(c.elementObject),f=w.element.closest(ht),e=t.element.closest(ht),o=r(f),a=r(e);t.element.trigger(h.default.fxrearrange,{partId:u,sourceId:o,targetId:a,col:l.col,row:l.row})}function wt(){v&&v.disposeDropPlaceholder();w=null;t=null;nt=null;l=null;v=null;c=null}function bt(){var t=$(a),
n=[];return t.each((function(t,i){var r=ut($(i),o.Widget),u=r.options;u.allowReorder&&!u.locked()&&n.push(r.element.findByClassName("fxs-flowlayout-childcontainer"))})),n}function kt(n){at();t=null;lt(n)}var y=i.Widgets.AzureGrid,p=window,k=$(p.document.body),ut=e.Widget.getWidget,ot="ui-draggable",g="draggable",st=ot+" fxs-drag-disableTouchAction",ft=".fxs-tile:not(.fxs-tilesize-herowidefitheight):not(.fxs-tilesize-fullwidthfitheight):not(.fxs-tilesize-fittocontainer)",a=".fxs-flowlayout",ht=".fxs-lens",ct={dismissFn:at,logName:"flowlayoutdragdrop"},c,w,t,v,nt,l,d,dt=250,tt=.33,b=null,it={left:0,top:0},fi=(function(){function n(){if(n._singleton)throw new Error("FlowLayoutDragDrop operates as a singleton.");n._singleton=this}return n.prototype.dispose=function(){this.disableDragDropTargets();wt();n._singleton=null},r.defineProperty(n,"Instance",{get:function(){return n._singleton||(n._singleton=new n),n._singleton},enumerable:!0,configurable:!0}),n.prototype.enableDragDropOnSingleTarget=
function(n){if(n.attr(g)!=="true"){n.attr(g,"true");var t=n.filter(ft).addClass(st);t.on(h.default.dragstart,(function(n){if(c&&kt(n),u.isFullscreen()||n.target!==n.currentTarget){n.preventDefault();return}k.on(h.default.dragover+a,(function(n){n.preventDefault();var t={left:n.pageX,top:n.pageY};ni(n,t);b.css(t)}));k.on(h.default.drop+a,(function(n){n.preventDefault();lt(n)}));k.on(h.default.dragleave+a,(function(n){0<n.clientX&&n.clientX<p.innerWidth&&0<n.clientY&&n.clientY<p.innerHeight||kt(n)}));var t=n.originalEvent.dataTransfer;t.setData("text","fxs-draganddrop");t.effectAllowed="move";gt(n)}))}},n.prototype.enableDragDropTargets=function(){var n=this;bt().forEach((function(t){t.on(h.default.mouseenter,ft,(function(t){var i=$(t.currentTarget);i.attr(g)!=="true"&&n.enableDragDropOnSingleTarget(i)}))}))},n.prototype.disableDragDropTargets=function(){bt().forEach((function(n){n.off(h.default.mouseenter,ft)}));$("."+ot).removeClass(st).off(h.default.dragstart).removeAttr(g)},n})();n.FlowLayoutDragDrop=
fi})(c||(c={})),c}));define("_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-desktop-organize .fxs-tile .fxs-tile-content{z-index:0}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay{display:block;-ms-touch-action:none;touch-action:none}.fxs-desktop-normal .fxs-hide-in-normal,.fxs-desktop-normal .fxs-portal-contextpane-left,.fxs-desktop-organize .fxs-contextpane .fxs-tile .fxs-tile-overlay,.fxs-desktop-organize .fxs-sidebar,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-actions,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-dropdown,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-migration{display:none}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay:hover{border-width:1px;border-style:solid;box-sizing:border-box}.fxs-desktop-organize .fxs-tile.fxs-tilesize-hero.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herotall.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herowide.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-large.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-mini.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-normal.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-small.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-tall.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-wide.fxs-tile-selected .fxs-tile-overlay{cursor:move}.fxs-desktop-organize .fxs-blade-locked .fxs-tile .fxs-tile-overlay:hover{border:none}.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-context .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-help .fxs-tile div.fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-hide-in-customize{visibility:hidden}.fxs-desktop-organize .fxs-startboard-layout>.fxs-flowlayout-childcontainer{min-height:2155px;min-width:3865px}.fxs-desktop-organize .fxc-hotspot-customclick{z-index:1}")})
);define("MsPortalImpl/UI/UI.DesktopModeManager",["require","exports","f","o","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){function d(n,r,e){var l=n.desktop,v=new t(l,r,n,e),b=function(n){var t=u(n.target).closest(w);return s.Widget.getWidget(t,h.Widget)},d=r.element,y=r.getPanorama().getStartBoardArea();d.on(c.default.fxexitorganizemode,(function(){l.mode(0);var n=l.startBoard.widget.element.findByClassName("fxs-startboard-button-edit");n.length&&n.focus()}));y.on(c.default.fxenterorganizemode,(function(n,t){n.stopPropagation();var r=b(n);t=u.extend({},t);i.isNullOrUndefined(t.trigger)&&(t.trigger=r?0:1);v.startPartManagment(t);r&&(r.options.selected(
!0),v.updateTileSelection(r),r.showTileManagementContextMenu())}));y.on(c.default.click,p,(function(n){var i=b(n),t=i&&i.options;t&&!t.locked()&&(t.selected(!t.selected()),v.updateTileSelection(i))}));y.on(c.default.click,a,(function(n){if(l.mode()===1){var i=b(n),t=i&&i.options;!t||t.locked()||t.selected()||(t.selected(!0),v.updateTileSelection(i))}}));y.on(c.default.mouseenter,a,(function(n){var t,i,r;if(l.mode()!==1&&!f.isFullscreen()&&(t=b(n),i=t&&t.options,i&&!i.locked()&&!i.selected())){r=t.element;o.FlowLayoutDragDrop.Instance.enableDragDropOnSingleTarget(r);r.one(c.default.mouseleave,(function(){l.mode()!==1&&o.FlowLayoutDragDrop.Instance.disableDragDropTargets()}))}}));y.on(c.default.dragstart,k,(function(n){if(f.isFullscreen()){n.preventDefault();return}l.mode()!==1&&l.mode(1);var t=b(n),i=t&&t.options;i&&!i.selected()&&(i.selected(!0),v.updateTileSelection(t))}));y.on(c.default.fxpartcreated,(function(n,t){n.stopPropagation();var i=t.widget;i.options.selected(!0);v.updateTileSelection(i)})
);return v}var y=MsPortalImpl.Resources.Images,l=s.Widget.widgetRemoveEvent,p="."+h.overlayClassName,w="."+h.widgetClassName,a="."+h.actionBarContainerClassName,v="fxs-desktop-normal",b="fxs-partgallery-container",k=".ui-draggable",t;(function(){var t=y.getFlowLayout().gridShadow,i=".fxs-desktop-organize .fxs-flowlayout-childcontainer {"+("background: url("+t+");")+"}",n=document.createElement("style");n.setAttribute("type","text/css");n.appendChild(document.createTextNode(i));document.head.appendChild(n)})();n.organizeModeClassName="fxs-desktop-organize";n.createDesktopModeManager=d;t=(function(){function t(n,t,i,r){var u=this;this._wasContextPaneCollapsed=!1;this._dismissHandle={dismissFn:function(){u._desktop.mode(0)},logName:"desktopmodemanager"};this._desktop=n;this._portalWidget=t;this._services=i;this._lifetime=r;this._userSettingsManager=i.settings;this._contextPane=i.leftContextPane;this._partMgmtStarted=!1;this._selectedTile=null;this._handleModeChange(n,r)}return r.defineProperty(
t.prototype,"selectedTile",{get:function(){return this._selectedTile},enumerable:!0,configurable:!0}),t.prototype.updateTileSelection=function(n){var t=this;if(this._deselectCurrentTile(),n.options.selected()&&(this._selectedTile=n),this._selectedTile)this._selectedTile.element.on(l,this._tileRemoveHandler=function(n){n.target===t._selectedTile.element[0]&&t._deselectCurrentTile()})},t.prototype.startPartManagment=function(n){var t=this,r;return this._partMgmtStarted?Q():(this._partMgmtStarted=!0,this._desktop.mode(1),r=this._contextPane,Q.all([i.require("MsPortalImpl/UI/UI.PartGalleryManager"),r.tryOpen(this)]).spread((function(i){var u=t._partGalleryManager,f=t._partGallery;u||(u=t._partGalleryManager=i.createPartGalleryManager(t._lifetime.createChildLifetime(),t._services,f),u.load(5,n));f.setFocus();n.expandTileGallery&&r.collapsed(!1)})))},t.prototype.onAddingContent=function(n){var t=this;return i.require("MsPortalImpl/Widgets/Widgets.PartGallery").then((function(i){t._partGallery||
(t._partGallery=i.create(u("<div class='"+b+"'><\/div>")),n.addChild(t._partGallery.element))}))},t.prototype.onRemovingContent=function(){this._partMgmtStarted=!1},t.prototype._enterOrganizeMode=function(){var i=this._portalWidget,r=i.element,t;return(r.addClass(n.organizeModeClassName),r.removeClass(v),t=i.getTopBarWidget(),t&&t.options.isInOrganizeMode(!0),e.register(this._dismissHandle),o.FlowLayoutDragDrop.Instance.enableDragDropTargets(),this._wasContextPaneCollapsed=this._contextPane.collapsed(),!this._partMgmtStarted)?this.startPartManagment({}):Q()},t.prototype._exitOrganizeMode=function(){var r=this._portalWidget,u=r.element,t,i;o.FlowLayoutDragDrop.Instance.disableDragDropTargets();u.removeClass(n.organizeModeClassName);u.addClass(v);t=r.getTopBarWidget();t&&t.options.isInOrganizeMode(!1);i=this._contextPane;i.close(!0);i.collapsed(this._wasContextPaneCollapsed);this._deselectCurrentTile();this._userSettingsManager.flushSettings();e.unregister(this._dismissHandle)},t.prototype.
_handleModeChange=function(n,t){var i=this;n.mode.subscribe(t,(function(n){switch(n){case 1:i._services.getService("DialogManager").then((function(n){n.dismissOpenDialog()}));i._enterOrganizeMode();f.isFullscreen()&&f.exitFullscreen();break;case 0:default:i._exitOrganizeMode()}}))},t.prototype._deselectCurrentTile=function(){this._selectedTile&&(this._selectedTile.element.off(l,this._tileRemoveHandler),this._tileRemoveHandler=null,this._selectedTile.options.selected(!1),this._selectedTile=null)},t})();n.DesktopModeManagerImpl=t})(l||(l={})),l}));define("MsPortalImpl/UI/Compositions/UI.Composition.Services",["require","exports","f","i","MsPortalImpl/Base/Base.Router","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Permissions","MsPortalImpl/Base/Themes","MsPortalImpl/UI/Hubs/UI.BrowseManager","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.DesktopModeManager",
"MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Widgets/Widgets.WidgetBase","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";var b;return (function(t){function g(t,g,nt,tt,it,rt,ut){var st=r.Rpc.client,et=g.extensionManager,ot=e.createAssetTypeService(et),yt=f.createAssetManager(ot),ht=o.createPermissionsManager(et,ot);i.isFeatureEnabled("whatsnew")&&nt.whatsNewEnabledKey()&&w.WhatsNew.showWhatsNewModal.register(st,[k],(function(n){i.require("MsPortalImpl/Widgets/Widgets.WhatsNew").then((function(t){var i=n.items.map((function(n){var t=!n.published?"":new Date(n.published).toLocaleString();return n.description+="\r\n"+t,n}));new t.Widget($("<div />"),new p.ViewModel,i,it.element)}))}));var pt=h.createBrowseManager(et,ot,ht,tt),ct=s.createManager(t,d,nt["fxs-theme"],nt.highContrastKey),lt=l.create(it.getRightContextPane()),wt=l.create(it.getLeftContextPane()),bt=it.getToastVM(),ft={rpcClient:st,storageService:g.storageService,themeManager:ct,redirect:
rt,settings:g.settings,editScopeManager:g.editScopeManager,extensionManager:et,hubsMetadata:g.hubsMetadata,openWindow:g.openWindow,assetManager:yt,permissionsManager:ht,assetTypeService:ot,browseManager:pt,desktop:null,modeManager:null,contextPane:lt,leftContextPane:wt,getService:null,router:null,notificationManager:null},at=ft.desktop=a.createDesktopManager(it,ft),vt=c.createCommandManager(ft.desktop).startListeningForEvents(),kt=ft.getService=i.memoizeQ((function(t){switch(t){case"DialogManager":return ut();case"ResourceMapManager":return b("../Hubs/UI.ResourceMapManager",n).then((function(n){return n.createResourceMapManager(et,ot)}));case"FeedbackPane":return b("../../Widgets/Widgets.FeedbackPane",n).then((function(n){return{amdModule:n,widget:new n.FeedbackPane(lt,bt,function(){return at.getCurrentBladeInfo()})}}));case"ThemeManager":return Q(ct);case"PortalFormTarget":return vt.getFormTarget()}throw new Error("Invalid service type '{0}' specified.".format(t));}));return ft.notificationManager=
y.createNotificationManager(ft),ft.router=u.createRouter(ft),ft.modeManager=v.createDesktopModeManager(ft,it,t),t.registerForDispose([at,vt,ft.router,kt,]),ft}function nt(){return b("MsPortalImpl/UI/UI.DialogManager")}var k=r.Extension.getHubsWindowId(),b=i.require,d=$("body,head");t.initialize=g;t.getDialogManagerModule=nt})(b||(b={})),b}));define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager",["require","exports","f","a","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Storage","MsPortalImpl/UI/Compositions/UI.Composition.Services"],(function(n,t,i,r,u,f,e,o){"use strict";var y=i.Base,p=y.Diagnostics,h=p.createLog(n),s=f.Shell.Dialogs,c=0,a=1,v=0,w=1,b=2,l=s.loadOnlySafeExtensionsButtonText,k=(function(){function n(n,t,i,r,u,f,e,o,s,h,c,l){this._temporaryTestCodeComponents=[];this._trustedCodeComponents=n;this._settingsManager=t;this._storageService=i;this._getDialogManager=r;this.
_dialogContainer=u;this._canModifyCodeComponents=f;this._acceptWithoutPrompt=e;this._storageServiceKey=o;this._hashQueryStringKey=s;this._createFunction=h;this._componentType=c;this._settingsKey=l}return n.prototype.getCodeComponentsMetadata=function(){var n=this,t;return Q().then((function(){var i=JSON.parse(JSON.stringify(n._trustedCodeComponents));return t=i.map((function(t){return n._createFunction(t)})),n.loadFromServer(t)})).then((function(i){return typeof i=="string"?i:(i.length>0&&n._merge(t,i),n._loadUntrustedCodeComponentsIfAllowed().then((function(i){if(i.length>0){var r=function(n){n.logUsageWarning()};n._merge(t,i,r)}return t.filter((function(n){return n.isValid()}))})))}))},n.prototype.loadFromServer=function(){},n.prototype.listTestCodeComponents=function(){var t=this,n=this._temporaryTestCodeComponents.slice(0);return this._settingsManager.querySetting(c,this._settingsKey).then((function(i){return i=i&&i.map((function(n){return t._createFunction(n)})),r.isArray(i)&&(n=n.concatUnique(
i,(function(n,t){return n.isEqual(t)}))),n.filter((function(n){return n.isValid()}))})).then(null,(function(n){return h.error("Error listing code components",2,n),[]}))},n.prototype.registerTestCodeComponent=function(n,t){var r=this,u;return n.isValid()?t?(this._addOrUpdateCodeComponent(this._temporaryTestCodeComponents,n),Q.resolve(null)):this.listTestCodeComponents().then((function(t){return r._addOrUpdateCodeComponent(t,n),r._settingsManager.setSetting(c,r._settingsKey,t),r._settingsManager.flushSettings()})).catch((function(t){h.error("Error registering code component",4,{codeComponent:n,error:t})})):(u=new i.Errors.Error("Invalid codeComponent"),u.data=n,Q.reject(u))},n.prototype.unregisterTestCodeComponent=function(n){var t=this;return this._removeCodeComponent(this._temporaryTestCodeComponents,n),this.listTestCodeComponents().then((function(i){if(t._removeCodeComponent(i,n))return t._settingsManager.setSetting(c,t._settingsKey,i),t._settingsManager.flushSettings()})).catch((function(n){h.error(
"Error unregistering code component.",6,{name:name,error:n})}))},n.prototype.unregisterAll=function(){this.clearTemporaryTestCodeComponents();var n=this._settingsManager;return n.deleteSettings({store:c,keys:[this._settingsKey]}),n.flushSettings().catch((function(n){h.error("Error registering all code components",5,n)}))},n.prototype.clearTemporaryTestCodeComponents=function(){var n=this._temporaryTestCodeComponents;n.splice(0,n.length)},n.prototype._loadUntrustedCodeComponentsIfAllowed=function(){var n=this,t=this._canModifyCodeComponents;return t?this.listTestCodeComponents().then((function(i){return i.length===0?(t&&h.verbose("No untrusted code components were found. Will load the portal in normal mode.",3),[]):n.prompt().then((function(t){return t?(i.forEach((function(t){n._componentType===v&&t.markAsTestExtension()})),i):[]}))})):Q([])},n.prototype.prompt=function(){var f=this,i=e.ComponentName.ExtensionManager,r=this._storageServiceKey,u=this._storageService,h=u.getValue(i,r,a),n,t;if(h||
this._acceptWithoutPrompt)return Q(!0);switch(this._componentType){case v:n=s.untrustedExtensionsTitle;t=s.untrustedExtensionsDescriptionFmt.format(l);break;case w:n=s.untrustedGalleryPackageTitle;t=s.untrustedGalleryPackageDescriptionFmt.format(l);break;case b:n=s.untrustedPatchTitle;t=s.untrustedExtensionsDescriptionFmt.format(l);break;default:throw new Error("Unsupported componentType");}return o.getDialogManagerModule().then((function(e){var o=$("<div />"),h=new e.MessageBox(n,t,2);return f._dialogContainer.prepend(o),h.defaultButtonText=l,h.cancelButtonText=s.loadUnsafeExtensionsButtonText,f._getDialogManager().then((function(n){return n.showDialog(o,h,null,"sideload").then((function(t){var f=t===1;return n.dismissOpenDialog(),o.remove(),f?u.setValue(i,r,"true",a):u.clearValue(i,r,a),f}))}))}))},n.prototype._registerTestCodeComponentFromUri=function(n){return n.isValid()?this.registerTestCodeComponent(n,!0):null},n.prototype._removeCodeComponent=function(n,t){var i=-1;return(i=n.firstIndex(
(function(n){return n.isEqual(t)})),i>=0)?(n.splice(i,1),!0):!1},n.prototype._merge=function(n,t,i){var r=this;n!==null&&t!==null&&t.forEach((function(t){i&&i(t);r._addOrUpdateCodeComponent(n,t)}))},n.prototype._addOrUpdateCodeComponent=function(n,t){var i=n.first((function(n){return n.isEqual(t)}));i?i.updateWith(t):n.push(t)},n})();t.CodeComponentSideLoadManagerImpl=k}));define("MsPortalImpl/Services/Services.FileUploadInitialization",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function f(r){t||(t=!0,n.uploadSettingsManager=r,Q(r.querySettings({store:12})).then((function(n){i.isEmpty(n)||u().then((function(n){return n.init(r)}))})))}var r="MsPortalImpl/Services/Services.FileUploadSettings",u=i.memoizeQ((function(){return i.require(r).then((function(n){return n.fileUploadResumableTrackerInstance()}))})),t=!1;n.init=f})(r||(r={})),r}));define("MsPortalImpl/Extension/ExtensionMetadataSource",["require","exports","f","i","o","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager",
"MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){function rt(n,t,i,r,u){var f=new l(n,t,i,r,u,w,y.isDevelopmentMode);return MsPortalImpl.Extension=f,f}var a=i.Base,k=a.Diagnostics,h=e.ExtensionMetadataExt,v=r.Extension,d=window,g=k.createLog(n),y=d.fx.environment,p="testExtensions",nt="loadUntrustedExtensions",tt=o.testExtensionsKey,it=5e3,w=e.canModifyExtensions,b="Reload the portal with the query parameter ?feature.canmodifyextensions=true to load the test extension.",c=h.create,l;t.initializeTestExtension=rt;l=(function(n){function t(t,i,r,u,f,e,o){n.call(this,t,i,r,u,f,e,o,nt,p,c,0,tt)}return __extends(t,n),t.prototype.registerTestExtension=function(n,t){var i=c(n);return this.registerTestCodeComponent(i,t).then((function(){console.log(b)}))},t.prototype.registerTestExtensionsFromUri=function(n,t){var o=this,l=new s.Uri(
n),c=l.getHashQueryStringValue(p),r,f;return c?(r=JSON.parse(decodeURIComponent(c)),f=u.keys(r),!w&&f.length&&console.warn(b),Q.allSettled(f.map((function(n){var u=new h,c,f,s,l;return u.name=n,u.cloudName=t,c=v.getWindowId(u),f=i.find(o._trustedCodeComponents,(function(n){return v.getWindowId(n)===c})),f&&(u.obsoleteBundlesBitmask=f.obsoleteBundlesBitmask),s=u.uri=r[n],e.isLocalhostUri(s)?o._registerTestCodeComponentFromUri(u):(l="Invalid extension: '{0}', only allowed on 'localhost'.".format(s),g.error(l,1),null)})))):Q(null)},t.prototype.unregisterTestExtension=function(n,t){var i=new h;return i.name=n,i.cloudName=t,i.normalizeCloudName(),this.unregisterTestCodeComponent(i)},t.prototype.listTestExtensions=function(){return this.listTestCodeComponents()},t.prototype.clearTemporaryTestExtensions=function(){this.clearTemporaryTestCodeComponents()},t.prototype.loadFromServer=function(n){var t=y.extensionsUri,i;return t?(i=a.Net2.postJSON({uri:t},n).timeout(it),i.then((function(n){return n.map(
(function(n){return c(n)}))}),(function(n){var t=n&&n.jqXHR&&n.jqXHR.responseJSON&&n.jqXHR.responseJSON.reason;return t==="notSignedUp"?"/UE_NotSignedUp":"/UE_NoExtensions"}))):Q([])},t})(f.CodeComponentSideLoadManagerImpl);t.ExtensionMetadataSourceImpl=l})(h||(h={})),h}));define("MsPortalImpl/GalleryPackage/GalleryPackageLoader",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function o(n){return new t(n)}var f=i.Base,r=f.Constants,u=r.ExtensionNames,e=i.Services.Rpc,t;n.initialize=o;t=(function(){function n(n){this._extensionManager=n}return n.prototype.loadGalleryPackages=function(n){if(n&&n.length>0)return this._extensionManager.getExtensionByName(u.Marketplace,r.DefaultCloudName).then((function(){e.invokeCallback(u.Marketplace,"loadGalleryPackages",n)}))},n})();n.GalleryPackageLoaderImpl=t})(r||(r={})),r}));define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css",["require","exports","module"],(function(n,t,i){"use strict";window.
fx.injectCss(i,".fxs-keyboardshortcuts{padding:0 25px;width:355px}.fxs-keyboardshortcuts-category{margin-top:20px}.fxs-keyboardshortcuts-shortcut{display:-webkit-flex;display:flex}.fxs-keyboardshortcuts-key{-webkit-flex:0 0 auto;flex:0 0 auto;width:98px}")}));define("MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler",["require","exports","f","$","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/Telemetry","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function c(n){var t=n.isJourneyVisible()&&n.getPanorama();return t&&t.getJourneyWidget()}function v(n){var t=c(n),r=t&&t.getFocusedBlade();return r?r:t&&i.last(t.getBlades())}function rt(n,t,i,r,u){return new y(n,t,i,r,u)}var l=i.Base.Diagnostics,p=l.Telemetry,w=window,a="#blade/HubsExtension/Resources",b=a+"/resourceType/",k="fxs-sidebar-collapse-button",
d="fxs-topbar-home",s=f.KeyboardShortcuts,h=s.GoTo,g=l.createLog(n),nt=p.trace,tt=[49,50,51,52,53,54,55,56,57,48],it=[97,98,99,100,101,102,103,104,105,96],y;t.setup=rt;y=(function(){function n(n,t,i,r,u){this._disposables=[];this._keyShortcuts={};this._goToShortcuts={};this._errorLoggingFunc=u||function(n){g.error(n)};this._addKeyShortcuts(n);this._addGoToShortcuts(t.router,n);this._registerSpecialShortcut(s.showDiagnostics,i,65);this._registerSpecialShortcut(s.showDebugHelper,r,68);this._registerShortcut(s.moveFavoritesUp,(function(){n.getSideBarWidget().reorderFavorites(38)}),38,5);this._registerShortcut(s.moveFavoritesDown,(function(){n.getSideBarWidget().reorderFavorites(40)}),40,5);this._attachEventHandlers()}return n.prototype.dispose=function(){this._removeEventHandlers()},n.prototype._attachEventHandlers=function(){var t=this,n;this._removeEventHandlers();n=!1;this._disposables.push(r(w.document).setEvents([u.default.keydown,function(i){var u,s=e.getModifierKeys(i),h,f;if(i.keyCode===
71&&s===0){n=!0;return}(h=n?t._goToShortcuts[i.keyCode]:t._keyShortcuts[i.keyCode],f=h&&h[s],f)&&((u=r(document.activeElement),u.length>0&&s===0&&(u.is("input")||u.is("textarea")||["azc-editableControl","fxc-editor","fxc-console"].some((function(n){return u.closest("."+n).length>0}))))||(f.handler(),nt({source:o.Source.KeyboardShortcuts,action:o.Action.KeyboardShortcutExecuted,name:f.id}),i.preventDefault()))}],[u.default.keyup,function(t){var i=e.getModifierKeys(t);t.keyCode===71&&i===0&&(n=!1)}]))},n.prototype._removeEventHandlers=function(){i.disposeDisposable(this._disposables);this._disposables=[]},n.prototype._registerShortcut=function(n,t,i,r){r===void 0&&(r=0);var u=this._keyShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate shortcut: "+f):this._keyShortcuts[i]=[];this._keyShortcuts[i][r]=e},n.prototype._addKeyShortcuts=function(n){this._registerGotoShortcut(s.toggleFocusSideAndTopBar,(function(){var n=
r(document).findByClassName(d)[0];r(document.activeElement)[0]===n?r(document).findByClassName(k)[0].focus():n.focus()}),190);this._registerGotoShortcut(s.moveFocusToCommandBar,(function(){var t=v(n),i=t&&t.getContentWidget();i&&i.setFocusOnCommandBar()}),188);this._registerShortcut(s.bladeSearch,(function(){var t=v(n);t&&t.focusSearchBox()}),191,8);i.isFeatureEnabled("bladedocker")&&(this._registerGotoShortcut(s.GoBackOneBlade.desc,(function(){var t=c(n);t&&t.dockBladeLeftAlign(!0)}),37),this._registerGotoShortcut(s.GoForwardOneBlade.desc,(function(){var t=c(n);t&&t.dockBladeLeftAlign(!1)}),39))},n.prototype._registerGotoShortcut=function(n,t,i){var r=0,u=this._goToShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r,!0),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate goto shortcut: "+f):this._goToShortcuts[i]=[];this._goToShortcuts[i][r]=e},n.prototype._registerSpecialShortcut=function(n,t,i){r.isFunction(t)&&this._registerShortcut(n,t,i,9)},n.prototype._addGoToShortcuts=
function(n,t){var r=this,i;this._registerGotoShortcut(s.browse,(function(){t.getSideBarWidget().toggleFlyout()}),66);this._registerGotoShortcut(s.new,(function(){t.getSideBarWidget().openCreate()}),78);this._registerGotoShortcut(s.search,(function(){t.getSearchWidget().setFocus()}),191);[[h.allResources,a,65],[h.resourceGroups,b+"Microsoft.Resources%2Fsubscriptions%2FresourceGroups",82],].forEach((function(t){r._registerGotoShortcut(t[0],(function(){n.route(t[1])}),t[2])}));this._registerGotoShortcut(h.dashboard,(function(){t.handleStartButtonClick()}),68);i=function(n,i){var u=i+1;r._registerGotoShortcut(h.sideBarItem+u,(function(){t.options.sideBar.openFavorite(i)}),n)};tt.forEach(i);it.forEach(i)},n.prototype._generateIdForKeyboardShortcut=function(n,t,i){i===void 0&&(i=!1);var r=i?"G+":"";return t>15&&this._errorLoggingFunc("Not allowed modifier!"),t&8&&(r+="CTRL+"),t&1&&(r+="ALT+"),t&2&&(r+="WIN/CMD+"),r+e.mapKeyCodeToString((t&4)==4,n)},n.prototype.getShortcuts=function(){return{key:this._keyShortcuts,
goTo:this._goToShortcuts}},n})()})(s||(s={})),s}));define("_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-part-buttonpart-assetname,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-wide .fxs-part-buttonpart-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-buttonpart{height:100%;width:100%;box-sizing:border-box}.fxs-part-buttonpart-inner{display:-webkit-flex;display:flex;position:relative;height:100%;box-sizing:border-box;text-align:center;-webkit-align-items:center;align-items:center;-webkit-flex-direction:column;flex-direction:column}.fxs-part-buttonpart-inner-pad{padding-top:28px}.fxs-part-buttonpart-iconcontainer{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.fxs-part-buttonpart-iconcontainer>img,.fxs-part-buttonpart-iconcontainer>svg{height:50px;width:50px}.fxs-part-buttonpart-textcontainer{width:100%;font-size:12px;line-height:18px}.fxs-part-buttonpart-assetname{margin:0;font-family:az_ea_font,\"Segoe UI\",wf_segoe-ui_semibold,\"Segoe UI Semibold\",\"Segoe WP Semibold\",\"Segoe WP\",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;line-height:10px;text-transform:uppercase}.fxs-part-buttonpart-title{margin:10px 0 5px;position:relative;overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-tilesize-mini .fxs-part-buttonpart-title,.fxs-tilesize-small .fxs-part-buttonpart-title{margin:0}.fxs-part-buttonpart-title::after,.fxs-part-buttonpart-title::before,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{position:absolute;background-color:inherit}.fxs-part-buttonpart-title::before{content:'\\02026';top:18px;right:0}.fxs-part-buttonpart-title::after{content:'';height:100%;width:100%}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg{height:30px;width:30px}.fxs-tilesize-small .fxs-part-buttonpart-inner,.fxs-tilesize-wide .fxs-part-buttonpart-inner{padding-top:0;text-align:left;-webkit-flex-direction:row;flex-direction:row}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>svg{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{-webkit-flex:0 1 auto;flex:0 1 auto;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:center;justify-content:center}.fxs-tilesize-mini{font-size:12px;line-height:normal}.fxs-tilesize-mini .fxs-part-buttonpart-inner{padding-top:5px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:32px;line-height:15px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:16px;right:0}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer{width:51px;padding-left:6px}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer{width:calc(100% - 51px)}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:18px;right:0}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{width:85px;padding-left:15px}.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{width:calc(100% - 85px)}.fxs-tilesize-wide .fxs-part-buttonpart-title{margin:0}.fxs-tilesize-wide .fxs-part-buttonpart-assetname{padding-top:2px}.fxs-tilesize-wide .fxs-part-buttonpart-desc{display:block;margin-top:10px;position:relative;overflow:hidden;text-overflow:ellipsis;max-height:90px}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after,.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{position:absolute;background-color:inherit}.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{content:'\\02026';top:72px;right:0}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after{content:'';height:100%;width:100%}.fxs-part-buttonpart-externallink{position:absolute;top:0;right:0;height:12px;width:12px}.fxs-part-buttonpart-externallink>img,.fxs-part-buttonpart-externallink>svg{height:12px;width:12px}.fxs-tilesize-mini .fxs-part-buttonpart-externallink{top:-5px;right:5px}.fxs-part-buttonpart,.fxs-part-buttonpart .fxs-part-buttonpart-desc,.fxs-part-buttonpart .fxs-part-buttonpart-inner,.fxs-part-buttonpart .fxs-part-buttonpart-textcontainer,.fxs-part-buttonpart .fxs-part-buttonpart-title{background-color:inherit}.fxs-part-buttonpart-adornment{position:absolute;top:0;left:33px;height:14px;width:14px}.fxs-tilesize-mini .fxs-part-buttonpart-adornment{position:absolute;top:0;left:17px;height:10px;width:10px}.fxs-tilesize-small .fxs-part-buttonpart-adornment{position:absolute;top:50% - 30px/2;left:0;height:10px;width:10px}.fxs-tilesize-wide .fxs-part-buttonpart-adornment{position:absolute;top:50% - 50px/2;left:0;height:14px;width:14px}html[lang^=ja] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=ko] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=zh] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title{font-size:11px;line-height:11px}")})
);define("MsPortalImpl/Parts/Parts.ButtonPart",["require","exports","f","ko","MsPortalImpl/Svg/Startup/Hyperlink.svg","MsPortalImpl/Parts/Parts","MsPortalImpl/Base/Base.SvgHelper","FxInternal/Composition/ViewModel","_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var t=i.getUniqueId(),s;n.template="<div class='fxs-part-buttonpart'><div class='fxs-part-buttonpart-inner'><div class='fxs-part-buttonpart-iconcontainer' data-bind='image: icon, css: { \"fxs-part-buttonpart-inner-pad\": _showTopPadding() }'><\/div><!-- ko if: $data.adornmentUri --><img alt='' class='fxs-part-buttonpart-adornment' data-bind='attr: { src: adornmentUri }' /><!-- /ko --><div class='fxs-part-buttonpart-textcontainer'><h3 class='fxs-part-buttonpart-title msportalfx-tooltip-overflow' "+('data-bind=\'text: _displayTitle, css: { "fxs-should-use-single-line": _assetNameVisible(), "fxs-can-use-multiline": !_assetNameVisible() }\' aria-describedby='+
t+"><\/h3>")+("<div data-bind='text: _assetName, visible: _assetName() && (_assetNameVisible())' class='fxs-part-buttonpart-assetname msportalfx-tooltip-overflow' id="+t+"><\/div>")+"<div data-bind='text: description, visible: ((_size() === MsPortalFx.Parts.PartSize.Wide) && description())' class='fxs-part-buttonpart-desc msportalfx-tooltip-overflow'><\/div><\/div><!-- ko if: _isExternalLink --><div class='fxs-part-buttonpart-externallink azc-fill-heavy' data-bind='attr: { \"aria-label\": _clickableLinkUri }'>"+e.getSvgReferenceOrFallBackToData(u,{customClass:"",isLogo:!0})+"<\/div><!-- /ko --><\/div><\/div>";s=(function(t){function u(){t.apply(this,arguments);this.template=n.template}return __extends(u,t),u.prototype._getContentForBinding=function(n,u){var l=this,e=u.content,s=u.container,f=s.clickableLink,a=function(n){return n.target()==="_self"||n.uri&&i.startsWith(n.uri(),"#")&&n.target()==="auto"},v=r.observable(!!f&&!a(f)),y,h,c;return r.computed(n,(function(){l.ariaLabel(e.title(
))})),y=f&&f.target,y&&y.subscribe(n,(function(){v(!a(f))})),h=f&&f.uri,h&&h.subscribe(n,(function(){v(!a(f))})),c=o.isV2(e)?function(){return l._options.size()}:function(){return e.size&&e.size()},i.extend2(t.prototype._getContentForBinding.call(this,n,u),{_displayTitle:r.computed(n,(function(){var n=c(),t=e.title();return n===0||n===1?e.shortTitle()||t:t})),_assetName:s.assetName,_isExternalLink:v,_clickableLinkUri:h,_assetNameVisible:r.computed(n,(function(){return!l.inContainerOfSameAsset()&&s.assetName()})),_showTopPadding:r.computed(n,(function(){return c()===2&&!s.partTitle()})),_size:r.computed(n,c)})},u})(f.PartImpl);n.ButtonPart=s})(s||(s={})),s}));define("_generated/Less/MsPortalImpl/Parts/Parts.Collection.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-part-collectionpart .azc-grid table td.azc-grid-cell:first-of-type,.fxs-part-collectionpart .azc-grid table thead tr th:first-child a{padding-left:15px}.fxs-part-collectionpart-more-data,.fxs-part-collectionpart-rollup-count{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.fxs-part-collectionpart .azc-grid table thead tr th{height:28px;line-height:28px;border-top-width:1px;border-top-style:solid}.fxs-part-collectionpart .azc-grid table thead tr th>a{line-height:normal}.fxs-part-collectionpart .azc-grid table tbody tr td{height:27px}.fxs-part-collectionpart .azc-grid table td:last-child,.fxs-part-collectionpart .azc-grid table td:last-of-type{padding-right:15px}.fxs-part-collectionpart .azc-grid table .azc-grid-resizableColumn-handle{height:28px}.fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:none}.fxs-part-collectionpart.fxs-part-collectionpart-rollup-forceshow .fxs-part-collectionpart-rollup-container{display:block}.fxs-part-collectionpart-more-data{font-size:12px;line-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:absolute;right:0}.fxs-part-collectionpart-more-data:hover{text-decoration:underline}.fxs-part-collectionpart-rollup-container{margin:-6px 0 6px}.fxs-part-collectionpart-rollup-count{font-size:30px;line-height:30px;letter-spacing:-.025em}.fxs-part-collectionpart-rollup-label{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em;margin-left:4px}.fxs-part-collectionpart-part-title{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;line-height:10px;text-transform:uppercase;margin:5px 0 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:none}.fxs-part-collectionpart-rollup-icon{width:21px;height:21px;margin-left:4px;display:inline-block}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:block;margin:0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label{display:none}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count{line-height:25px}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count{width:30px;height:30px;margin-left:0}.fxs-tilesize-mini .fxs-part-collectionpart{text-align:center;padding:5px 6px 0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-part-title{display:block}.fxs-tilesize-small .fxs-part-collectionpart{float:right;margin-top:-15px}html[lang^=ja] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=ko] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=zh] .fxs-part-collectionpart .fxs-part-collectionpart-part-title{font-size:11px;line-height:11px}')})
);define("MsPortalImpl/Parts/Parts.Collection",["require","exports","f","ko","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Parts/Parts","MsPortalImpl/Resources/ImplScriptResources","_generated/Less/MsPortalImpl/Parts/Parts.Collection.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var t=o.Parts,s='<div class="fxs-part-collectionpart" data-bind="css: {\'fxs-part-collectionpart-rollup-forceshow\': alwaysShowRollupCount()}"><div class="fxs-part-collectionpart-rollup-container"><span class="fxs-part-collectionpart-rollup-count" data-bind="text: rollupCount, visible: !noRollupCount()"><\/span><span class="fxs-part-collectionpart-rollup-label" data-bind="text: rollupCountLabel"><\/span><img class="fxs-part-collectionpart-rollup-icon" data-bind="attr: { src: rollupCountIconUri }, visible: rollupCountIconUri, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }" alt=""/><div class="fxs-part-collectionpart-rollup-icon" data-bind="image: rollupCountIcon, visible: rollupCountIcon, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }"><\/div><h4 class="fxs-part-collectionpart-part-title fxs-display-none" data-bind="text: _partTitle"><\/h4><\/div><!-- ko if: emptyGrid() && noRowsHtml() --><div class="fxs-part-collectionpart-norowshtml fxs-display-none" data-bind="pcControl: noRowsHtml"><\/div><!-- /ko --><!-- ko if: !emptyGrid() || !noRowsHtml() --><!-- ko if: !!gridMode() --><div data-bind="pcGrid: grid" class="msportalfx-removepartpaddingside"><\/div>'+
('<a href="#" class="fxs-part-collectionpart-more-data fxs-portal-text-primary" tabindex="0" data-bind="visible: hasMoreData">'+i.encodeHtml(t.more)+"<\/a>")+"<!-- /ko --><!-- /ko --><\/div>",h=(function(n){function t(t,i,r,f){n.call(this,t,i,r,f);this.template=s;var e=this._container=u(t);e.on("click keydown","a.fxs-part-collectionpart-more-data",(function(n){n.preventDefault();n.stopPropagation();var t=u.Event(n.type);t.keyCode=n.keyCode;u(n.delegateTarget).trigger(t)}))}return __extends(t,n),t.prototype._getContentForBinding=function(n,t){var u=this._container.findByClassName("fxs-part-collectionpart-part-title"),e=this._container.findByClassName("fxs-part-collectionpart-norowshtml");return r.computed(n,(function(){var n=t.content.size();f.toggle(u,n!==0||!!t.container.partTitle());f.toggle(e,n!==0&&n!==1)})),i.extend2(t.content,{_partTitle:t.container.partTitle})},t})(e.PartImpl);n.CollectionPart=h})(s||(s={})),s}));define("_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css",["require",
"exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxpart-itemsummary{height:100%;background:#00f;display:block;color:#fff}.fxpart-itemsummary-name{font-size:19px;padding:20px;text-transform:uppercase}.fxpart-itemsummary-sourceControl{font-size:16px;padding:0 20px}")}));define("_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".msportalfx-pricingTier .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.msportalfx-pricingTier .msportalfx-pricingTier-normal-iconContainer,.msportalfx-pricingTier .msportalfx-pricingTier-wide-iconContainer{height:55px;border-bottom:1px solid #dcdfe2}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:10px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-specCode{float:left;margin-right:8px;max-width:100px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-promotedFeatures{line-height:12px;padding-top:4px}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon{width:30px;height:30px;margin-top:1.7em}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon.msportalfx-pricingTier-icon-small{margin-top:-.15em}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:10px}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:30px;height:30px;margin-right:15px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:18px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:20px;height:20px;margin-right:5px}.fxs-tilesize-small .msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:-12px}.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specCode,.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specTitle{text-align:center;float:initial}")})
);define("_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,'.msportalfx-specpicker-footer-value,.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode,.msportalfx-specpicker-table .msportalfx-specpicker-feature-name,.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.msportalfx-specpicker{width:175px;height:320px;position:relative;border-color:inherit}.msportalfx-specpicker:after,.msportalfx-specpicker:before{content:"";position:absolute;z-index:-1;top:10px;bottom:10px;left:0;right:0;border-radius:10px}.msportalfx-specpicker:after{right:10px;left:auto;transform:skew(8deg) rotate(3deg)}.msportalfx-specpicker .msportalfx-specpicker-table{table-layout:auto}.msportalfx-specpicker ul{list-style-type:none;padding:0}.msportalfx-specpicker .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.fxs-mode-dark .msportalfx-specpicker{box-shadow:0 1px 4px rgba(255,255,255,.3),0 0 40px rgba(255,255,255,.1) inset}.fxs-mode-dark .msportalfx-specpicker:after,.fxs-mode-dark .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(255,255,255,.8)}.fxs-mode-light .msportalfx-specpicker{box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset}.fxs-mode-light .msportalfx-specpicker:after,.fxs-mode-light .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(0,0,0,.8)}.msportalfx-specpicker-star{width:14px;height:14px;fill:#ffb900;stroke:#000;stroke-width:1px;float:right;margin-right:4px;margin-top:1px}.msportalfx-specpicker-header{color:#fff;font-size:14px;height:26px;line-height:26px}.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode{text-transform:uppercase;padding-left:11px}.msportalfx-specpicker-header .msportalfx-specpicker-header-title{padding-left:6px}.msportalfx-specpicker-header-text{fill:#ffb900;stroke:#000;stroke-width:1px;width:161px;position:absolute}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade1{background-color:#4668c5}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade2{background-color:rgba(70,104,197,.2)}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade3{background-color:rgba(70,104,197,.1)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade1{background-color:#8a2da5}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade2{background-color:rgba(138,45,165,.2)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade3{background-color:rgba(138,45,165,.1)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade1{background-color:#578000}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade2{background-color:rgba(87,128,0,.2)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade3{background-color:rgba(87,128,0,.1)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade1{background-color:#c40}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade2{background-color:rgba(204,68,0,.2)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade3{background-color:rgba(204,68,0,.1)}.msportalfx-specpicker-table{table-layout:auto;width:100%;border-collapse:collapse}.msportalfx-specpicker-table .msportalfx-specpicker-feature-name{font-size:12px;margin-left:6px}.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-size:17px}.msportalfx-specpicker-row td{white-space:nowrap;padding:0}.msportalfx-specpicker-row td .msportalfx-specpicker-cell{height:30px;line-height:30px}.msportalfx-specpicker-row td.msportalfx-specpicker-right{overflow:hidden;text-overflow:ellipsis;max-width:1px;width:100%}.msportalfx-specpicker-row.msportalfx-specpicker-promotedFeatures td{padding-bottom:1px}.msportalfx-specpicker-row.msportalfx-specpicker-borderBottom td{border-bottom:1px solid #e9e9f3}.msportalfx-specpicker-row .msportalfx-specpicker-left{text-align:center;min-width:39px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-value{font-size:12px;padding-top:6px;margin-left:6px;line-height:normal}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-name{font-size:10px;line-height:normal;margin-top:-3px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-mutipleline .msportalfx-specpicker-feature-value{padding-top:1px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{min-width:29px;text-align:center}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell img{width:22px;height:22px;margin-top:8px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell div{width:20px;height:20px;padding-top:5px;padding-left:0;display:inline-block}.msportalfx-specpicker-footer-container{position:absolute;bottom:0;left:0;right:0;height:46px;text-align:right}.msportalfx-specpicker-footer{margin-right:10px;margin-bottom:8px;background-color:inherit}.msportalfx-specpicker-footer-value{margin-top:6px;text-transform:uppercase;font-size:22px;line-height:22px;letter-spacing:-.025em}.msportalfx-specpicker-footer-details{font-size:10px;line-height:14px;text-transform:uppercase}.msportalfx-specpicker-footer-channelMessage,.msportalfx-specpicker-footer-statusMessage{margin-left:5px;margin-right:5px;font-size:11px;text-align:left}.msportalfx-specpicker-footer-statusMessage{margin-top:25px}.msportalfx-specpicker-footer-channelMessage{margin-top:10px;position:absolute;background-color:inherit;white-space:normal;overflow:hidden;text-overflow:ellipsis;max-height:32px}.msportalfx-specpicker-footer-channelMessage::after,.msportalfx-specpicker-footer-channelMessage::before{position:absolute;background-color:inherit}.msportalfx-specpicker-footer-channelMessage::before{content:\'\\02026\';top:16px;right:0}.msportalfx-specpicker-footer-channelMessage::after{content:\'\';height:100%;width:100%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker{background-color:rgba(189,189,189,.05)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-header{background-color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.2)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-right .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.1)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-container{background-color:#dedede}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-name,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-value,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-value{color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor{position:absolute;text-align:center;left:15px;right:15px;top:40%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container{display:inline-block;background-color:rgba(50,56,63,.8);margin-top:20px;padding:15px 10px;width:100%;box-sizing:border-box}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container .msportalfx-specpicker-disable-message{display:inline}.ext-hubs-specPickerGrid-container{height:100%;overflow:hidden;display:flex;flex-direction:column}.ext-hubs-specPicker-container{width:100%;min-height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-filtersContainer.ext-hubs-specPicker-filtersContainer{margin-top:0;padding-top:5px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer{height:25px;padding-top:5px;padding-right:15px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions{font-size:14px;float:right}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .msportalfx-specpicker-recommendationsIcon{width:14px;height:14px;display:inline-block}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-selected{cursor:default;background-color:inherit}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-clickable{color:#0058ad;fill:#0058ad}.ext-hubs-specPicker-container .ext-hubs-specPicker-content{height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-message{margin-top:0;border-left:6px solid #ffb900;padding:15px;white-space:pre-wrap}.ext-hubs-specPicker-container .ext-hubs-specPicker-listView{margin-left:19px}.ext-hubs-specPicker-container .fxc-hotspot{outline:0;padding:5px}.ext-hubs-specPicker-container .fxc-hotspot:focus{outline-style:dotted;outline-width:1px}')})
);define("MsPortalImpl/Parts/Parts.Intrinsics",["require","exports","f","MsPortalImpl/Parts/Parts","_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css","_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css"],(function(n,t,i,r){"use strict";var u;return (function(n){var t=i.Parts.PartKind,s=0,e=1,f=2,u=3,h=10,c=4,l=5,a=6,p=7,v=8,w=9,o="<div data-bind='{0}: $root'><\/div>",y={defaultSize:v,supportedSizes:[v],viewStateProperties:["content.selection.selectedItems","content.selection.activatedItems"]};n.parts=[{kind:t.Asset,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Asset",(function(n,t,i,r,u){return new n.AssetPart(t,i,r,u)}),{defaultSize:e,supportedSizes:[s,e,f]})},{kind:t.Button,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.ButtonPart",(function(n,t,i,r,u){return new n.ButtonPart(t,i,r,u)}),{supportedSizes:[s,e,f,u]})},{kind:t.Chart,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Chart",(function(
n,t,i,r,u){return new n.Chart(t,i,r,u)}),{supportedSizes:[e,f,c,u,h,l,a,p,v,w]})},{kind:t.Collection,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Collection",(function(n,t,i,r,u){return new n.CollectionPart(t,i,r,u)}),{supportedSizes:[s,e,f,u,c,h,l,a,p,w,v]})},{kind:t.CollectionSummary,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.CollectionSummary",(function(n,t,i,r,u){return new n.Part(t,i,r,u)}),{supportedSizes:[s,e,f,u]})},{kind:t.DiffEditor,factory:r.createPartFactory(o.format("pcDiffEditor"))},{kind:t.Donut,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Donut",(function(n,t,i,r,u){return new n.Donut(t,i,r,u)}),{supportedSizes:[f,l,u,h,c,a,]})},{kind:t.Editor,factory:r.createPartFactory(o.format("pcEditor"))},{kind:t.Grid,factory:r.createPartFactory(o.format("pcGrid"),{viewStateProperties:["content.selectableData.selectedItems","content.selectableData.activatedItems","content.selectableData.itemsWithChildEdits"]})},{kind:t.InfoList,factory:r.createAmdPartFactory(
"MsPortalImpl/Parts/Parts.InfoList",(function(n,t,i,r,u){return new n.InfoListPart(t,i,r,u)}),y)},{kind:t.ItemSummary,factory:r.createPartFactory("<div class='fxpart-itemsummary'><div class='fxpart-itemsummary-name' data-bind='text: name'><\/div><\/div>")},{kind:t.LogStream,factory:r.createPartFactory(o.format("pcLogStream"))},{kind:t.Properties,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Properties",(function(n,t,i,r,u){return new n.PropertiesPart(t,i,r,u)}),y)},{kind:t.Provisioning,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Provisioning",(function(n,t,i,r,u){return new n.ProvisioningPart(t,i,r,u)}),{supportedSizes:[f,u]})},{kind:t.QuickStart,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuickStart",(function(n,t,i,r,u){return new n.QuickStartPart(t,i,r,u)}),{defaultSize:e,supportedSizes:[s,e,f,u]})},{kind:t.QuotaGauge,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuotaGauge",(function(n,t,i,r,u){return new n.QuotaGauge(t,i,r,u)}),{supportedSizes:
[f,h,u,c,a,l]})},{kind:t.ResourceSummary,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.ResourceSummary",(function(n,t,i,r,u){return new n.ResourceSummaryPart(t,i,r,u)}),y)},{kind:t.Settings,factory:r.createPartFactory(o.format("pcSettings"),{defaultSize:u,supportedSizes:[u]})},{kind:t.SingleSetting,factory:r.createPartFactory(o.format("pcSingleSetting"))},{kind:t.SingleValueGauge,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.SingleValueGauge",(function(n,t,i,r,u){return new n.SingleValueGauge(t,i,r,u)}),{supportedSizes:[f,h,u,c]})},{kind:t.Unavailable,factory:r.createPartFactory("<div><\/div>")}];n.parts.forEach((function(n){r.registerFactory(t[n.kind],n.factory)}))})(u||(u={})),u}));define("MsPortalImpl/Services/Services.AzureStorage",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function e(){u.register(r.Rpc.client,[r.Extension.getWindowId({name:"Microsoft_Azure_Scheduler",cloudName:t.Constants.DefaultCloudName})],o)}function o(n)
{var i={isBackgroundTask:!1,uri:f};return t.Net2.postJSON(i,n).then((function(n){return n.data}))}var t=i.Base,u=r.InternalAzure.getSasUriForQueueEndPoint,f=t.Resources.getAppRelativeUri("api/Storage/getsasuriforqueue");n.registerSasEndPoint=e})(u||(u={})),u}));define("MsPortalImpl/Services/Services.BrowseCuration",["require","exports","f","i","a","MsPortalImpl/Resources/ImplScriptResources","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f,e){"use strict";function p(n){if(n&&!d.test(n)){a.warning("Invalid curation file name: <"+n+">, skipping this curation file.");return}return n}function tt(n,t,i){var r=u.isArray(t[0])?t:[t];return{base:o(n),associated:s.apply(s,r),infoTextOverride:i}}function o(n){var t,i;if(n&&!(n.length<2)&&n[0].length&&n[1].length)return t={extensionName:n[0],assetType:n[1]},n.length>2&&(i=n[2],i&&typeof i=="string"?t.kind=i:n[2]===!1&&(t.isHidden=!0)),t}function s(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];return t.map((function(n){return o(n)})).filter((function(
n){return!!n}))}function it(){e.Curation.getSharedCurationEndpoint.register(b.client,[r.Extension.getHubsWindowId()],(function(){return t.getSharedCuration()}))}var h=i.Base,b=r.Rpc,c=i.Hubs.Notifications,k=window,l=k.fx.environment,a=h.Diagnostics.createLog(n),d=/^[a-z\_]+[a-z\d\-\_]*$/i,v=f.BrowseCuration,y=i.lowerCaseAllStrings,g=p(i.getFeatureValue("browsecuration")),nt=p(l.browseCuration),w=g||nt||"default";t.getMergedAssetType=tt;t.getAssetType=o;t.getAssetTypes=s;t.getBrowseCuration=i.memoizeQ((function(){return i.require("MsPortalImpl/Services/BrowseCuration/"+w).then((function(n){return n.getCuration()})).catch((function(n){var i="Failed to get the browse curation file <"+w+">",t=i;return n&&n.statusText?t+=": "+(n.status||"")+" ("+n.statusText+")":n&&n.message&&(t+=": "+n.message),a.warning(t),c.ClientNotification.publish({title:v.noCurationTitle,description:v.noCuration,status:c.NotificationStatus.Warning}),{}}))}));t.getSharedCuration=i.memoizeQ((function(){var n=f.SearchTypeDisplayText,
r=f.SearchTypeKeywords,u=f.SearchTypeSubText;return t.getBrowseCuration().then((function(t){var f=(t&&t.search||[]).map((function(t){var i=(t.id||"").toLowerCase(),f=i&&n[i];if(f)return{id:t.id,displayName:f,subText:u[i],keywords:(r[i]||"").split(","),icon:typeof t.icon=="string"?h.Images.ImageUri(t.icon):t.icon,link:(t.link||"").format({accountPortal:l.links.accountPortal})}})).filter(i.identity);return{searchCuration:f,resourceTypesExcludedFromBrowse:y(t&&t.resourceTypesExcludedFromBrowse),mergedAssetTypes:y(t&&t.mergedAssetTypes)}}))}));t.testReset=i.noop;t.initializeRpc=it}));define("MsPortalImpl/Services/Services.Controller",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function r(n){var i=[n?n.flushSettings():Q(),t.Telemetry.flush(),t.Upload.flush()],r=i.every((function(n){return!n||Q.isPromise(n)?!Q.isPending(n):n.state()!=="pending"}));return r?Q():Q.all(i)}var t=i.Base.Diagnostics;n.flush=r})(r||(r={})),r}));define("MsPortalImpl/Services/Services.FavoritesSettings",
["require","exports","i","ko","MsPortalImpl/Services/Services.SettingsProcessor"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function h(i){if(f&&!o.isTestMode)throw new Error(t+" has already been called.");f=!0;n.processor.init(i,n.settings,e,t,!0)}var e=10,t="InitializeFavoritesSettingsInternal",o=window.fx.environment,f=!1,s=new i.TriggerableLifetimeManager;n.processor=new u.SettingsProcessor(s);n.settings={favorites:r.observable(""),version:r.observable(0)};n.init=h})(f||(f={})),f}));define("MsPortalImpl/Services/Services.FileUploadEndpointRegistration",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function s(){e||(e=!0,u.uploadActionEndPoint.register(t.client,null,(function(n){return f().then((function(t){return t.invokeUploadAction(n.uploadKey,n.action,n.context)}))})),u.getUploadInfosEndPoint.registerObjectFactory(t.client,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){return f().then((function(t){return t.getUploadInfos(
n.uploadKeys,n.category,n.resumable)}))}}))}var t=r.Rpc,u=r.FileUpload,o="MsPortalImpl/Services/Services.FileUploadManager",f=i.memoizeQ((function(){return i.require(o).then((function(n){return n.fileUploadManagerInstance()}))})),e=!1;n.registerFileUploadEndpoints=s})(u||(u={})),u}));define("MsPortalImpl/Services/Services.GalleryEndpoints",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){var t=r.Extension,e=i.Base,o=e.Constants.ExtensionNames,s=window,u=s.fx.environment,f=u.features,h=(function(){function n(n,i,r){var e=this;this._registeredEndpoints=[];this._extensionManager=i;this._extensionMetadataSource=r;t.getLocalGalleryPackagesEndpointsDefinition.register(n,null,(function(n,i){var r=t.getDescriptor(i.srcWindowId).name.toLowerCase();return r===o.Marketplace.toLowerCase()?e._ensureAllTestExtensionsAreLoaded().then((function(){return e._registeredEndpoints.slice(0)})):null}));t.registerLocalGalleryPackagesEndpointDefinition.register(n,null,(function(n){if(u.
isDevelopmentMode||f&&f.canmodifyextensions){var t=e._registeredEndpoints;t.indexOf(n)<0&&t.push(n)}}))}return n.prototype._ensureAllTestExtensionsAreLoaded=function(){var n=this;return this._extensionMetadataSource.listTestExtensions().then((function(t){return Q.allSettled(t.map((function(t){return n._extensionManager.getExtensionByName(t.name,t.cloudName)})))}))},n})();n.GalleryEndpointsService=h})(u||(u={})),u}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-messagebox,.fxs-progressbox{font-size:14px;box-sizing:border-box;box-shadow:0 5px 15px 2px rgba(0,0,0,.3);border:1px solid}.fxs-messagebox h2,.fxs-progressbox h2{font-size:110%;padding:24px 27px 7px;margin:0;line-height:14px;border-bottom:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-messagebox .fxs-messagebox-text,.fxs-messagebox .fxs-modal-template,.fxs-messagebox .fxs-progressbox-text,.fxs-progressbox .fxs-messagebox-text,.fxs-progressbox .fxs-modal-template,.fxs-progressbox .fxs-progressbox-text{padding:0 27px;word-wrap:break-word}.fxs-messagebox .fxs-progressbox-progressbar,.fxs-progressbox .fxs-progressbox-progressbar{padding:7px 27px 24px}.fxs-messagebox .fxs-messagebox-buttons,.fxs-progressbox .fxs-messagebox-buttons{border-top-width:1px;border-top-style:solid}.fxs-messagebox .fxs-messagebox-buttons .fxs-button,.fxs-progressbox .fxs-messagebox-buttons .fxs-button{margin-right:5px}.fxs-messagebox .msportalfx-form,.fxs-progressbox .msportalfx-form{padding:0;margin:27px 0 0}.fxs-messagebox .msportalfx-form>div,.fxs-progressbox .msportalfx-form>div{padding:15px 27px}.azc-balloon-dialog .fxs-messagebox{box-shadow:unset;border:0}.fxs-messagebox-confirmation{padding:10px 27px 0;display:block}")})
);define("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","MsPortalImpl.Controls/Controls/SimpleButton"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function rt(n){var i=n.closest("."+v),t;i.length>0&&(t=h.Widget.getWidget(i,y),t.cancelBtn&&t.cancelBtn.onClick.call(this))}function d(n,t){var r=n.closest("."+v),i;for(r.length>0&&c.waitForBindings(r[0]).then((function(){var n=h.Widget.getWidget(r,y);n.options.confirmationRequired?n.element.find(".azc-checkBox").focus():n.element.find(".fxs-portal-button-primary").focus()})),i=t||document.activeElement;i&&typeof i.focus!="function";)i=f(i).closest("[tabindex]")[0];w=i}var nt=i.Base.Diagnostics,tt=i.ViewModels.
Controls.SimpleButton.ViewModel,a=nt.createLog(n),b=i.newGuid,l=e.Dialogs.ButtonText,k="fxs-portal-bg-txt-br",v="fxs-messagebox",p="fxs-messagebox-text",it='<h2 data-bind="text: data.title" class="fxs-messagebox-title" msportalfx-tooltip-overflow"><\/h2><!-- ko if: data.modal --><!-- ko ifnot: data.template -->'+('<div data-bind="sanitizedHtml: data.text" class="'+p+'"><\/div>')+'<!-- /ko --><!-- ko if: data.template --><div class="fxs-modal-template" data-bind="untrustedHtml: { html: data.template, data: data.templateViewModel, isolated: true }"><\/div><!-- /ko --><!-- /ko --><!-- ko ifnot: data.modal --><!-- ko ifnot: data.template -->'+('<div data-bind="text: data.text" class="'+p+'"><\/div>')+'<!-- /ko --><!-- ko if: data.template --><div class=\'msportalfx-padding\' data-bind="untrustedHtml: { html: data.template, data: data.templateViewModel, isolated: true }"><\/div><!-- /ko --><!-- /ko --><!-- ko if: data.confirmationRequired --><div data-bind="pcControl: func.checkboxVm" class="fxs-messagebox-confirmation"><\/div><!-- /ko --><div class="msportalfx-form fxs-messagebox-buttons fxs-portal-border"><div data-bind="foreach: func.buttonVms"><div data-bind="pcControl: $data.vm, attr: { \'data-result\': $data.result }"><\/div><\/div><\/div>',
w=document.activeElement,g,y;t.cancelMessageBox=rt;t.setFocusOnMessageBox=d;g=(function(n){function t(){n.apply(this,arguments);this.title=u.observable();this.text=u.observable();this.template=u.observable();this.templateViewModel=u.observable();this.modal=!1;this.buttons=1;this.confirmationRequired=!1}return __extends(t,n),r.defineProperty(t.prototype,"onButtonClick",{get:function(){return this._buttonClick},set:function(n){if(this._buttonClick)throw new Error("The onButtonClick callback has already been set.");this._buttonClick=n},enumerable:!0,configurable:!0}),t})(h.ViewModel);t.ViewModel=g;y=(function(n){function t(t,r){var e=this,h,c,l;n.call(this,t,r);this.buttonVms=u.observableArray([]);t.html(it).addClass(v).addClass(k);h=this.ltm;c=function(n){var t=e.element[0];return!e.options.modal&&!(t===n)&&!f.contains(t,n)?2:0};this._dismissHandle={dismissFn:function(){e.cancelBtn&&e.cancelBtn.onClick.call(e)},shouldDismissOnMouseDownFn:c,shouldDismissOnMouseWheelFn:c,restoreFocus:function(
){o.validatePreviousFocusedElement(e._dismissHandle,w)&&w.focus()},logName:"messagebox"};this.checkboxVm=new i.ViewModels.Forms.CheckBox.ViewModel(h,{label:u.observable(r.confirmationMessage),inlineLabel:!0});this._getButtonHtml(r.buttons,h);this._bindDescendants();this._setAria();d(t,document.activeElement);l=new s.KeyboardNavigation(t,2);o.register(this._dismissHandle);h.registerForDispose((function(){l.dispose();o.unregister(e._dismissHandle)}));this.checkboxVm.value(!r.confirmationRequired);u.reactor(h,(function(){e.defaultBtn.disabled(!e.checkboxVm.value())}))}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(v,k);n.prototype.dispose.call(this)},t.prototype.generateBtns=function(n,t){var u=this,r=this.buttonVms,f=function(n,t,i,r){return new tt(n,{text:t,primary:i,onClick:function(){if(typeof u.options.onButtonClick=="function")u.options.onButtonClick(r);u._dismissHandle.restoreFocus()}})};r().forEach((function(n){n.vm.dispose()}));r().length=0;r([]);this.defaultBtn=
null;this.cancelBtn=null;t.forEach((function(t,i){i===0&&t.kind!==1&&a.error("The first button should be the default button for this dialog.");u.defaultBtn&&t.kind===1&&a.error("Only one default button should be defined.");u.cancelBtn&&t.kind===2&&a.error("Only one cancel button should be defined.");switch(t.kind){case 1:r.push({vm:f(n,t.text,!0,t.result),result:t.result});u.defaultBtn=r().last().vm;break;case 2:r.push({vm:f(n,t.text,!1,t.result),result:t.result});u.cancelBtn=r().last().vm;break;case 3:default:r.push({vm:f(n,t.text,!1,t.result),result:t.result})}}));t.length===1&&(this.cancelBtn=this.defaultBtn);i.isNullOrUndefined(this.cancelBtn)&&a.error("Cancel button should be defined.")},t.prototype._getButtonHtml=function(n,t){var i=this.options;if(i.customBtns)this.generateBtns(t,i.customBtns);else{switch(n){case 0:this.generateBtns(t,[{kind:1,text:l.retry,result:5},{kind:2,text:l.abort,result:0},{kind:3,text:l.ignore,result:2}]);break;case 1:this.generateBtns(t,[{kind:1,text:l.ok,
result:4}]);break;case 2:this.generateBtns(t,[{kind:1,text:l.ok,result:4},{kind:2,text:l.cancel,result:1}]);break;case 3:this.generateBtns(t,[{kind:1,text:l.retry,result:5},{kind:2,text:l.cancel,result:1}]);break;case 4:this.generateBtns(t,[{kind:1,text:l.yes,result:6},{kind:2,text:l.no,result:3}]);break;case 5:this.generateBtns(t,[{kind:1,text:l.yes,result:6},{kind:3,text:l.no,result:3},{kind:2,text:l.cancel,result:1}]);break;default:throw new Error("Could not locate message box button of type {0}.".format(n));}this.defaultBtn&&i.defaultButtonText&&this.defaultBtn.text(i.defaultButtonText);this.cancelBtn&&i.cancelButtonText&&this.cancelBtn.text(i.cancelButtonText)}return},t.prototype._setAria=function(){var n=this.element,t=b(),i=b();n.attr({role:"alertdialog","aria-labelledby":i,"aria-describedby":t});n.find("h2").attr("id",i);n.findByClassName(p).attr("id",t);this.ltm.registerForDispose((function(){n.removeAttr("role aria-labelledby aria-describedby")}))},t})(h.Widget);t.Widget=y}));define(
"MsPortalImpl/Services/Services.PortalTips",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function s(n,t,i,r){return t.then((function(){h(n,i);u.settings.whatsNewVersion(r)}))}function h(t,r){var s=t.createChildLifetime(),h=function(){s.isDisposed()||s.dispose()},c=o.DefaultView,u=new f.ViewModel;u.buttons=1;u.title(c.title);u.text(c.description.format(e.browseLabel));u.onButtonClick=h;u.disabled(!1);Q.delay(500).then((function(){i.require("../../Viva.Controls/Controls/Viva.Balloon",n).then((function(n){var t=new n.ViewModel({ltm:s}),i;r.push(i=function(e){if(e.length&&r.indexOf(i)>=0){r.removeAll([i]);t.box((function(){return n.getBox($(e[0]))}));t.content('<div class="fxs-portal-tip-content"><\/div>');var o=$(".fxs-portal-tip:first"),c=new n.Widget(o,t,{isTrusted:!0});s.registerForDispose([c,new f.Widget(o.find(
".fxs-portal-tip-content:first"),u),]);t.visible(!0);t.visible.subscribe(s,(function(n){n||h()}))}})}))}))}var e=window.fx.environment.branding,o=r.PortalTips;t.setup=s})(e||(e={})),e}));define("MsPortalImpl/Services/Services.SecurityTokens",["require","exports","f","i"],(function(n,t,i,r){"use strict";function pt(n){t.authState=n}function wt(){t.authState&&ht.setItem(yt,JSON.stringify(t.authState))}function bt(n){return n.refreshToken?new l(new tt,n):new it(n)}function kt(n,t,i){return new a(ft.client,n,t,i)}function dt(n){var t=n&&n.authHeader;return t?function(){return Q(t)}:function(){return Q.reject(h)}}var v=r,s=v.Extension,u=i.Base,y=u.Net2,rt=u.Constants,p=u.Constants.ExtensionNames.Hubs,w=u.Diagnostics,b=w.Telemetry,ut=u.Resources,ft=r.Rpc,et=u.Security,ot=v.Security,st=window,ht=MsPortalImpl.sessionStorage,k=w.createLog(n),ct=ut.getAppRelativeUri("/api/DelegationToken"),f=ot.tokenErrors,e="",o=rt.Shell.toLowerCase(),lt=f.accessDenied,d=f.unknown,g=f.sessionEnded,h=f.credentialsExpired,
at=f.networkError,vt=f.nullToken,c=Date.now,nt=s.getWindowId,yt=st.fx.environment.bootstrapAuthorizationKey,tt,l,it,a;t.updateAuthState=pt;t.writeAuthState=wt;t.createOAuthTokenProvier=bt;t.createSecurityTokensManager=kt;tt=(function(){function n(){}return n.prototype.getToken=function(n,t,r,u){var e={extensionName:n,resourceName:r,tenant:t,portalAuthorization:u},o=b.start({source:"Services.SecurityTokens",action:"Get",name:n}),f;return Q(y.postJSON({uri:ct,dataType:"json",setAuthorizationHeader:!1,performRetry:!0},e)).catchError(i.Errors.AjaxError,(function(t){return f="Failed to get tokens for extension '{0}' resource '{1}'. {2} {3} {4}".format(n,r,t.jqXHR.status,t.textStatus,t.errorThrown),Q.reject(t)})).finally((function(){b.endTrace(o,!f,f||r)}))},n})();l=(function(){function n(n,t){var r=this._refreshToken=t.refreshToken,i;this._pendingAuthorization=Q.resolve(r);this._client=n;i=this._user=t.user;this._tenant=i&&i.tenantId}return n.prototype.getToken=function(n,t){var i=this;return this.
_pendingAuthorization.then((function(r){var u=i._client.getToken(n,i._tenant,t||e,r).catch((function(n){var i=n.data||{},t=i.status,u;return u=t===401?h:t?d:at,{portalAuthorization:r,value:{authHeader:null,expiresInMs:0,refreshToken:null,error:u,errorMessage:"code: {0}, statusText: {1}, message: {2}, stack: {3}".format(t,i.statusText,n.message,n.stack||"")}}}));return i._pendingAuthorization=u.then((function(n){return i._refreshToken=n.portalAuthorization||r})),u}))},n.prototype.getRefreshToken=function(){return this._refreshToken},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n})();t.OAuthTokenProviderImpl=l;it=(function(){function n(n){this._token=n.oAuthToken;this._user=n.user}return n.prototype.getToken=function(){return Q.resolve({value:this._token,portalAuthorization:""})},n.prototype.getRefreshToken=function(){return""},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n})();a=(function(){function n(n,t,i,r){this._extensionTokenSettings={};this._sessionEnded=
!1;this._hubsWindowId=s.getHubsWindowId();this._tokenProvider=t;this._rpcClient=n;this._sessionEndedHandler=i;this._tokenFailedHandler=r}return n.prototype.initializeSecurityForShell=function(n){var t=n||{},i=t.oAuthToken,f=t.refreshToken,r=t.createdOn||c(),u=f?this._createShellTokenFunc(i,r):dt(i,r,this._sessionEndedHandler);return this._enableShellTokenAccess(),y.initialize(u),u},n.prototype.registerGetAuthorizationTokenEndpoint=function(n){var t=this;this._extensionTokenSettings=i.convertArrayToMap(n,(function(n){var t=n.cloudName;return nt({name:n.name.toLowerCase(),cloudName:t?t.toLowerCase():undefined},{forceCloudName:!0}).toLowerCase()}),(function(n){return n.tokenSettings}));this._enableShellTokenAccess();s.getAuthorizationTokenEndPoint.register(this._rpcClient,null,(function(n,i){var r,u=n.cloudName;return r=i.srcWindowId===t._hubsWindowId?nt({name:p,cloudName:u},{forceCloudName:!0}):i.srcWindowId,t._getSecurityToken(u,r,n.resourceName||e,n.isBackground)}))},n.prototype.getDiagnosticsData=
function(){return this._tokenProvider.getDiagnosticsData()},n.prototype._getSecurityToken=function(n,t,i,r){var f=this,l=t.toLowerCase(),s=this._extensionTokenSettings[l],u=this._shellTokenCache;return i&&s&2?Q({error:lt}):this._sessionEnded?Q({error:g}):u&&!i&&s&1?u.getToken({cloudName:n,resourceName:""}).then((function(n){return{token:n}})):this._tokenProvider.getToken(t,i,r).then((function(s){var y=c(),l=s&&s.value||{},a=l?l.error:vt,nt=l.errorMessage,w,v,tt,it,b;return!a&&l.authHeader?{token:{header:l.authHeader,expiresAt:y+l.expiresInMs}}:(w=a===h,(a===g||w)&&(f._sessionEnded=!0,v=void 0,w||!u?v=y:(tt=t===o?i:e,v=u.getTokenExpiresAt(n,tt)),f._sessionEndedHandler(t,v||y)),r||(it=!i&&(t===o||t===p),f._tokenFailedHandler(t,it),b="Failed to get token for {0} & {1}. Error:{2}. Message:{3}".format(t,i,a,nt),a===d?k.error(b):k.verbose(b)),{error:a,errorMessage:nt})}))},n.prototype._createShellTokenFunc=function(n,i){var u=this,f={},r,s;return n&&(r=n.expiresInMs||1,f[e]={header:n.authHeader,
expiresAt:r>0?i+r:-1}),s=this._shellTokenCache=et.createAuthTokenCache((function(n){return u._getSecurityToken(n.cloudName,o,n?n.resourceName:e,n.isBackground).then((function(i){var o=(i||{}).token,s;if(!!o&&n.resourceName===e){var r=t.authState||{},h=c(),f=r.oAuthToken||{};f.authHeader=o.header;f.expiresInMs=o.expiresAt-h;s=u._tokenProvider.getRefreshToken();s&&(f.refreshToken=s);r.createdOn=h;r.oAuthToken=f;t.authState=r}return i}))}),f),function(n){return s.getToken(n).then((function(n){return n&&n.header}))}},n.prototype._enableShellTokenAccess=function(){this._extensionTokenSettings[o]=0},n})();t.SecurityTokensManagerImpl=a}));define("MsPortalImpl/Services/Services.SharedSettings",["require","exports","i"],(function(n,t,i){"use strict";var r;return (function(n){function o(){u.getSharedSettingsEndPoint.register(f.client,null,(function(){return r()}))}function r(){return Q.fcall((function(){return{links:{accountPortal:t.accountPortal,classicPortal:t.classicPortal,createSupportRequest:t.createSupportRequest,
helpAndSupport:t.helpAndSupport,manageSupportRequests:t.manageSupportRequests,giveFeedback:t.giveFeedback,privacyAndTerms:t.privacyAndTerms,learnRelatedResources:t.learnRelatedResources,resourceGroupOverview:t.resourceGroupOverview}}}))}var u=i.Extension,f=i.Rpc,e=window,t=e.fx.environment.links;n.initializeRpc=o;n.getSharedSettings=r})(r||(r={})),r}));define("MsPortalImpl/Services/Services.ShellProvisioner",["require","exports","f","i","MsPortalImpl/Extension/Extension.Definition.Locator"],(function(n,t,i,r,u){"use strict";var f;return (function(t){function y(n){return h||(h=new o(n.desktop,n.rpcClient))}var c=u.Locator,f=r.Extension,l=f.CloudName,e=r.ViewModels.ParameterCollectionV3,a=i.Base,v=a.Diagnostics,s,h,o;t.promiseCleanupDelay=3e4;s=v.createLog(n);t.create=y;o=(function(){function n(n,t){this.provisioningPromisesLookup={};this._desktopManager=n;this._registerRpcCallbacks(t)}return n.prototype.processProvisioningRequest=function(n,r){var f=this,h=!0,e="Provisioning request is ",u,o,
s;if(!n)throw new Error(e+" undefined.");if(u=n.provisioningRefKey,!u)throw new Error(e+"missing the provisioningReferenceKey.");if(!n.provisioningPromise)throw new Error(e+"missing the provisioningPromise.");if(!i.isFeatureEnabled("removecreatepin")&&n.startboardInfo){if(this.provisioningPromisesLookup[u])throw new Error("Provisioning promise already exists with the same key.");this.provisioningPromisesLookup[u]={promise:n.provisioningPromise,wasAcquired:!1,data:undefined};o=function(n){f.provisioningPromisesLookup[u].data=n};n.provisioningPromise.progress(o).then(o).finally((function(){setTimeout((function(){f.provisioningPromisesLookup[u]&&!f.provisioningPromisesLookup[u].wasAcquired&&f._logWarning("Provisioning operation with ref key "+u+" wasn't aquired by the provisioning part. Deleted at "+new Date+".");delete f.provisioningPromisesLookup[u]}),t.promiseCleanupDelay)}));this._addProvisioningPart(n,r)}else n.provisioningPromise.catch((function(n){var t=(n||{}).error||n;f._logWarning("Provisioning promise rejected. "+
(t.message||JSON.stringify(t)))})),n.provisioningConfig&&!!n.provisioningConfig.dontDiscardJourney&&(h=!1);return h&&(s=this._desktopManager.getActiveJourney(),s&&this._desktopManager.forceDiscardJourney(s.id)),n.provisioningPromise},n.prototype._addProvisioningPart=function(n,t){this._desktopManager.addPartToStartBoard({originPartLocator:c.forExtension(n.startboardInfo.provisioningPart.extension,t).withPartType(n.startboardInfo.provisioningPart.name),model:l.addToModel(t,{initialData:{provisioningConfig:n.provisioningConfig,provisioningRefKey:n.provisioningRefKey,startboardPart:n.startboardInfo.startboardPart}}),initialSize:2})},n.prototype._registerRpcCallbacks=function(n){var t=this;e.initiateProvisioningRequestEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(i,r){var s,u=r.srcWindowId,o;return(s=u!==f.getHubsWindowId()?f.getDescriptor(u).cloudName:i.cloudName,o="Can't initiate the provisioning request. ",!i.provisionerId)?Q.reject(o+"provisionerId unspecified."):
i.provisioningRefKey?(e.getProvisioningRequestEndPoint.acquireObject(n,u,i).then((function(n){var i=n.getValue();t.processProvisioningRequest(i,s).finally((function(){n.dispose()}))}),(function(n){throw new Error(n);})),Q(i)):Q.reject(o+"provisioningRefKey unspecified.")}});e.getProvisioningOperationEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){if(!n)return Q.reject("Can't return provisioning operation. provisioningRefKey unspecified.");var i=t.provisioningPromisesLookup[n],r=i&&i.promise;return r&&(t.provisioningPromisesLookup[n].wasAcquired=!0),Q({provisioningPromise:r,data:i&&i.data})}})},n.prototype._logWarning=function(n){s.warning(n)},n})();t.ShellProvisionerImpl=o})(f||(f={})),f}));define("MsPortalImpl/Services/Services.TelemetrySharing",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function h(n){return f.registerExtensionUnloadCallback(n),f}var e=r.Extension,o=i.Base,u=o.Constants,t=r.Rpc,s=(function(
){function n(){var n=this;this._extensions={};t.client.registerRpcEndPoint(u.TelemetrySharing.RegisterExtension,{allowedOrigin:null,handler:function(){n._extensions[t.messageContext.srcWindowId]=!0}})}return n.prototype.registerExtensionUnloadCallback=function(n){var t=this;n.onUnload((function(n){var i=e.getWindowId(n);return t._extensions[i]&&delete t._extensions[i],!0}))},n.prototype.trace=function(n){var i=n.extension,r=n.data&&n.data.srcExtension,f=u.TelemetrySharing.TraceTelemetry;this._extensions[i]&&t.client.invokeRpc(f,i,n);i!==r&&this._extensions[r]&&t.client.invokeRpc(f,r,n)},n.prototype.flush=function(){return i.Helpers.Deferred().resolve().promise()},n})(),f=new s;n.getProcessor=h})(u||(u={})),u}));define("MsPortalImpl/Services/Services.Util",["require","exports","f","i"],(function(n,t,i,r){"use strict";function c(n,t){var i="./Services.UtilHandlers";u(f.pinParts,i,"pinPartsRpcHandler",n,{desktop:t});u(f.getHmacSha256,i,"hmacShaRpcHandler",n);u(s,i,"x509CertificateRpcHandler",n);
u(h,i,"getPublishingProfileRpcHandler",n,null,[o.DefaultCloudName+"/"+e.ClassicResources,"fx"])}function u(t,r,u,f,e,o){return f.registerRpcEndPoint(t,{allowedOrigin:o,handler:function(t,f,o){return i.require(n.normalize(r)).then((function(n){var i=n[u];return i(t,f,o,e)}))}})}var f=r.Constants.RpcMethods,e=i.Base.Constants.ExtensionNames,o=i.Base.Constants,s="MsPortalFx.Internal.Constants.RpcMethods.X509Certificate.getX509Certificates",h="MsPortalFx.Internal.Constants.RpcMethods.PublishingProfile.getPublishingProfile";t.registerEndpoints=c}));define("MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder",["require","exports","f","o","ko","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function d(n,t){var i=n.parent&&n.getPartsContainer(),u=i&&i.getCompatibleSourceReferences&&i.getCompatibleSourceReferences.
bind(i),o=function(n){if(u){var t=u(n);return t&&t[0]}},f,r;return t=t||[],f=n.overridesModel,r=[],t.forEach((function(n){var i=n.name,t;t=e.getModelValue(f,i).exists?null:o(n);r.push(s(n,t))})),r}function a(n){if(n.adapter){var i=v(n),t={},r=y(n,!1);return r.forEach((function(n){var r,f=n.compositionBindingDefinition,u=f&&f.source,e;u&&u.modelType===l&&(e=u.property,r=i[e]);r||(r={bindingSources:[],activeBindingSourceName:null});t[n.targetProperty]=r})),t}return v(n)}function g(n,t,i){function f(f,s){var y,b,l,v;t&&o.CompositionBinder.turnOnInputsSetSuppressionOn(t);o.CompositionBinder.turnOnInputsSetSuppressionOn(i);try{var k=f.inputs,p=f.settings,d=f.inputsMetadata,w=n.getSettingsModel(),c=n.partDefinition&&n.partDefinition.partState,g=c?(c.inputIdentityProperties||[]).concat((c.sharedProperties||[]).map((function(n){return n.property}))):[],it=r.keys(p);g.forEach((function(n){var r=u.unwrap(e.getModelValue(w,n).value),t=n.startsWith("content.")?n.slice(8):n,i=u.toJS(e.getModelValue(p,t).value);
h(i,r)||(e.setModelValue(w,n,i),y=!0);it.remove(t)}));l=a(n);r.keys(l).forEach((function(t){var i=l[t],r=d[t],u=k[t];tt(n,t,i,r.activeBindingSourceName,u)&&(b=!0)}));b&&(n.widgetState.valueHasMutated(),nt(n),n.save())}finally{return v=(y?2:1)|(s?0:4),Q.all([t&&Q(o.CompositionBinder.turnOnInputsSetSuppressionOff(t,v,!0))||Q(),Q(o.CompositionBinder.turnOnInputsSetSuppressionOff(i,v,!0))])}}n.getViewModel().internal.updateConfigFn(f)}function nt(n){var t=n.widget;t&&t.element.trigger(f.fxpartinputchanged,{part:n})}function s(n,t){var r=n,i=n,e=i.targetProperty||r.name,o=!!n.optional,u;return t||(u=i.source&&i.source.property||r.name,t=f.createOverridesOrContainerModelSourceReference(u)),{targetProperty:e,optional:o,source:t,isDynamicBinding:!0}}function v(n){var t=n.parent&&n.getPartsContainer(),i=t&&t.getCompatibleSourceReferences&&t.getCompatibleSourceReferences.bind(t),r=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,s=function(n){var u,t;return r&&i&&(t=r.first((function(
t){return t.name===n})),t&&(u=i(t))),(u||[]).map((function(n){return{sourceReference:n,name:n.property,acceptsValueUpdates:!1}}))},u=n.overridesModel,h=function(n){if(!n||f.isDynamicBindingWithNonLocalSource(n))return!1;var t=n.source&&n.source.property;return u&&t&&e.getModelValue(u,t).exists},o={},c=y(n);return c.forEach((function(n){var r=n.targetProperty,u=s(r),t=n.compositionBindingDefinition,i=t&&t.source,f=!h(t)&&i&&(u||[]).first((function(n){var t=n.sourceReference;return t.modelType===i.modelType&&t.property===i.property}));o[r]={bindingSources:u,activeBindingSourceName:f&&f.name}})),o}function y(n,t){return t===void 0&&(t=!0),n.getNonDetailsContainerPropertyBindings(t).filter((function(n){var t=n.targetProperty;return!b.isBladeCallerInput(t)&&t!==p.EditScopeId}))}function tt(n,t,i,r,f){var y=r&&i.bindingSources.first((function(n){return n.name===r})),p,a,b,d,rt,ut,w,it;if(r&&!y){c.error("Source with name '{0}' for configurable Part input named '{1}' does not exist at the Dashboard/Blade-level.".
format(r,t));return}if(p=n.getInputPropertyBindings(),a=p.properties.first((function(n){return n.targetProperty===t})),y?(rt=i.activeBindingSourceName,y.name!==rt&&(b=!0)):(ut=u.unwrap(e.getModelValue(a.targetModel,a.targetProperty).value),h(u.toJS(f),ut)||(d=!0)),!(b||d))return!1;if(n.adapter){var ft=n.bindings.first((function(n){return n.targetProperty===t})),g=ft&&ft.source,et=g&&g.modelType===l&&g.property;if(et)w=et;else return c.error("For Adapted Part '{0}', input named '{1}' to the inner Part is not configurable.  Presently, only those inner Part inputs using the 'AdapterInput' binding are configurable.".format(n.toString(),t)),!1}else w=t;var nt=n.adapter?n.adapter.inputPropertyBindings:n.getInputPropertyBindings(),tt=nt.properties.first((function(n){return n.targetProperty===w})),ot=tt.compositionBindingDefinition,st=n.overridesModel,v;if(b){var ht=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,ct=ht.first((function(n){return n.name===w})),lt=y.sourceReference;
v=s(ct,lt)}return d&&(e.setModelValue(st,tt.sourceProperty,u.toJS(f)),v=s(ot)),v&&(nt.removeProperty(tt),it=n.adapter?n.adapter.bindings:n.bindings,k(it,ot),o.CompositionBinder.setupPropertyBindings(n,nt,[v],n.bindAgainstOverridesOrContainerModel.bind(n)),it.push(v),n.adapter&&(p.removeProperty(a),o.CompositionBinder.setupPropertyBindings(n,p,a&&[a.compositionBindingDefinition],n.bindAdaptedInput.bind(n)))),!0}var p=i.Base.Constants.BladeParameterNames,w=i.Base.Diagnostics,b=i.ViewModels.Internal,k=i.remove,h=i.deepEquals,c=w.createLog(n),l=9;t.inferInitialBindingsForInputDefinitions=d;t.getConfigurableInputsMetadata=a;t.listenForConfigurationChanges=g})(s||(s={})),s}));define("MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration",["require","exports","o","ko","MsPortalImpl/ViewModels/ViewModels.BladeCaller"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function e(n,t,u){var e=t.internal,f=r.observableArray([]);f.map(n,(function(n,t){r.ignoreDependencies((function(
){o(n,t,e,u)}))}));r.computed(n,e.registeredSelectables,(function(n){n===void 0&&(n={});f.splice.apply(f,[0,f.peek().length].concat(i.keys(n)))})).extend({deferred:!0})}function o(n,i,e,o){var l=o.getBladeOpener(),h={invocationInputArguments:[{valuesFrom:[{referenceType:0,property:t+"."+i}]}]},c=r.unwrap(e.registeredSelectableOptions),s;c&&(s=c[i],s&&(s.parameterCollector&&u.addCallerBindings(f+"."+i+".parameterCollector.bladeCaller",h,0),h.openInContextPane=s.openInContextPane,h.persistentContextPane=s.persistentContextPane));l.registerInvocationProperty(h,null,n)}var t="internal.registeredSelectables",f="internal.registeredSelectableOptions";n.listenForRegistrationChanges=e})(f||(f={})),f}));define("MsPortalImpl/UI/Hubs/UI.FavoritesManager",["require","exports","f","i","o","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/UI/Hubs/UI.BrowseManager","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Services/Services.BrowseCuration"],
(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function dt(n,t,r,u){var e=f.computed(n,t,i.identity),o;e.extend(et);o=e.subscribe(n,r);u&&o.callback(e())}function ot(n,t){var r=(t||"").toLowerCase(),i=n.assetTypeManifest.resourceType;return(t&&i&&i.kinds||[]).first((function(n){return n.name.toLowerCase()===r}))}function p(n,t,i,r){i===w.BrowseResourceGroupBlade&&(i=w.ResourceGroups);var u=b.getWindowId({name:t,cloudName:n},{forceCloudName:!0});return vt.getAssetTypeOrResourceTypeIdByWindowId(u,i)+(r?"."+r.toLowerCase():"")}function st(n,t){return t&&(t.serviceDisplayName||t.pluralDisplayName||tt.assetPlusKindFormat.format(n.compositeDisplayName.service,t.name))||n.compositeDisplayName.service}function ht(n,t){return t&&t.icon||n.icon}function ct(n,t){return t&&t.keywords||n.assetTypeManifest.keywords}function gt(n,t){return d(n.cloudName,t.cloudName)&&n.extensionName===t.extension&&n.assetType===t.assetTypeManifest.name}function lt(n,t,i){var e,r,u=t.indexOf("."),f;return u>0&&(r=t,t=r.substring(
0,u),e=r.substring(u+1)),f=n.first((function(n){return n.id===t})),f&&g(f,e,i,[],r)}function ni(n,t,i){var o=[],r=[[],["Microsoft_AAD_IAM_AzureActiveDirectory","Microsoft_Azure_Monitoring_AzureMonitoring","Microsoft_Azure_Security_SecurityDashboard","Microsoft_Azure_Billing_Billing","Microsoft_Azure_Support_HelpAndSupport",],["Microsoft_Azure_Expert_AzureAdvisor",],["HubsExtension_Dashboard",],],u;if(i&&n.version()<r.length-1){var f=n.favorites,s=f().toLowerCase(),e=l(f()),h=function(n){r[n].forEach((function(t){var i=t.toLowerCase();s.indexOf(i)<0&&(n===3?e.unshift(t):e.push(t),o.push(t))}))};for(u=(n.version()||0)+1;u<r.length;u++)h(u);f(y(e))}t(o);n.version(r.length-1)}function g(n,t,i,r,u){var o=n.assetTypeManifest,e=ot(n,t),s=st(n,e),h=n.id.toLowerCase(),c=!!k(r,(function(n){return n.toLowerCase()===h}));return{id:u||n.id,image:ht(n,e),isFavorite:f.observable(!1),isHome:f.observable(!1),opensDashboard:o.name===w.Dashboard&&n.extension===a.ExtensionNames.Hubs,isFilteredOut:f.observable(!1),
isHidden:f.observable(c),label:f.observable(s),labelId:f.observable(s.replace(rt,"")),keywords:ct(n,e),matches:f.observable(),uri:i.assetTypeService.getAssetTypeDeepLink(n,t),opensExternal:o.browseType===3,cloudName:b.normalizeCloudName(n.cloudName),isPreview:n.isPreview,assetType:n,kind:t}}function ti(n){var t=[];return n.forEach((function(n){t=i.union(t,(n.associated||[]).map((function(n){return p(n.cloudName||v,n.extensionName,n.assetType,n.kind)})))})),t}function ii(n,t){return new at(n,t)}var nt=i.Base,a=nt.Constants,w=a.AssetNames,b=r.Extension,vt=r.Assets,yt=i.Hubs.Notifications.NotificationStatus,pt=nt.Diagnostics,tt=e.Favorites,it=tt.Notification,ri=pt.createLog(n),v=a.DefaultCloudName,l=JSON.parse,y=JSON.stringify,wt="uncurated",rt=/\s+/g,k=i.find,ut=i.stableSort,d=b.isEqualCloudName,ft=s.compareAssetTypeForSort,bt=i.isFeatureEnabled("userdefineddefaultview"),kt={},et,at;r.getAssetTypeMappingData=function(){return kt};et={deferred:!0};t.connectDebouncedObservable=dt;t.calculateHiddenAssetTypes=
ti;t.createFavoritesManager=ii;at=(function(){function n(n,t){var i=this;this.categories=f.observableArray();this.categoriesLookup={};this.showCategories=f.observable(!1);this.possibleFavorites=f.observableArray();this.possibleFavoritesLookup={};this.favorites=f.observableArray();this.selectedCloud=f.observable();this._notificationsForItems=f.observable();this._extensionToDefaultCategoryMap={};this._missingFavoritesWithIndex={};this._hiddenAssetTypes=[];this._cloudNames=[];this._assetTypesPerCloudMap=r.getCloudMap();this._assetTypesForSelectedCloud=f.observable();this._favLoaded=!1;this._initialFavorites=[];this._categoriesInitialized=!1;this.remove=function(n){var t=i._savedFavorites().length&&l(i._savedFavorites())||[],r=t.indexOf(n);r!==-1&&(t.splice(r,1),i._savedFavorites(y(t)))};this.add=function(n){var t=l(i._savedFavorites())||[],r=t.indexOf(n);r===-1&&(t.push(n),i._savedFavorites(y(t)))};this.move=function(n){var t=l(i._savedFavorites())||[],r=i.favorites()[n],u=t.indexOf(r.id);
t.splice(n,0,t.splice(u,1)[0]);i._savedFavorites(y(t))};this._services=t;this._savedFavorites=f.observable("");this._ltm=n.createChildLifetime()}return n.prototype.initializeFavorites=function(n,t){var r=this,s=this._savedFavorites=n.favorites,y=s&&s().length,c;if(this._cloudNames=o.getCloudNames(),y?(i.isFeatureEnabled("skipfavoritesupgrade")||ni(n,this._notificationsForItems,y),this._initialFavorites=l(s())):this._cloudNames.forEach((function(n){r._initialFavorites.push(p(n||v,a.ExtensionNames.Hubs,w.Dashboard,undefined))})),!bt)return this._registerDependency(),this.loadFavorites();var h=i.find(this._initialFavorites,(function(n){return t.some((function(t){t.name===a.ExtensionNames.Hubs&&(t={name:t.name,cloudName:r._cloudNames[0]});var u=b.getWindowId(t,{forceCloudName:!0});return i.startsWith(n,u+"_")}))})),u=Q.defer(),e=f.observable(!1),k=this._ltm.createChildLifetime();return u.promise.finally((function(){k.dispose()})),this.favorites.subscribeAndRun(k,(function(){h&&(!r.favorites().length||
r.favorites()[0].id!==h||e())||e(!0)})),this._registerDependency(),f.reactor(this._ltm,[this._assetTypesForSelectedCloud,e],(function(n,t){n&&n.length&&!r._favLoaded&&(r.loadFavorites().catch((function(n){return Q.isPending(u.promise)&&u.reject(n),Q.reject(n)})),t=e());Q.isPending(u.promise)&&r._favLoaded&&t&&u.resolve()})),c=3e4,u.promise.timeout(c,new Error("initializeFavorites timeout trying to find "+h+". Timeout: "+c))},n.prototype.initializeCategories=function(){var n=this,t=this._curationPromise||c.getBrowseCuration();return this._categoriesInitialized=!0,t.then((function(t){var h,u;n._discoveryPolicy=t.discoveryPolicy||0;var e=function(t,i){var r={id:t,showLabel:f.observable(!0),isFilteredOut:f.observable(!1),isHidden:f.pureComputed((function(){var t=n.selectedCloud();return!r.possibleFavorites().some((function(n){return!n.isHidden()&&!n.isFilteredOut()&&d(n.cloudName,t)}))})),label:o.provideCategoryName(t),count:f.observable(0),possibleFavorites:f.observableArray(),sourceCategory:i};return r}
,s=t.categories||[],r=s.map((function(n){return e(n.id,n)}));r&&r.length&&(h=n._uncuratedCategory=e(wt),r.push(h));n.categories(r);n.possibleFavorites().forEach((function(t){var r=ot(t.assetType,t.kind),u=t.assetType,f=st(u,r);t.label(f);t.labelId(f.replace(rt,""));t.image=ht(u,r);t.keywords=ct(u,r);t.isHidden(t.isHidden()&&!!i.find(n._hiddenAssetTypes,(function(n){return n===t.id})))}));u={};s.forEach((function(t){(t.discoveryExtensions||[]).forEach((function(i){u[i]=k(r,(function(n){return n.id===t.id}))||n._uncuratedCategory}))}));n._extensionToDefaultCategoryMap=u;n._loadFlyoutMenu()}))},n.prototype.loadFavorites=function(){var n=this,t=this._savedFavorites&&this._savedFavorites().length&&l(this._savedFavorites())||[],i=[],f=this._services.assetTypeService.allManifestsLoaded(),r,u;return(this._favLoaded=!0,r=function(t,r){var u=lt(n._assetTypesForSelectedCloud(),t,n._services);u?(u.isHome(!r),u.isFavorite(!0),i.push(u)):n._missingFavoritesWithIndex[t]=r},u=function(){var t=n._notificationsForItems(
)||[],r=t.slice(0);t.forEach((function(n){var t=k(i,(function(t){return n===t.id})),u,f;t&&(u=it.titleFmt.format(t.label()),f=t.assetType.assetTypeManifest||{},h.getNotificationManager().addClientNotification({title:u,description:it.Description[(f.name||"").toLowerCase()]||u,status:yt.Information,timestamp:new Date,cloudName:v,uri:t.uri}),r.remove(n))}));n._notificationsForItems(r);n.favorites(i)},t.length)?(t.forEach((function(n){n&&r(n,t.indexOf(n))})),u(),Q()):(this._curationPromise=c.getBrowseCuration()).then((function(t){var i=n._initialFavorites;t.favorites.forEach((function(n){var t=p(n.cloudName||v,n.extensionName,n.assetType,n.kind);i.push(t)}));n._initialFavorites.forEach((function(n){r(n,i.indexOf(n))}));n._savedFavorites(y(i));u()}))},n.prototype.dispose=function(){var n=this._ltm;n&&n.dispose();this._ltm=null},n.prototype._registerDependency=function(){var n=this,i=this._ltm,t,r;this._assetTypesForSelectedCloud(this._assetTypesPerCloudMap.get(this.selectedCloud())||[]);this.selectedCloud.
subscribe(i,(function(t){n._assetTypesForSelectedCloud(n._assetTypesPerCloudMap.get(t)||[]);n._assetTypesForSelectedCloud().length&&(n.possibleFavorites([]),n.possibleFavoritesLookup={},n.loadFavorites(),n._loadFlyoutMenu())}));t=this._services.browseManager;r=t.registerAssetTypesUpdateCallback((function(){n._createPerCloudAssetTypes();n._assetTypesForSelectedCloud(n._assetTypesPerCloudMap.get(n.selectedCloud())||[]);n._updateFavorites(n._assetTypesForSelectedCloud());n._categoriesInitialized&&n._loadFlyoutMenu()}));i.registerForDispose((function(){t.unregisterAssetTypesUpdateCallback(r)}))},n.prototype._createPerCloudAssetTypes=function(){var t=this,n=this._services.browseManager.getFilteredAssetTypes()||[];n.length&&this._cloudNames.forEach((function(i){var r=n.filter((function(n){return d(n.cloudName,i)}));t._assetTypesPerCloudMap.set(i,r)}))},n.prototype._updateFavorites=function(n){var t=this;i.forEachKey(this._missingFavoritesWithIndex,(function(i,r){if(r!==-1){var u=lt(n,i,t._services);u&&
(u.isHome(!r),u.isFavorite(!0),t.favorites.splice(r,0,u),t._missingFavoritesWithIndex[i]=-1)}}))},n.prototype._addBrowseMenuItem=function(n,t){var u=p(n.cloudName,n.extension,n.assetTypeManifest.name,t),i=g(n,t,this._services,this._hiddenAssetTypes,u),r;this.possibleFavoritesLookup[u]||(this.possibleFavorites().push(i),r=this.favorites().first((function(n){return n.id===i.id})),r&&(i.isFavorite=r.isFavorite,i.isHome=r.isHome),this.possibleFavoritesLookup[i.id]=i)},n.prototype._addBrowseMenuItemToCategory=function(n,t,i,r,u){var s=p(n.cloudName,n.extension,n.assetTypeManifest.name,i),e=g(n,i,this._services,this._hiddenAssetTypes,s),o,f;u.some((function(n){return n.id===s}))||(f=this.possibleFavoritesLookup[e.id],f&&(e.isFavorite=f.isFavorite,e.isHome=f.isHome,o=e.isHidden=f.isHidden,o(o()||r)),u.splice(t,0,e));r&&(f=this.possibleFavorites().filter((function(n){return n.id===e.id}))[0],f&&f.isHidden(r))},n.prototype._loadFlyoutMenu=function(){var n=this,f=this.possibleFavoritesLookup,t,i,r,e,o;
this._assetTypesForSelectedCloud().forEach((function(t){n._addBrowseMenuItem(t,undefined)}));t=this.categories();this.showCategories(!!t.length);i=u.keys(f).slice(0);t.forEach((function(t){var u=t.possibleFavorites;u();var f=t.sourceCategory,e=f&&f.items||[],r=[];e.length&&(e.forEach((function(t,u){var f=-1,e,o;n._assetTypesForSelectedCloud().some((function(n){var i,r,s;return t.cloudName=t.cloudName||v,gt(t,n)&&(i=n.assetTypeManifest.resourceType,r=(t.kind||"").toLowerCase(),r&&(s=(i&&i.kinds||[]).some((function(n){return n.name.toLowerCase()===r})),s&&(o=t.kind)),f=u,e=n),f>-1}));f>-1&&(o&&n._addBrowseMenuItem(e,o),i.remove(e.id),n._addBrowseMenuItemToCategory(e,f,o,!!t.isHidden,r))})),u(r),t.count(r.filter((function(n){return!n.isHidden()})).length))}));r=this._uncuratedCategory;e=[];r&&(o=ut(i.map((function(n){return f[n]})),(function(n,t){return ft(n.label(),t.label())})),o.forEach((function(t){var o=t.assetType,u=n._extensionToDefaultCategoryMap[o.extension],s=u||r,h=!u&&n._discoveryPolicy===1,f,
i;n.possibleFavorites().filter((function(n){return n.id===t.id}))[0].isHidden(h);f=s.possibleFavorites;i=[];i=u?f():e;n._addBrowseMenuItemToCategory(o,i.length,undefined,h,i);f(i);s.count(i.length)})));this.possibleFavorites(ut(this.possibleFavorites(),(function(n,t){return ft(n.label(),t.label())})))},n})()}));define("MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks",["require","exports","i","FxHubs/HubsSettingsSchema"],(function(n,t,i,r){"use strict";var u;return (function(n){function t(n,t,i){var r={store:i?0:6,keys:t};return n.querySettings(r).then((function(n){var i={};return t.forEach((function(t){i[t]=t in n?n[t]:undefined})),i}))}function u(n,t,i){n.setSettings({store:6,settings:t},i)}function f(n){var f=n.settings,e=n.rpcClient,o=[i.Extension.getHubsWindowId()];r.readHubsUserSettings.register(e,o,(function(n){return t(f,n.settingsKeys,n.useShellGeneralStore)}));r.writeHubsUserSettings.register(e,o,(function(n){return u(f,n.settings,n.priority),undefined}))}n.registerRpcCallbacks=f})(u||(u={})),u}));define(
"MsPortalImpl/UI/Hubs/UI.NotificationsPane",["require","exports","f","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var t=i.Hubs.Notifications.NotificationStatus,e=u.NotificationMenu,o=[t.Information,t.Warning,t.Error,t.Success],s=[t.Information],h=(function(n){function t(){var t=this;n.apply(this,arguments);this.hasNotifications=r.pureComputed((function(){return t.notifications&&(t.notifications()||[]).length}));this.lastPaneOpenedTime=r.observable(Date.now());this.isPaneOpen=r.observable(!1);this.dismissOptions=[{name:e.informational,dismissableStates:s,isEnabled:r.pureComputed((function(){return t._checkNotificationsState(s)}))},{name:e.completed,dismissableStates:o,isEnabled:r.pureComputed((function(){return t._checkNotificationsState(o)}))},{name:e.all,dismissableStates:null,isEnabled:this.hasNotifications}]}return __extends(t,n),t.prototype._checkNotificationsState=function(n){return this.
hasNotifications()&&this.notifications().some((function(t){return n.indexOf(t.status)>-1}))},t})(f.ViewModel);n.ViewModel=h})(e||(e={})),e}));define("MsPortalImpl/UI/Hubs/UI.ResourceMapManagerRpc",["require","exports","FxHubs/RpcEndPoints"],(function(n,t,i){"use strict";var r;return (function(n){function e(n,i){var e=r.getHubsWindowId(),f=function(n){return r.getDescriptor(n.srcWindowId).cloudName};r.mapAssetIdToResourceIdEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapAssetIdToResourceId(n,f(r))}))}));r.mapResourceIdToAssetIdEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapResourceIdToAssetId(n,f(r))}))}));u.mapResourceIdToAssetIdEndPoint.register(n,[e],(function(n){return i.getService(t).then((function(t){return t.mapResourceIdToAssetId(n.resourceId,n.cloudName)}))}));r.mapResourceIdToDynamicSelectionAndIconEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapResourceIdToDynamicSelectionAndIcon(
n.resourceId,f(r),{reason:"mapResourceIdToDynamicSelectionAndIcon",extension:r.srcWindowId})}))}));u.mapResourceIdToDynamicSelectionAndIconEndPoint.register(n,[e],(function(n,r){return i.getService(t).then((function(t){return t.mapResourceIdToDynamicSelectionAndIcon(n.resourceId,n.cloudName,{reason:"mapResourceIdToDynamicSelectionAndIcon",extension:r.srcWindowId})}))}));r.getResourceAssetInformationEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResourceAssetInformation(n,f(r),{reason:"getResourceAssetInformation",extension:r.srcWindowId})}))}));u.getResourceAssetInformationEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResourceAssetInformation(n.data,n.cloudName,{reason:"getResourceAssetInformationForHubs",extension:r.srcWindowId})}))}));r.getResourceEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResource(n.resourceId,n.skipCache,f(r),{reason:n.invoker+":getResource",
extension:r.srcWindowId})}))}));r.getResourceGroupEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResourceGroup(n.resourceGroupId,n.skipCache,f(r),{reason:n.invoker+":getResourceGroup",extension:r.srcWindowId})}))}));r.signalResourcesChangedEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return Q(t.signalResourcesChanged(n,f(r)))}))}));u.signalResourcesChangedEndPoint.register(n,null,(function(n){return i.getService(t).then((function(t){return Q(t.signalResourcesChanged(n.resourceIds,n.cloudName))}))}));u.mapAssetIdToResourceIdEndPoint.register(n,[e],(function(n){return i.getService(t).then((function(t){return t.mapAssetIdToResourceId(n.assetTriplet,n.cloudName)}))}));i.assetManager.onAssetDeleted((function(n,r,u){i.getService(t).then((function(t){t.processAssetDeletion(n,r,u)}))}))}var f=FxImpl,r=f.Extension,u=i.AssetTypes,t="ResourceMapManager";n.setupResourceMapManagerRpc=e})(r||(r={})),r}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration",
["require","exports","f","i","MsPortalImpl/Extension/ViewModelManager"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function h(n){var e=t+"All.Part",i,r;u.registerWithState("Browse$BrowseAllBlade$ServicesListPartViewModel",e,(function(t,i){return f.composePartViewModel((function(r){return new t.ServicesListPartViewModel(r,i,n)}),{initialState:i,logArea:e})}));u.registerWithState("Browse$BrowseServiceBladeViewModel",t+"Service.Blade",(function(t,i){var r=new s,u=new t.BrowseServiceBladeViewModel(r,i,n);return new o(r,u,i)}));i=t+"Service.Part";u.registerWithState("Browse$BrowseServiceBlade$ServiceItemsListPartViewModel",i,(function(t,r){return f.composePartViewModel((function(i){return new t.ServiceItemsListPartViewModel(i,r,n)}),{logArea:i})}));r=t+"Service.PinnedPart";u.registerWithState("Browse$BrowseServiceTileViewModel",r,(function(t,i){return f.composePartViewModel((function(r){return new t.BrowseServiceTileViewModel(r,i,n)}),{createHubsInternalCloudNameProperty:!0,logArea:r})}))}
var e=r.ViewModels,o=e.CompositionViewModel,f=e.Part,s=i.ViewModels.Internal.ContainerViewModel,t="./MsPortalImpl/UI/Hubs/ViewModels/UI.Browse";n.registerViewModels=h})(f||(f={})),f}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration",["require","exports","f","MsPortalImpl/Extension/ViewModelManager"],(function(n,t,i,r){"use strict";var u;return (function(n){function u(){r.register("Gallery$CsmCommand","./MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",(function(n){return new n.CsmCommand(t.DefaultCloudName)}))}var t=i.Base.Constants;n.registerViewModels=u})(u||(u={})),u}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration",["require","exports","f","i","MsPortalImpl/Extension/ViewModelManager"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function y(n){var i=u.registerWithState,h,r,c,y;i(l+"ViewModel",t+(f+"Blade"),(function(n,t){var i=new s,r=new n.SettingsBladeViewModel(i,t);return new o(i,r,t)}));h=t+(f+"SettingsPart");i(l+"$SettingsPartViewModel",
h,(function(t,i){return e((function(r){return new t.SettingsPartViewModel(r,i,n)}),{createHubsInternalCloudNameProperty:!0,logArea:h})}));i(a+"ViewModel",t+(f+"LanguageSelectionBlade"),(function(n,t){var i=new s,r=new n.LanguageSelectionBladeViewModel(i,t);return new o(i,r,t)}));r=t+(f+"LanguageGrid");i(a+"$LanguageGridViewModel",r,(function(n,t){return e((function(i){return new n.LanguageGridViewModel(i,t)}),{logArea:r})}));i(v+"ViewModel",t+(f+"LocaleSelectionBlade"),(function(n,t){var i=new s,r=new n.LocaleSelectionBladeViewModel(i,t);return new o(i,r,t)}));c=t+(f+"LocaleGrid");i(v+"$LocaleGridViewModel",c,(function(n,t){return e((function(i){return new n.LocaleGridViewModel(i,t)}),{logArea:r})}));y=t+(f+"DiagnosticsPart");i("Help$HelpAndSupportBlade$DiagnosticsPartViewModel",y,(function(t,i){return e((function(r){return new t.DiagnosticsPartViewModel(r,i,n)}),{logArea:r})}))}var c=r.ViewModels,o=c.CompositionViewModel,e=c.Part.composePartViewModel,s=i.ViewModels.Internal.ContainerViewModel,t="./MsPortalImpl/UI/Hubs/ViewModels/",
h="Settings$",l=h+"SettingsBlade",a=h+"LanguageSelectionBlade",v=h+"LocaleSelectionBlade",f="UI.Settings.";n.registerViewModels=y})(f||(f={})),f}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-formdialog{font-size:14px;border:1px solid;line-height:14px}.fxs-formdialog h2{font-size:110%}.fxs-formdialog .fxs-formdialog-description{margin-top:-10px}.fxs-formdialog .fxs-formdialog-form{margin:20px 0 0;padding:15px 25px;width:448px;max-width:calc(100% - 2 * 25px)}.fxs-formdialog .fxs-formdialog-buttons{margin-left:25px}.fxs-formdialog .fxs-formdialog-buttons>.fxc-simplebutton{margin-right:5px;margin-bottom:25px}.fxs-formdialog-header{border-bottom:1px solid;margin:0 25px;padding-bottom:10px}")}));define("MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog",["require","exports","f","ko","$","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Interactions/Interactions.DismissHandler",
"MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){var c=i.ViewModels.Controls.SimpleButton.ViewModel,w=i.ViewModels.Forms.Section,t=w.ViewModel,l=i.newGuid,a="fxs-formdialog",v="fxs-portal-bg-txt-br",y="fxs-popup",b="<div class='fxs-formdialog-header fxs-portal-border'><h2 data-bind='text: data.dialogOptions.title'><\/h2><div class='fxs-formdialog-description' data-bind='text: data.dialogOptions.description'><\/div><\/div><div class='fxs-formdialog-form msportalfx-form' data-bind='pcControl: func._formSection'><\/div><div class='fxs-formdialog-buttons'><div class='fxs-formdialog-okbutton' data-bind='pcControl: func._okButton'><\/div><div class='fxs-formdialog-cancelbutton' data-bind='pcControl: func._cancelButton'><\/div><\/div>",k=(function(n){function t(){n.apply(this,
arguments);this.okButtonText=r.observable();this.cancelButtonText=r.observable();this.onOkClick=u.noop;this.onCancelClick=u.noop}return __extends(t,n),t})(s.ViewModel),p;n.ViewModel=k;p=(function(n){function i(t,i){var f=this;if(n.call(this,t,i),!i.dialogOptions)throw new Error("dialogOptions must be specified for rendering a form dialog.");t.addClass(a+" "+y+" "+v).html(b);var u=document.activeElement,r=this._dismissHandle={dismissFn:function(){f._cancelButton&&i.onCancelClick()},restoreFocus:function(){e.validatePreviousFocusedElement(r,u)&&u.focus()},logName:"formdialog"},s=new o.KeyboardNavigation(t,2);e.register(r);this.ltm.registerForDispose((function(){s.dispose();e.unregister(r)}));this._initializeViewModels();this._bindDescendants();this._setAria();this.setFocus()}return __extends(i,n),i.prototype.setFocus=function(){var n=this.element;h.waitForBindings(n[0]).finally((function(){var t=n.find("input:first");t.length===0&&(t=n.find(".fxs-formdialog-okbutton:first .fxs-button"));setTimeout(
(function(){t.offsetParent()&&t.focus()}))}))},i.prototype.dispose=function(){this._cleanElement(a,y,v);n.prototype.dispose.call(this)},i.prototype._setAria=function(){var t="aria-labelledby",i="aria-describedby",n=this.element,r=l(),u=l();n.attr("role","alertdialog").attr(t,u).attr(i,r);n.find("h2").attr("id",u);n.findByClassName("fxs-formdialog-description").attr({id:r});this.ltm.registerForDispose((function(){n.removeAttr(["role",t,i].join(" "))}))},i.prototype._initializeViewModels=function(){var b=this,n=this.ltm,u=this.options,i=u.dialogOptions,l=3,e=0,o=new t(n,{style:r.observable(l),children:r.observableArray()}),s=new t(n,{style:r.observable(l),children:r.observableArray()}),a,v,y,p,h,w;i.row1column1&&(a=new t(n,{style:r.observable(e),children:r.observableArray([i.row1column1])}),o.children.push(a));i.row1column2&&(v=new t(n,{style:r.observable(e),children:r.observableArray([i.row1column2])}),o.children.push(v));i.row2column1&&(y=new t(n,{style:r.observable(e),children:r.observableArray(
[i.row2column1])}),s.children.push(y));i.row2column2&&(p=new t(n,{style:r.observable(e),children:r.observableArray([i.row2column2])}),s.children.push(p));h=this._formSection=new t(n,{children:r.observableArray()});o.children().length&&h.children.push(o);s.children().length&&h.children.push(s);this._cancelButton=new c(n,{text:u.cancelButtonText,onClick:function(){u.onCancelClick()}});w=this._okButton=new c(n,{text:u.okButtonText,primary:!0,onClick:function(){f.ensureFormFieldValidation(b.element,!0).then((function(n){n&&u.onOkClick()}))}});r.computed(n,(function(){w.disabled(!h.valid())}))},i})(s.Widget);n.Widget=p})(c||(c={})),c}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-listpopup{display:inline-block;cursor:default;position:absolute;left:0;width:200px;max-height:300px;z-index:200;overflow-y:auto;box-sizing:border-box}.fxs-listpopup .fxs-listpopup-list{list-style-type:none;padding:0;max-height:300px}.fxs-listpopup .fxs-listpopup-item{font-size:12px;line-height:normal;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto;white-space:nowrap;text-overflow:ellipsis;position:relative;box-sizing:border-box;padding:0 10px;border:0;overflow:visible;text-align:left;height:35px;cursor:pointer}")})
);define("MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup",["require","exports","f","ko","$","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";var b=i.Base.Diagnostics,h=".fxs-commandBar-item",c="fxs-listpopup",k=b.createLog(n),l="fxs-portal-bg-txt-br",a="fxs-popup",v="fxs-listpopup-list",y="fxs-listpopup-item",p="."+y,d="<ul class='"+v+"' data-bind='foreach: func._items' role='menu'>"+("<li role='menuitem' class='"+y+" fxs-portal-hover' tabindex='-1'")+'data-bind=\'text: text, css: { "fxs-listpopup-item-selected fxs-portal-selected fxs-portal-activated fxs-br-primary": text === $root.data.dialogOptions.selectedItem() }, event: { click: onClick, keydown: onKeyDown}, attr: { title: text, "aria-setsize": $parent.func._items().length, "aria-posinset": $index() + 1, "aria-selected": text === $root.data.dialogOptions.selectedItem() }\'><\/li><\/ul>',
g=(function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t})(s.ViewModel),w;t.ViewModel=g;w=(function(n){function t(t,i){var b=this;n.call(this,t,i);i.dialogOptions||k.error("dialogOptions must be specified for rendering a list popup.");var s=document.activeElement,y=function(n){return n===s||u.contains(s,n)?0:!(t[0]===n)&&!u.contains(t[0],n)?2:0},w=this._dismissHandle={dismissFn:function(){var n=i.onLostFocus;n&&n()},shouldDismissOnFocusOutFn:y,shouldDismissOnMouseDownFn:y,shouldDismissOnMouseWheelFn:y,restoreFocus:function(){f.validatePreviousFocusedElement(w,s)&&s.focus()},logName:"listpopup"};this._items=r.computed(this.ltm,(function(){var n=function(n){typeof i.onItemSelected=="function"&&(i.dialogOptions.selectedItem(n),i.onItemSelected(),w.restoreFocus())};return i.dialogOptions.listItems().map((function(t){return{text:t,onClick:function(i,r){r.stopPropagation();n(t)},onKeyDown:function(i,r){if((r.keyCode===13||r.keyCode===32)&&e.getModifierKeys(r)===0)r.stopPropagation(
),n(t);else return!0}}}))}));t.addClass(c+" "+a+" "+l).html(d);this._keyboardNavigation=new o.KeyboardNavigation(t.find("."+v),12,p);t.closest(h).attr("aria-expanded","true");this._bindDescendants();Q.nextTick((function(){b.setFocus()}));f.register(w)}return __extends(t,n),t.prototype.dispose=function(){f.unregister(this._dismissHandle);this._cleanElement(c,a,l);this._keyboardNavigation&&(this._keyboardNavigation.dispose(),this._keyboardNavigation=null);this.element.removeAttr("tabindex").closest(h).attr("aria-expanded","false");n.prototype.dispose.call(this)},t.prototype.setFocus=function(){this.element.find(p).first().focus()},t})(s.Widget);t.Widget=w}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-progressbox{color:#fff}")}));define("MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox",["require","exports","f","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase",
"_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var v=u.Dialogs.ProgressBar,e="fxs-progressbox",o="fxs-progressbox-text",y="<h2 data-bind='text: data.title' class='fxs-progressbox-title'><\/h2><div data-bind='text: data.text' class='"+o+"'><\/div><div data-bind='text: data.completionText' class='fxs-progressbox-progressbar'><\/div>",s="fxs-popup",h="fxs-portal-bg-txt-br",t=r.observable,c=r.isObservable,l=i.newGuid,p=(function(n){function i(i,u){var f=this;n.call(this);this.title=t();this.text=t();this.completionPercentage=t(-1);c(i)&&(this.text=i);c(u)&&(this.completionPercentage=u);this.completionText=r.pureComputed((function(){var n=f.completionPercentage();return n<0||n>100?"":v.percentComplete.format(n)}))}return __extends(i,n),i})(f.ViewModel),a;n.ViewModel=p;a=(function(n){function t(t,i){n.call(this,t,i);this.element.html(y).addClass(e).addClass(s).
addClass(h);this._bindDescendants();this._setAria()}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(e,s,h);n.prototype.dispose.call(this)},t.prototype._setAria=function(){var t="aria-labelledby",i="aria-describedby",n=this.element,r=l(),u=l();n.attr("role","alertdialog").attr(t,u).attr(i,r);n.find("h2").attr("id",u);n.findByClassName(o).attr("id",r);this.element.attr("tabindex",-1).focus();this.ltm.registerForDispose((function(){n.removeAttr("tabindex role "+t+" "+i)}))},t})(f.Widget);n.Widget=a})(e||(e={})),e}));define("MsPortalImpl/UI/UI.DialogManager",["require","exports","f","o","a","Viva.Controls/Util/Viva.Util","MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup","MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox","MsPortalImpl/Svg/Startup/Error.svg","MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.WidgetBase",
"MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";function k(n){return"The {0} used to render the dialog was not specified.".format(n)}function bt(n){return nt||(nt=new ht(n)),nt}function kt(){nt=null}function st(n,t){var r=i.getUniqueId();return n.replaceAll(t,r).replaceAll("msportalfx-svg-c01",t).replaceAll(r,"msportalfx-svg-c01")}function ct(n,t,r,u,f){var o,c;switch(r.type){case 1:o=new p.Widget(t,dt(f,r,u));break;case 2:o=new h.Widget(t,ni(null,r));break;case 4:c=ii(f,r);c.onLostFocus=function(){n.dismissOpenDialog()};o=new s.Widget(t,c);break;case 3:o=new e.Widget(t,ti(f,r));break;case i.ViewModels.Internal.Dlg2:r.positionHint=r.positionHint||3;o=new p.Widget(t,gt(f,r,u))}return o}function dt(n,t,i){var r=new p.ViewModel;return r.title(t.title),t.templateViewModel?(r.template(t.text),r.templateViewModel(t.templateViewModel)):r.text(t.text),r.
buttons=t.buttons,r.onButtonClick=function(t){n(t)},r.modal=i,r.defaultButtonText=t.defaultButtonText,r.cancelButtonText=t.cancelButtonText,r.confirmationRequired=t.confirmationRequired,r.confirmationMessage=t.confirmationMessage,r}function gt(n,t,r){var f=new p.ViewModel;return f.title(t.title),typeof t.content=="object"?(f.template(t.content.htmlTemplate),f.templateViewModel(t.content.viewModel)):typeof t.content=="string"&&f.text(t.content),u.isArray(t.buttons)?(f.customBtns=[],t.buttons.forEach((function(n){f.customBtns.push({kind:3,text:n.displayText,result:n.button})})),f.customBtns.length&&(f.customBtns[0].kind=1,f.customBtns.length>1&&(i.last(f.customBtns).kind=2))):f.buttons=t.buttons,f.onButtonClick=function(t){n(t)},f.modal=r,f}function ni(n,t){var i=new h.ViewModel(t.text,t.completionPercentage);return i.title(t.title),i}function ti(n,t){var i=new e.ViewModel;return i.dialogOptions=t,i.okButtonText(b.Dialogs.okButtonText),i.cancelButtonText(b.Dialogs.cancelButtonText),i.onOkClick=
function(){n(4)},i.onCancelClick=function(){n(1)},i}function ii(n,t){var i=new s.ViewModel;return i.dialogOptions=t,i.onItemSelected=function(){n(4)},i}function lt(n,t){var r=n.closest(".fxs-tile").data(v.CompositionInstanceDataName),u;return r&&v.isPartComposition(r)?u=r.locator:t!=="sideload"&&pt.error("Unable to determine the extension that opened the dialog. "+i.getCurrentCallStack(!0)),u}function at(n){var r=n.closest(".fxs-bladecontent"),t=y.Widget.getWidgets(r),i;return t&&t.length&&(i=t[0],n=g(i.getForm())),n}function vt(n){ut.trace({source:ft,name:n&&n.toFriendlyString(),action:et.DialogOpened,extension:n&&n.getExtensionLocator().name})}function d(n,t){ut.trace({source:ft,name:n&&n.toFriendlyString(),action:et.DialogClosed,extension:n&&n.getExtensionLocator().name,data:t+""})}var tt=i.Base,rt=tt.Diagnostics,ut=rt.Telemetry,yt=i.ViewModels.Dialogs,g=jQuery,it=g("body"),pt=rt.createLog(n),wt="<div class='fxs-portal-shield'><div class='fxs-portal-shield-icon fxs-portal-shield-icon-on-topbar'><\/div><div class='fxs-portal-shield-modaldialog'><div/><\/div><\/div>",
ft=a.Source.Shell,et=a.Action,nt,ot=(function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t})(yt.MessageBox),ht;t.MessageBox=ot;t.getOrCreate=bt;t.dispose=kt;ht=(function(){function n(n){this._portalIdleSvc=n}return r.defineProperty(n.prototype,"hasOpenDialog",{get:function(){return!!this._dismissOpenDialog},enumerable:!0,configurable:!0}),n.prototype.dismissOpenDialog=function(){this._dismissOpenDialog&&(this._dismissOpenDialog(),this._dismissOpenDialog=null)},n.prototype.showModalDialog=function(n){var s=this,t=g(wt),r,y,h,e,a,u,v,p,f;return it.append(t),r=t.findByClassName("fxs-portal-shield-icon"),y=t.findByClassName("fxs-portal-shield-modaldialog"),n.showErrorIcon?(h=w.getSvgReferenceOrFallBackToData(i.extend2(c,{data:st(c.data,"msportalfx-svg-c22")})),e="fxs-portal-shield-icon-error"):(h=w.getSvgReferenceOrFallBackToData(i.extend2(l,{data:st(l.data,"msportalfx-svg-c10")})),e="fxs-portal-shield-icon-warning"),r.html(h),r.addClass(e),a=it.findByClassName("fxs-topbar-content").
width(),u=it.findByClassName("fxs-topbar-notifications").position(),a&&u&&(v=a-(u.left+40),r.css({top:u.top,right:v}),y.css({top:u.top+40,right:v})),this._currentCancelToken&&(this._currentCancelToken.cancel(),this._currentCancelToken=null),p=t.find(".fxs-portal-shield-modaldialog > div"),f=new ot(n.title,n.description,n.buttons),f.defaultButtonText=n.defaultButtonText,f.cancelButtonText=n.cancelButtonText,f.templateViewModel=n.templateViewModel,o.unhide(t),this._portalIdleSvc.signalIdle(),this._showDialog(p,f,!0,null).then((function(i){var u=n.uiShield&&n.uiShield.hidePromise;return u?(s._currentCancelToken=new tt.Promises.CancelationToken,tt.Promises.wrapWithCancelablePromise(u,s._currentCancelToken).then((function(){o.hide(t)}))):o.hide(t),r.removeClass(e),i})).finally((function(){s._portalIdleSvc.signalBusy()}))},n.prototype.showDialog=function(n,t,i,r){return n?t?(this.dismissOpenDialog(),this._showDialog(n,t,!1,i,r)):Q.reject(k("options")):Q.reject(k("element"))},n.prototype.showDialogWithCallback=
function(n,t,i,r){if(!n)throw new Error(k("element"));if(!t)throw new Error(k("options"));this.dismissOpenDialog();this._showDialogWithCallback(n,t,!1,i,r)},n.prototype.showShellDialog=function(n,t,r,u,e,o){if(!t)return Q.reject(k("formTarget"));if(!r)return Q.reject(k("sourceTarget"));if(!n)return Q.reject(k("options"));e=i.isUndefined(e)?!0:e;this.dismissOpenDialog();var s=this._showDialog(g(t.getForm()),n,e,u,o?"sideload":"").then((function(n){return t.hideForm(),n})),h=f.getBox(r);return t.showForm(h,n.positionHint),s},n.prototype._showDialog=function(n,t,i,r,u){var o=this,f=Q.defer(),s=function(n){f.resolve(n)},e;return r||i||(r=lt(n,u)),t.type!==4&&(n=at(n)),e=ct(this,n,t,i,s),vt(r),e?(this._dismissOpenDialog=function(){e.dispose();f.reject();d(r,"Dismissed")},f.promise.then((function(n){e.dispose();o._dismissOpenDialog=null;d(r,n)}))):(d(r,"InvalidDialogType"),f.reject("Invalid type specified in dialogOptions.")),f.promise},n.prototype._showDialogWithCallback=function(n,t,i,r,u){var
o=this,f,e;u||i||(u=lt(n));t.type!==4&&(n=at(n));e=function(n){f&&f.dispose();o._dismissOpenDialog=null;d(u,n);r&&r(n)};f=ct(this,n,t,i,e);vt(u);f?this._dismissOpenDialog=function(){f.dispose();d(u,"Dismissed")}:d(u,"InvalidDialogType")},n})()}));define("MsPortalImpl/UI/UI.NpsHelper",["require","exports","f","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r){"use strict";var u;return (function(n){function u(u,s,h,c,l){return t||!o&&e&&!n.npsShownInSession?i.require("MsPortalImpl/Widgets/Widgets.Nps").then((function(t){f.Diagnostics.Telemetry.trace({source:r.Source.ToastTray,action:r.Action.NPSShown,data:i.extend({productId:h},c)});t.showSurvey(u,s,h,l);n.npsShownInSession=!0})):Q(null)}function c(n,i){var r=i(),f=Date.now()-h,e=r<f&&Math.random()<s;return t||e?u(n,null,null,{surveyLastCompleted:r},(function(){i(Date.now())})):Q(null)}var f=i.Base,t=i.isFeatureEnabled("testnps"),e=i.isFeatureEnabled("nps"),o=i.isFeatureEnabled("ci"),s=(parseFloat(i.getFeatureValue("npspercent"))||1)/100,h=(parseInt(
i.getFeatureValue("npsintervaldays"))||90)*864e5;n.npsShownInSession=!1;n.showNps=u;n.showPortalNps=c})(u||(u={})),u}));define("MsPortalImpl/UI/UI.SessionHandler",["require","exports","f","ko"],(function(n,t,i,r){"use strict";var u;return (function(t){function h(n,t,u){return t.addCallbacks({onIdle:function(t,i){var f=r.unwrap(n);f&&t.getTime()-i.getTime()>=f*6e4&&(c.warning("Signing out user at {0} after inactivity timeout of {1} minutes".format(t,f)),u())},onBusy:i.noop})}function a(n,t,r,e,c,a){var v,p,y;s?h(s,r,e):t.subscribeAndRun(n,(function(n){n&&!u?u=h(t,r,e):!n&&u&&r.removeCallbacks(u)}));v=i.memoizeQ((function(){return i.require("MsPortalImpl/UI/UI.SessionHandlerDeferred")}));i.isFeatureEnabled("sessionvalidity")&&(p=r.addCallbacks({onIdle:function(n){v().then((function(t){t.validateSessionLifetime(c,a,n.getTime(),"SessionValidityIdle").then((function(n){n?f():(o(),r.removeCallbacks(p))}))}))},onBusy:i.noop}),y=function(){return Q.delay(l).then((function(){v().then((function(n){n.validateSessionLifetime(
c,a,Date.now(),"SessionValidityPoll").then((function(n){n?(f(),y()):o()}))}))}))},y());f()}var c=i.Base.Diagnostics.createLog(n),l=parseInt(i.getFeatureValue("sessionpollinterval"))||18e5,e="LastValidSessionTs",f=function(){MsPortalImpl.localStorage.setItem(e,Date.now().toString())},o=function(){MsPortalImpl.localStorage.removeItem(e)},s=parseInt(i.getFeatureValue("idletimeoutmins")),u;t.initialize=a})(u||(u={})),u}));define("MsPortalImpl/UI/UI.StatusHandler",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function y(n,t){return(n&t)===t}function o(n,t,i,r,u){rt.ClientNotification.publish({title:n,description:t,status:r||k.Information,descriptionAsHtml:u,correlationIds:[i]})}function et(n,t,i,r){return new p(n,t,i,r)}var s=i.Base,w=s.Diagnostics,b=w.Telemetry,rt=i.Hubs.Notifications,k=i.Hubs.Notifications.NotificationStatus,h=f.Action,
d=f.Source,g=window,c=w.createLog(n),ut=g.fx.environment.errorPageUri,l=s.Constants.Shell,nt=r.Shell,a=nt.Notifications,e=nt.Dialogs,v=a.SessionEnding,tt=a.TokenFailure,it=a.VersionChanged,ft=[12e5,6e5],p;t.create=et;p=(function(){function n(n,t,i,r){this._pageBlockingPrompt=!1;this._isDialogVisible=!1;this._unknownNetworkErrorCount=0;this._unknownNetworkErrorCanceled=!1;this._getDialogManager=n;this._initializationPromise=t;this._redirectFunc=i;this._showSplashScreenFunc=r}return n.prototype.onLastTokenRefresh=function(n,t){var i=Date.now();if(t<=i)this.onStatus({code:2},n);ft.forEach((function(n){var r=t-n;g.setTimeout((function(){var t=Math.floor(n/6e4),i=t>10?v.messageFmt.format(t):v.message;o(v.title,i,"lastTokenRefresh")}),r-i)}))},n.prototype.onStatus=function(n,t){var nt=this,r=Q.resolve(null),f,y,p;if(!n||this._pageBlockingPrompt)return r;var a=t===l||t===s.Constants.ExtensionNames.Hubs,v=n.data||{},w=v.uri||"",g=function(n){var u=w,r;return i.isUriAbsolute(u)||(u="//"+t+i.ensurePrefix(
u,"/")),r=document.createElement("a"),r.text=n,r.title=r.href=u,r.outerHTML};switch(n.code){case 0:break;case 1:a?r=this._showDialog(t,h.ShellVersionChanged,e.newVersionMessageTitle,e.newVersionMessageDescription,e.newVersionDefaultButtonText,null,3e4,2,5):(b.trace({source:d.Shell,action:h.ExtensionVersionChanged,data:t}),c.warning("Extension reporting incompatible server version. {0}:{1}".format(t,v.version)),o(it.title,it.messageFmt.format(t),"VersionChanged-{0}".format(t)));break;case 2:a&&n.data.isPrimaryToken?(u.updateAuthState(null),this._redirectFunc({uri:ut+"/UE_SessionExpired"+window.location.hash})):o(tt.title,tt.messageFmt.format(t),"AuthTokenError-{0}".format(t));break;case 7:r=this._showDialog(l,"SessionExpired",e.sessionExpired,e.sessionExpiredMessage,e.refresh,null,0,1,2);break;case 4:if(c.verbose("Received a status code zero from extension {0} for URL '{1}'.".format(t,w)),!a)break;if(this._unknownNetworkErrorCount>3||this._isDialogVisible||this._unknownNetworkErrorCanceled)
break;this._unknownNetworkErrorCount++;r=this._showDialog(l,h.UnknownNetworkError,e.connectionErrorMessageTitle,e.connectionErrorMessageDescription.format(g(e.connectionErrorMessagePlaceHolder)),null,e.connectionErrorCancelButtonText,0,2,0).then((function(n){nt._unknownNetworkErrorCanceled=n===1}));break;case 6:f=e.tooManyRequestsDescription.format(g(e.tooManyRequestsLink));y=v.retryAfter;y&&(f=f+" "+e.tooManyRequestsRetry.format(y));o(e.tooManyRequestsTitle,f,"TooManyRequests-{0}".format(t),k.Warning,!0);break;default:p="Received unknown extension event '{0}' for extension '{1}'.".format(n.code,t);r=Q.reject(p);c.error(p)}return r},n.prototype._showDialog=function(n,t,i,r,f,e,o,s,h){var a=this,v,k=this._redirectFunc,p=y(h,2),c,w,l;return this._pageBlockingPrompt=y(h,1),t&&b.trace({source:d.Shell,action:t,data:n}),p&&u.updateAuthState(null),c=function(n){k({skipFlushBuffers:p,delayPromise:n&&o?Q.delay(o):null})},w=y(h,4)&&Q.isPending(this._initializationPromise),w?(v=Q.defer().promise,c(
!1)):(l=Q.defer(),this._isDialogVisible=!0,v=this._getDialogManager().then((function(n){return n.showModalDialog({title:i,description:r,defaultButtonText:f,cancelButtonText:e,buttons:s,uiShield:{hidePromise:l.promise}})})).then((function(n){return a._pageBlockingPrompt?(a._showSplashScreenFunc(),l.resolve(),c(!0)):n===4?c(!1):l.resolve(null),n})).finally((function(){a._isDialogVisible=!1}))),v},n})();t.StatusHandlerImpl=p})(e||(e={})),e}));define("MsPortalImpl/UI/UI.ViewTimeTelemetry",["require","exports","f","i","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Telemetry","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function ot(n,i){s=n.desktop;k=i&&i.increment||w;d=i&&i.tooSmall||b;t&&t.dispose();t=new r.TriggerableLifetimeManager;ft=s.activeJourney.subscribe(t,(function(n){n?a():h(v)}));s.getDashboardManager().then((function(n){et=n.currentDashboardId.subscribe(t,(function(n){a();p=n;h(v)}));p=n.currentDashboardId()}));var u,f,o;y(e.default.blur,
f=function(){a()});y(e.default.focus,o=function(){h(v)});y(e.default.mousemove,u=function(){l(e.default.mousemove,u);h()});t.registerForDispose((function(){l(e.default.blur,f);l(e.default.focus,o);l(e.default.mousemove,u)}))}function st(){t&&(t.dispose(),t=null);a()}function h(n){o||s.activeJourney()||(n&&(nt=0,++g),tt=Date.now(),o=setTimeout((function(){it();o=null;h()}),k))}function a(){o!==null&&(clearTimeout(o),it());o=null}function it(){var n=Date.now()-tt;n>=d&&ut.trace({source:f.Source.Shell,action:f.Action.DashboardViewTime,data:{target:"Dashboard",trackId:p,timespan:n,sequenceId:g,sequence:++nt,tileCount:s.startBoard.children.filter((function(n){return!n.dontSetupWidget})).length,fullscreen:!!u.isFullscreen()}})}var rt=i.Base,ut=rt.Diagnostics.Telemetry,c=window,v=!0,w=3e5,b=1e4,y=c.addEventListener.bind(c),l=c.removeEventListener.bind(c),s,p="",ft,et,k=w,d=b,g=0,nt=0,o=null,tt,t;n.start=ot;n.stop=st})(o||(o={})),o}));define("MsPortalImpl/Interactions/Interactions.ContextMenuTouch",["require",
"exports","$","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r){"use strict";var u;return (function(n){function c(n){var i=n.originalEvent,t=i&&i.touches,r=t&&t.length===1,u=t&&t[0];return r?u:null}function v(){var n={width:0,height:0,top:t.targetY,left:t.targetX};u.css(n);i("body").append(u);u.animate({width:f,height:f,top:"-="+(f/2+5),left:"-="+f/2},75)}function y(n){if(n){var t={opacity:.2},i={opacity:1};u.animate(t,25).animate(i,25).animate(t,25).animate(i,25)}u.animate({width:0,height:0,top:"+="+f/2,left:"+="+f/2},75,(function(){u.detach()}))}function o(n,i){i.off(e);s.clearTimeout(h);y(n);t={startTime:0,target:null,targetX:0,targetY:0}}function p(n){o(!0,i(n.currentTarget))}function w(r){var u=c(r)||{clientX:0,clientY:0},f=i(r.currentTarget),e=Math.abs(t.targetX-u.clientX),s=Math.abs(t.targetY-u.clientY);(e>n.MoveTolerancePixels||s>n.MoveTolerancePixels)&&o(!0,f)}function b(u){var s=i(u.currentTarget),h,f;t.startTime&&(h=Math.abs(Date.now()-t.startTime),h>=n.ReactionDelayMillis&&
(s.off(r.default.contextmenu+e),f=i.Event(r.default.contextmenu),f.clientX=t.targetX,f.clientY=t.targetY,i(t.target).trigger(f)));o(!1,s)}function l(u){var f=c(u),l=i(u.currentTarget);if(!f){o(!0,l);return}if(!t||t.startTime===0){t={startTime:Date.now(),target:u.target,targetX:f.clientX,targetY:f.clientY};h=s.setTimeout((function(){v()}),n.ReactionDelayMillis);l.on(r.default.contextmenu+e,(function(){return!1})).on(r.default.touchmove+e,w).on(r.default.touchcancel+e,p).on(r.default.touchend+e,b)}}function k(n){n.on(r.default.touchstart,l)}function d(n){n.off(r.default.touchstart,l);o(!0,n)}var s=window;n.ReactionDelayMillis=550;n.MoveTolerancePixels=10;n.HintClassIdentifier="fxs-contextMenuTouchHint";var a="<div class='"+n.HintClassIdentifier+"' style='position: fixed;z-index: 500border: 2px solid grey;box-sizing: border-box;background-color: rgba(255, 255, 255, 0.2);pointer-events: none;'><\/div>",u=i(a),f=110,e=".cmtevt",h,t={startTime:0,target:null,targetX:0,targetY:0};n.register=k;n.unregister=
d})(u||(u={})),u}));define("MsPortalImpl/Widgets/Widgets.ContextPane",["require","exports","f","ko","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Svg/Startup/Close.svg","MsPortalImpl/Svg/Startup/Hamburger.svg","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var a;return (function(n){var v=f.findByClassName,y=s.ContextPane,p="fxs-contextpane",a="fxs-contextpane-close",t="fxs-contextpane-expand",w="fxs-progress-dots",b="fxs-contextpane-button-inner",k="fxs-contextpane-content",d="fxs-portal-bg-txt-br",nt=(function(n){function t(){n.call(this,"fxs-contextpane-identifier");this.opened=r.observable(!1);this.loading=r.observable(!1)}return __extends(t,n),t})(c.ViewModel),g;n.ViewModel=nt;g=(function(n){function s(r,f){n.call(this,r,f);var s=
'<button type="button" class="'+t+' fxs-display-none"><div class="'+b+' fxs-portal-svg">'+u.getSvgReferenceOrFallBackToData(o)+"<\/div><\/button>"+('<button type="button" class="'+a+' fxs-display-none" title="'+i.encodeAttribute(y.close)+'"><div class="'+b+' fxs-portal-svg">'+u.getSvgReferenceOrFallBackToData(e)+"<\/div><\/button>")+('<div class="'+w+'">')+"<div><\/div><div><\/div><div><\/div><\/div>";r.addClass(p).addClass(d).attr("role","complementary").append(s);this._$closeButton=v(r,a);this._$expandButton=v(r,t);this._$progress=v(r,w);this._init();this._attachEventHandlers(f)}return __extends(s,n),s.prototype.dispose=function(){this._cleanElement(p,d);this.element.removeAttr("role");n.prototype.dispose.call(this)},s.prototype.hasContent=function(){return!!this._$content},s.prototype.addChild=function(n){var t,i;if(!n)throw new Error("Can't add null child.");this.hasContent()&&this.removeChild(null);t=this._$content=n.element?n.element:n;t.addClass(k).insertBefore(this._$progress);
i=!t.hasClass("fxs-blade")&&!t.hasClass("fxs-partgallery-container");f.toggle(this._$closeButton,i);f.toggle(this._$expandButton,t.hasClass("fxs-partgallery-container"))},s.prototype.insertChild=function(n){this.addChild(n)},s.prototype.removeChild=function(n,t){return this._$content?(t?this._$content.detach():this._$content.remove(),this._$content.removeClass(k),this._$content=null,!0):!0},s.prototype.clear=function(n){return this.removeChild(null,n)},s.prototype.setFocus=function(){if(!i.isFeatureEnabled("skipautofocus")){var n=this._$content;n&&h.waitForBindings(this.element[0]).then((function(){n.findFirstTabbable().focus()}))}},s.prototype._init=function(){var n=this.ltm,t=this.element,i=this.options;r.reactor(n,(function(){var n=i.opened();t.toggleClass("fxs-contextpane-visible",n)}));r.reactor(n,(function(){var n=i.loading();t.toggleClass("fxs-contextpane-loading",n)}))},s.prototype._attachEventHandlers=function(n){var r=this.element,i=r.findByClassName.bind(r),u,f;i(a).on(l.default.click,
u=function(){r.trigger(l.default.fxcontextpaneclosing)});i(t).on(l.default.click,f=function(){n.collapsed(!n.collapsed())});n.collapsed&&n.collapsed.subscribeAndRun(this.ltm,(function(n){i(t).attr({title:n?y.expand:y.collapse,"aria-expanded":!n})}));this.ltm.registerForDispose((function(){i(a).off(l.default.click,u);i(t).off(l.default.click,f)}))},s})(c.Widget);n.Widget=g})(a||(a={})),a}));define("_generated/Templates/WidgetsPanorama",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-startboard-target" aria-labelledby="startboard-title"><\/div> <div class="fxs-journey-target"><\/div>'}}));define("MsPortalImpl/Widgets/Widgets.Panorama",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsPanorama","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css"],
(function(n,t,i,r,u,f,e,o,s){"use strict";var v=window,h="fxs-panorama",c=i.encodeHtml(r.Portal.preview),l="Can't add null child.",y=(function(n){function t(t,i){n.call(this,t);this.rotateThemeEvent=null;this.applyViewSettings(i)}return __extends(t,n),t.prototype.getViewSettings=function(){return{}},t.prototype.applyViewSettings=function(){return},t})(o.ViewModel),a;t.ViewModel=y;a=(function(n){function t(t,i){var r=this;n.call(this,t,i);t.addClass(h).html(f());t.findByClassName("fxs-panorama-previewbadge").attr("title",c).findByClassName("fxs-panorama-previewbadge-text").text(c);this.ltm.registerForDispose(t.setEvents([s.default.doubleclick,function(n){var t=$(n.target),i=t.hasClass(h),u=t.hasClass("fxs-startboard-layout"),f=t.hasClass("fxs-flowlayout-childcontainer"),e=t.hasClass("fxs-journey-layout"),o=t.hasClass("fxs-journey-placeholder");(i||u||f||e||o)&&(n.preventDefault(),n.stopPropagation(),v.getSelection().removeAllRanges(),r.trigger(s.default.fxrotatetheme))}]))}return __extends(
t,n),t.prototype.dispose=function(){this._cleanElement(h);n.prototype.dispose.call(this)},t.prototype.addChild=function(n){if(!n)throw new Error(l);this.getJourneyWidget().addChild(n)},t.prototype.insertChild=function(n,t){if(!n)throw new Error(l);this.getJourneyWidget().insertChild(n,t)},t.prototype.removeChild=function(n){var t=this.getJourneyWidget();return t&&t.removeChild(n)},t.prototype.getStartBoardArea=function(){return this.element.findByClassName("fxs-startboard-target")},t.prototype.getJourneyArea=function(){return this.element.findByClassName("fxs-journey-target")},t.prototype.getStartBoardWidget=function(){return u.Widget.getWidget(this.getStartBoardArea(),e.Widget)},t.prototype.getJourneyWidget=function(){var n=u.Widget.getWidgets(this.getJourneyArea());if(n.length>1)throw new Error("The journey target has been initialized with more than one widget.");return n[0]},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t})(o.Widget);t.Widget=a}));define(
"_generated/Templates/WidgetsSearch",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-search" role="search" data-bind="css: { \'fxs-search-expanded\': data.isExpanded() }, attr: { \'aria-label\': searchLabel }"> <div class="fxs-box-wrapper" data-bind="css: { \'fxs-searching\': data.showSearching() }"> <div class="fxs-icon msportalfx-svg-flip-horizontal" data-bind="image: data.icons.search, attr: { title: searchLabel}"><\/div> <div class="fxs-searchbox fxs-topbar-input"><\/div> <div class="fxs-indicator"> <div><\/div><div><\/div><div><\/div> <\/div> <div role="presentation" aria-hidden="true" class="fxs-cross">&times;<\/div> <\/div> <a href="#" class="fxs-search-icon fxs-topbar-button fxs-trim-svg fxs-trim-hover" role="button" data-bind="attr: { title: searchLabel, \'aria-label\': searchLabel }" > <div class="msportalfx-svg-flip-horizontal" data-bind="image: data.icons.search"><\/div> <\/a> <div class=\'fxs-menu fxs-popup fxs-portal-bg-txt-br fxs-dropmenu-content\' data-bind=\'visible: data.showMenu()\' title=\'\'><\/div> <\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.Search",["require","exports","f","ko","MsPortalImpl/Resources/ImplScriptResources","Viva.Controls/Controls/Forms/Viva.TextBox","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsSearch","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Svg/Startup/Search.svg","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){var l=i.Base,c;n.searchClass="fxs-search";n.searchBoxClass="fxs-searchbox";var a="fxs-search-icon",v="fxs-hidden-important",t=u.Search,y=(function(n){function i(){n.apply(this,arguments);this.isExpanded=r.observable(!1);this.showMenu=r.observable(!1);this.showResults=r.observable(!1);this.showSearching=r.observable(!1);this.showExternalColumn=r.observable(!1);this.showAllSubscriptionsSearch=r.observable(!1);this.showChangeSubscriptions=r.observable(!1);this.icons={search:l.Images.CustomImageWithOptions(h,{isLogo:!0})};this.text=t;this.filter=r.observable(
);this.searchInFilterText=r.observable();this.subscriptionSummary=r.observable();this.mruItems=r.observableArray();this.results=r.observableArray()}return __extends(i,n),i})(e.ViewModel);n.ViewModel=y;c=(function(e){function h(h,c){var l=this,b;e.call(this,h,c);this._initialized=Q.defer();b=n.searchClass;h.addClass(b).html(o());window.fx.environment.chrome.hideSearchBox&&h.addClass(v);this._bindDescendants({text:c.text,searchLabel:u.KeyboardShortcuts.search});var tt=h.findByClassName(n.searchBoxClass),k=this._textWidget=new f.Widget(tt,{placeholder:i.isFeatureEnabled("globalsearch")?r.observable(t.globalPlaceholder):r.observable(t.placeholder),readonly:r.observable(!1)}),it=this._textField=$(k._getElementToFocus()),w,d,g,y=s.default.focusin,nt=s.default.mousedown,p=h.findByClassName(a);h.on(y,w=function(){h.off(y,w);c.showMenu(!0);var n=l._initOptions;(n&&n()||Q(!0)).then((function(){i.require("MsPortalImpl/Widgets/Widgets.SearchDefered").then((function(n){l._initialized.resolve();n.initialize(
l,it)}))}))});p.on(y,d=function(n){n.preventDefault();l.setFocus()});p.on(nt,g=function(n){n.preventDefault();l.setFocus()});this.ltm.registerForDispose((function(){k.dispose();h.off(y,w);p.off(y,d);p.off(nt,g)}))}return __extends(h,e),h.prototype.setFocus=function(){this.options.isExpanded(!0);this._textField.focus()},h.prototype.initOptions=function(n){this._initOptions=n},h.prototype.isDropdownInitialized=function(){return this._initialized.promise},h})(e.Widget);n.Widget=c})(c||(c={})),c}));define("MsPortalImpl/Widgets/Widgets.SideBar",["require","exports","f","i","ko","MsPortalImpl/Base/Base.Router","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Svg/Startup/AllServices.svg","MsPortalImpl/Svg/Startup/CaretUp.svg","MsPortalImpl/Svg/Startup/DoubleChevron.svg","MsPortalImpl/Svg/Startup/Ellipsis.svg",
"MsPortalImpl/Svg/Startup/Hamburger.svg","MsPortalImpl/Svg/Startup/Hyperlink.svg","MsPortalImpl/Svg/Startup/Plus.svg","MsPortalImpl/Svg/Startup/Star.svg","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){"use strict";function st(n,t,i){vt.Diagnostics.Telemetry.trace({source:h.Source.SideBar,name:t,action:n,data:i})}function oi(n,t,i,r){var u=r?tt.expand:tt.collapse;n.toggleClass("fxs-sidebar-is-collapsed",r);t.attr({title:u,"aria-expanded":!r});rt&&(t.hasClass(lt)?t.removeClass(lt):t.addClass(lt))}function si(n){var f=n.isCollapsed,e=f(),t=!e,r=n.saveCollapseState,u;i.isFeatureEnabled("sideBarAutoCollapsedInJourney")?(u=n.getStartboardVisible,u&&u()&&r&&r(t)):r&&r(t);f(t);st(ot.SideBarViewChanged,"",t?"collapsed":"expanded")}function gt(n,t,i){var f;if(t){var r=i.favorites,u=r.indexOf(n),e=r.indexOf(t);if(u||!t.opensExternal)return st(ot.SideBarFavoriteMoved,t.id,
{oldIndex:e,newIndex:u}),r.valueWillMutate(),f=r(),f.splice(u,0,f.splice(e,1)[0]),i.favoritesManager().move(u),r.valueHasMutated(),u}return-1}function hi(n,t,i){var f=$(document.activeElement).parent(),e=i===40?f.next(bt)[0]:f.prev(bt)[0],o,r;e&&(o=u.dataFor(e),r=gt(o,n,t),r>=0&&Q.fcall((function(){var i=t.favorites()[r].uri,n=$("."+wt+" [href|='"+i+"']")[0];n&&n.focus()})))}var vt=i.Base,ti=i.ViewModels.Obsolete.Forms.DropDown.ViewModel,it=vt.Images,ii=window,yt=ii.fx.environment,ut=l.default.click,ht=".fxs-sidebar-droppable",ri=r.Extension.getHubsWindowId()+"_Dashboard",ft="fxs-sidebar-entered",et=".fxs-sidebar-entered",pt="fxs-sidebar-flyout",ct=l.default.keydown,wt="fxs-sidebar-bar",bt="li.fxs-sidebar-item",lt="fxs-sidebar-collapse-button-flip",tt=e.SideBar,ot=h.Action,rt=i.isFeatureEnabled("improvedsidebar"),at=".fxs-sidebar-item-link",kt='<button class="fxs-sidebar-collapse-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="image: data.collapseIcon"><\/button><!-- ko if: data.cloudOptions().length > 1 --><div class="fxs-sidebar-cloudFilter" data-bind=\'formElement: func.cloudDropDown\'><\/div><!-- /ko --><button class="fxs-sidebar-create fxs-trim-hover fxs-trim-border" role="button" data-bind="attr: { title: data.createTooltip, \'aria-label\': data.createTooltip }, visible: !data.hideCreateButton()"><div class="fxs-sidebar-button-flex"><div class="fxs-sidebar-create-icon fxs-fill-success" data-bind="image: data.icons.plus"><\/div><div class="fxs-sidebar-create-label fxs-sidebar-show-if-expanded fxs-trim-text" aria-hidden="true" data-bind="text: data.createText"><\/div><\/div><span class="fxs-hide-accessible-label" data-bind="text: data.newResourceAriaLabel"><\/span><\/button>',
dt='<div class="fxs-sidebar-middle"><ul class="fxs-sidebar-favorites" data-bind="attr: { \'aria-label\': data.svcListText }"><!-- ko foreach: func._favorites --><li class="fxs-sidebar-item fxs-trim-hover fxs-sidebar-draggable fxs-sidebar-droppable fxs-trim-border" draggable="true" data-bind="attr: {\'aria-label\': label }"><a tabindex=\'-1\' href=\'\' class=\'fxs-sidebar-item-link fxs-trim-text\' data-bind="attr: { href: uri, title: label }"><div class="fxs-sidebar-icon fxs-trim-svg" data-bind="image: image"><\/div><div class="fxs-sidebar-label fxs-sidebar-show-if-expanded" aria-hidden="true" data-bind="text: label"><\/div><div class="fxs-sidebar-external fxs-sidebar-show-if-expanded" data-bind="visible: $data.opensExternal"><div class="fxs-trim-svg-secondary" data-bind="image: $root.data.icons.hyperlink"><\/div><\/div><div class="fxs-sidebar-handle fxs-trim-svg-secondary" data-bind="image: $root.data.icons.ellipsis"><\/div><span class="fxs-hide-accessible-label" data-bind="text: label"><\/span><\/a><\/li><!-- /ko --><\/ul><\/div>',
ui='<nav class="fxs-sidebar-bar fxs-trim fxs-trim-text" data-bind="attr: { \'aria-label\': data.svcNavLabel }"><div class="fxs-sidebar-top">'+kt+"<\/div>"+(""+dt)+'<div class="fxs-sidebar-bottom"><div class="fxs-sidebar-browse fxs-trim-hover fxs-menu-browse msportalfx-vertical-center" tabindex="0" role="button" aria-expanded="false" data-bind="attr: { title: data.browseTooltip, \'aria-label\': data.browseText }"><div class="fxs-sidebar-button-flex"><div class="fxs-sidebar-browse-label fxs-trim-text fxs-sidebar-show-if-expanded" data-bind="text: data.browseText"><\/div><div class="fxs-sidebar-browse-icon fxs-trim-svg" data-bind="image: data.icons.caretUp"><\/div><\/div><\/div><div class="fxs-sidebar-flyout fxs-popup fxs-portal-bg-txt-br fxs-sidebar-flyout-is-hidden" role="presentation"><\/div><\/div><\/nav>',fi='<nav class="fxs-sidebar-bar fxs-trim fxs-trim-text" data-bind="attr: { \'aria-label\': data.svcNavLabel }"><div class="fxs-sidebar-top">'+kt+'<div class="fxs-sidebar-browse fxs-trim-hover fxs-menu-browse msportalfx-vertical-center" tabindex="0" role="button" aria-expanded="false" data-bind="attr: { title: data.browseTooltip, \'aria-label\': data.browseText }"><div class="fxs-sidebar-button-flex"><div class="fxs-sidebar-browse-icon fxs-trim-svg" data-bind="image: data.icons.allServices"><\/div><div class="fxs-sidebar-browse-label fxs-trim-text fxs-sidebar-show-if-expanded" data-bind="text: data.browseText"><\/div><\/div><\/div><div class="fxs-sidebar-flyout fxs-popup fxs-portal-bg-txt-br fxs-sidebar-flyout-is-hidden" role="presentation"><\/div><\/div><div class="fxs-sidebar-favorites-section"><div class="fxs-sidebar-pre-divider fxs-trim-border"><\/div><div class="fxs-sidebar-star-icon" data-bind="image: data.icons.star"><\/div><span class="fxs-sidebar-myfavorites" data-bind="text: data.myFavoritesText, visible: !data.isCollapsed()"><\/span><div class="fxs-sidebar-post-divider fxs-trim-border"><\/div><\/div>'+
(""+dt)+"<\/nav>",ei=(function(n){function t(){n.call(this);this.browseText=rt?tt.allServices:yt.branding.browseLabel;this.svcListText=tt.svcList;this.svcNavLabel=tt.svcNavLabel;this.closeText=tt.close;this.myFavoritesText=tt.myFavorites;this.browseTooltip=this.browseText;this.createText=rt?tt.createResource:tt.create;this.createTooltip=tt.createTooltip;this.newResourceAriaLabel=tt.newResourceAriaLabel;this.favorites=u.observableArray();this.isCollapsed=u.observable(!0);this.onFavoritesChanged=u.observableArray([]);this.onDashboardFavoriteClick=i.noop;this.possibleFavorites=u.observableArray();this.previewText=tt.preview;this.icons={hamburger:it.CustomImageWithOptions(b,{isLogo:!0}),allServices:v,doubleChevron:it.CustomImageWithOptions(p,{palette:5}),star:it.CustomImageWithOptions(g,{isLogo:!0,customClass:"msportalfx-svg-c11"}),plus:it.CustomImageWithOptions(d,{isLogo:!0}),hyperlink:it.CustomImageWithOptions(k,{isLogo:!0}),ellipsis:it.CustomImageWithOptions(w,{isLogo:!0}),caretUp:it.CustomImageWithOptions(
y,{isLogo:!0})};this.collapseIcon=rt?this.icons.doubleChevron:this.icons.hamburger;this.cloudOptions=u.observableArray();this.selectedCloud=u.observable();this.favoritesManager=u.observable();this.hideCreateButton=u.observable(!0);this.hideCreateButton(yt.chrome.hideCreateButton)}return __extends(t,n),t.prototype.openFavorite=function(n,t,i){var r;if(typeof n=="number"){var u=this.favoritesManager(),f=u&&u.favorites||this.favorites,e=f();if(n||e.length)r=f()[n];else if(r=this.possibleFavorites().first((function(n){return n.id===ri})),r)this.favorites.push(r);else this.onDashboardFavoriteClick(h.Source.SideBar)}else r=n;if(r){if(r.opensExternal)return this.openExternal(r.uri),!0;if(!t&&!i){if(r.opensDashboard)this.onDashboardFavoriteClick(h.Source.SideBar);else this.launchBlade(r.uri);return!0}}},t.prototype.openExternal=function(n){window.open(n,"_blank")},t.prototype.attachFavoritesManager=function(n){this.favoritesManager(n)},t.prototype.initLifetime=function(n){var t=this;this.favoritesManager.
subscribeAndRun(n,(function(i){i&&(s.connectDebouncedObservable(n,t.selectedCloud,i.selectedCloud,!0),s.connectDebouncedObservable(n,i.favorites,t.favorites))}))},t})(c.ViewModel),ni;t.ViewModel=ei;ni=(function(n){function t(t,r){var e=this,v,f,h,c,l;n.call(this,t,r);t.attr("role","presentation").html(rt?""+fi:""+ui);i.isFeatureEnabled("userdefineddefaultview")&&t.addClass("fxs-sidebar-defaultviewenabled");rt&&t.addClass("fxs-sidebar-improvedsidebar");this._createButton=t.findByClassName("fxs-sidebar-create");this._browseLink=t.findByClassName("fxs-sidebar-browse");v=this._collapseButton=t.findByClassName("fxs-sidebar-collapse-button");this._sideBar=t.findByClassName(wt);f=this.ltm;r.initLifetime(f);h=this._favorites=r.favorites.filter(f,(function(n){return n&&n.cloudName===r.selectedCloud()})).map(f,(function(n,t){return t.image=t.image&&i.Base.Images.CustomImageWithOptions(t.image,{isLogo:!0}),t}));h.extend({deferred:!0});c=t.find(".fxs-sidebar-favorites");h.subscribeAndRun(f,(function(){a.requestAnimationFrame(
(function(){var n=c.find(at+'[tabindex="0"]:eq(0)');n.length||c.find(at+":eq(0)").attr("tabindex","0")}))}));f.registerForDispose(new nt.KeyboardNavigation(c,12,at));this.cloudDropDown=new ti(f,{label:u.observable(tt.cloud),options:r.cloudOptions});l=this.cloudDropDown.value;r.cloudOptions.subscribe(f,(function(n){n.length>0&&!l()&&l(n[0].value)}));l.subscribe(f,(function(n){r.selectedCloud(n);r.favoritesManager().selectedCloud(n)}));this._bindDescendants();this._flyout=t.findByClassName(pt);this._attachEventHandlers(f,t,r);u.computed(f,r.onFavoritesChanged,(function(n){if(n.length){h();var i=o.findByClassName(t,"fxs-sidebar-favorites:first .fxs-sidebar-item");n.slice().forEach((function(n){n(i)}))}}));this._getSidebarFlyout=i.memoizeQ((function(){return i.require("MsPortalImpl/Widgets/Widgets.SideBarFlyout").then((function(n){var i=new n.ViewModel,t=new n.Widget(e.element.findByClassName(pt),i,e.options.favoritesManager());return e._initOptions&&e._initOptions().then((function(){t.options.openFeedbackPane=
e.options.openFeedbackPane})),t.options.launchBlade=e.options.launchBlade,t.options.openFavorite=e.options.openFavorite,s.connectDebouncedObservable(e.ltm,e.options.selectedCloud,t.options.selectedCloud,!0),t}))}));r.isCollapsed.subscribeAndRun(f,(function(n){oi(t,v,r,n)}))}return __extends(t,n),t.prototype.dispose=function(){n.prototype.dispose.call(this);this._cleanElement()},t.prototype.initOptions=function(n){this._initOptions=n},t.prototype.toggleFlyout=function(){var n=this._flyout.hasClass("fxs-sidebar-flyout-is-hidden");i.tryImmediateResolve(this._getSidebarFlyout(),(function(t){t.toggle(n)}))},t.prototype.openCreate=function(){st(ot.SideBarNewMenuOpened);this.options.launchBlade(f.getGalleryDeepLink("hub","",this.cloudDropDown.value()))},t.prototype.reorderFavorites=function(n){var t=u.dataFor(document.activeElement);hi(t,this.options,n)},t.prototype._attachEventHandlers=function(n,t,i){var f=this,s=this._flyout,h=this._sideBar,r=function(t,i,r,u){t.on(i,r,u);n&&n.registerForDispose(
(function(){t.off(i,r,u)}))},e,o;r(this._createButton,ut,null,(function(){f.openCreate()}));e=this._browseLink;o=function(n){s.addClass("fxs-sidebar-browse-shown");f.toggleFlyout();n.stopPropagation()};r(e,ut,null,o);r(e,ct,null,(function(n){var t=n.keyCode;if(t===13||t===32)return o(n),!1}));r(t,ut,".fxs-sidebar-item a",(function(n){var t=u.dataFor(n.target);st(ot.SideBarItemOpened,t.id,{isFavorite:t.isFavorite(),isHome:t.isHome()});f.options.openFavorite(t)&&n.preventDefault()}));r(this._collapseButton,ut,null,(function(){si(i)}));u.reactor(n,i.favorites,(function(n){n.forEach((function(n,t){n.isHome(!t)}))}));r(h,ct,null,(function(n){var i=n.keyCode,t;n.type===ct&&i===32&&(t=$(n.target),t.trigger(l.default.click),t.hasClass("fxs-sidebar-filter-input")||n.preventDefault(),n.stopPropagation())}));r(t,l.default.dragstart,".fxs-sidebar-draggable",(function(n){var t=n.originalEvent.dataTransfer;t.setData("text","fxs-draganddrop");t.effectAllowed="move";f._dragItem=u.dataFor(n.target)}));r(t,l.default.dragover,
null,(function(n){n.preventDefault()}));r(t,l.default.dragenter,null,(function(n){var t=$(n.target),i=t.closest(ht),r=t.closest(et);r.length===0&&($(et).removeClass(ft),i.length&&i.addClass(ft))}));r(t,l.default.dragleave,null,(function(n){var t=$(n.target).closest(ht).length===0?!0:!1;t&&$(et).removeClass(ft)}));r(t,l.default.drop,null,(function(n){var t=n.target,r=$(t).closest(ht),e=u.dataFor(t);n.preventDefault();$(et).removeClass(ft);r.length&&gt(e,f._dragItem,i)}))},t})(c.Widget);t.Widget=ni}));define("MsPortalImpl/Widgets/Widgets.ToastViewModel",["require","exports","a","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function e(n){var i=r.unwrap(n&&n.timeoutID);i&&t.clearTimeout(i)}var t=window,s=5e3,h=3e4,o;n.clearItemTimeout=e;o=(function(f){function o(n){n===void 0&&(n={});f.call(this);this.displayCount=4;this.shouldShowToasts=r.observable(!0);this._items=r.observableArray();this.eventHandlers=
r.observableArray();this.closeTitle=u.NotificationMenu.dismissToast;this.displayCount=n.displayCount||this.displayCount;this.shouldShowToasts=n.shouldShowToasts||this.shouldShowToasts}return __extends(o,f),o.prototype.addToasts=function(n){var t=this,f=i.isArray(n)?n:[n];f.length&&f.forEach((function(n){var l=t._items(),a=n.icon,v=n.title,y=n.description,p=n.uri,w=n.time,f=n.ids||[],h=n.data||null,o=n.duration||0,b=n.htmlContent||"",k=n.clickable!==!1,d=n.descriptiveText||u.Toast.description.format(n.title),i,s;if(o!==3)if(f.length>0&&(i=l.first((function(n){var t=n.ids();return f.some((function(n){return t.indexOf(n)>-1}))}))),i)i.icon(a),i.title(v),i.description(y),i.uri(p),i.time(w),i.ids(f),i.data(h),i.clickable(k),i.htmlContent(b),i.descriptiveText(d),i.duration(o),i.formSection(n.formSection),e(i),t.startRemoveTimer(i);else{s={icon:r.observable(a),title:r.observable(v),description:r.observable(y),uri:r.observable(p),time:r.observable(w),ids:r.observableArray(f),data:r.observable(h),htmlContent:
r.observable(b),timeoutID:r.observable(null),clickable:r.observable(k),onDismissFn:n.onDismissFn,descriptiveText:r.observable(d),duration:r.observable(o),formSection:r.observable(n.formSection)};(l.length<t.displayCount||t._canDeque(o))&&t._items.unshift(s);var tt=(h||{}).inlineForm,g=n.formSection,nt=g&&g.children()||[],c=nt.length>1&&nt[1].children();c&&tt.buttons.forEach((function(n,i){if(!n.endpoint){var r=c[i].onClick;c[i].onClick=function(){r();t.removeToast(s)}}}));t.startRemoveTimer(s)}}))},o.prototype._canDeque=function(n){for(var t,r,u=this._items(),i=0;i<=n+0;i++)for(t=u.length-1;t>=0;t--)if(r=u[t],r.duration()===i)return this.removeToast(r),!0;return!1},o.prototype.removeToast=function(t){n.clearItemTimeout(t);this._items.remove(t)},o.prototype.removeAllToasts=function(){this._items().forEach((function(t){n.clearItemTimeout(t)}));this._items.removeAll()},o.prototype.startRemoveTimer=function(n){var f=this,u=r.unwrap(n.duration)||0,i;u!==2&&(i=s,u===1&&(i=h),n.timeoutID(t.setTimeout(
(function(){f._items.remove(n)}),i)))},o})(f.ViewModel);n.ViewModel=o})(e||(e={})),e}));define("MsPortalImpl/Widgets/Widgets.Portal",["require","exports","f","ko","MsPortalImpl/Interactions/Interactions.ContextMenuTouch","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextPane","MsPortalImpl/Widgets/Widgets.Panorama","MsPortalImpl/Widgets/Widgets.Search","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/Widgets/Widgets.ToastViewModel","MsPortalImpl/Widgets/Widgets.TopBar","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.FocusHandler"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";var k;return (function(n){var it=i.Base.UriBuilder,rt=i.Base.Diagnostics.Telemetry,w=window,k=w.fx.environment.features.rapidtoasts,t="fxs-show-journey",d="fxs-show-startboard",
g="fxs-blade-position-feature2",ut="fxs-portal-peekmode",nt,tt;r.components.register("fxs-progress",{template:'<div class="fxs-progress-dots"><div><\/div><div><\/div><div><\/div><\/div>'});nt=(function(n){function t(){n.apply(this,arguments);this.topBar=new y.ViewModel;this.sideBar=new a.ViewModel}return __extends(t,n),t})(s.ViewModel);n.ViewModel=nt;tt=(function(n){function s(o,s){var nt=this,ft,ot,st,ht,ct,vt,lt,at,yt,pt,it;n.call(this,o,s);this.hasActiveJourney=!1;var et=this.ltm,tt=s.sideBar,rt=new y.Widget(o.findByClassName("fxs-topbar"),s.topBar,o.findByClassName("fxs-portal-console"));this.getTopBarWidget=function(){return rt};ft=new c.Widget(o.findByClassName("fxs-portal-content"),new c.ViewModel("fxs-panorama-instanceid"));this.getPanorama=function(){return ft};ot=new h.ViewModel;ot.collapsed=tt.isCollapsed;st=new h.Widget(o.findByClassName("fxs-portal-contextpane-left"),ot);this.getLeftContextPane=function(){return st};ht=new h.Widget(o.findByClassName("fxs-portal-contextpane-right"),
new h.ViewModel);this.getRightContextPane=function(){return ht};ct=new l.Widget(o.findByClassName("fxs-topbar-search"),new l.ViewModel);this.getSearchWidget=function(){return ct};u.register(o);f.register(o);vt=r.computed(et,(function(){return e.settings.notificationToastEnabledKey()&&k!=="0"&&k!=="true"}));lt=new v.ViewModel({shouldShowToasts:vt});this.getToastVM=function(){return lt};i.require("MsPortalImpl/Widgets/Widgets.Toast").then((function(n){et.registerForDispose(new n.Widget(o.findByClassName("fxs-topbar-toast"),lt))}));tt.getStartboardVisible=function(){return nt.isStartBoardVisible()};at=new a.Widget(o.findByClassName("fxs-sidebar"),tt);this.getSideBarWidget=function(){return at};yt=function(){nt.isJourneyVisible()||(i.isFeatureEnabled("sideBarAutoCollapsedInJourney")||tt.isCollapsed(e.settings.sideBarCollapsedKey()),nt.element.removeClass(d).addClass(t),nt.options.topBar.dashboardVisible(!1),b.FocusHandler.Instance.journey(!0))};pt=function(){tt.isCollapsed(e.settings.sideBarCollapsedKey(
));nt.element.removeClass(t).addClass(d);nt.options.topBar.dashboardVisible(!0);b.FocusHandler.Instance.journey(!1);var n=nt.getPanorama().getStartBoardWidget();n&&n.setFocus()};i.isFeatureEnabled("reservehozscroll")&&this.element.addClass(g);it=r.observable(!1);this.ltm.registerForDispose([rt,ft,st,ht,ct,at,function(){u.unregister(o);f.unregister(o)},this.element.setEvents([p.default.fxloadingontopbar,function(n,t){rt.loadingHint(t.id,!t.cancel);var i=ft.getJourneyWidget();i&&i.loadingHint(t.id,!t.cancel)}],[p.default.fxshowstartboard,pt],[p.default.fxshowjourney,yt],[p.default.fxdashboardactivity,function(){var n=nt.getPanorama().getJourneyWidget(),t=n&&n.getBlades()[0];t&&t.close(!1)}],[p.default.fxpeekmode,function(n,t){it(t&&t.enter!==undefined?!!t.enter:!it())}]),$(w).setEvents([p.default.keyup,function(n){n.which===27&&it(!1)}]),]);it.subscribe(et,(function(n){nt.element.toggleClass(ut,n);var t=nt.getPanorama().getJourneyWidget();t&&t.peekMode(n);rt.options.peekMode(n)}))}return __extends(
s,n),s.prototype.dispose=function(){n.prototype.dispose.call(this);this._cleanElement(g)},s.prototype.isStartBoardVisible=function(){return!this.element.hasClass(t)},s.prototype.isJourneyVisible=function(){return this.element.hasClass(t)},s.prototype._hasJourneyWithContent=function(){var n=this.getPanorama(),t=n&&n.getJourneyWidget(),i=this.getRightContextPane();return t&&t.hasChildren()||i&&i.options.opened()},s.prototype.handleStartButtonClick=function(){var t=o.ActionModifier.PortalScrolled,i=new it(w.location.href),r=!i.fragment,n;this.isStartBoardVisible()||(this._hasJourneyWithContent()&&r&&!this.hasActiveJourney?(n=this.getPanorama().getJourneyWidget(),n&&n.close()):(this.element.trigger(p.default.fxhomebuttonclick),t=o.ActionModifier.StartBoardRestored));rt.trace({source:o.Source.Desktop,action:o.Action.HomeButtonClicked,actionModifier:t})},s})(s.Widget);n.Widget=tt})(k||(k={})),k}));define("MsPortalImpl/UI/UI.Initialize",["require","exports","f","i","a","ko","$","MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector",
"MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/ClaimsIdentity","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels","MsPortalImpl/Controls/ControlBindings.Async","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/ExtensionMetadataSource","Fx/Feedback","MsPortalImpl/GalleryPackage/GalleryPackageLoader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Languages","MsPortalImpl.Controls/Controls/ResourceFilterHelper","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.AzureStorage","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/Services/Services.Controller","MsPortalImpl/Services/Services.FileUploadEndpointRegistration",
"MsPortalImpl/Services/Services.FileUploadInitialization","MsPortalImpl/Services/Services.GalleryEndpoints","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/Services/Services.PortalIdentity","MsPortalImpl/Services/Services.PortalTips","MsPortalImpl/Services/Services.SharedSettings","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.ShellProvisioner","MsPortalImpl/Services/Services.TelemetrySharing","MsPortalImpl/Services/Services.Util","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Services","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration",
"MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks","MsPortalImpl/UI/Hubs/UI.NotificationsPane","MsPortalImpl/UI/UI.NpsHelper","MsPortalImpl/UI/Hubs/UI.ResourceMapManagerRpc","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration","MsPortalImpl/UI/UI.SessionHandler","MsPortalImpl/UI/UI.StatusHandler","MsPortalImpl/UI/UI.ViewTimeTelemetry","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.KnockoutExtensions","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding",
"MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Parts/Parts.ButtonPart","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration","MsPortalImpl/UI/UI.DialogManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai,vi,yi,pi,wi,bi,ki,di,gi){"use strict";function nu(n,t){t&&t.startsWith("#")&&n.route(t)}function bf(n,t,i){return[n,t].forEach((function(n){var t=n.length;if(t!==1)throw new Error("Unexpected length '"+n.selector+"': "+t);})),new ku(n,t,i)}function fr(n,t,i){pr({source:n,action:t,data:i})}function ou(n,t){return Q().then(t).catch((function(n){cr.error(n)})).then((function(){return n.getCodeComponentsMetadata()}))}function kf(n){var f,e;if(n&&yr&&yr.getEntriesByType&&yr.timing){var u=ir(),i=function(n,t,i){bu(n,{duration:t,endTime:
Math.round(i+yr.timing.navigationStart)})},o=yr.getEntriesByType("resource").filter((function(n){var t=n.initiatorType;return t==="link"||t==="script"})),r=o.reduce((function(n,t){return Math.min(t.startTime,n)}),Infinity),t=o.reduce((function(n,t){return Math.max(t.responseEnd,n)}),0),s=t-r,h=t;return r=Math.max(r,n),t=Math.min(t,u),f=t-r,e=u-f-n,i("TotalTimeToSplashScreen",n,n),i("TotalStartupResourceDownload",s,h),i("StartupResourceDownload",f,t),i("StartupScriptExecution",e,u),e}}function bu(n,t){t=t||{};var r=t.duration||ir(),i=t.data||{};return i.cdn="CdnIndex"+dr.index,i.bundling="Bundling"+dr.bundling,pr({timestamp:t.endTime,source:hr,action:n,actionModifier:ar.ActionModifier.Complete,duration:r,data:i}),r}function df(n,t){var i=n.getValue(yu,vu,pu);return t!==i&&n.setValue(yu,vu,t,pu),i}function gf(){bi.registerPrefix(v.PinVMPrefix,"./MsPortalImpl/Extension/PinBladeInferred",(function(n,t,i,r){return n.createViewModel(t,i,r)}))}function ne(n,t,r,u,f){var o=new ci.ViewModel,c=i.memoizeQ(
(function(){return nr("MsPortalImpl/Widgets/Widgets.NotificationsPane").then((function(n){return new n.Widget(e("<div/>"),o,t)}))})),s=i.memoizeQ((function(){return nr("MsPortalImpl/UI/Hubs/UI.NotificationHelper")})),h;t.notificationManager.notifications.subscribeArrayChanges(f,(function(n){s().then((function(t){return t.showToastAndUpdateCount(n,o,r)}))}),(function(n){s().then((function(t){return t.removeToastAndUpdateCount(n,o,r)}))}));f.registerForDispose(n.options.topBar.notificationButtonClick=function(){c().then((function(n){n.toggleNotificationsContextPane().then((function(){r.removeAllToasts();s().then((function(n){return n.updateUnreadCountOnButton(0)}))}))}))});h={events:gi.default.fxtoastclick,handler:function(n,t){u.handleNotificationClick(t,!0)}};r.eventHandlers.push(h)}function te(n,t,r,u,f){var o=i.memoizeQ((function(){return nr("MsPortalImpl/Widgets/Widgets.SettingsPane").then((function(n){var i=new n.ViewModel;return new n.Widget(e("<div/>"),i,t,r,f)}))}));u.registerForDispose(o);n.element.on(
gi.default.fxsettingsbuttonclick,(function(){o().then((function(n){fr(vr.TopBar,er.SettingsPaneOpen);n.toggleSettingsContextPane()}))}))}function ie(n,t){n.feedbackButtonClick=function(){t.getService("FeedbackPane").then((function(n){var t=n.widget;fr(br,er.FeedbackSmileyClicked,{isPaneOpen:t.isVisible()});t.toggle()}))}}function re(n,t,r,u,f){var o=i.memoizeQ((function(){return nr("MsPortalImpl/Widgets/Widgets.DirectoryPane").then((function(n){return new n.Widget(e("<div><\/div>"),new n.ViewModel,{portalServices:t,subscriptionsPromise:r,userInfoPromise:u})}))}));f.registerForDispose(n.options.topBar.directoryButtonClick=function(){o().then((function(n){n.toggleDirectoryContextPane()}))})}function ue(n,t,i,r,u){var f=function(n){return nr("MsPortalImpl/Widgets/Widgets.SharedOptionsInit").then((function(t){n(t)}))};n.initOptions((function(){return f((function(t){t.initSearchWidgetOptions(u,n,i,r)}))}));t.initOptions((function(){return f((function(n){n.initSideBarWidgetOptions(u,t,i)}))}));t.options.onDashboardFavoriteClick=
function(n){i.router.navigateToDashboard(n)}}function fe(n,t,r,u,f,e,o,s,h,c,l){var a=n.getTopBarWidget(),v=n.getSearchWidget(),y=n.getSideBarWidget(),p=a.options;te(a,t,r,h,l);ie(p,t);ue(v,y,t,e,h);ne(n,t,f,c,h);i.isFeatureEnabled("directorypane")&&re(n,t,r,u,h)}var sr=r,du=sr.Data,gu=sr.Extension,nf=sr.TriggerableLifetimeManager,lr=i.Base,tu=lr.Constants,tf=tu.Shell,iu=lr.Diagnostics,ar=iu.Telemetry,su=r.NetDiagnostics,rf=lr.Resources,hu=r.Rpc,uf=i.Hubs.Notifications,ff=uf.NotificationStatus,ef=sr.Hubs.Notifications,of=i.Services,sf=tu.DefaultCloudName,cu=lr.Net2,er=ri.Action,vr=ri.Source,hf=i.Helpers,or=MsPortalImpl.Performance,ru=lr.UriBuilder,ur=window,yr=ur.performance,lu=ur.fx,ir=lu.getTimestamp,pr=ar.trace,uu=hu.client,hr=vr.Shell,tr=lu.environment,cf=tr.chrome,wr=tr.links,br=vr.TopBar,nr=i.require,lf=i.ensureSuffix,af=i.pathJoin,kr=lf(rf.getAppRelativeUri("/"),"/"),vf=ur.console,rr=ur.location,cr=iu.createLog(n),au=kr+"SignOut",yf=kr+"signin/index",pf=tr.errorPageUri,wf=tr.isDevelopmentMode,
vu="loadedPageVersion",yu=wt.ComponentName.Telemetry,pu=0,dr=tr.cdn,fu=i.isFeatureEnabled("ci"),eu,gr,wu=function(){cr.warning.apply(cr,arguments)},ku;cu.setAjaxLogFunc(wu);t.routeIfHash=nu;t.create=bf;ku=(function(){function t(n,t,i){this._lifetime=new nf;this._disposed=!1;this._dependencies=i;this._element=n;this._$splashScreen=t;this._idleSvc=bt.createInstance()}return t.prototype.initialize=function(){var t=this,u=this._lifetime,ot=this._$splashScreen,bt=i.memoizeQ((function(){return ei.getDialogManagerModule().then((function(n){return n.getOrCreate(t._idleSvc)}))}));u.registerForDispose(bt);var ci=function(n,i){return t._redirect({uri:n,skipFlushBuffers:i})},yt=this._dependencies,v=yt.settings,wt=yt.extensionManager,bi=yt.storageService,lr=new ru(rr.href),yr=Q(ur.fx.early.authBootstrapStatePromise);return yr.then((function(yr){var af=function(n,t,r){var u=new ru(n+rr.search+(r||"")),f=dr.forceIndex,e=u.query;f&&e.setParameter(dr.indexParameter,f);t&&i.forEachKey(t,(function(n,t){return e.
setParameter(n,t)}));ci(u.toString())},nf,yu,re;if(!yr){af(kr,null,rr.hash);return}yr.createdOn||(yr.createdOn=Date.now());kt.updateAuthState(yr);tr.enableAnimations||e.enableAnimations(!1);yu=t._idleSvc;ar.initialize(hr);lt.init(v);at.init(v);dt.init(v);var bf=gt.queryStores(v,[8,4,7]),ne=tr.pageVersion,te=df(bi,ne),vu={defaultRoute:!1,splashScreen:or.splashScreenLoadTime,initializeStart:ir(),cdnFailedIndex:yt.cdnFailedIndex,loadedSameVersion:ne===te,previousVersion:te||""};nt.shutdown();nt.initialize(t._element);var ue=nt.read(k.Shell.Reader.portalLoading,1,"portal"),lu,rf=lt.processor.initialized.then((function(p){function ge(n,t){fr(br,t);nu(gt,n)}function ve(n){return c.getAvatarImage(ti.avatarUri,ti.defaultAvatarUri,bi,n)}var we=lr.query.getParameter("l")!==undefined,ru,st,yi,cu,ue,pu,ct,oe,du,lt,gt,le,tf,sr,rf,of,ar,nt,ae,kf,dt,df,ye,pe;it.initialize(u,bi,p.rawLocale,tr.localeFromQuery,we)&&ci(null,!0);Q.fcall((function(){i.isObject(tr)&&vf.log("Version: "+tr.version+"\nSession: "+
tr.sessionId)}));vu.initializeGeneralSettings=ir();var ne=it.currentLocaleContext,te=ne.selectedDisplayLanguage,be=ne.selectedFormatCulture;fr(hr,er.PortalInitializeLanguage,{language:te,formatCulture:be||te});vt.initialize(yr.user);var ti=vt.getSignedInUser(),dr=ti.tenantId,ke=vt.getTenants(),re=f.observable(!1);d.initialize();u.registerForDispose((function(){d.dispose()}));ru=new ki.ViewModel;st=new ki.Widget(t._element,ru);u.registerForDispose((function(){tt.hide(t._element);ur.setTimeout((function(){st.dispose()}),100)}));lu=ei.initialize(u,yt,p,re,st,ci,bt);a.initialize(lu);yi=lu.desktop;ru.sideBar.onDashboardFavoriteClick=function(n){lu.router.navigateToDashboard(n)};rt.initialize(lu.assetTypeService,u);cu=Q(vt.getSubscriptions());ue=cu.then((function(n){hf(n);re((n&&n.subscriptions||[]).some((function(n){return n.requireRdfe})))}));t._notificationManager=lu.notificationManager;gu.extensionStatusEndPoint.register(uu,null,(function(n,t){n&&ie(n,t.srcWindowId)}));pu=st.options;ct=pu.topBar;i.isFeatureEnabled(
"azureconsole")&&(ct.getConsoleViewModel=function(){return nr("MsPortalImpl/Widgets/Widgets.Console").then((function(n){return new n.ViewModel({src:tr.consoleUri,getAuthToken:nf})}))});ct.exitDevMode=function(){tt.unhide(ot);MsPortalImpl.Extension.unregisterAll().then((function(){ci(kr)}))};var pi=function(){nr("../Base/Base.ClientRawFileDownload",n).then((function(n){n.downloadFile({provideText:function(){return se().then((function(n){return JSON.stringify(n,null,2)}))}},"PortalDiagnostics.json","charset=utf-8;application/json")}))},wi=i.memoizeQ((function(){return nr("../Base/Base.DebugInfo",n).then((function(n){return n.initialize(u,lu)}))})),de=cf.hideShortcuts?null:g.setup(st,lu,pi,(function(){wi().then((function(n){return n.toggleStickys(eu)}))})),ee=st.element,wu=function(){return nr("MsPortalImpl/Widgets/Widgets.WelcomeSequence").then((function(n){return new n.Widget(e("<div />"),new di.ViewModel,ee,v)}))};u.registerForDispose(wu);oe=i.memoizeQ((function(){return nr("MsPortalImpl/Widgets/Widgets.HelpPane").
then((function(n){return new n.Widget(e("<div/>"),new n.ViewModel,lu,pi.bind(t),de,v,wu)}))}));u.registerForDispose(ct.helpButtonClick=function(){oe().then((function(n){return n.toggle(vr.TopBar)}))});var se=function(){return Q.all([nr("MsPortalImpl/Base/Base.DiagnosticsPopup"),ue,ae]).spread((function(n){return n.getDiagnosticsData(lu,hf,lf,ku)}))},he=dr==="72f988bf-86f1-41af-91ab-2d7cd011db47",ce=i.getFeatureValue("showbugreportlink");return ct.canReportBug(ce==="force"||ce==="true"&&he),ct.reportBug=function(){nr("./UI.Portal.Actions",n).then((function(n){n.reportBug(lu,se,lr)}))},du=oi.createFavoritesManager(u,lu),lt=pu.sideBar,lt.attachFavoritesManager(du),gt=lu.router,le=i.getIdGenerator("SideBarOpeningBlade"),lt.launchBlade=function(n){var u=gt.route(n),r=st.getPanorama(),t=r&&r.getJourneyWidget(),i;t&&(i=le(),t.loadingHint(i,!0),u.finally((function(){t.loadingHint(i,!1);t.trigger(gi.default.fxbladerepos,null,{noScroll:!0,noExitPeekMode:!0})})))},tf=!1,sr=ou(uf,(function(){return uf.registerTestExtensionsFromUri(
rr.href)})).then((function(n){return typeof n=="string"?(gr=n,Q.reject()):n})),l.canModifyExtensions&&(sr=sr.then((function(n){return nr("MsPortalImpl/Extension/ExtensionPatch").then((function(n){var t=n.initializeTestPatch([],lu,ot);return ou(t,(function(){return t.registerTestPatchesFromUri(rr.href).then((function(){return t.listTestPatches().then((function(n){n=n||[];y.patchUris=n.map((function(n){return n.uri}));tf=!!n.length}))}))}))})).then((function(){return n}))}))),vu.preGetExtensionMetadata=ir(),of=sr.then((function(n){var t,i;return(vu.getExtensionMetadata=ir(),rf=at.processor.initialized.then((function(t){vu.favoritesManagerInitialized=ir();var i=t.favorites(),r=i&&JSON.parse(i);return fr(vr.SideBar,"SideBarSettings",{collapsed:p.sideBarCollapsedKey(),favorites:r,favoritesCount:r.length}),du.initializeFavorites(t,n)})),t=[sf],r.Extension.multiCloudEnabled&&(t=n.map((function(n){return n.cloudName})).unique().filter((function(n){return n!==tu.HubsCloudName}))),ut.setCloudNames(t),lt.cloudOptions(t.
map((function(n){return{text:f.observable(n),value:n}}))),wt.initialize({extensions:n,useCachedManifests:!0}),ku.registerGetAuthorizationTokenEndpoint(n),vt.initializeRpc(n),pt.initializeRpc(),et.initializeRpc(),ft.registerSasEndPoint(),ii.registerEndpoints(hu.client,lu.desktop),i=function(t){var i=n.some((function(n){return n.isTestExtension||n.isTestStamp}));return ct.inDevMode(i||t||tf),yi.initialize(n,bf,vu)},l.canAddGalleryPackages)?nr("MsPortalImpl/GalleryPackage/GalleryPackageMetadataSource").then((function(n){var t=n.initializeTestGalleryPackage([],lu,ot);return ou(t,(function(){return t.registerTestGalleryPackagesFromUri(rr.href)}))})).then((function(n){var t=b.initialize(wt);return t.loadGalleryPackages(n),n&&n.length>0})).then((function(n){return vu.galleryPackagesSideload=ir(),i(n)})):i(!1)})).then((function(){return vu.desktopAndExtensionManagerInitialize=ir(),gt.initialRoute((function(){return vu.defaultRoute=!0,i.isFeatureEnabled("userdefineddefaultview")?rf.then((function(){if(!lt.openFavorite(
0))throw new Error("Couldn't open first favorite.");})).catch((function(n){var t=cr.warning;return t.call(cr,new i.Errors.Error({message:"favoritesManagerInitialized failed",innerErrors:n})),lu.router.goToDashboardOnInit("UiInitialize")})):lu.router.goToDashboardOnInit("UiInitialize")}))})).then((function(){vu.setupInitialRoute=ir();tt.hide(ot);or.pageLoaded();vu.locationHash=lr.fragment.split("?")[0];vu.hiddenTime=or.getHiddenTime();var r={data:e.extend(vu,su.traceDocumentNavigation())};wt.getHubsExtension().then((function(){eu=bu("TotalTimeToPortalReady",r);var t=1;!fu&&i.isFeatureEnabled("userdefineddefaultview")&&p.whatsNewVersion()<t&&nr("../Services/Services.PortalTips",n).then((function(n){n.setup(u,rf,lt.onFavoritesChanged,t)}))}));t._idleHandle=yu.addCallbacks({onIdle:function(){var n=ur.navigator;n&&n.onLine!==!1&&(nt.avatarImage(ve(!0)),i.getFeatureValue("prefetch")!=="false"&&nr("MsPortalImpl/Services/Services.PortalPrefetch",null,!0).then((function(n){n.start(u,yu,bi,eu)})),tr.useCachedManifests&&
wt.refreshManifests().catch((function(){})),i.isFeatureEnabled("ldnstrace")&&nr("ldns",null,!0),nr("MsPortalImpl/Services/Services.BrowserTelemetry",null,!0));yu.removeCallbacks(t._idleHandle)},onBusy:i.noop});i.isFeatureEnabled("nodirectory")&&nt.dropMenu.isMenuOpen(!0)})).catch((function(n){gr=gr||"/LoadFailed?stack="+encodeURIComponent(n&&n.stack).substr(0,1e3);t._redirect({uri:pf+gr})})),bf.then((function(n){var t="userDefaultDirectory",i=n[7],r=i&&i[t];r!==dr&&v.setSetting(7,t,dr)})),of.then((function(){var n,r,u,f;!fu&&i.isFeatureEnabled("guidedtour")&&v.querySetting(7,"WelcomeSequence").then((function(n){n||wu().then((function(){fr(ri.Action.PortalInitializeWelcome,ri.Source.Shell)}))}));t._notificationManager.listenForClientNotifications();ht.init(v);!i.isFeatureEnabled("internalonly")||l.canModifyExtensions||he||(n=tr.trustedParentOrigin,r=n.replace(/^([^\/]+\/\/).+\.([^\.]+\.[^\.]+\.[^\.]+)$/,"$1$2"),n!==r&&(u=k.Portal,t._notificationManager.addClientNotification({status:ff.Information,title:
u.preview,description:u.unsupportedEnvironment.format(n),uri:r,timestamp:new Date,cloudName:null,uriAction:ef.ClientNotificationUriAction.OpenInCurrentTab})));s.isSafari&&s.webKitVersion<602&&(f=k.Portal,bt().then((function(n){return n.showModalDialog({title:f.unsupportedBrowser,description:f.unsupportedBrowserDesc.format(wr.unsupportedBrowser),buttons:1,showErrorIcon:!0})})))})).then((function(){var n=ur.navigator.serviceWorker;n&&n.getRegistrations&&n.getRegistrations().then((function(n){n.forEach((function(n){n.unregister()}))}))})),ut.setupAssetTypeServiceRpc(lu),ai.setupResourceMapManagerRpc(uu,lu),ni.create(lu),iu.ErrorReporter.initialize((function(){cr.debug(yi.getDiagnosticsData())})),o.initialize(yi,lu),ar=st.getToastVM(),fe(st,lu,cu,vt.getUserInfo(),ar,lt.selectedCloud,pi,wi,u,t._notificationManager,nf),w.Internal.showNpsEndpoint.register(lu.rpcClient,null,(function(n,t){li.showNps(ar,n.productDisplayName,(t.srcWindowId||"")+"_"+n.productId)})),w.Internal.canShowNpsEndpoint.register(lu.rpcClient,
null,(function(){return!li.npsShownInSession})),li.showPortalNps(ar,p.npsTimeMs),nt=ct.avatarMenu,nt.userIdentity(ti),nt.hideTenant(i.isFeatureEnabled("hideavatartenant")),vt.getUserInfo().then((function(n){nt.userInfo(n)})),ae=ke.then((function(n){var t=n.tenants;lf(t);nt.listOfTenants(t)})),nt.showDiagnostics=pi,nt.signedOut=function(){kt.updateAuthState(null);ci(au)},nt.openAccountPortal=function(){var n=wr.accountPortal;ge(n.startsWith("#")?n:n+"subscriptions",er.AvatarMenuOpenBilling)},nt.avatarImage(ve()),lt.saveCollapseState=function(n){p.sideBarCollapsedKey(n)},nt.giveFeedback=function(){fr(br,er.AvatarMenuOpenFeedback);nu(gt,wr.giveFeedback)},nt.showMyAccessBlade=function(){fr(br,er.AvatarMenuOpenAccessDetails);nu(gt,wr.accessDetails)},nt.switchedTenant=function(n,t){var i=h.getHashQueryStringSegment(rr.href);MsPortalImpl.localStorage.removeItem("LastValidSessionTs");af(yf+"/@"+t.tenant.domainName,null,"#"+i)},!fu&&(wf||tr.clientOptimizations&&tr.clientOptimizations!=="true"||l.canModifyExtensions)
&&wi().then((function(n){return n.startErrorDetection(u)})),u.registerForDispose(wi),kf="data-click-telemetry",dt=ee[0],dt.addEventListener(gi.default.mousedown,pe=function(n){df=n.target},!0),dt.addEventListener(gi.default.mouseup,ye=function(n){var i=df,r,t;if(df=null,n.target===i&&(r=e(i),t=r.closest("["+kf+"]",dt),t.length)){var o=t.attr(kf)+"",u=t.closest(".fxs-tile",dt).data(fi.CompositionInstanceDataName),f=u&&u.locator,s=f&&f.toFriendlyString()||hr;pr({source:s,action:er.CustomClick,name:o})}},!0),u.registerForDispose((function(){dt.removeEventListener(gi.default.mousedown,pe,!0);dt.removeEventListener(gi.default.mouseup,ye,!0)})),lu.browseManager.initialize(),ui.registerViewModels(lu),si.registerViewModels(),vi.registerViewModels({portalServices:lu,securityTokensManager:ku,subscriptions:hf,tenants:lf}),hi.registerRpcCallbacks(lu),gf(),of})),pu=pi.create(bt,rf,(function(n){t._redirect(n)}),(function(){tt.unhide(ot)})),ee=function(n,t){return pu.onLastTokenRefresh(n,t)},oe=function(n,t){
pu.onStatus({code:2,data:{isPrimaryToken:t}},n)},ie=function(n,t){pu.onStatus(n,t)},ku=kt.createSecurityTokensManager(kt.createOAuthTokenProvier(yr),ee,oe),uf=p.initializeTestExtension(yt.extensionsMetadata.map((function(n){return l.ExtensionMetadataExt.create(n)})),v,bi,bt,ot),hf=f.observable(),lf=f.observableArray();return new ct.GalleryEndpointsService(uu,wt,uf),du.registerTelemetrySubmissionHandler(),su.registerTelemetrySubmissionHandler(),sr.ProvisioningTelemetry.registerTelemetrySubmissionHandler(),cu.status.subscribe(u,(function(n){ie(n,tf)})),ar.addProcessor(ti.getProcessor(wt)),i.isFeatureEnabled("consoletelemetry")&&(re=of.getConsoleTelemetryEventProcessor(),ar.addProcessor(re)),MsPortalEarly.initializedTelemetry(pr),kf(or.splashScreenLoadTime),rf.then((function(){wi.start(lu)})).then((function(){function r(n){wu("Injecting {0}blockable untrusted content : {1} from {2}".format(n.blockable?"":"un",n.tag,n.src));fr(hr,"UntrustedSource",n)}function i(t){var i=t.src,s=t.tag,u=i!=="document.write",
f,e,o;return u&&s==="SCRIPT"&&(f=document.createElement("a"),f.href=i,i=f.href,e=/(.*?)[#\?]|$/.exec(i)[1]||i,o=!!n.filter((function(n){return!!~e.indexOf(n||null)})).length,u=!i||o||!!r(t)&&!1),u}var n=or.allowList=or.allowList.concat(tr.cdnPrefixes);n.push(rr.host);n.push("about:blank");or.sourceLogger=i;or.sourceBacklog.forEach(i);ue();nt.read(k.Shell.Reader.portalReady,1,"portal");yi.initialize(t._lifetime,lt.settings.idleTimeoutMins,t._idleSvc,(function(){return t._redirect({uri:au})}),vt.getSignedInUser().tenantDomain,pu)})),u.registerForDispose(wi.stop),nf=ku.initializeSecurityForShell(yr),st.registerFileUploadEndpoints(),ht.uploadSettingsManager=v,rf}))},t.prototype.dispose=function(){var n,t;this._disposed=!0;n=this._idleSvc;n&&(n.dispose(),this._idleSvc=null);sr.resetGlobalState();t=this._lifetime;t&&(t.dispose(),this._lifetime=null);kt.writeAuthState()},t.prototype._redirect=function(n){var t=n.uri,r=hf.Deferred(),i;tt.unhide(this._$splashScreen);pr({source:hr,action:er.PortalRedirect,
actionModifier:ri.ActionModifier.Redirect,data:t});i=function(){r.resolve()};n.skipFlushBuffers?i():(ot.flush(this._dependencies.settings).finally(i),ur.setTimeout(i,5e3));Q.allSettled([n.delayPromise,r]).finally((function(){if(!t){var n=new ru(rr.href);n.path=af("/",n.path,vt.getSignedInUser().tenantId,"/");t=n.toString()}rr.href=t}))},t})()}));define("_generated/Less/MsPortalImpl/Base/Base.Images.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".msportalfx-svg-c01{fill:#fff}.msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-c03{fill:#a0a1a2}.msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-c08{fill:#ba141a}.msportalfx-svg-c09{fill:#dd5900}.msportalfx-svg-c10{fill:#ff8c00}.msportalfx-svg-c11{fill:#fcd116}.msportalfx-svg-c12{fill:#fee087}.msportalfx-svg-c13{fill:#b8d432}.msportalfx-svg-c14{fill:#7fba00}.msportalfx-svg-c15{fill:#59b4d9}.msportalfx-svg-c16{fill:#3999c6}.msportalfx-svg-c17{fill:#804998}.msportalfx-svg-c18{fill:#ec008c}.msportalfx-svg-c19{fill:#0072c6}.msportalfx-svg-c20{fill:#68217a}.msportalfx-svg-c21{fill:#00188f}.msportalfx-svg-c22{fill:#e81123}.msportalfx-svg-c97{fill:#ffb900}.msportalfx-svg-c98{fill:#00a4ef}.msportalfx-svg-c99{fill:#f25022}.fxs-blade-header-icon .msportalfx-svg-c05,.fxs-sidebar-middle .msportalfx-svg-c05,.fxs-theme-dark .msportalfx-svg-c05,.msportalfx-inverted-theme .msportalfx-svg-c05{fill:#777}.fxs-blade-header-icon .msportalfx-svg-c07,.fxs-sidebar-middle .msportalfx-svg-c07,.fxs-theme-dark .msportalfx-svg-c07,.msportalfx-inverted-theme .msportalfx-svg-c07{fill:#f2f2f2}.msportalfx-svg-palette-white>*,.msportalfx-svg-palette-white>g>*{fill:#fff}.msportalfx-svg-palette-blue>*,.msportalfx-svg-palette-blue>g>*{fill:#3999c6}.msportalfx-svg-palette-black>*,.msportalfx-svg-palette-black>g>*{fill:#1e1e1e}.msportalfx-svg-palette-green>*,.msportalfx-svg-palette-green>g>*{fill:#7fba00}.msportalfx-svg-palette-gray>*,.msportalfx-svg-palette-gray>g>*{fill:#a0a1a2}.msportalfx-svg-palette-inherit>*,.msportalfx-svg-palette-inherit>g *{fill:inherit!important}.msportalfx-svg-badge{position:absolute;left:0;bottom:0;min-height:12px;min-width:12px}.ext-fxc-menu-icon>.msportalfx-svg-badge{left:8px;bottom:7px;min-height:8px;min-width:8px}.msportalfx-svg-disabled{filter:grayscale(100%)}@-moz-document url-prefix(){.msportalfx-svg-disabled{filter:none}}.msportalfx-svg-disabled .msportalfx-svg-c01{fill:#fff}.msportalfx-svg-disabled .msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-disabled .msportalfx-svg-c03{fill:#a1a1a1}.msportalfx-svg-disabled .msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-disabled .msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-disabled .msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-disabled .msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-disabled .msportalfx-svg-c08{fill:#676767}.msportalfx-svg-disabled .msportalfx-svg-c09{fill:#6f6f6f}.msportalfx-svg-disabled .msportalfx-svg-c10{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c11{fill:#898989}.msportalfx-svg-disabled .msportalfx-svg-c12{fill:#c3c3c3}.msportalfx-svg-disabled .msportalfx-svg-c13{fill:#838383}.msportalfx-svg-disabled .msportalfx-svg-c14{fill:#5d5d5d}.msportalfx-svg-disabled .msportalfx-svg-c15{fill:#999}.msportalfx-svg-disabled .msportalfx-svg-c16{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c17{fill:#717171}.msportalfx-svg-disabled .msportalfx-svg-c18{fill:#767676}.msportalfx-svg-disabled .msportalfx-svg-c19{fill:#636363}.msportalfx-svg-disabled .msportalfx-svg-c20{fill:#4e4e4e}.msportalfx-svg-disabled .msportalfx-svg-c21{fill:#484848}.msportalfx-svg-disabled .msportalfx-svg-c22{fill:#7d7d7d}.msportalfx-svg-disabled .msportalfx-svg-c97{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c98{fill:#787878}.msportalfx-svg-disabled .msportalfx-svg-c99{fill:#8a8a8a}.msportalfx-svg-loading-square{-webkit-animation:ProgressFlagAnimation 1.45s infinite ease-in-out;animation:ProgressFlagAnimation 1.45s infinite ease-in-out}.msportalfx-svg-loading-square:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.msportalfx-svg-loading-square:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.msportalfx-svg-loading-square:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}@-webkit-keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}@keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}.msportalfx-svg-flip-horizontal>svg,svg.msportalfx-svg-flip-horizontal{transform:scalex(-1)}.msportalfx-svg-flip-vertical>svg,svg.msportalfx-svg-flip-vertical{transform:scaley(-1)}.msportalfx-svg-rotate360{-webkit-animation:ImageRotation 1.45s infinite linear;animation:ImageRotation 1.45s infinite linear}@-webkit-keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}")})
);define("_generated/Less/MsPortalImpl/Themes/Themes.Universal.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,"a{color:#0078d7}.fxs-topbar{background-color:#1c1c1c;color:#fff}.fxs-topbar .fxs-bg-warning,.fxs-topbar.fxs-bg-warning{color:#000}.fxs-topbar .fxs-bg-warning svg,.fxs-topbar.fxs-bg-warning svg{fill:#000}.fxs-topbar-search .fxs-searchbox input{background-color:#444;color:#fff}.fxs-topbar-search .fxs-searchbox input::-webkit-input-placeholder{color:#bbb}.fxs-topbar-search .fxs-searchbox input:-ms-input-placeholder{color:#bbb}.fxs-topbar-search .fxs-searchbox input::-moz-placeholder{color:#bbb}.fxs-trim,.fxs-trim-text,.fxs-trim-text a,a.fxs-trim-text{color:#fff}.fxs-topbar-dashboard,.fxs-topbar-exit-customize{background-color:#8a2da5}.fxs-trim{background-color:#252525}.fxs-trim-btn{color:#fff;border-color:#fff}.fxs-trim-title{color:#bbb}.fxs-trim-selected{background-color:#444}.fxs-trim-hover:hover{background-color:#3d3d3d}.fxs-trim-border{border-color:#444}.fxs-trim-svg{fill:#fff}.fxs-trim-svg .fxs-portal-svg{fill:#fff!important}.fxs-trim-svg-secondary{fill:#bbb}.fxs-trim-text-primary a,a.fxs-trim-text-primary{color:#55b3ff}.fxs-sidebar-star.fxs-is-favorite svg{fill:#ffb900;stroke:#000;stroke-width:1px}.fxs-fill-white,.fxs-tile-actionbar-action{fill:#fff}.fxs-sidebar .azc-form-labelcontainer{color:#fff}.fxs-bg-white{background-color:#fff}.fxs-overlay{background:rgba(0,0,0,.7)}.fxs-highlight{color:#000;background-color:#fff100}.fxs-tile-actionbar{background-color:#9cd5f4}.fxs-tile-actionbar-action.fxs-tile-actionbar-action-pressed,.fxs-tile-actionbar-action:hover{background:#00bcf2}.fxs-tile-actionbar-action.fxs-tile-actionbar-command-unpinfromstartboard:hover{background:#ba141a}.fxs-portal .fxs-accent,.fxs-portal .fxs-popup{box-shadow:0 5px 15px 2px rgba(0,0,0,.3)}.fxs-portal .fxs-portal-main .azc-is-edited .azc-dockedballoon-validation.azc-control.azc-dockedballoon{border-color:#8a2da5}.fxs-blade-status-container,.fxs-blade-title-description{color:#000}.fxs-text-white{color:#fff}.fxs-br-primary{border-color:#00bcf2}.fxs-tile-selected .fxs-tile-overlay{background-color:transparent}.fxs-bg-overlay-dark{background:rgba(0,0,0,.7)}.fxs-bg-primary-10{background-color:rgba(0,188,242,.1)}.azc-is-edited.azc-has-focus{border-color:#7fba00}.azc-is-edited.azc-has-focus .azc-dockedballoon-validation{border-color:#00bcf2}.azc-is-edited .azc-dockedballoon-validation{border-color:#8a2da5}.azc-disabled:hover,.azc-row-disabled:hover{background-color:inherit}.azc-disabled,.azc-disabled:focus,.azc-disabled:hover,input.azc-disabled{cursor:default;outline:0}.fxs-part::after{border-color:#9cd5f4}.fxs-part.fxs-part-selected-command::after,.fxs-part.fxs-part-selected::after{border-color:#00bcf2}.fxs-portal .fxs-text-info,.fxs-portal .msportalfx-text-info{color:#0058ad}.fxs-portal .fxs-text-success,.fxs-portal .msportalfx-text-success{color:#7fba00}.fxs-portal .fxs-text-dirty,.fxs-portal .msportalfx-text-dirty{color:#8a2da5}.fxs-portal .fxs-text-warning,.fxs-portal .msportalfx-text-warning{color:#ff8c00}.fxs-fill-info,.msportalfx-fill-info{fill:#0058ad!important}.fxs-fill-complete,.fxs-fill-success,.msportalfx-fill-success{fill:#7fba00!important}.fxs-fill-dirty,.fxs-fill-upsell,.msportalfx-fill-dirty{fill:#8a2da5!important}.fxs-fill-warning,.msportalfx-fill-warning{fill:#ff8c00!important}.fxs-fill-error,.msportalfx-fill-error{fill:#e81123!important}.fxs-br-info,.msportalfx-br-info{border-color:#00bcf2!important}.fxs-br-success,.msportalfx-br-success{border-color:#7fba00!important}.fxs-br-dirty,.msportalfx-br-dirty{border-color:#8a2da5!important}.fxs-br-warning,.msportalfx-br-warning{border-color:#ff8c00!important}.fxs-br-error,.msportalfx-br-error{border-color:#e81123!important}.fxs-bg-info,.msportalfx-bg-info{background-color:#0058ad!important}.fxs-bg-success,.msportalfx-bg-success{background-color:#7fba00!important}.fxs-bg-dirty,.fxs-bg-upsell,.msportalfx-bg-dirty{background-color:#8a2da5!important}.fxs-bg-warning,.msportalfx-bg-warning{background-color:#ff8c00!important}.fxs-bg-error,.msportalfx-bg-error{background-color:#e81123!important}.fxs-blade-statusbg.fxs-bg-info{background-color:#d1e7f8!important}.fxs-blade-statusbg.fxs-bg-complete,.fxs-blade-statusbg.fxs-bg-success{background-color:#d1ebd1!important}.fxs-blade-statusbg.fxs-bg-dirty,.fxs-blade-statusbg.fxs-bg-upsell{background-color:#e4d5f0!important}.fxs-blade-statusbg.fxs-bg-warning{background-color:#fff0d1!important}.fxs-blade-statusbg.fxs-bg-error{background-color:#f9b1b7!important}")})
);define("MsPortalImpl/Init",["require","exports","f","MsPortalImpl/Base/Base.Router","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Services/Services.PortalIdentity","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.Initialize","MsPortalImpl/Services/Services.Storage","_generated/Less/MsPortalImpl/Base/Base.Images.css","_generated/Less/MsPortalImpl/Themes/Themes.Universal.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function nt(n){var t={fx:y.version};n||w.initializedExtensions.forEach((function(n){t[n.name]=n.extension.getVersion()}));ut.custom("Session",et,ot++,st,t)}var p=i.Base,rt=p.Diagnostics,b=p.UriBuilder,a=c.ComponentName,v=window,y=v.fx.environment,ut=rt.createLog(n),ft=y.cdn,l=c.create(),k=new b(v.location.href),d=JSON.parse(l.getValue(a.Redirect,"BootParameters",0)||"{}"),g;l.clearValue(a.Redirect,"BootParameters",0);l.clearValue(a.Redirect,"BootParameters",1);l.clearValue(
a.Redirect,"ReloadCount",1);v.fx.bootEnvironment=d.environment||{region:"unknown"};k.query=new p.QueryStringBuilder(d.userQuery);r.history_replaceState(null,v.document.title,k.toString());ft.enabled||(g=l.clearValue(a.Cdn,"FailedIndex",1));l.clearValue(a.Redirect,"IdpRedirectCount",1);var et=1,ot=0,st=l.clearValue(a.Redirect,"Referrers",1)||"";nt(!0);v.setInterval(nt,36e5);var w=u.create(),tt=o.createUserSettingsManager(l),it=h.create($("#web-container"),$("body").find("> .fxs-splashscreen"),{storageService:l,settings:tt,extensionManager:w,editScopeManager:e.createEditScopeManager(w),extensionsMetadata:y.extensionsMetadata,hubsMetadata:y.hubsMetadata,openWindow:function(n){var t=v.open();return Q(n).then((function(n){if(n){var r=new b(n),e=r.path,u=i.ensureSuffix(e,"/");i.localeCompareIgnoreCase(u,i.ensureSuffix(location.protocol+"//"+location.host,"/"))||(r.path=i.pathJoin("/",u,f.getSignedInUser().tenantId,"/"),n=r.toString())}t.location.href=n}))},cdnFailedIndex:g});it.initialize();$(
v).on("unload",(function(){tt.dispose();it.dispose()}))}))